"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[377],{316032:(e,t,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path fill-rule="evenodd" d="M4.22 2.47a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1 0 1.06l-3 3a.75.75 0 0 1-1.06-1.06L6.69 6 4.22 3.53a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/></svg>',name:"chevron_12"}}o.d(t,{getIcon12Chevron:()=>i})},126415:(e,t,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="m8.53 4.69.06.18-.22-.63a.83.83 0 0 0-1.6.47l.13.48-.23-.85a.82.82 0 0 0-1.6.24l-.73-2.93a.85.85 0 0 0-1.65.4L4 7.34 2.87 6.18A.8.8 0 0 0 1.66 7.2l2.23 2.94s1.23 1.83 4.3 1.23c2.43-.48 3.25-2.67 2.59-4.88l-.56-2.3a.88.88 0 1 0-1.7.49Z"/></svg>',name:"hand_point_up_12"}}o.d(t,{getIcon12HandPointUp:()=>i})},638770:(e,t,o)=>{function i(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.6 6.41a.9.9 0 0 1-.1-1.8 12.22 12.22 0 0 1 10 4.9c.58.84.9 1.7.9 2.49 0 .94-.46 1.98-1.24 2.97a.9.9 0 1 1-1.42-1.12c.41-.52.86-1.17.86-1.85 0-.31-.14-.82-.59-1.48a8.43 8.43 0 0 0-1.94-1.96A10.24 10.24 0 0 0 11.6 6.4ZM4.84 16.89A12.35 12.35 0 0 0 12 19.4c1.97 0 3.93-.6 5.6-1.52l1.26 1.26a.9.9 0 0 0 1.28-1.28L6.64 4.36a.9.9 0 0 0-1.28 1.28l.69.68c-.42.25-.82.51-1.2.8-.97.72-1.79 1.55-2.36 2.39-.57.84-.89 1.7-.89 2.49 0 .79.32 1.65.9 2.5.56.83 1.37 1.66 2.35 2.39ZM10.4 12a1.6 1.6 0 0 0 2.59 1.26l-2.25-2.25a1.6 1.6 0 0 0-.34.99Zm1.6 3.4a3.4 3.4 0 0 1-2.54-5.66l-2.09-2.1c-.51.28-1 .58-1.44.92a8.4 8.4 0 0 0-1.94 1.96A2.84 2.84 0 0 0 3.4 12c0 .31.14.82.59 1.48A10.56 10.56 0 0 0 12 17.6c1.43 0 2.92-.4 4.26-1.06l-2-2a3.39 3.39 0 0 1-2.27.86Z" clip-rule="evenodd"/></svg>',name:"hide_outline_24"}}o.d(t,{getIcon24HideOutline:()=>i})},143268:(e,t,o)=>{function i(){return{icon:'<svg fill="none" height="56" viewBox="0 0 56 56" width="56" xmlns="http://www.w3.org/2000/svg"><path d="M37.74 6c3.57 0 4.86.37 6.17 1.07s2.32 1.72 3.02 3.02c.7 1.3 1.07 2.6 1.07 6.17v23.48c0 3.57-.37 4.86-1.07 6.17a7.27 7.27 0 0 1-3.02 3.02c-1.3.7-2.6 1.07-6.17 1.07H18.26c-3.57 0-4.86-.37-6.17-1.07-1.3-.7-2.32-1.72-3.02-3.02S8 43.3 8 39.74V16.26c0-3.57.37-4.86 1.07-6.17.7-1.3 1.72-2.32 3.02-3.02S14.7 6 18.26 6zm.32 3h-19.8c-2.8 0-3.77.19-4.75.71a4.27 4.27 0 0 0-1.8 1.8c-.5.95-.7 1.87-.7 4.43L11 39.74c0 2.8.19 3.77.71 4.75a4.27 4.27 0 0 0 1.8 1.8c.99.52 1.95.71 4.75.71h19.48c2.8 0 3.77-.19 4.75-.71a4.27 4.27 0 0 0 1.8-1.8c.52-.98.71-1.95.71-4.75V16.26c0-2.8-.19-3.77-.71-4.75a4.27 4.27 0 0 0-1.8-1.8c-.95-.5-1.87-.7-4.43-.7zM18.72 38c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm-20-8c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13zm20 0c.44 0 .6.05.77.13.16.1.29.22.38.38.08.16.13.33.13.77v1.44c0 .44-.05.6-.13.77a.9.9 0 0 1-.38.38c-.16.08-.33.13-.77.13h-1.44c-.44 0-.6-.05-.77-.13a.9.9 0 0 1-.38-.38c-.08-.16-.13-.33-.13-.77v-1.44c0-.44.05-.6.13-.77a.9.9 0 0 1 .38-.38c.16-.08.33-.13.77-.13z" fill="currentColor"/></svg>',name:"video_outline_56"}}o.d(t,{getIcon56VideoOutline:()=>i})},287470:(e,t,o)=>{function i(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function n(e,t){return`<b>${e}</b><br/>${t}`}o.d(t,{buildTooltipeContent:()=>n,isElementInViewport:()=>i})},134551:(e,t,o)=>{o.d(t,{Video:()=>z});var i=o(474848),n=o(754866),s=o(412573),r=o(432081),a=o(892848),c=o(560377),d=o(102088),l=o(898848),u=o(270959),_=o(636576),h=o(342879),g=o(672277),v=o(246429),m=o(432465),E=o(593159),p=o(972332),I=o(683234),S=o(568129),T=o(843570),f=o(638770),w=o(963251),V=o(143268),C=o(150585),b=o(723022),y=o(287470),L=o(826619),A=o(952661),O=o(342018),P=o(540462),D=o(810068),M=o(856289),R=o(395846),N=o(450927),B=o(90345),k=o(3820),x=o(818515),F=o(538522),G=o(22421),H=o(873900),U=o(163068),Y=o(373594),j=o(205389),X=o(36644),W=o(971878),q=o(636826),K=o(428374);const z={VIDEO_SEARCH_TYPE:"search_videos",VIDEO_GLOBAL_SEARCH_TYPE:"search_global_videos",VIDEO_SEARCH_TOP_TYPE:"search_top_videos",ALBUM_SEARCH_TYPE:"search_albums",ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:"search_promo_albums",SEARCH_FILTERS:["hd","notsafe","live","date","order","len"],AVAILABLE_TABS:["all","uploaded","scheduled","albums","clips"],VIDEOS_PER_PAGE:60,VIDEOS_PER_ROW:3,PLAYLIST_FIRST_CHUNK_SIZE:9,PLAYLIST_OBJECT_ID_INDEX:6,SEARCH_KEEP_FILTERS_DELAY:3e3,SEARCH_STATS_POSITION_FIELDS:["oid","vid","clicked","viewStarted","viewedParts","viewedSeconds"],USER_SYSTEMS_ALBUM_TYPES:["type_my_uploaded","type_my_added","type_my_lives","type_my_recorded_calls"],DAY_IN_MS:864e5,getLoc:function(){const e=cur.showcaseSection&&"uploaded"===cur.showcaseSection&&(0,P.partConfigEnabled)("video_fix_load_more_uploaded_videos");return cur.curLoc?cur.curLoc:cur.is_showcase&&!nav.objLoc.section&&cur.showcaseSection&&("playlist"===cur.section||(0,E.inArray)(cur.showcaseSection,z.USER_SYSTEMS_ALBUM_TYPES)||e)?(nav.objLoc.section=cur.showcaseSection,nav.objLoc):((0,l.isEmpty)(nav.objLoc)||!nav.objLoc[0]||0!=nav.objLoc[0].indexOf("video"))&&cur.section&&(0,E.inArray)(cur.section,["catalog","all","uploaded","albums"])?{0:"catalog"===cur.section?"video":"videos"+cur.oid}:nav.objLoc},init:function(){cur.searchInputEl=(0,n.geByClass1)("video_search_input"),cur.videoRecentlyRemoved={},cur.videoShowWindow={},cur.found={},cur.silentLoaded={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.videoSearchStats=null,cur.videoSearchPos=null,cur.videoSearchTrackCodeForQID="",cur.albumsPreload=cur.albumsPreload||{},cur.albumsShowingAll={},cur.curLoc=!!cur.query&&nav.fromStr(cur.query);const e=()=>{z._initScroll()},t=()=>{(0,p.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null};window.cur._back?(window.cur._back.hide?window.cur._back.hide.push(t):window.cur._back.hide=[t],window.cur._back.show?window.cur._back.show.push(e):window.cur._back.show=[e]):window.cur._back={hide:[t],show:[e]},(0,l.isObject)(cur.curLoc)&&(cur.curLoc.section=cur.section),cur.getOwnerId=function(){return cur.oid},z.initNavigation(),z.initSearch();const o=z._getCurrentSectionType();if(z.isInAlbum()||z.loadSilent(),z.loadSilent(z.getLoc().section),"catalog"===o&&"playlists"!==z.getLoc().section||z.initOwnerVideoPage(),cur.videoCanSort&&"all_playlists"===cur.showcaseSection){const e=document.getElementById("video_all_playlists_list");e&&(0,N.getGridSorterModule)().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:z._onAlbumReorder})}))}cur.curLoc=!1,cur.section=!1,cur.currentModule=function(){return z.isInSearch()?"video_search":cur.is_showcase&&cur.ref?cur.ref:z.isInCatalog()?"videocat":z.isInVideosList()?D.Ranges.isGroupId(cur.oid)?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos":cur.module},z._initScroll(),z._loadNextChunkIfNeed(),z._updateThumbsInView(),cur.videoSortItems=[["default",(0,d.getLang)("video_sort_dd_by_default")],["popularity",(0,d.getLang)("video_sort_dd_by_popularity")],["new",(0,d.getLang)("video_sort_dd_newest")],["old",(0,d.getLang)("video_sort_dd_oldest")],["short",(0,d.getLang)("video_sort_dd_shortest")],["long",(0,d.getLang)("video_sort_dd_longest")]]},_loadNextChunkIfNeed:function(){if(!cur.is_showcase)return;const e=document.getElementById(`ui_${cur.showcaseSection}_load_more`);if(e&&e.clientHeight&&(0,y.isElementInViewport)(e))return void z.onScroll();const t=document.getElementById(`video_${cur.showcaseSection}_list`);if(t){t.getBoundingClientRect().bottom-(0,n.clientHeight)()<300&&z.onScroll()}},_getMyAddedVideosPath:function(){return cur.my_added_videos_path},_initScroll:function(){cur._ev_onScroll&&(0,p.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=(0,C.throttle)(z.onScroll,100),(0,p.addEvent)(window,"scroll",cur._ev_onScroll),(0,O.pushNavDestroy)((()=>{(0,p.removeEvent)(window,"scroll",cur._ev_onScroll),cur._ev_onScroll=null}))},initOwnerVideoPage:function(){if(cur._videoInited)return;if(cur._videoInited=!0,cur.videoCanSort){if(!z.isInAlbum()){const e=cur.is_showcase?"video_playlist_list":"video_albums_list";(0,N.getGridSorterModule)().then((()=>{cur.albumsSorter=new window.GridSorter(e,"video_item__thumb_link",{onReorder:z._onAlbumReorder})}))}z._createSorters()}z.isGroupsRedesignEnabled()&&z.isInVideosList()&&(0,j.initVideoExtraTabsActions)({commentsTooltipText:(0,d.getLang)("video_comments_review"),orderItems:cur.videoSortItems.map(j.mapRawVideosOrderItemToVideosOrderItem),canSeeComments:!!cur.canSeeCommentsPage,canSeeOrder:!!cur.canSeeOrder,onCommentsButtonClick:()=>nav?.objLoc?.[0]&&nav.go(nav.objLoc[0]+"/comments"),onVideosOrderChange:z._sortVideos});const e=(0,n.ge)("video_sort_dd");e&&(cur.videoSortDD=new K.InlineDropdown(e,{items:cur.videoSortItems,withArrow:!0,ariaLabel:(0,d.curLang)("video_search_order"),selected:"default",onSelect:z._sortVideos})),z._toggleSorter("albums"!==z.getLoc().section)},_toggleSorter:function(e){const t=(0,n.geByClass1)("video_tab_actions_wrap"),o=[(0,n.geByClass1)("_video_sort_dd_wrap",t),(0,n.geByClass1)("divider",t)];(0,n.toggle)(o[0],e),(0,n.toggle)(o[1],e)},updateEmptyPlaceholder:function(e){if(!e)return;let t=!1,o="";"albums"===e?cur.playlistsCount||(t=!0,o=(0,d.getLang)("video_no_albums_placeholder_text")):cur.videosCount[cur.getOwnerId()][e]||(t=!0,(0,P.partConfigEnabled)("video_legacy_card_removing_from_playlist_bugfix")&&((0,E.inArray)(e,["all","type_my_added"])||e.startsWith("playlist_"))||(o=(0,d.getLang)("video_no_videos_here_yet"))),z._toggleEmptyPlaceholder(t,o)},initNavigation:function(){(0,T.pickTrackCodeFromURL)(),cur.nav.push((function(e,t,o,i){const s=void 0!==e[0],r=!cur.is_showcase&&"comments"===o.section,c=o.q&&!t.q&&o[0].indexOf("video")>=0,d=t.q&&!o.q&&t[0].indexOf("video")>=0,l="upload"===t.section&&!o.section,u=e.q;if(c||u?z._initSearchStats(o):d&&z._clearSearchStats(),(0,a.revertLastInlineVideo)(),r)return delete cur._back,!0;if(s){const t=cur.getOwnerId();if(t==vk.id&&(cur.is_showcase||!(0,E.inArray)(e[0],["video","videos"+t])))return!0;if(t!=vk.id&&!(0,E.inArray)(e[0],["videos"+t]))return!0}if(l)return!0;if(window.uiTabs?.hideProgress?.("video_main_tabs"),"all"===e.section&&delete o.section,c&&(cur.videoLocBeforeSearch=t),d&&(cur.videoSearchFilters={},cur.lastProcessedSearchParams=null,z.doSearch(),z.inputVal(cur.searchInputEl,""),cur.videoLocBeforeSearch&&i.fromSearch)){const e=(0,E.clone)(cur.videoLocBeforeSearch);return delete cur.videoLocBeforeSearch,nav.go(e),!1}const h=o.section||"all";if(o.q||(0,S.removeSearchPositionTracker)(S.serviceVideo),o.q)z.isInAlbum()||delete o.section,c&&"lives"===cur.section_id&&(o.live=1),z._prepareSearchFilters(o),i.fromSearch||z.inputVal(cur.searchInputEl,o.q),i.fromSearch||i.globalQuery||(i.globalQuery=o.q),z.doSearch(o.q),z._toggleSearchProgress(!1);else{if(cur.is_showcase)return"left_nav"===i.params?._ref||(nav.setLoc(o),!(!cur.is_showcase||!o.z||t.z===o.z)||(t.section!==o.section||t[0]!==o[0]));if(-1==z.AVAILABLE_TABS.indexOf(h))return~h.indexOf("album")&&(0,_.statlogsValueEvent)("video_play_album",0,"open_album"),!0;{if(z.isInAlbum(t.section))return nav.setLoc(o),!0;(0,E.each)(z.AVAILABLE_TABS,(function(e,t){(0,n.hide)("video_subtab_pane_"+t)})),(0,n.show)("video_subtab_pane_"+h),z.updateEmptyPlaceholder(h);const e=(0,n.domFC)((0,n.ge)("video_tab_"+h));e&&window.uiTabs.switchTab(e,{noAnim:i.hist}),"albums"!==h?(z.loadSilent(h),cur.videoSortDD&&cur.videoSortDD.select(cur.currentSortings[h]||"default",!0),z._toggleSorter(!0)):z._toggleSorter(!1),z._createSorters(h)}}return!!o.show_original||(nav.setLoc(o),!1)})),(0,O.pushNavDestroy)((()=>{cur.nav.pop()}))},initSearch:function(){cur.searchInputEl=(0,n.ge)("video_search_input"),cur.lastProcessedSearchParams=null,cur._videoRenderedSearchResults={},cur.searchInputEl&&!cur.is_showcase&&((0,n.data)(cur.searchInputEl,"opts").onChange=z.onSearchInputChange,(0,n.data)(cur.searchInputEl,"opts").onBlur=z.onSearchInputBlur,cur.searchInputEl.focus())},onSearchInputChange:function(e,t,o){e=(0,E.trim)(e),t=(0,l.isString)(t)?(0,E.trim)(t):"";let i={};e||((0,E.each)(z.SEARCH_FILTERS,(function(e,t){i[t]=!1})),cur.videoPrevSearchFilters=(0,E.clone)(cur.videoSearchFilters),setTimeout((function(){delete cur.videoPrevSearchFilters}),z.SEARCH_KEEP_FILTERS_DELAY)),e&&cur.videoPrevSearchFilters&&(i=cur.videoPrevSearchFilters,delete cur.videoPrevSearchFilters),nav.change((0,E.extend)({q:e||!1,no_spellcheck:!1,suggest_trackcode:o||!1},i),!1,{fromSearch:!0,globalQuery:t})},onSearchInputBlur:function(){(0,E.trim)((0,n.val)(cur.searchInputEl))&&(cur.vSearchInputBlurred=!0)},_sortVideos:function(e){window.tooltips&&tooltips.hideAll();let t=z._getCurrentSectionType();const o=cur.getOwnerId();"album"===t&&(t=z.getLoc().section);let i=cur.silentLoaded[o][t];if(!i)return z.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(L.VideoOrderEvents.START_LOADING)):((0,n.show)("video_sort_progress"),(0,n.hide)("video_sort_dd")),void z._addPendingAction(t,(function(){z._sortVideos(e)}));z.isGroupsRedesignEnabled()?window.dispatchEvent(new CustomEvent(L.VideoOrderEvents.END_LOADING)):((0,n.hide)("video_sort_progress"),(0,n.show)("video_sort_dd"));let s=0;i=i.filter((function(e){const t=e[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+e[VideoConstants.VIDEO_ITEM_INDEX_ID];return!cur.videoRecentlyRemoved[t]||(s++,!1)}));const r=cur.videosCount[cur.getOwnerId()];if(s&&r)if(z.isInAlbum()){const e="album_"+z._getSectionAlbumId();r[e]&&(r[e]-=s,(0,n.val)((0,n.geByClass1)("_video_subtitle_counter",(0,n.ge)("video_layout_contents")),(0,d.langNumeric)(r[e],(0,d.curLang)("video_playlist_size"))))}else r.all-=s,z.updateTabCounter(r.all);cur.pageVideosList?.[o]?.[t]?.count===cur.silentLoaded[o][t].length&&(cur.pageVideosList[o][t].list=i,cur.pageVideosList[o][t].count=i.length),cur.silentLoaded[o][t]=i,clearTimeout(cur._sortTO),cur._sortTO=setTimeout((function(){if(!i.length)return;i.sort((function(t,o){switch(e){case"default":return t[cur.indexIndex]-o[cur.indexIndex];case"new":return o[VideoConstants.VIDEO_ITEM_INDEX_DATE]-t[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"old":return t[VideoConstants.VIDEO_ITEM_INDEX_DATE]-o[VideoConstants.VIDEO_ITEM_INDEX_DATE];case"popularity":return o[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]-t[VideoConstants.VIDEO_ITEM_INDEX_VIEWS];case"short":return t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION];case"long":return o[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]-t[VideoConstants.VIDEO_ITEM_INDEX_RAW_DURATION]}}));(0,n.ge)("video_"+t+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[o]&&(cur.videoShowWindow[o][t]=!1),z.showMore(t),z._reinitSorters("default"!==e),cur.currentSortings=cur.currentSortings||{},cur.currentSortings[t]=e}),10)},_reindex:function(e){for(let t=0,o=e.length;t<o;t++)e[t].length>=cur.indexIndex?e[t][cur.indexIndex]=t:e[t].push(t)},_onAlbumReorder:function(e,t,o){const i=e.getAttribute("data-id"),n=o&&!o.getAttribute("nodrag")?o.getAttribute("data-id"):null,s=t&&!t.getAttribute("nodrag")?t.getAttribute("data-id"):null;let r=!1;const a=cur.albumsSorter._contEl;if(cur.is_showcase&&a){if(r=e.classList.contains("VideoCard--first")||e.classList.contains("VideoCard--second"),!r){const e=[...a.querySelectorAll(".js-video_playlist_item")];e.length&&(r=e[0].getAttribute("data-id")===i||e[1].getAttribute("data-id")===i)}const t=a.querySelector(`.VideoPlaylistInfo[data-id='${i}']`);t&&e.insertAdjacentElement("afterend",t)}r&&[...a.querySelectorAll(".js-video_playlist_item:not(.VideoCard--isSystem)")].forEach(((e,t)=>{e.classList.toggle("VideoCard--first",0===t),e.classList.toggle("VideoCard--second",1===t)})),ajax.post("al_video.php?act=reorder_albums",{oid:cur.getOwnerId(),aid:i,before:s,after:n,hash:cur.videoAlbumsSortHash,need_update:r?1:0},{onDone:function(e){z._updatePlaylistPanel(e)}})},_onReorder:function(e,t,o){const i=cur.getOwnerId(),s=(0,n.domData)(e,"id"),r=o?(0,n.domData)(o,"id"):null,a=t?(0,n.domData)(t,"id"):null;let c=z._getCurrentSectionType();"album"===c&&(c=z.getLoc().section.split("_")[1]);const d=z._getCurrentSectionType(),l=cur.silentLoaded[i][d];if(l){let e=-1,t=-1;if((0,E.each)(l,(function(o,i){const n=i[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+i[VideoConstants.VIDEO_ITEM_INDEX_ID];if(n==s&&(e=o),n==r&&(t=o),t>=0&&e>=0)return!1})),e>=0){const o=l.splice(e,1)[0];t<0?l.unshift(o):(t>e&&t--,l.splice(t+1,0,o)),z._reindex(l)}}let u=!1;if(cur.is_showcase){if(u=e.classList.contains("VideoCard--first"),!u){const e=document.querySelector(`._video_playlist_${c}_list .VideoCard`);e&&(u=e.getAttribute("data-id")===s)}u&&[...document.querySelectorAll(`._video_playlist_${c}_list .VideoCard`)].forEach(((e,t)=>{e.classList.toggle("VideoCard--first",0===t)}))}ajax.post("al_video.php?act=reorder_videos",{album_id:c,target_id:i,vid:s,before:a,after:r,hash:cur.videoSortHash,ref:window.cur.ref,update_cover:u?1:0},{onDone:function(e,t,o){if(e){const o=document.querySelector(".VideoInfoPanel--playlistPage");o?.classList.toggle("VideoInfoPanel--hasRestriction",t);const i=o.querySelector(".VideoInfoPanel__coverImage");if(i){i.src=e;const n=o.querySelector(".VideoInfoPanel__coverIcon");n&&(n.innerHTML=t?(0,f.getIcon24HideOutline)().icon:"")}}z._updatePlaylistPanel(o)}})},_updatePlaylistPanel:function(e){if(!e)return;const t=document.getElementById("own_playlist_panel");t&&(t.innerHTML="",t.insertAdjacentHTML("beforeend",e))},_prepareSearchFilters:function(e){return cur.videoSearchFilters={},(0,E.each)(z.SEARCH_FILTERS,(function(t,o){let i=e[o];(0,l.isString)(i)&&(i=(0,l.htsc)(i)),cur.videoSearchFilters[o]=i})),cur.videoSearchFilters},onFilterRemoved:function(e){z._setFilterSelector(e),clearTimeout(cur._frto),cur._frto=setTimeout(z._onFiltersChanged,10)},_setFilterSelector:function(e,t){const o=cur["videoFilter_"+e];let i;return!!o&&("Selector"===o.__className?(void 0===t&&(t=o.options.defaultItems[0][0]),o.selectItem(t,!1),i=(0,E.clone)(o.selectedItems()[0]),i.push(i[0]==o.options.defaultItems[0][0])):(0,n.hasClass)(o,"checkbox")&&((0,n.toggleClass)(o,"on",!!t),i=[!!t,(0,n.data)(o,"title"),!t]),i)},_onFiltersChanged:function(){const e=(0,I.isChecked)("video_fltr_hd"),t=(0,I.isChecked)("video_fltr_notsafe"),o=(0,I.isChecked)("video_fltr_live"),i=cur.videoFilter_len.selectedItems()[0][0],n=cur.videoFilter_date.selectedItems()[0][0],s=cur.videoFilter_order.selectedItems()[0][0];nav.change({hd:!!e&&"1",len:i>0&&i,date:n>0&&n,order:s>=0&&s,notsafe:!!t&&"1",live:!!o&&"1"},!1,{filtersChanged:!0})},initFilters:function(){if(!(0,n.geByClass1)("video_search_input"))return;cur.videoFilter_len=new Dropdown((0,n.ge)("video_fltr_len"),cur.lenFilters,{big:1,zeroPlaceholder:!0,onChange:z._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_date=new Dropdown((0,n.ge)("video_fltr_date"),cur.dateFilters,{big:1,zeroPlaceholder:!0,onChange:z._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_order=new Dropdown((0,n.ge)("video_fltr_order"),cur.orderFilters,{big:1,zeroPlaceholder:!0,onChange:z._onFiltersChanged,width:cur.is_showcase?218:void 0}),cur.videoFilter_hd=(0,n.ge)("video_fltr_hd"),(0,p.removeEvent)(cur.videoFilter_hd,"click"),(0,p.addEvent)(cur.videoFilter_hd,"click",z._onFiltersChanged),(0,n.data)(cur.videoFilter_hd,"title",(0,d.curLang)("video_hd_checkbox")),vk.id&&(cur.videoFilter_notsafe=(0,n.ge)("video_fltr_notsafe"),(0,p.removeEvent)(cur.videoFilter_notsafe,"click"),(0,p.addEvent)(cur.videoFilter_notsafe,"click",z._onFiltersChanged),(0,n.data)(cur.videoFilter_notsafe,"title",(0,d.curLang)("video_filter_no_safe"))),cur.videoFilter_live=(0,n.ge)("video_fltr_live"),(0,p.removeEvent)(cur.videoFilter_live,"click"),(0,p.addEvent)(cur.videoFilter_live,"click",z._onFiltersChanged),(0,n.data)(cur.videoFilter_live,"title",(0,d.curLang)("video_filter_live"));const e=z.getLoc().q;e&&(z._prepareSearchFilters(z.getLoc()),cur.searchText=e,z.inputVal(cur.searchInputEl,cur.searchText),z.doSearch(e))},_isGeneralSection:function(e){for(let t=0;t<z.AVAILABLE_TABS.length;t++)if(e==z.AVAILABLE_TABS[t])return!0;return!1},showMoreShowcase:function(e,t,o=()=>{}){if(!(0,n.isVisible)(t)||(0,I.isButtonLocked)(t))return;(0,I.lockButton)(t);const i={silent_loading:1,next_from:window.cur.listNextFrom,__showcase_session_id:window.cur.showcaseSessionId,unsafe:window.cur.unsafe_filter};"type_for_kids"===e&&Boolean(window.cur.ageFilter)&&(i.age_filter_value=window.cur.ageFilter);const s=window.nav.strLoc;ajax.post(s,i,{onDone:function(i){const{videos:r,playlists:a,nextFrom:c,communities:d,shopping:u,shoppingVideos:_}=JSON.parse(i);if(c&&(cur.listNextFrom=c),"type_my_communities"===e)return void z.showMoreCommunities(d,c,t);if(!(0,l.isEmpty)(u)&&void 0!==u)return void z.showMoreShopping(_,c,t,o);if(s!==window.nav.strLoc)return;const h=document.getElementById(`video_${e}_list`),g=document.createDocumentFragment(),v=[];if(!(0,l.isEmpty)(r)){for(let t of r){if("type_my_history"===e){const e=t[VideoConstants.VIDEO_ITEM_INDEX_VIEWED_DAY];if(e){if(!document.querySelector(`.VideoGrid__separator[data-date='${e}']`)&&-1===v.indexOf(e)){v.push(e);const t=(0,b.buildDateSeparatorEl)(e);g.appendChild(t)}}}const o=z.buildVideoEl(t,!0);g.appendChild(o)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...r),window.VideoPlaylist&&window.mvcur)){const e=window.VideoPlaylist.getCurList();e&&(window.VideoPlaylist.addVideosToBlockList(r,!e.reversed,e.reversed),c&&r&&r.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}}if(!(0,l.isEmpty)(a))for(let e of a){const t=z.buildPlaylistEl(e,!0);g.appendChild(t)}h.appendChild(g),(0,I.unlockButton)(t),c||(0,n.hide)(t),0!==r?.length||c||"type_my_history"!==e||0!==h.childElementCount||document.getElementById("video_empty_placeholder_main")?.classList.remove("VideoEmptyStub--hidden"),"function"==typeof o&&o();U.VideoCardLoggerFactory.getInstance().saveCardsCollection()},onFail:()=>{(0,I.unlockButton)(t)},timeout:3e4})},showMoreOwnerPlaylists:function(){if(!cur.playlistsNextOffset||cur.loadingAlbums)return;cur.loadingAlbums=!0;const e=document.getElementById("video_all_playlists_list"),t=document.getElementById("ui_all_playlists_load_more");(0,I.lockButton)(t),ajax.post("/video?act=more_owner_playlists",{owner_id:cur.oid,offset:cur.playlistsNextOffset},{onDone:(o,i,s,r)=>{e?.insertAdjacentHTML("beforeend",o),window.VideoShowcase.initPlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),cur.playlistsNextOffset=r,cur.loadingAlbums=!1,(0,I.unlockButton)(t),r||(0,n.hide)(t)},onFail:()=>{cur.loadingAlbums=!1,(0,I.unlockButton)(t)}})},showMoreCommunities:function(e,t,o){const i=document.getElementById("video_type_my_communities_list"),s=document.createDocumentFragment();if(e?.length)for(let t of e)t?.length&&(0,E.each)((0,b.buildCommunityEl)(t),(function(e,t){s.appendChild(t)}));i.appendChild(s),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,I.unlockButton)(o),t||(0,n.hide)(o)},showMoreShopping:function(e,t,o,i){const s=document.querySelectorAll("#video_subtab_pane_type_trends"),r=s[s.length-1].firstElementChild,a=document.createDocumentFragment();for(let t of e){const e=z.buildVideoEl(t,!0);a.appendChild(e)}if(cur.catPlaylistId&&(cur.catVideosList[cur.catPlaylistId].list.push(...e),window.VideoPlaylist&&window.mvcur)){const o=window.VideoPlaylist.getCurList();o&&(window.VideoPlaylist.addVideosToBlockList(e,!o.reversed,o.reversed),t&&e&&e.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}r.appendChild(a),window.VideoShowcase.updatePlaylistSlider(),window.VideoShowcase.initPlaylistsActionsDropdowns(),(0,I.unlockButton)(o),t||(0,n.hide)(o),"function"==typeof i&&i()},loadSilent:function(e){e=e||"all";const t=cur.getOwnerId(),o=z.isInAlbum(e),i=!!cur.isSnippetVideoSelection;if(!o&&!this._isGeneralSection(e)||"albums"==e)return;cur.silentLoaded=cur.silentLoaded||{},cur.silentLoaded[t]=cur.silentLoaded[t]||{},cur.silentLoadingProgress=cur.silentLoadingProgress||{},cur.silentLoadingProgress[t]=cur.silentLoadingProgress[t]||{};const n=cur.silentLoadingProgress[t][e];!0!==n&&cur.pageVideosList&&cur.pageVideosList[t]&&(!1!==n?void 0===n&&(cur.silentLoadingProgress[t][e]=!0,function(e){function n(o,i){cur.silentLoadingProgress&&cur.silentLoadingProgress[t]&&(cur.silentLoadingProgress[t][e]=!1,o&&(o.length&&(cur.indexIndex=o[0].length),z._reindex(o),cur.silentLoaded[t][e]=o),i&&(cur.albumsPreload[t]=!1,cur.silentLoaded[t].albums=i),z.indexItems((function(){cur.silentLoadingProgress&&(z._callPendingAction(e),i&&z._callPendingAction("albums"),cur.is_showcase?z.onScroll():z.showMore(e))})))}const s=cur.pageVideosList[t][e],r=!!s&&cur.videosCount[t][e]<=s.list.length,a=!!o||cur.albumsPreload&&cur.playlistsCount<=cur.albumsPreload[t].length;if(a&&(cur.silentLoaded[t].albums=cur.albumsPreload[t]),r&&a)n(cur.pageVideosList[t][e].list,cur.albumsPreload[t]);else if(cur.noVideos)n([],[]);else{const o=!cur.videosCount||!cur.videosCount[t],s=!cur.playlistsCount;if(o&&s)return n([],[]);const r=cur.VIDEO_SILENT_VIDEOS_CHUNK_SIZE;let c=0;if(cur.videosCount[t]&&cur.videosCount[t][e]){const o=Math.min(cur.videosCount[t][e],cur.VIDEO_SILENT_VIDEOS_MAX_SIZE);c=Math.ceil(o/r)}const d=Math.ceil((cur.playlistsCount||0)/r),l=Math.max(c,d),u=new Array(c);let _=[];const h=()=>{n([].concat.apply([],u),_)},g=new window.callHub(h,l);if(0==l)return n([],[]);let v;for(let o=0;o<l;o++)!function(o){if(cur.serverPaging&&!cur.isCurrentVideoLayer){if(cur.pageVideosList[t]){n(cur.pageVideosList[t].all||[],[])}}else{const n="/al_video.php?act=load_videos_silent",s={oid:t,section:e,rowlen:z.VIDEOS_PER_ROW,offset:o*r,snippet_video:i?1:0,need_albums:(0,E.intval)(!a&&"all"==e&&(0,E.intval)(0==o))};v=()=>{ajax.post(n,s,{onDone:function(t,i,n){n&&(cur.listNextFrom=n),t&&t[e]&&t[e].list?u[o]=t[e].list:u[o]=[],0==o&&(_=i),g.done()}})},cur.direct_link?(0,L.idlizeCall)(v):v()}}(o)}}(e)):z._callPendingAction(e))},indexItems:function(e){if(!cur.getOwnerId)return;let t=0;const o=cur.getOwnerId();cur.videoIndexes=cur.videoIndexes||{},cur.videoIndexes[o]=cur.videoIndexes[o]||{},(0,E.each)(cur.silentLoaded[o],(function(e){cur.videoIndexes[o][e]||t++}));const i=new callHub(e,t);(0,N.getIndexerModule)().then((()=>{(0,E.each)(cur.silentLoaded[o],(function(e,t){cur.videoIndexes[o][e]||(cur.videoIndexes[o][e]=new vkIndexer(t,(function(t){return"albums"===e?t[0]:t[VideoConstants.VIDEO_ITEM_INDEX_TITLE]}),(function(){i.done()})))}))}))},_updateSearchPageTitle:function(e){(0,v.curBox)()||(e?(cur.prevVideoPageTitle||(cur.prevVideoPageTitle=document.title),(0,n.setDocumentTitle)((0,d.getLang)("video_title_search").replace("{q}",e))):cur.prevVideoPageTitle&&(0,n.setDocumentTitle)(cur.prevVideoPageTitle))},inputVal:function(e,t){if((0,n.val)(e)==t)return;(0,n.val)(e,t);const o=(0,n.gpeByClass)("_wrap",e);(0,n.toggleClass)(o,"ui_search_field_empty",!t)},doSearch:function(e){if(!cur.searchInputEl)return;const t=(0,E.trim)(e),o=t+z._buildFiltersSearchStr();if(cur.lastProcessedSearchParams===o)return;cur.videoLocalSearchQuery=t,cur.videoGlobalSearchQuery=t;const i=cur.searchQueryId&&cur.videoSearchTrackCodeForQID?cur.searchQueryId:(0,S.generateQID)();cur.searchQueryId=i,(0,E.each)(z.SEARCH_FILTERS,(function(e,t){const o=z._setFilterSelector(t,cur.videoSearchFilters[t]);o&&uiSearch.toggleFilter(cur.searchInputEl,t,o[1],!o[2])})),cur.noEmptyLocalResults=z.isInCatalog();const s=[z.VIDEO_SEARCH_TYPE,z.ALBUM_SEARCH_TYPE,z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE,z.VIDEO_GLOBAL_SEARCH_TYPE];z.isInSearch()&&cur.noEmptyLocalResults&&s.pop(),(0,E.each)(s,(function(e,t){(0,n.hide)("video_subtab_pane_"+t)})),t||z._toggleSearchContent(!1),(0,v.curBox)()?(0,n.ge)("box_layer_wrap").scrollTop=0:(0,g.scrollToTop)(cur.is_showcase?500:1e3);const r=z.isInAlbum()?z.getLoc().section:"all";z._clearPendingAction(r),z._updateSearchPageTitle(t),t?(z._addPendingAction(r,(function(){const e=z._searchLocally(t);(0,S.saveSearchAttemptStats)(S.serviceVideo,0,e,t,i,0,"0","",S.blockNameOwn),cur.lastProcessedSearchParams=o,e<15&&z._searchGlobally(t)})),z.loadSilent(r),z._searchGlobally(t)):cur.lastProcessedSearchParams=o},getCurrentGlobalSearchKey(){if(!window.cur.searchInputEl)return"";const e=(0,E.trim)((0,n.val)(window.cur.searchInputEl));return e?e+z._buildFiltersSearchStr():""},isGlobalSearchMode:()=>!!z.getCurrentGlobalSearchKey(),_searchGlobally:function(e,t){if(!e)return;t=(0,E.intval)(t)||0;const o=cur.searchQueryId,i=t>0;cur.globalSearchResults=cur.globalSearchResults||{};const n=e+z._buildFiltersSearchStr(),s=cur.globalSearchResults[n];if(!i&&s)return(0,S.saveSearchAttemptStats)(S.serviceVideo,0,s.count,e,o,s.eventBits,"1",s.modelName,S.blockNameSearch,"",s.isAnonym),cur.globalSearchInProgress=!1,z._showGlobalSearchResults(e),void z._toggleSearchProgress(!1);if(cur.globalSearchInProgress===e)return;cur.globalSearchInProgress=e;const r=!!cur.isSnippetVideoSelection,a={q:e,offset:t,from:cur.oid,query_id:o};r&&(a.snippet_video=1),cur.videoSearchTrackCodeForQID&&(a.track_code_for_qid=cur.videoSearchTrackCodeForQID,cur.videoSearchTrackCodeForQID=""),i||z._toggleSearchProgress(!0);const c=Date.now(),d={onDone:function(t,s,r,a,d,l,u,_,h,g,m){if(!i){z._toggleSearchProgress(!1),cur.lastEventBits=u,cur.lastModelName=_;const i=Date.now()-c;(0,S.saveSearchAttemptStats)(S.serviceVideo,0,t,e,m||o,u,i,_,S.blockNameSearch,"",g),cur.searchQueryId=m}cur.globalSearchInProgress=!1,(0,v.curBox)()&&(d=!1),cur.globalSearchResults=cur.globalSearchResults||{},cur.globalSearchResults[n]=cur.globalSearchResults[n]||{count:0,countHash:s,list:[],realOffset:0,promoPlaylists:d,modelName:_,eventBits:u,playlistTotalCount:h,isAnonym:g};const E=cur.globalSearchResults[n];E.done=E.done||!r.list||0==r.list.length;const p=E.list.length;if(!E.done){const e=r.list[0];let o=0;for(let t=E.list.length-1;t>=0;t--){const i=E.list.length-t;if(i>20)break;const n=E.list[t];if(e[0]==n[0]&&e[1]==n[1]){o=i;break}}E.count=parseInt(t);const i=r.list.slice(o);if(Array.prototype.push.apply(E.list,i),window.VideoPlaylist&&window.mvcur){const e=window.VideoPlaylist.getCurList();e?.id===z.VIDEO_GLOBAL_SEARCH_TYPE&&(window.VideoPlaylist.addVideosToBlockList(i,!e.reversed,e.reversed),!a&&i&&i.length||window.VideoPlaylist.setCurPlaylistBottomAsFull())}const n=E.list.length%z.VIDEOS_PER_ROW;t>z.VIDEOS_PER_PAGE&&n&&E.list.length<E.count&&(E.list.splice(-n,z.VIDEOS_PER_ROW),l-=n),E.realOffset=l}(a||!E.done&&E.list.length==p)&&(E.done=!0),z._showGlobalSearchResults(e,i)}};cur.is_showcase?(clearTimeout(cur.searhRequestTimeout),cur.searhRequestTimeout=setTimeout((()=>{cur.is_section||ajax.post("/al_video.php?act=search_video",(0,E.extend)(a,cur.videoSearchFilters),d)}),300)):ajax.post("/al_video.php?act=search_video",(0,E.extend)(a,cur.videoSearchFilters),d)},toggleSearchProgress:function(e){z._toggleSearchProgress(e)},_toggleSearchProgress:function(e){cur.is_showcase||(cur.searchProgressRef=cur.searchProgressRef||0,cur.searchProgressRef=Math.max(0,cur.searchProgressRef+(e?1:-1)),e=cur.searchProgressRef>0);const t=(0,n.geByClass1)("ui_search_fltr_control",(0,n.geByClass1)("video_search_input")),o=(0,n.geByClass1)("ui_search_fltr_progress",t);(0,n.toggle)(o,e),(0,n.hasClass)(t,"shown")||(0,n.toggleClass)((0,n.gpeByClass)("_wrap",cur.searchInputEl),"ui_search_loading",e)},_buildFiltersSearchStr:function(){const e=[];return(0,E.each)(cur.videoSearchFilters||{},(function(t,o){o&&e.push(t+":"+o)})),"$"+e.join("#")},_toggleEmptySearchPlaceholder:function(e,t,o){const i=(0,n.ge)("video_empty_placeholder_search");let s=D.Ranges.isGroupId(cur.getOwnerId())?(0,d.getLang)("video_not_found_group"):(0,d.getLang)("video_not_found_user");if(cur.getOwnerId()==vk.id&&(s=(0,d.getLang)("video_not_found_yours")),z.isInAlbum()&&(s=(0,d.getLang)("video_not_found_in_album")),z.isInCatalog()&&(s=(0,d.getLang)("video_not_found_globally")),t){const e=s.replace("{searchText}",'<b class="VideoEmptyStub__token">'+(0,E.clean)(t.replace(/\$/g,"$$$$"))+"</b>");i.classList.contains("VideoEmptyStub")?i.querySelector(".VideoEmptyStub__text").innerHTML=e:i.innerHTML=e}if((0,n.toggle)(i,e),o){let e=!0;const t=(0,n.ge)("video_layout_search");(0,E.each)((0,n.domChildren)(t),(function(){if((0,n.isVisible)(this))return e=!1,!1})),e&&(0,n.toggle)(i,!0)}},_toggleEmptyPlaceholder:function(e,t){const o=(0,n.ge)("video_empty_placeholder_main");t&&e&&o&&(o.classList.contains("VideoEmptyStub")?o.querySelector(".VideoEmptyStub__text").innerHTML=t:o.innerHTML=t),(0,n.toggle)(o,e)},_showSearchResult:function(e){const t=cur.found[e],o=cur.getOwnerId();if((0,n.toggle)("video_subtab_pane_"+e,!!t.count&&!!t.list),t.count){let i="";switch(e){case z.ALBUM_SEARCH_TYPE:i=z.isInAlbum()?(0,d.curLang)("video_found_albums_in_album"):D.Ranges.isGroupId(cur.getOwnerId())?(0,d.curLang)("video_found_albums_community"):cur.getOwnerId()==vk.id?(0,d.curLang)("video_found_albums_yours"):(0,d.curLang)("video_found_albums_of");break;case z.VIDEO_SEARCH_TYPE:i=z.isInAlbum()?(0,d.curLang)("video_found_videos_in_album"):D.Ranges.isGroupId(cur.getOwnerId())?(0,d.curLang)("video_found_videos_community"):cur.getOwnerId()==vk.id?(0,d.curLang)("video_found_videos_yours"):(0,d.curLang)("video_found_videos_of");break;case z.VIDEO_GLOBAL_SEARCH_TYPE:i=cur.is_showcase?(0,d.getLang)("video_found_videos"):(0,d.curLang)("video_found_videos_global");break;case z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE:i=cur.is_showcase?(0,d.getLang)("video_search_playlists"):(0,d.getLang)("video_search_promo_playlists")}i=(0,d.langNumeric)(t.count,i,!0),i=i.replace("{user}",(0,d.curLang)("video_owner_name_gen"));const s=(0,n.ge)("video_subtab_pane_"+e),r=(0,n.geByClass1)("js-video-subtitle",s);if((0,n.val)(r,i),cur.is_showcase&&t.count){const e=(0,n.geByClass1)("js-video-subtitle-counter",s);(0,n.val)(e,(0,d.langNumeric)(t.count,"%s",!0))}let a=e==z.VIDEO_GLOBAL_SEARCH_TYPE?cur.videoGlobalSearchQuery:cur.videoLocalSearchQuery;a+=z._buildFiltersSearchStr(),cur._videoRenderedSearchResults=cur._videoRenderedSearchResults||{};const c=cur._videoRenderedSearchResults;c[e]!=a&&(c[e]=a,(0,n.ge)("video_"+e+"_list").innerHTML="",cur.videoShowWindow&&cur.videoShowWindow[o]&&delete cur.videoShowWindow[o][e],z.showMore(e))}},_showGlobalSearchResults:function(e,t){const o=e+z._buildFiltersSearchStr(),i=cur.getOwnerId(),n=z.isInAlbum()?z.getLoc().section:"all",s=cur.is_showcase||!!cur.silentLoaded[i][n];if((e==cur.videoGlobalSearchQuery||e==cur.videoLocalSearchQuery)&&s&&cur.globalSearchResults[o]&&cur.globalSearchResults[o].count>=0){const i=cur.globalSearchResults[o];cur.found[z.VIDEO_GLOBAL_SEARCH_TYPE]={list:i.list,count:i.count,done:i.done,realOffset:i.realOffset},cur.found[z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE]={list:i.promoPlaylists,count:i.playlistTotalCount||i.promoPlaylists.length,done:!i.promoPlaylists.length},cur.noEmptyLocalResults&&(z._toggleSearchContent(!0),0==i.count?z._toggleEmptySearchPlaceholder(!0,e):z._toggleEmptySearchPlaceholder(!1)),t||(z._showSearchResult(z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE),z._showSearchResult(z.VIDEO_GLOBAL_SEARCH_TYPE)),z._callPendingAction(z.VIDEO_GLOBAL_SEARCH_TYPE)}},_toggleSearchContent:function(e){(0,n.toggle)("video_layout_contents",!e),(0,n.toggle)("video_layout_search",!!e),cur.is_showcase&&(0,n.toggle)("video_block_header",!e)},setVisibilityShowcaseContent:function(e){(0,n.toggle)("video_main_block",e)},_searchLocally:function(e){if(cur.found={},!e||!cur.videoIndexes)return!1;const t=cur.getOwnerId(),o=[];let i=[];!z.isInAlbum()&&cur.videoIndexes[t].albums&&(i=cur.videoIndexes[t].albums.search(e),cur.found[z.ALBUM_SEARCH_TYPE]={list:i,count:i.length},z._showSearchResult(z.ALBUM_SEARCH_TYPE));const n=z.isInAlbum()?z.getLoc().section:"all";if(cur.videoIndexes[t][n]){const i=cur.videoIndexes[t][n].search(e);(0,E.each)(i,(function(e,t){(!cur.videoSearchFilters.hd||t[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_HD)&&(!cur.videoSearchFilters.live||t[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_LIVE)&&(Date.now()/1e3-t[VideoConstants.VIDEO_ITEM_INDEX_DATE]>cur.videoSearchFilters.date||cur.videoRecentlyRemoved&&cur.videoRecentlyRemoved[(0,F.joinRawId)({ownerId:t[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID],itemId:t[VideoConstants.VIDEO_ITEM_INDEX_ID]})]||o.push(t))})),cur.found[z.VIDEO_SEARCH_TYPE]={list:o,count:o.length},z._showSearchResult(z.VIDEO_SEARCH_TYPE)}return i.length+o.length?(z._toggleSearchContent(!0),z._toggleEmptySearchPlaceholder(!1)):cur.noEmptyLocalResults?z._toggleEmptySearchPlaceholder(!1,void 0,!0):(z._toggleSearchContent(!0),z._toggleEmptySearchPlaceholder(!0,e)),z._toggleSearchProgress(!1),o?o.length:0},onItemEnter:function(e){(0,n.setTitle)(e,e)},showMoreAlbums:function(e){let t=!1;const o=cur.getOwnerId();cur.albumsPreload&&cur.albumsPreload[o]&&!cur.silentLoaded[o].albums&&(cur.silentLoaded[o].albums=cur.albumsPreload[o],t=!0),cur.albumsShowingAll[o]=!0,z.showMore("albums",e),t&&(cur.silentLoaded[o].albums=!1)},prepareVideoItemAttrs:function(e){let t="",o="";const i={};i[VideoConstants.VIDEO_ITEM_FLAG_EXTERNAL]="video_ext",i[VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE]="video_active_live",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT]="video_can_edit",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DOWNLOAD]="video_can_download",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD]="video_can_add",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE]="video_can_delete",i[VideoConstants.VIDEO_ITEM_FLAG_NO_AUTOPLAY]="video_nap",i[VideoConstants.VIDEO_ITEM_FLAG_ADDED]="VideoCard--videoAdded",i[VideoConstants.VIDEO_ITEM_FLAG_SKIP_THUMB_LOAD]="video_skip_thumb_load",i[VideoConstants.VIDEO_ITEM_FLAG_DELETED]="video_deleted",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE_FROM_HISTORY]="VideoCard--history",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE]="VideoCard--private",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_MEMBERS]="VideoCard--privateMembers",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_BY_LINK]="VideoCard--privateByLink",i[VideoConstants.VIDEO_ITEM_FLAG_PRIVATE_NOT_PUBLISHED]="VideoCard--privateNotPublished",i[VideoConstants.VIDEO_ITEM_FLAG_CAN_MOVE]="video_can_edit_albums",i[VideoConstants.VIDEO_ITEM_FLAG_HORIZONTAL]="VideoCard--horizontal",i[VideoConstants.VIDEO_ITEM_FLAG_INTERACTIVE]="VideoCard--interactive";const n=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS],s=e[VideoConstants.VIDEO_ITEM_INDEX_LINK],r=s&&s.includes("clip")&&(0,P.partConfigEnabled)("clips_publish_videos_to_clips_web");(0,E.each)(i,(function(e,o){n&e&&(t+=o+" ")})),n&VideoConstants.VIDEO_ITEM_FLAG_SCHEDULED&&(t+=" VideoCard--scheduled"),n&VideoConstants.VIDEO_ITEM_FLAG_UPCOMING_LIVE&&(t+=" VideoCard--upcomingLive"),e[VideoConstants.VIDEO_ITEM_INDEX_PLATFORM]||e[VideoConstants.VIDEO_ITEM_INDEX_DURATION]||n&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE||(t+=" video_no_duration"),n&VideoConstants.VIDEO_ITEM_FLAG_PRIVATE||!r||(t+=" ShortVideoGridItem__removePrivate"),cur.is_showcase&&n&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE&&(t+=" video_no_duration"),e[VideoConstants.VIDEO_ITEM_INDEX_DATE]||(t+=" no_date");const a=e[VideoConstants.VIDEO_ITEM_INDEX_MUSIC_VIDEO_META];a&&a.explicit&&(t+=" video_explicit");const c=!(n&VideoConstants.VIDEO_ITEM_FLAG_CAN_EDIT||n&VideoConstants.VIDEO_ITEM_FLAG_CAN_DELETE),d=e[VideoConstants.VIDEO_ITEM_INDEX_BLOCKED],l=!(n&VideoConstants.VIDEO_ITEM_FLAG_CAN_ADD);return c&&(l||d)&&(t+=" video_no_actions"),c&&r&&(t+=" ShortVideoGridItem__noActions"),d&&(t+=" video_blocked"),cur.videoCanAddAlbums&&!d&&(t+=" video_can_edit_albums"),cur.isSnippetVideoSelection&&(t+=" no_video_select_btn"),n&VideoConstants.VIDEO_ITEM_FLAG_NEED_SIGN_IN&&(o+=' rel="nofollow"'),[t,o]},buildVideoEl:function(e,t=!1,o=!1){return(0,b.buildVideoEl)(e,t)},buildPlaylistEl:function(e,t=!1){return(0,b.buildPlaylistEl)(e,t)},addShowMoreButton:function(e,t){if(!e||!t||0===t.length)return;const o=(0,n.ce)("div",{className:(z.showMoreClassNames||"").replace("%type%",t),innerHTML:(0,d.curLang)("video_show_more")});return e.parentNode.append(o),o.onClick=z.showMore(t,o),o},onMoreLoaded:function(e,t,o,i,s){z._loading=!1;const r=cur.getOwnerId(),a=cur.videoShowWindow[r][t],c=(0,n.ge)("video_"+t+"_list"),d=(0,n.gpeByClass)("ge_video_pane",c),l=c.classList.contains("VideoGrid");let u;if(c){e=(0,n.geByClass1)("ui_load_more_btn",d);const _=t.indexOf("albums")>=0,h=_?0:3;let g=z._getCurrentSectionType();g="album"==g?z.getLoc().section:"all";let v=!1;t.indexOf("search")>=0&&cur.videoIndexes&&cur.searchText&&(v=new RegExp("("+cur.searchText.replace(/\|/g,"").replace(cur.videoIndexes[r][g]?.delimiter,"|").replace(/^\||\|$/g,"").replace(/([\+\*\)\(])/g,"\\$1")+")","gi"));for(let e=0,i=o.length;e<i;e++){const i=(0,E.extend)({},o[e]);v&&!l&&(i[h]=i[h].replace(v,"<em>$1</em>")),u=_?z.buildPlaylistEl(i,l):z.buildVideoEl(i,l),t==z.VIDEO_GLOBAL_SEARCH_TYPE&&u.setAttribute("data-search-pos",e+a.offset),c.appendChild(u)}!e&&!s&&!a.done&&i>a.offset&&(e=z.addShowMoreButton(c,g)),a.offset=i,a.done=!o.length||s,(0,n.toggle)(e,!a.done),cur.is_showcase&&d.classList.toggle("VideoPane--noMore",a.done),t==z.VIDEO_GLOBAL_SEARCH_TYPE&&(cur.videoSearchStats||z._initSearchStats(z.getLoc()),cur.videoSearchStats.lastActionTime=Date.now(),z._updateLastSeenElement(c))}},showMore:function(e,t){e=e||z._getCurrentSectionType();const o=(0,v.curBox)()?(0,v.curBox)().bodyNode:void 0,i=(0,n.geByClass1)("_video_"+e+"_list",o);if(!i)return;const s=z.isInAlbum(e),r=cur.getOwnerId();if((s||-1!=z.AVAILABLE_TABS.indexOf(e))&&!cur.silentLoaded[r][e])return void((0,I.isButtonLocked)(t)||(z._addPendingAction(e,(function(){z.showMore(e,t)})),(0,I.lockButton)(t)));let a;(0,I.unlockButton)(t),cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[r]=cur.videoShowWindow[r]||{},cur.videoShowWindow[r][e]||(cur.videoShowWindow[r][e]={done:!1,offset:i.children.length});const c=cur.videoShowWindow[r][e];if(!c.done)if(e.indexOf("search")>=0&&cur.found[e]){let o,s,r;if(e===z.VIDEO_GLOBAL_SEARCH_TYPE){if(a=cur.found[e].list.length,o=cur.found[e].realOffset||a,s=cur.found[e].list.slice(c.offset,a),r=cur.found[e].done,!r&&0===s.length)return z._addPendingAction(e,(function(){z.showMore(e,t)})),(0,I.lockButton)(t),void(cur.globalSearchInProgress||z._searchGlobally(cur.videoGlobalSearchQuery,o))}else if(e===z.ALBUM_GLOBAL_SEARCH_PROMO_PLAYLISTS_TYPE){const o=0===c.offset,i=(0,n.ge)("video_"+e+"_list"),d=i.classList.contains("VideoGrid");if(!o)return(0,I.lockButton)(t),void z.showMorePlaylist(cur.videoGlobalSearchQuery,c.offset,((o,n,s)=>{d&&i.classList.remove("VideoGrid--oneRow"),(0,I.unlockButton)(t),z.onMoreLoaded(t,e,n,s,o)}));a=cur.found[e].list.length,s=cur.found[e].list,r=a>=cur.found[e].count,d&&i.classList.add("VideoGrid--oneRow")}else if(cur.is_showcase&&e===z.ALBUM_SEARCH_TYPE){if(0===c.offset){a=z._getNumberOfVideoGridColumns()||z.PLAYLIST_FIRST_CHUNK_SIZE,s=cur.found[e].list.slice(0,a);const t=cur.found[e].list.length-a;if(t>0){r=!1;const e=(0,n.geByClass1)("ui_load_more_btn",(0,n.gpeByClass)("ge_video_pane",i));if(e){const o=(0,d.curLang)("video_show_more_playlists").map((e=>e.replace("%s",'<span class="VideoShowMoreButton__counter">%s</span>')));e.innerHTML=(0,d.langNumeric)(t,o)}}else r=!0}else(0,n.ge)("video_"+e+"_list").classList.remove("VideoGrid--oneRow"),s=cur.found[e].list.slice(c.offset,cur.found[e].list.length),r=!0}else a=c.offset+z.VIDEOS_PER_PAGE,s=cur.found[e].list.slice(c.offset,a),r=a>=cur.found[e].list.length;z.onMoreLoaded(t,e,s,a,r)}else if((s||-1!=z.AVAILABLE_TABS.indexOf(e))&&cur.silentLoaded[r][e]){const o=cur.silentLoaded[r][e];if(!a&&!o.length)return cur.is_showcase?void(0,n.hide)(t):void z._toggleEmptyPlaceholder(!0,(0,d.getLang)("video_no_videos_here_yet"));a=Math.min(o.length,c.offset+z.VIDEOS_PER_PAGE);const i=o.slice(c.offset,a);let s;if("albums"===e&&cur.albumsPreload[r])s=cur.albumsNoMore,cur.albumsPreload[r]=!1;else{s=a>=o.length;const e=Math.ceil(a,z.VIDEOS_PER_PAGE);if(window.cur.unauthScrollMoreBox){const{ownerId:t,screens:o}=window.cur.unauthScrollMoreBox;e>o&&z.getCurOwnerId()===t&&(window.cur.unauthScrollMoreBox.needShow=!0,s=!0)}}"albums"===e&&(cur.albumsShowingAll[r]=!s),z.onMoreLoaded(t,e,i,a,s)}z._updateThumbsInView()},showMorePlaylist:function(e,t,o){ajax.post("/al_video.php?act=search_video_playlist",{q:e,offset:t,query_id:cur.searchQueryId},{onDone:function(e,t,i){o(e,t,i)}})},isInAlbum:function(e){return 0===(e=e||z.getLoc().section||"").indexOf("album_")||0===e.indexOf("playlist_")},isInSearch:function(){return!!z.getLoc().q},_getSectionAlbumId:function(){const e=z.getLoc().section||"all";switch(e){case"all":return-2;case"uploaded":return-1;default:return e.split("_")[1]}},isInCatalog:function(e){return e=e||z.getLoc(),cur.is_showcase?!cur.isOwnerVideos&&!(0,E.inArray)(e.section,z.USER_SYSTEMS_ALBUM_TYPES):"video"===e[0]&&!e.section},_getCurrentSectionType:function(){return cur.videoForcedSection?cur.videoForcedSection:z.isInAlbum(z.getLoc().section)?"album":z.isInCatalog()?"catalog":z.getLoc().section||"all"},_getNumberOfVideoGridColumns:function(){const e=document.querySelector(".VideoLayout__contentsWrapper"),t=document.querySelector(".VideoLayout__contents .VideoGrid");let o,i;if(t){o=t.offsetWidth||e.offsetWidth;const n=getComputedStyle(t);i=parseInt(n.getPropertyValue("column-gap"),10)}else o=e.offsetWidth,i=12;return Math.floor((o+i)/(300+i))},onScroll:function(){if("upload"===z.getLoc().section)return;let e;cur.getOwnerId&&cur.albumsShowingAll[cur.getOwnerId()]?e="albums":(e=z._getCurrentSectionType(),z.getLoc().q||"search"===e?e=(0,n.isVisible)((0,n.gpeByClass)("ge_video_pane","ui_search_global_videos_load_more"))?z.VIDEO_GLOBAL_SEARCH_TYPE:z.VIDEO_SEARCH_TYPE:"album"===e?e=z.getLoc().section:cur.showcaseSection&&(e=cur.showcaseSection));const t=(0,v.curBox)()?(0,v.curBox)().bodyNode:void 0,o=(0,n.geByClass1)("_video_"+e+"_list",t);if(o&&"all_playlists"!==e){const t=(0,n.gpeByClass)("ge_video_pane",o),i=(0,n.geByClass1)("ui_load_more_btn",t);if(i){const t=(0,n.clientHeight)(),o=(0,g.scrollGetY)(),s=(0,n.getXY)(i);o+t>(cur.serverPaging?s[1]-t:s[1]-t/2)&&(cur.serverPaging&&cur.showcaseSection===e?z.showMoreShowcase(e,i,(()=>{z._updateThumbsInView(),z._loadNextChunkIfNeed()})):z.showMore(e,i))}e===z.VIDEO_GLOBAL_SEARCH_TYPE&&z._updateLastSeenElement(o)}else if("all_playlists"===cur.showcaseSection&&cur.playlistsNextOffset&&!cur.loadingAlbums){const e=(0,n.clientHeight)(),t=document.body.clientHeight;(0,g.scrollGetY)()+e>t-e/2&&z.showMoreOwnerPlaylists()}z._updateChooseFixedBottom(),z._updateThumbsInView()},_createSorters:function(e){if(!cur.videoCanSort)return;cur.videoSorter&&cur.videoSorter.destroy(),"album"===(e=e||z._getCurrentSectionType())&&(e=z.getLoc().section);const t=cur.is_showcase?"VideoCard--dragOver":"video_on_drag_over";(0,N.getGridSorterModule)().then((()=>{cur.videoSorter=new window.GridSorter((0,n.ge)("video_"+e+"_list"),"video_item__thumb_link",{onReorder:z._onReorder,onDragOverElClass:"js-video_playlist_item",onDragLeave:function(e,o){(0,n.removeClass)(e,t),(0,n.removeClass)(o,"video_on_drag_over")},onDragEnter:function(e,o){(0,n.addClass)(e,t),(0,n.addClass)(o,"video_on_drag_over")},onDragDrop:function(e,t){const o=(0,n.attr)(t,"data-id").split("_"),i=(0,n.attr)(e,"data-id");return ajax.post("/al_video.php?act=a_add_to_playlist",{oid:o[0],vid:o[1],gid:D.Ranges.isGroupId(cur.getOwnerId())?D.Ranges.convertGroupIdToOwnerId(cur.getOwnerId()):0,add:1,playlist_id:i,own:1,hash:cur.videoAddToPlaylistOwnHash},{onDone:function(t,o){if(o&&o[i]){const t=z.buildPlaylistEl(o[i],cur.is_showcase);(0,n.domPN)(e).replaceChild(t,e),z._reinitSorters(),cur.albumsSorter.update()}}}),!0}})}))},_reinitSorters:function(e){cur.videoCanSort&&(clearTimeout(cur._rsto),cur._rsto=setTimeout((function(){cur.videoSorter?e?cur.videoSorter.disable():cur.videoSorter.enable():z._createSorters()})))},_saveHistoryAction:function(e,t){if(z.isInSearch()&&cur.videoGlobalSearchQuery){const o=cur.videoGlobalSearchQuery+z._buildFiltersSearchStr(),i=cur.globalSearchResults[o];i&&!cur.videoSearchFilters.notsafe&&uiSearch.saveHistorySearch(this.searchInputEl,cur.videoGlobalSearchQuery,e,t,i.count,i.countHash)}},onVideoAdd:function(e,t,o,s,r){const a=t?.closest("._video_item"),c=a?.classList?.contains("VideoCard");if(c)return;const l=(0,E.intval)((0,n.toggleClass)(a,"VideoCard--videoAdded"));let u;return u=l?{playlist_id:M.MY_VIDEO_ALBUM_ID}:{playlists:0},z._saveHistoryAction(o,s),ajax.post("/al_video.php?act=a_add_to_playlist",(0,E.extend)({oid:o,vid:s,add:(0,E.intval)(l),hash:r},u),{onFail:function(){l&&(window.tooltips&&tooltips.destroyAll(),(0,n.removeClass)(a,"VideoCard--videoAdded"))},onDone:function(t,r,a){const c=cur.currentSortings&&(!cur.currentSortings.all||"default"===cur.currentSortings.all),u=!!cur._preloadedPages&&(0,n.geByClass1)("_video_list_my_all",cur._preloadedPages.all);let _,h=!1;if(_=l?(0,d.getLang)("video_added_to_section"):(0,d.getLang)("video_deleted_from_section"),(0,m.showSnackbar)({text:_,before:{content:(0,i.jsx)(x.Icon28ListCheckOutline,{})},action:{label:`«${(0,d.getLang)("video_catalog_showcase_section_my_video_added_title")}»`,onClick:()=>window.location.href=(0,M.getPlaylistURL)(o,M.MY_VIDEO_ALBUM_ID)}}),u){const e=(0,n.geByClass1)("ge_video_item_"+o+"_"+s,u);e&&(0,n.re)(e),h=!!e,l&&c&&u.insertBefore(z.buildVideoEl(a,cur.is_showcase),u.firstChild)}if(cur.silentLoaded&&cur.silentLoaded[vk.id]&&cur.silentLoaded[vk.id].all){const e=cur.silentLoaded[vk.id].all;if(l)c&&(e.unshift(a),z._reindex(e));else for(let t=0,i=e.length;t<i;t++)if(e[t][0]==o&&e[t][1]==s){e.splice(t,1);break}if(cur.videosCount[vk.id]){let e=l?1:-1;1===e&&h&&(e=0);const t=cur.videosCount[vk.id].all=Math.max(0,(cur.videosCount[vk.id].all||0)+e);z.updateTabCounter(t)}}const g=(0,B.getTrackCodeFromElement)(e?.target);(0,B.logEvent)({action:l?B.SearchClickActionMap.ADD_TO_ME:B.SearchClickActionMap.REMOVE_FROM_ME,track_code:g,type:B.EventItemType.VIDEO})}}),window.tooltips&&tooltips.destroyAll(),(0,p.cancelEvent)(e)},updateTabCounter:function(e){const t=(0,n.ge)("video_tab_all");if(t){(0,n.geByClass1)("ui_tab_count",t).innerHTML=e}},onVideoMove:function(e,t,o,i,n){return(0,u.showBox)("/al_video.php?act=video_playlists_box",{target_id:cur.getOwnerId(),oid:o,vid:i,hash:n},{stat:[window.jsc("web/indexer.js")]}),(0,p.cancelEvent)(e)},_showProgressPanel:function(e){const t=(0,n.se)('<div class="video_delete_progress _video_delete_progress VideoCard__deleteProgress"><div class="round_spinner"></div></div>');return e.appendChild(t),t},onVideoDelete:function(e,t,i,s,r,a=!1){const c=(0,n.gpeByClass)("_video_item",t);if(!c)return;const d=z._getCurrentSectionType(),l="album"===d?z._getSectionAlbumId():-2;let u=z._showProgressPanel(c);c.classList.add(c.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),cur.videoRecentlyRemoved||(cur.videoRecentlyRemoved={}),cur.videoRecentlyRemoved[i+"_"+s]=!0;const _=(0,F.joinRawId)({itemId:s,ownerId:i}),h=l===M.MY_VIDEO_ALBUM_ID||l===M.UPLOADED_ALBUM_ID,g=()=>{u?.remove(),cur.section_id===M.SECTION_MY_BOOKMARKS&&(0,k.showWatchLaterSnackbar)({isBookmarked:!1}),cur.section_id!==M.SECTION_MY_BOOKMARKS&&cur.section_id!==M.SECTION_MY_LIKED&&cur.videoRecentlyRemoved[_]},v=()=>{const e=c.querySelector("._video_restore");u=z._showProgressPanel(c),e?.remove(),c.classList.remove(c.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now")},m=()=>{const e=(0,b.buildVideoRestorationEl)(s,i,a,cur.section_id,cur.is_showcase,h);e&&(u.remove(),c.appendChild(e),a&&d!==M.SECTION_MY_CLIPS||Promise.all([o.e(73538),o.e("langs/web/video_restore_button")]).then(o.bind(o,69727)).then((({initVideoRestoreButton:e,unmountVideoRestoreButton:t})=>{if(c.classList.contains("video_deleted"))return;const o=(0,F.joinRawId)({itemId:s,ownerId:i}),r=document.getElementById(`video-restore-button-widget-${o}`),a={videoId:+s,ownerId:+i,targetId:cur.oid,playlistId:l,section:cur.section_id,onRestore:g,onClick:v};let d=(0,n.data)(c,"restoreTO");e(r,a),clearTimeout(d),d=setTimeout((()=>{t(r)}),6e4),(0,n.data)(c,"restoreTO",d)})))};return cur.section_id===M.SECTION_MY_BOOKMARKS?((0,q.removeVideoFromBookmarks)({id:s,owner_id:i}).then((()=>{m(),(0,k.showWatchLaterSnackbar)({isBookmarked:!0,rollbackCallback:()=>{v(),(0,q.addVideoToBookmarks)({id:s,owner_id:i}).then(g)}})})),(0,p.cancelEvent)(e)):cur.section_id===M.SECTION_MY_LIKED?((0,q.removeVideoFromLikes)({item_id:s,owner_id:i,type:"video"}).then(m),(0,p.cancelEvent)(e)):(h?(0,q.removeVideoFromMy)({video_id:s,owner_id:i,target_id:cur.oid}).then(m):(0,q.removeVideoFromAlbum)({video_id:s,owner_id:i,album_id:l,target_id:cur.oid}).then(m),(0,p.cancelEvent)(e))},restoreVideo:function(e,t,o,i){const s=(0,n.gpeByClass)("_video_item",e),r=s.querySelector("._video_restore"),a=z._showProgressPanel(s),c="album"===z._getCurrentSectionType()?z._getSectionAlbumId():-2;if((0,n.re)(r),"my_bookmarks"===cur.section_id){let e=t.split("_");return(0,n.removeClass)(s,s.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,n.re)(a),(0,k.showWatchLaterSnackbar)({isBookmarked:!1}),void window.bookmark(e[0],e[1],"video",i,!1,"","","",0,Y.FAVORITE_SOURCES.SNACKBAR)}if("my_liked"!==cur.section_id)(0,P.partConfigEnabled)("video_remove_restore_video_act")||ajax.post("/al_video.php?act=a_restore_video",{from:o,video_id:t,pl_id:c,hash:i,section:cur.section_id},{onDone:function(){(0,n.removeClass)(s,s.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,n.re)(a)}}),delete cur.videoRecentlyRemoved[t];else{(0,n.removeClass)(s,s.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,n.re)(a);const o=()=>window.Likes.toggle(e,!1,"video"+t,i);window.Likes?o():window.stManager.add([window.jsc("web/likes.js")]).then(o)}},onVideoUMA:function(e,t,o,i){return(0,u.showBox)("al_video.php?act=get_uma_restrictions",{oid:o,vid:i},{params:{width:750}}),(0,p.cancelEvent)(e)},onVideoEdit:function(e,t,o,i,s=!1){cur.videoEditItem=(0,n.gpeByClass)("_video_item",t),window.Videoview&&Videoview.hidePlayer();return(0,u.showBox)("al_video.php?act=edit_box",{vid:i,oid:o,is_short_video:+s},{containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css","video_edit.css",window.jsc("web/videoview.js"),window.jsc("web/video_upload.js"),window.jsc("web/upload.js")]}).setOptions({onHide:function(){window.Videoview&&Videoview.showPlayer()}}),(0,p.cancelEvent)(e)},switchChooserToOwner:function(e){const t={to_id:e,switched:1};!!cur.isSnippetVideoSelection&&(t.snippet_video=1),t.from=cur.chooseParams?.from||"",boxQueue.hideLast(),(0,u.showBox)("al_video.php?act=a_choose_video_box",t,{cache:1})},chooseBoxBack:function(){cur.videoChoosePrevSection=cur.videoChoosePrevSection||"all",0==cur.videoChoosePrevSection.indexOf("album_")&&(cur.videoChoosePrevSection="albums"),nav.go("/videos?section="+cur.videoChoosePrevSection)},initChooseBox:function(e,t,o,i,s,r,a,l){if(arguments.length>0)this.initChooseBoxOptions={isNoteEdit:e,isReview:t,toMail:o,curOwnerId:i,defaultTitle:s,blockPersonal:r,isSnippetVideo:a};else{if(!this.initChooseBoxOptions)return;e=this.initChooseBoxOptions.isNoteEdit,t=this.initChooseBoxOptions.isReview,o=this.initChooseBoxOptions.toMail,i=this.initChooseBoxOptions.curOwnerId,s=this.initChooseBoxOptions.defaultTitle,r=this.initChooseBoxOptions.blockPersonal,a=this.initChooseBoxOptions.isSnippetVideo}cur.found={},cur.currentSortings={},cur._preloadedPages={},cur.videoSearchFilters={},cur.chosenVideos=cur.chosenVideos||[],cur.albumsShowingAll={},cur.isNoteEdit=e,cur.videoShowWindow={},cur.isSnippetVideoSelection=a;const u=(0,v.curBox)(),_=cur.getOwnerId;function h(){u.setOptions({width:631,bodyStyle:"padding: 0",hideButtons:!0}),(0,n.ge)("box_layer_wrap").scrollTop=0}function g(){(0,E.each)(z.AVAILABLE_TABS,(function(e,t){(0,n.hide)("video_subtab_pane_"+t)})),(0,n.hide)((0,n.geByClass1)("video_subtab_pane_album"))}function m(){u.setOptions({title:'<div class="back" onclick="Video.chooseBoxBack();"><span class="back__icon">'+(0,w.getIcon24BrowserBack)().icon+"</span>"+(0,d.getLang)("video_choose_box_back_to_videos")+"</div>",bodyStyle:"padding: 0",noRefreshCoords:1})}function I(){let e=s;if(!r&&!t&&cur.videoSwitchOwnerId){const t=i==vk.id?(0,d.getLang)("video_choose_wall_to_group_videos"):(0,d.getLang)("video_choose_wall_to_my_videos");e+='<span class="divider">|</span><a class="toggle" onclick="Video.switchChooserToOwner('+(i==vk.id?cur.videoSwitchOwnerId:vk.id)+')">'+t+"</a>"}u.getOptions().defaultTitle&&(e=u.getOptions().defaultTitle),u.setOptions({title:e,grey:t})}function S(){(0,v.curBox)()&&(0,E.each)((0,n.geByClass)("video_item",(0,v.curBox)().bodyNode),(function(){const e=(0,n.geByClass1)("media_check_btn_wrap",this),t=this.getAttribute("data-id");(0,n.toggleClass)(e,"checked",-1!=cur.chosenVideos.indexOf(t))}))}cur.getOwnerId=function(){return i},u.setOptions({onHideAttempt:function(){return cur.getOwnerId=_,cur.chosenVideos=[],!0}}),cur.nav.push((function(e,t,o,s){if(!s.filtersChanged&&1===Object.keys(o).length&&o[0]&&0!=o[0].indexOf("video")&&!s.fromSearch)return!0;if(e[0]&&!e.section&&o[0]!=="videos"+i)return!0;(0,n.hide)("global_prg");const r=(0,n.geByClass1)("video_default_tabs",u.bodyNode),a=(0,n.geByClass1)("video_subtab_pane_album",u.bodyNode);let d=e.section||"all";z._prepareSearchFilters(o);const l=e.section?"":o.q||(0,n.val)(cur.searchInputEl);if(l?(d="search",s.fromSearch||s.globalQuery||(s.globalQuery=l),z.doSearch(l),m(),z._updateChooseFixedBottom()):(z.inputVal(cur.searchInputEl,""),z.doSearch("")),cur.videoForcedSection=d,-1!==z.AVAILABLE_TABS.indexOf(d))g(),(0,n.show)("video_subtab_pane_"+d),(0,n.show)(r),(0,n.hide)("albumPane"),I(),h(),cur.videoChoosePrevSection=d,"albums"!==d&&z.loadSilent(d),z._updateChooseFixedBottom(),z.updateEmptyPlaceholder(d);else if(d&&0==d.indexOf("album_")){const e=d.split("_")[1];(0,c.showGlobalPrg)((0,n.ge)("video_playlist_item_"+e),{cls:"progress_inv_img",w:46,h:16,shift:[0,-22],zIndex:1e3}),z._addPendingAction(d,(function(){m(),g(),(0,n.hide)("global_prg"),(0,n.hide)(r),a.id="video_subtab_pane_"+d;const e=(0,n.geByClass1)("video_items_list",a);e.id="video_"+d+"_list",(0,n.addClass)(e,"_video_"+d+"_list"),e.innerHTML="",(0,n.show)(a);const t=cur.getOwnerId();cur.videoShowWindow=cur.videoShowWindow||{},cur.videoShowWindow[t]=cur.videoShowWindow[t]||{},cur.videoShowWindow[t][d]=!1,z.showMore(d,(0,n.geByClass1)("ui_load_more_btn",(0,n.ge)("video_subtab_pane_album"))),h(),S(),z._updateChooseFixedBottom()})),cur.videoChoosePrevSection=d,z.loadSilent(d)}return S(),!1})),cur.chooseVideoToMail=o,cur.isCurrentVideoLayer=!0,z.loadSilent(l),h(),(0,p.addEvent)((0,n.ge)("box_layer_wrap"),"scroll",z.onScroll);const T=boxLayerWrap.scrollTop;(0,n.elfocus)((0,n.geByClass1)("_scroll_node",u.bodyNode)),boxLayerWrap.scrollTop=T,z.initSearch(),I(),t||(cur.chooseVideoMedia=function(e,t,o){let i,s=e;if((0,n.hasClass)(s,"media_check_btn_wrap")?cur.cancelClick=!0:s=(0,n.geByClass1)("media_check_btn_wrap",s),(i=cur.chosenVideos.indexOf(t))>=0)cur.chosenVideos.splice(i,1);else{if(cur.chosenVideos.length>=(cur.maxFiles||10))return;cur.chosenVideos.push(t)}const r="true"===s.dataset.selected;if(s.setAttribute("data-selected",!r),(0,n.toggleClass)(s,"checked"),1===cur.chosenVideos.length&&!o)return z.doAttachSelectedVideos(e),!1;const a=(0,n.ge)("video_choosebox_bottom");if(cur.chosenVideos.length>0){(0,n.show)(a);const e=cur.chooseVideoAdd?(0,d.curLang)("video_add_videos"):(0,d.curLang)("global_attach_videos"),t=a?.querySelector(".video_choosebox_attach_btn");t&&A.FlatButton.setLabel(t,(0,d.langNumeric)(cur.chosenVideos.length,e)),z._updateChooseFixedBottom()}else(0,n.hide)(a);return(0,n.toggleClass)((0,n.ge)("video_choose_box"),"with_bottom_fixed",(0,n.isVisible)(a)),!1}),window.uiScrollBox&&window.uiScrollBox.init((0,v.curBox)(),{onHide:function(){(0,n.hide)("global_prg"),cur.nav.pop(),(0,p.removeEvent)((0,n.ge)("box_layer_wrap"),"scroll",z.onScroll),cur.isCurrentVideoLayer=!1,cur.chooseVideoMedia=null},onShow:function(){z.initChooseBox()}})},doAttachSelectedVideos:function(e){A.FlatButton.isFlatButton(e)?A.FlatButton.lock(e):(0,c.showGlobalPrg)((0,n.geByClass1)("video_item_thumb_wrap",e)||e,{cls:"progress_inv_img",w:46,h:16,zIndex:1e3});const t=function(){A.FlatButton.isFlatButton(e)&&A.FlatButton.unlock(e),(0,n.hide)("global_prg"),cur.chooseVideoAdd&&(cur.chosenVideos=[])};if(cur.chooseVideoAdd)return cur.chooseVideoAdd(cur.chosenVideos,"",t);(0,W.isPostingPerfStatsEnabled)()&&window.Wall?.postingTimelineLogger?.logStartAttaching({pickerType:X.POSTING_PICKER_TYPES.VIDEO_VK}),z.attachVideos(cur.chosenVideos,t)},attachVideos:function(e,t){const o=cur.getFrom?.()||"";ajax.post("al_video.php?act=a_videos_attach_info",{from:o,videos:e.join(",")},{onDone:function(e){if(t&&t(),cur.isSnippetVideoSelection&&cur.chooseSnippetVideo)return(0,E.each)(e,(function(e,t){return cur.chooseSnippetVideo(e,t),!1})),void((0,v.curBox)()&&(cur.chosenVideos=[],(0,v.curBox)().hide()));let i=0,n=0;const s=("page_add_media"===cur.chooseVideoBoxMedia?.id?cur.wallAddMedia:cur.wallEditMedia)||{},r=Number(s.postponeDate),a=s.chosenMedias?.some((e=>"video"===e[0])),c="post"===o&&(r||"page_add_media"===cur.chooseVideoBoxMedia?.id);(0,E.each)(e,(function(e,t){t.publish_date&&(n=Number(t.publish_date)),cur.isNoteEdit&&window.editorChooseVideo?window.editorChooseVideo(t.thumb,t.name,t.duration,"/video"+e,e):cur.chooseMedia("video",e,t,i,cur.chosenVideos.length>1),i++})),c&&1===i&&n&&!a&&n!==r&&((0,u.showBox)("al_video.php?act=publish_date_info_box",{video_date:n,post_date:r},{params:{width:420},onDone:function(e,t){e.setButtons((0,d.getLang)("video_publish_on_wall_date_info_keep_date_btn"),(function(){boxQueue.hideAll(!0)}),(0,d.getLang)("video_publish_on_wall_date_info_change_date_btn"),(function(){if(t){cur.onMediaChange?.(t);const e=("page_add_media"===cur.chooseVideoBoxMedia?.id?cur.wallAddMedia:cur.wallEditMedia)||{};e&&(e.postponeDate&&(e.unchooseMediaForType("postpone"),cur.postponedLastDate=null),e.addOrUpdateChosenMedia("postpone",t,{date:t}))}boxQueue.hideAll(!0)}))}}),window.boxLayerBG&&(window.boxLayerBG.style.display="block",document.body.classList.add("layers_shown"))),(0,v.curBox)()&&cur.chosenVideos.length>1&&(cur.chosenVideos=[],(0,v.curBox)().hide())}})},_updateChooseFixedBottom:function(){const e=(0,v.curBox)(),t=(0,n.ge)("video_choosebox_bottom");if(e&&t){const o=(0,n.gpeByClass)("box_layout",e.bodyNode);(0,n.getSize)(o)[1]+((0,n.getXY)(o)[1]-(0,g.scrollGetY)())-(0,n.clientHeight)()>0?(0,n.addClass)(t,"fixed"):(0,n.removeClass)(t,"fixed")}},_addPendingAction:function(e,t){const o=cur.getOwnerId?cur.getOwnerId():cur.oid;if(cur.videoPendingAction=cur.videoPendingAction||{},cur.videoPendingAction[o]=cur.videoPendingAction[o]||{},e){const i=cur.videoPendingAction[o][e];cur.videoPendingAction[o][e]=function(){t(),i&&i()}}},_callPendingAction:function(e){z._addPendingAction();const t=z.getCurOwnerId();cur.videoPendingAction[t][e]&&cur.videoPendingAction[t][e](),cur.videoPendingAction[t][e]=!1},_clearPendingAction:function(e){z._addPendingAction();const t=z.getCurOwnerId();cur.videoPendingAction[t][e]=!1},toggleTooltip:function(e,t,o,i=!1){let n=[9,18,3];"view-toggle"===o?n=[-5,-1,3]:i&&(n=[9,12]),(0,h.showTooltip)(e,{black:1,text:t,shift:n,needLeft:!0,forcetodown:i})},toggleAddTooltip:function(e,t,o){const i=(0,n.gpeByClass)("_video_item",e);z.toggleTooltip(e,(0,n.hasClass)(i,"VideoCard--videoAdded")?o:t)},show:function(e,t,o,i){if(cur.videoEditItem=(0,n.gpeByClass)("_video_item",i),cur.articleEditorLayer)return(0,p.cancelEvent)(e);if((0,G.isValidUrl)(i.dataset.vkLiveChannelUrl)){if(e.ctrlKey||e.metaKey||e.button&&1===e.button)return;return void(window.location.href=i.dataset.vkLiveChannelUrl)}if(o.playAlbum&&(0,_.statlogsValueEvent)("video_play_album",0,"play_album"),cur.isCurrentChooseVideoBox){const o=window.event,i=t.split("_");return ajax.post("al_video.php?act=a_video_photo_sizes",{oid:i[0],vid:i[1],type:cur.isCurrentChooseVideoBox},{onDone:function(){switch(window.event=o||window.event,cur.isCurrentChooseVideoBox){case"video_add":cur.chooseVideoAdd(t,arguments[0]);break;case"wiki_editor":window.editorChooseVideo(arguments[0],arguments[1],arguments[2],"video"+t,t);break;case"video_choose":cur.chooseMedia("video",t,arguments[0])}}}),(0,p.cancelEvent)(e),!1}if(i&&(0,n.hasClass)(i,"video_row_deleted"))return!1;if(!vk.id&&i&&(0,n.hasClass)(i,"video_row_not_public"))return(0,v.showDoneBox)((0,d.getLang)("video_please_sign_in")),!1;const s=(0,E.extend)({root:1,autoplay:1},o||{});let a=(o?o.listId:"")||this.getDefaultListId();if(!s.module){let e=cur.currentModule?cur.currentModule():cur.module;"video_search"===e&&(0,n.isAncestor)(i,"video_search_videos_list")&&(e="video_search_local"),s.module=e}if("video_live_categories"===s.module){const t=i.getAttribute("href");return void(e.ctrlKey||e.metaKey||e.button&&1===e.button?window.open(t,"_blank"):window.nav.go(t))}if(z.isInVideosList()&&!s.playlistId){let e,t;e=cur.is_showcase?cur.showcaseSection:z.getLoc().section||"all","all"===e?s.playlistId=cur.oid+"_-2":"uploaded"===e?s.playlistId=cur.oid+"_-1":(t=e.match(/^(album|playlist)_(-?\d+)$/))&&(s.playlistId=cur.oid+"_"+t[1])}if(z.isInCatalog()&&!s.playlistId&&cur.catPlaylistId&&!cur.isCatalog&&(s.playlistId=cur.catPlaylistId),s.playlistId&&(s.addParams=(0,E.extend)(s.addParams||{},{playlist_id:s.playlistId,show_next:(0,E.intval)(window.VideoPlaylist&&!!VideoPlaylist.getList(s.playlistId)),force_no_repeat:1,show_all_videos:s.forceAllVideos?1:(0,E.intval)(cur.isCatalog&&(!window.VideoPlaylist||!VideoPlaylist.getList(s.playlistId)))})),s.playFrom&&(s.addParams=(0,E.extend)(s.addParams||{},{t:s.playFrom})),cur.videoSearchStats){const e=(0,n.domClosest)("video_item",i);if(e&&e.hasAttribute("data-search-pos")){cur.videoSearchPos=parseInt(e.getAttribute("data-search-pos")),cur.videoSearchPos>cur.videoSearchStats.lastSeenIndex&&(cur.videoSearchStats.lastSeenElement=e,cur.videoSearchStats.lastSeenIndex=cur.videoSearchPos),cur.videoSearchStats.positions[cur.videoSearchPos]=(0,E.extend)({clicked:0},cur.videoSearchStats.positions[cur.videoSearchPos]),cur.videoSearchStats.positions[cur.videoSearchPos].clicked++;const t=++cur.videoSearchStats.clickNum,o=Date.now()-cur.videoSearchStats.lastActionTime;s.addParams=(0,E.extend)(s.addParams||{},{click_num:t,click_time:o})}}if(!cur.is_section){const e=t.split("_");z._saveHistoryAction(e[0],e[1])}const c=e?.target?.closest?.("#search_auto_rows");if(c){const t=(0,B.getTrackCodeFromElement)(e?.target);(0,B.logEvent)({action:B.SearchClickActionMap.PLAY,track_code:t,type:B.EventItemType.VIDEO})}return(0,r.showVideo)(t,a,s,e)},getDefaultListId:function(){return D.Ranges.isGroupId(window.cur.oid)?"club"+-window.cur.oid:window.cur.pvVideoTagsShown&&window.cur.pvShown?"tag"+window.cur.pvVideoTagsShown:""},isCurSectionHasMyPlaylistList:()=>{const e=["my","all_playlists"];return!!cur?.section_id&&e.includes(cur.section_id)},isInVideosList:function(){if(cur.is_showcase)return(0,E.inArray)(cur.showcaseSection,["all","uploaded","all_playlists","clips"])||/^playlist_-?\d+$/.test(cur.showcaseSection);const e=z.getLoc();return/^videos-?\d+|video-?\d+_\d+$/.test(e[0])&&!e.q&&((0,E.inArray)(z._getCurrentSectionType(),z.AVAILABLE_TABS)||z.isInAlbum())},deleteAlbum:function(e,t){return e=e.split("_")[1],(0,u.showBox)("al_video.php?act=delete_album",{aid:e,oid:cur.oid,is_showcase:cur.is_showcase}),(0,p.cancelEvent)(t)},editAlbum:function(e,t,o,i){const[n,s]=e.split("_");return(0,u.showBox)("al_video.php?act=edit_album",{oid:i?n:cur.oid,aid:s,is_showcase:cur.is_showcase},{stat:[window.jsc("web/upload.js"),"video_edit.css"],containerClass:"VideoPlaylistPopup",onDone:function(e){e.boxLayoutNode.dataset.requestOrigin=o}}),(0,p.cancelEvent)(t)},doDeleteAlbum:(e,t,o,i)=>{const n=(0,v.curBox)();if(!n)return;const s=n.btns.ok[0];ajax.post("al_video.php?act=do_delete_album",{aid:e,hash:t,oid:cur.oid},{onDone:function(){window.dispatchEvent(new CustomEvent(L.PlaylistFormEvents.DELETE)),n.hide(),globalHistoryDestroy(i),"/"+nav.strLoc===o?nav.reload():nav.go(o,!1,{back:!0})},showProgress:()=>(0,I.lockButton)(s),hideProgress:()=>(0,I.unlockButton)(s)})},initEditAlbumBox:function(e,t,o,s,r,a,c){const u=(0,v.curBox)(),_=(0,l.isObject)(r),h=!!Object.keys(c).length,g=u.bodyNode.querySelector(".js-video-upload-thumb-chooser"),p=u.bodyNode.querySelector(".js-video-upload-vertical-thumb-chooser");if(h){if(window.VideoUpload.initThumbUpload(c,g),(0,l.isObject)(a)&&a.uploaded_id){const e=g.querySelector(".js-video_tc_upload_image");e.style.backgroundImage="url("+a.uploaded_url+")",e.style.display="block";const t=g.querySelector(".js-video_tc_uploader");t&&(t.setAttribute("data-thumb-id",a.uploaded_id),t.setAttribute("data-thumb-hash",a.uploaded_hash))}if(p){const e={...c,url:c.url_for_vertical_thumb,is_vertical:!0};if(window.VideoUpload.initThumbUpload(e,p),(0,l.isObject)(a)&&a.uploaded_vertical_url){const e=p.querySelector(".js-video_tc_upload_image");e.style.backgroundImage="url("+a.uploaded_vertical_url+")",e.style.display="block";const t=p.querySelector(".js-video_tc_uploader");t&&(t.setAttribute("data-thumb-id",a.uploaded_id),t.setAttribute("data-thumb-hash",a.uploaded_hash))}}}if(D.Ranges.isGroupId(e)&&_){const e=(0,n.rs)(r.key,{id:t}),o=document.getElementById(e);new K.InlineDropdown(o,{items:r.items,selected:r.selected})}_&&(cur.privacy=(0,E.extend)(cur.privacy||{},r));const S=t?(0,d.getLang)("global_save"):(0,d.getLang)("video_create_new_playlist");u.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),u.removeButtons(),u.addButton(S,(function(a){let c=(0,n.ge)("video_album_edit_title"),l=c.value.trim();if(!l)return(0,I.notaBene)(c);let v="";if(_)if(D.Ranges.isUserId(e))v=window.Privacy.getValue("video_playlist"+t);else if(D.Ranges.isGroupId(e)){const e=(0,n.rs)(r.key,{id:t});v=document.getElementById(`${e}_input`)?.value}let E="",S="",T="",f="";if(h){const e=(0,n.geByClass1)("js-video_tc_uploader",g);E=(0,n.domData)(e,"thumb-id")||R.VIDEO_DEFAULT_THUMB_ID,E===R.VIDEO_DEFAULT_THUMB_ID&&(E=""),S=(0,n.domData)(e,"thumb-hash")||"";const t=p?.querySelector(".js-video_tc_uploader");t&&(T=t.getAttribute("data-random-tag"),f=t.getAttribute("data-vertical-photo-hash"))}ajax.post("al_video.php?act=do_edit_album",{id:t,oid:e,hash:o,title:l,privacy:v,thumb_id:E,photo_hash:S,random_tag:T,vertical_photo_hash:f},{showProgress:()=>(0,I.lockButton)(a),hideProgress:()=>(0,I.unlockButton)(a),onDone:function(o){const n=(0,P.partConfigEnabled)("video_created_playlist_snackbar_bugfix"),r=u.boxLayoutNode.dataset?.requestOrigin,a=u.boxLayoutNode.dataset?.videoId,c=u.boxLayoutNode.dataset?.videoOwnerId;if(r===L.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL&&a&&c)return window.dispatchEvent(new CustomEvent(L.PlaylistFormEvents.CREATE,{detail:{id:o,ownerId:e,title:l,privacy:v,videoOwnerId:c,videoId:a}})),void u.hide();if(!t&&n&&((e,t)=>{(0,m.showSnackbar)({before:{content:(0,i.jsx)(x.Icon28ListCheckOutline,{})},text:(0,d.getLang)("video_playlist_created_notification"),action:{label:(0,d.getLang)("video_open_new_playlist"),onClick:()=>{cur.is_showcase?nav.go(s+"/"+(0,H.getIdentityRawId)({id:t,ownerId:e})):nav.go({section:"album_"+t},!1)}}})})(e,o),[L.CreatePlaylistRequestOrigin.NEW_PLAYLIST_PAGE,L.CreatePlaylistRequestOrigin.VIDEO_CATALOG].includes(r))return window.dispatchEvent(new CustomEvent(L.PlaylistFormEvents.UPDATE,{detail:{id:t,ownerId:e,title:l,privacy:v}})),void u.hide();if(u.hide(),t)cur.isAdmin?AdminShowcasePlaylists.search():nav.reload();else{if(window.dispatchEvent(new CustomEvent(L.PlaylistFormEvents.CREATE,{detail:{id:o,ownerId:e,title:l,privacy:v,videoId:a}})),!n){const t=()=>{cur.is_showcase?nav.go(s+"/"+e+"_"+o):nav.change({section:"album_"+o},!1,{noback:!0})};(0,m.showSnackbar)({before:{content:(0,i.jsx)(x.Icon28ListCheckOutline,{})},text:(0,d.getLang)("video_playlist_created_notification"),action:{label:(0,d.getLang)("video_open_new_playlist"),onClick:t}})}const t=(0,P.partConfigEnabled)("video_add_to_album_group")&&r===L.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL;z.isCurSectionHasMyPlaylistList()&&!t&&nav.reload()}}})}),"yes",!1,"popup_save_button"),u.addButton((0,d.getLang)("global_cancel"),u.hide,"no"),(0,n.elfocus)("video_album_edit_title")},editCategories:function(e,t,o){return(0,u.showBox)("al_video.php?act=show_movie_info_form",{owner_id:e,playlist_id:t},{onDone:function(e,t){cur.categoriesUpdateOptions={hash:t.hash,owner_id:t.owner_id,playlist_id:t.playlist_id};const o=new Dropdown((0,n.ge)("video_playlist_categories"),t.all_categories,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:t.category_ids}),i=new Dropdown((0,n.ge)("video_movie_actors"),"/al_video.php?act=get_movie_info_dropdown_data&type=1",{multiselect:!0,autocomplete:!0,big:1,width:380,noResult:"Актер не найден",selectedItem:t.selected_actors}),s=new Dropdown((0,n.ge)("video_movie_directors"),"/al_video.php?act=get_movie_info_dropdown_data&type=2",{multiselect:!0,autocomplete:!0,big:1,width:380,noResult:"Режиссер не найден",selectedItems:t.selected_directors}),r=new Dropdown((0,n.ge)("video_movie_countries"),t.all_tag_countries,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:t.country_ids,noResult:"Страна не найдена"}),a=new Dropdown((0,n.ge)("video_movie_genres"),t.all_tag_genres,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:t.genre_ids,noResult:"Жанр не найден"}),c=new Dropdown((0,n.ge)("video_movie_custom_tags"),t.all_tag_custom_tags,{multiselect:!0,autocomplete:!0,big:1,width:380,selectedItem:t.custom_tag_ids,noResult:"Тег не найден"});e.setOptions({bodyStyle:"padding: 20px; padding-bottom: 25px;",width:422}),e.removeButtons(),e.addButton("Сохранить",(function(d){let l={hash:cur.categoriesUpdateOptions.hash,owner_id:cur.categoriesUpdateOptions.owner_id,playlist_id:cur.categoriesUpdateOptions.playlist_id,year:(0,n.ge)("video_movie_year").value,kinopoisk_id:(0,n.ge)("video_movie_kinopoisk_id").value,rating_kinopoisk:(0,n.ge)("video_movie_rating_kinopoisk").value,rating_age:(0,n.ge)("video_movie_rating_age").value,category_ids:o.selectedItems().map((e=>e[0])),actor_ids:i.selectedItems().map((e=>e[0])),director_ids:s.selectedItems().map((e=>e[0])),country_ids:r.selectedItems().map((e=>e[0])),genre_ids:a.selectedItems().map((e=>e[0])),custom_tag_ids:c.selectedItems().map((e=>e[0])),info_updated_at:t.info_updated_at};const u=document.getElementById("video_playlist_mark");null!==u&&(l.playlist_mark=u.value),ajax.post("al_video.php?act=update_movie_info",l,{showProgress:()=>(0,I.lockButton)(d),hideProgress:()=>(0,I.unlockButton)(d),onDone:function(){e.hide()}})})),e.addButton("Отмена",e.hide,"no")}}),(0,p.cancelEvent)(o)},initCreateAlbumWarningBox:function(){const e=(0,v.curBox)();e.removeButtons(),e.addButton((0,d.getLang)("video_cancel_but"),e.hide,"neutral")},createAlbum:function(e,t=cur.oid,o,i,n,r,a){return(0,E.intval)(t)?cur.is_showcase&&!vk.id?((0,u.showBox)("al_login.php?act=box",{from:nav.strLoc},{},e),!1):void(0,u.showBox)("al_video.php?act=edit_album",{oid:t,is_showcase:cur.is_showcase,...(0,P.partConfigEnabled)("video_fix_ability_to_add_private_video_to_public_playlist")&&{no_public_add:Number(a)}},{stat:[window.jsc("web/upload.js")],containerClass:"VideoPlaylistPopup",onDone:function(e){e.setOptions({width:500,onDestroy:r}),e.titleWrap.classList.toggle("OwnerChooseWrapper",cur.is_showcase),e.titleWrap.classList.toggle("OwnerChooseWrapper--colorGrey",!0),e.boxLayoutNode.dataset.requestOrigin=n??"",e.boxLayoutNode.dataset.videoId=o??"",e.boxLayoutNode.dataset.videoOwnerId=i??""},onFail:function(e){if(e)return(0,v.curBox)().hide(),(0,u.showFastBox)((0,d.getLang)("global_error"),e),!0}}):((0,s.showQuickLoginBox)(),!1)},isVideoPlayerOpen:function(e,t){let o=e;return t&&(o+="_"+t),window.mvcur&&!0===mvcur.mvShown&&mvcur.videoRaw===o},startPollVideoReady:function(e,t){const o=e+"_"+t;setTimeout((function(){ajax.post("al_video.php?act=check_upload_status",{video:o,oid:e,vid:t},{onDone:function(i){z.isVideoPlayerOpen(e,t)&&(i?(mvcur.minimized?Videoview.hide(!1,!0):Videoview.backLocation(),(0,r.showVideo)(o,"",{})):z.startPollVideoReady(e,t))}})}),1e4)},tcSlide:function(e,t,o,i){const s=(0,n.gpeByClass)("video_tc_slider",t),r=(0,n.geByClass1)("video_tc_slider_cont",s),a=(0,n.getW)(r),c=getComputedStyle(r.children[0]),d=getComputedStyle(r.children.length>0?r.children[1]:r.children[0]),l=parseInt(c.getPropertyValue("margin-left"))+parseInt(c.getPropertyValue("margin-right")),u=parseInt(d.getPropertyValue("margin-left"))+parseInt(d.getPropertyValue("margin-right")),_=(0,n.getW)(r.children[0])+l,h=(0,n.getW)(r.children.length>0?r.children[1]:r.children[0])+u,g=_>0?Math.max(Math.floor(a/_),Math.floor((a-u)/h)):Math.floor((a-u)/h),v=Math.max(0,r.children.length-g);let m=(0,n.data)(r,"currOffset")||0;m+=o,m=Math.min(r.children.length,Math.max(0,m),v),(0,n.data)(r,"currOffset",m),i&&(0,n.addClass)(r,"no_transition");const E=_*+(r.children.length>0)+h*(r.children.length-1)-a-u;let I=_*+(m>0)+Math.max(0,h*(m-1));I=Math.max(0,Math.min(I,E)),(0,n.setStyle)(r,{left:-I}),i&&setTimeout((function(){(0,n.removeClass)(r,"no_transition")}));const S=0===m,T=m===v||I===E,f=(0,n.geByClass1)("video_tc_btn_left",s),w=(0,n.geByClass1)("video_tc_btn_right",s);function V(e,t){e?(0,p.addEvent)(t,"mouseleave",(function(){(0,n.setStyle)(t,"pointer-events","none"),(0,p.removeEvent)(t,"mouseleave")})):((0,n.setStyle)(t,"pointer-events","all"),(0,p.removeEvent)(t,"mouseleave"))}return(0,n.toggleClass)(f,"video_tc_btn_none",S),(0,n.toggleClass)(w,"video_tc_btn_none",T),V(S,f),V(T,w),e&&(0,p.cancelEvent)(e),!1},_initSearchStats:function(e){cur.videoSearchPos=null,cur.videoSearchStats={loc:e,totalViews:0,lastSeenElement:null,lastSeenIndex:-1,totalViewedTime:0,clickNum:0,lastActionTime:Date.now(),positions:[]}},_clearSearchStats:function(){delete cur.videoSearchPos,delete cur.videoSearchStats},_updateLastSeenElement:function(e){if(!cur.videoSearchStats)return;if(!(null!==cur.videoSearchStats.lastSeenElement&&e.contains(cur.videoSearchStats.lastSeenElement)||(cur.videoSearchStats.lastSeenElement=(0,n.domFC)(e),cur.videoSearchStats.lastSeenElement)))return;cur.videoSearchStats.lastSeenIndex=0;const t=(0,n.clientHeight)();let o=(0,n.domNS)(cur.videoSearchStats.lastSeenElement);if(!o)return;let i=o.getBoundingClientRect();for(;i.top+o.clientHeight/2<t&&(cur.videoSearchStats.lastSeenElement=o,o=(0,n.domNS)(cur.videoSearchStats.lastSeenElement),o);)i=o.getBoundingClientRect();cur.videoSearchStats.lastSeenIndex=parseInt(cur.videoSearchStats.lastSeenElement.getAttribute("data-search-pos"))||0},_updateThumbsInView:function(){(0,b.updateThumbsInView)()},getCurOwnerId:function(){return cur.getOwnerId?cur.getOwnerId():cur.oid},onImageError:function(e,t=!0){if(!e.getAttribute("data-thumb")){const o=e.parentNode;if(o.removeChild(e),t){let e=(0,V.getIcon56VideoOutline)().icon;o.insertAdjacentHTML("beforeend",`<div class="VideoCard__thumbIcon">${e}</div>`)}}},checkClickEvent:e=>"click"===e.type&&(e.ctrlKey||e.metaKey),isGroupsRedesignEnabled:()=>{const e=cur.getOwnerId?cur.getOwnerId():cur.oid;return D.Ranges.isGroupId(e)}}},723022:(e,t,o)=>{o.d(t,{buildCommunityEl:()=>T,buildDateSeparatorEl:()=>S,buildPlaylistAsideItem:()=>p,buildPlaylistEl:()=>E,buildPlaylistShowAllEl:()=>I,buildVideoEl:()=>m,buildVideoRestorationEl:()=>v,updateThumbsInView:()=>w});var i=o(581197),n=o(593159),s=o(102088),r=o(540462),a=o(672277),c=o(538522),d=o(908671),l=o(754866),u=o(826619),_=o(8520),h=o(316032),g=o(126415);const v=(e,t,o,n,r,a)=>{if(!window?.cur?.videoRestorationCardTemplate)return null;const d=(0,c.joinRawId)({itemId:e,ownerId:t});let u="";return u=o?(0,s.getLang)("video_clip_deleted"):r?a?(0,s.getLang)("video_video_deleted_from_all_playlists"):(0,s.getLang)("video_video_deleted_from_playlist"):a?(0,s.getLang)("video_video_deleted_from_all"):(0,s.getLang)("video_video_deleted_from_album"),"my_bookmarks"===cur.section_id&&(u=(0,s.getLang)("video_deleted_from_my_watch_later")),"my_liked"===cur.section_id&&(u=(0,s.getLang)("video_deleted_from_my_liked")),(0,i.createElementFromHTML)((0,l.rs)(window.cur.videoRestorationCardTemplate,[d,u]))};function m(e,t=!1){let o=(0,n.trim)(t?cur.videoItemTemplate:cur.videoItemTpl);const i=e[VideoConstants.VIDEO_ITEM_INDEX_LINK],a=i&&i.includes("clip")&&(0,r.partConfigEnabled)("clips_publish_videos_to_clips_web"),c=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&&e[VideoConstants.VIDEO_ITEM_INDEX_VK_LIVE_CHANNEL_URL];cur.shortVideoGridItemTemplate&&a&&(o=cur.shortVideoGridItemTemplate);const h=(e=(0,n.clone)(e))[VideoConstants.VIDEO_ITEM_INDEX_MUSIC_VIDEO_META];if(h){const t=h.subtitle?' <span class="mv_subtitle">'+h.subtitle+"</span>":"",o=(0,r.partConfigEnabled)("cut_release_date_from_music_clips")?(0,u.getFormattedUpdatedTime)(e[VideoConstants.VIDEO_ITEM_INDEX_DATE]):h.release_date;e[VideoConstants.VIDEO_ITEM_INDEX_TITLE]=h.title+t,e[VideoConstants.VIDEO_ITEM_INDEX_OWNER]=h.main+h.featured,e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=o,e[VideoConstants.VIDEO_ITEM_INDEX_DATE]=h.genre}else c?e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=(0,s.getLang)("video_live_N_watching",e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],!0):t&&e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]>999&&!a?e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=(0,u.getFormattedBigViewsToShortCase)(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]):e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]=a?(0,d.formatCount)(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]):(0,s.langNumeric)(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],(0,s.curLang)("video_N_views_list"),!0),e[VideoConstants.VIDEO_ITEM_INDEX_DATE]=(0,u.getFormattedUpdatedTime)(e[VideoConstants.VIDEO_ITEM_INDEX_DATE],t),e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_ACTIVE_LIVE&&(e[VideoConstants.VIDEO_ITEM_INDEX_DURATION]='<span class="video_thumb_label_live_icon"></span>');const v=t&&!!e[VideoConstants.VIDEO_ITEM_INDEX_RECOMMENDATION_USERS];v&&(e[VideoConstants.VIDEO_ITEM_INDEX_RECOMMENDATION_USERS]=(0,_.decodeHTMLEntities)(e[VideoConstants.VIDEO_ITEM_INDEX_RECOMMENDATION_USERS]));const m=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_SCHEDULED,E=e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_UPCOMING_LIVE,p=(0,r.partConfigEnabled)("interactive_video_redesign_badge_vk")&&e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_INTERACTIVE;if(e[VideoConstants.VIDEO_ITEM_INDEX_SUBTITLE_PLACE]=(0,l.rs)(function(e=!1,t=!1,o=!1){return cur?.videoItemSubTitleTemplate?t?cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_SCHEDULED]||"":o?cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_UPCOMING_LIVE]||"":e?cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_LABEL]||"":cur.videoItemSubTitleTemplate?.[VideoConstants.VIDEO_TEMPLATE_INDEX_SUBTITLE_DURATION_WITH_VIEWS]||"":""}(v,m,E),e),e[VideoConstants.VIDEO_ITEM_INDEX_DESCRIPTON]&&(e[VideoConstants.VIDEO_ITEM_INDEX_DESCRIPTON]=(0,l.rs)(cur?.videoItemDescriptionTemplate||"",e)),e[VideoConstants.VIDEO_ITEM_INDEX_AVATAR_IMAGE]){const t=function(e=!1){return cur?.videoItemBaseAvatarTemplate?e?cur.videoItemBaseAvatarTemplate?.[1]||"":cur.videoItemBaseAvatarTemplate?.[0]||"":""}(e[VideoConstants.VIDEO_ITEM_INDEX_FLAGS]&VideoConstants.VIDEO_ITEM_FLAG_NFT_AVATAR);e[VideoConstants.VIDEO_ITEM_INDEX_AVATAR_PLACE]=(0,l.rs)(t,e)}m?(e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]=(0,u.getFormattedPostponePublishDateTime)(e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]),e[VideoConstants.VIDEO_ITEM_INDEX_CARD_PRIVACY_ICONS]="",e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]=(0,l.rs)(cur?.videoItemPostponePublishTemplate||"",e)):e[VideoConstants.VIDEO_ITEM_PUBLISH_DATE]="",a&&(e[VideoConstants.VIDEO_ITEM_INDEX_CARD_ACTIONS]=(0,l.rs)(cur?.shortVideoActionTemplate||"",e)),E?(e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]=(0,u.getFormattedPostponePublishDateTime)(e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]),e[VideoConstants.VIDEO_ITEM_INDEX_CARD_PRIVACY_ICONS]="",e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]=(0,l.rs)(cur?.videoItemUpcomingLiveDateTemplate||"",e)):e[VideoConstants.VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE]="",e[VideoConstants.VIDEO_ITEM_INDEX_LABEL_PLACE]=function(e="",t="",o=!1){const i=e=>{const t=document.createElement("span");return t.className="VideoCard__labelItem",t.innerHTML=e,t},n=document.createElement("div");if(n.className="VideoCard__label",o){n.classList.add("VideoCard__label--interactive"),n.setAttribute("scheme","vkcom_dark");const e=i((0,g.getIcon12HandPointUp)().icon);n.appendChild(e)}t&&n.appendChild(i(t));e&&n.appendChild(i(e));return n.outerHTML}(e[VideoConstants.VIDEO_ITEM_INDEX_DURATION],e[VideoConstants.VIDEO_ITEM_INDEX_PLATFORM],p);const I=Video.prepareVideoItemAttrs(e);let S=(0,l.rs)(o,e);return S=S.replace("%classes%",I[0]).replace("%attrs%",I[1]),S=(0,l.se)(S),S}function E(e,t=!1){const o=(0,n.trim)(t?cur.playlistItemTemplate:cur.albumItemTpl);return(0,l.se)((0,l.rs)(o,e))}function p(e){const t=(0,n.trim)(cur.newPlaylistAsideItemTemplate);return(0,i.createElementFromHTML)((0,l.rs)(t,e))}function I(e){const t=document.createElement("span");t.innerHTML=(0,s.getLang)("video_show_all_short");const o=document.createElement("span");o.className="PlaylistPanel__headerLinkIcon",o.innerHTML=(0,h.getIcon12Chevron)().icon;const i=document.createElement("a");return i.className="PlaylistPanel__headerLink",i.href=e,i.appendChild(t),i.appendChild(o),i}function S(e){const t=(0,_.isDateToday)(new Date(e))?(0,s.getLang)("video_date_today"):langDate(e,"{day} {month}",0,(0,s.getLang)("months_of","raw")),o=(0,l.ce)("div",{className:"VideoGrid__separator",innerHTML:t});return o.setAttribute("data-date",e),o}function T(e){const t=(0,n.trim)(cur.communityItemTemplate);return(0,l.sech)((0,l.rs)(t,e))}let f=0;function w(){clearTimeout(f),f=setTimeout((()=>{let e=null;const t=(0,l.clientHeight)(),o="im"===cur.module?0:(0,a.scrollGetY)();(0,n.each)((0,l.geByClass)("js-video-item-thumb"),((i,n)=>{if(!(0,l.domData)(n,"thumb"))return;const s=(0,l.getXY)(n,"im"===cur.module)[1];if(e=e||(0,l.getSize)(n),s>o-e[1]-800&&s<o+t+800){const e=(0,l.domData)(n,"thumb");(0,l.domData)(n,"thumb",null),"IMG"===n.tagName?n.src=e:(0,l.setStyle)(n,"background-image",`url(${e})`)}}))}),50)}},245778:(e,t,o)=>{o.d(t,{audioTupleToApiAudio:()=>a});var i=o(898848),n=o(915570),s=o(482310),r=o(867366);const a=e=>{if(!e)return null;const[t,o,a,c,d,l,u,,,,,,,_,,h,g,v,m,E,p,I,S,,T,f]=e,{urlHash:w}=(0,n.getAudioHashesFromString)(_),V=(0,s.getAudioExtra)(e),C=e[r.EAudioTupleIndex.LEGAL_NOTICES_TYPE];return{access_key:T||w||"",ads:h,artist:(0,i.unclean)(d||""),id:t,owner_id:o,url:a,title:(0,i.unclean)(c),performer:(0,i.unclean)(d),duration:l,album_id:u,subtitle:(0,i.unclean)(g),main_artists:v||void 0,featured_artists:m||void 0,album:E?{owner_id:E[0],id:E[1],access_key:E[2],title:""}:void 0,track_code:p,content_restricted:I,album_part_number:S,audio_chart_info:f||void 0,dislike:V?.dislike??!1,legal_notices_type:C||void 0}}},915570:(e,t,o)=>{o.d(t,{getAudioHashesFromString:()=>n});var i=o(587952);const n=e=>{if(!e)return{};const[t,o,n,s,r,a,c]=e?.split(i.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR);return{addHash:t,editHash:o,actionHash:n,deleteHash:s,replaceHash:r,urlHash:a,restoreHash:c}}},587258:(e,t,o)=>{o.d(t,{ATTACH_VIEW_EVENTS:()=>i,POSTING_STATS_NAME:()=>n});const i={grid:"grid_mode",carousel:"carousel_mode"},n="posting_web_stats"},33132:(e,t,o)=>{o.d(t,{ErrorEvent:()=>n});var i=o(900181);class n{setMessage(e){this.message=e}setCode(e){this.code=e}getStatValue(){const{message:e,code:t}=this;return{message:e,code:t}}getStatEvent(){const e=this.getStatValue();return e?{type:i.POSTING_TIMELINE_EVENT_TYPES.ERROR,[i.POSTING_TIMELINE_EVENT_TYPES.ERROR]:e}:null}getValue(){const{message:e,code:t}=this;return{message:e,code:t}}}},439667:(e,t,o)=>{o.d(t,{FileUploadingErrorEvent:()=>s});var i=o(55809),n=o(900181);class s{setFileType(e){this.fileType=e}setStartTime(e){this.timeRange.setStartTime(e)}setEndTime(e){this.timeRange.setEndTime(e)}setMessage(e){this.message=e}setCode(e){this.code=e}getStatValue(){const{fileType:e,timeRange:t,message:o,code:i}=this;if(e){const n=t.getStatValue();if(n)return{file_type:e,time_range:n,message:o,code:i}}return null}getStatEvent(){const e=this.getStatValue();return e?{type:n.POSTING_TIMELINE_EVENT_TYPES.FILE_UPLOADING_ERROR,[n.POSTING_TIMELINE_EVENT_TYPES.FILE_UPLOADING_ERROR]:e}:null}getValue(){const{fileType:e,timeRange:t,message:o,code:i}=this;return{fileType:e,timeRange:t,message:o,code:i}}constructor(){this.fileType=null,this.timeRange=new i.TimeRangeValue}}},751281:(e,t,o)=>{o.d(t,{FileUploadingEvent:()=>s});var i=o(55809),n=o(900181);class s{setFileType(e){this.fileType=e}setStartTime(e){this.timeRange.setStartTime(e)}setEndTime(e){this.timeRange.setEndTime(e)}getStatValue(){const{fileType:e,timeRange:t}=this;if(e){const o=t.getStatValue();if(o)return{file_type:e,time_range:o}}return null}getStatEvent(){const e=this.getStatValue();return e?{type:n.POSTING_TIMELINE_EVENT_TYPES.FILE_UPLOADING,[n.POSTING_TIMELINE_EVENT_TYPES.FILE_UPLOADING]:e}:null}getValue(){const{fileType:e,timeRange:t}=this;return{fileType:e,timeRange:t}}constructor(){this.fileType=null,this.timeRange=new i.TimeRangeValue}}},539920:(e,t,o)=>{o.d(t,{PickerAttachmentAttachingEvent:()=>s});var i=o(900181),n=o(55809);class s{setAttachmentType(e){this.attachmentType=e}setStartTime(e){this.timeRange.setStartTime(e)}setEndTime(e){this.timeRange.setEndTime(e)}getStatValue(){const{attachmentType:e,timeRange:t}=this;if(e){const o=t.getStatValue();if(o)return{time_range:o,picker_type:e}}return null}getStatEvent(){const e=this.getStatValue();return e?{type:i.POSTING_TIMELINE_EVENT_TYPES.PICKER_ATTACHMENT_ATTACHING,[i.POSTING_TIMELINE_EVENT_TYPES.PICKER_ATTACHMENT_ATTACHING]:e}:null}getValue(){const{attachmentType:e,timeRange:t}=this;return{attachmentType:e,timeRange:t}}constructor(){this.attachmentType=null,this.timeRange=new n.TimeRangeValue}}},963060:(e,t,o)=>{o.d(t,{PickerOpeningEvent:()=>s});var i=o(55809),n=o(900181);class s{setAttachmentType(e){this.attachmentType=e}setStartTime(e){this.timeRange.setStartTime(e)}setEndTime(e){this.timeRange.setEndTime(e)}getStatValue(){const{attachmentType:e,timeRange:t}=this;if(e){const o=t.getStatValue();if(o)return{time_range:o,picker_type:e}}return null}getStatEvent(){const e=this.getStatValue();return e?{type:n.POSTING_TIMELINE_EVENT_TYPES.PICKER_OPENING,[n.POSTING_TIMELINE_EVENT_TYPES.PICKER_OPENING]:e}:null}getValue(){const{attachmentType:e,timeRange:t}=this;return{attachmentType:e,timeRange:t}}constructor(){this.attachmentType=null,this.timeRange=new i.TimeRangeValue}}},252055:(e,t,o)=>{o.d(t,{PostPublishingErrorEvent:()=>s});var i=o(900181),n=o(55809);class s{setStartTime(e){this.timeRange.setStartTime(e)}setEndTime(e){this.timeRange.setEndTime(e)}setMessage(e){this.message=e}setCode(e){this.code=e}getStatValue(){const{timeRange:e,message:t,code:o}=this,i=e.getStatValue();return i?{time_range:i,message:t,code:o}:null}getStatEvent(){const e=this.getStatValue();return e?{type:i.POSTING_TIMELINE_EVENT_TYPES.POST_PUBLISHING_ERROR,[i.POSTING_TIMELINE_EVENT_TYPES.POST_PUBLISHING_ERROR]:e}:null}getValue(){const{timeRange:e,message:t,code:o}=this;return{timeRange:e,message:t,code:o}}constructor(){this.timeRange=new n.TimeRangeValue}}},335927:(e,t,o)=>{o.d(t,{PostPublishingTimeRangeEvent:()=>s});var i=o(900181),n=o(55809);class s{setStartTime(e){this.value.setStartTime(e)}setEndTime(e){this.value.setEndTime(e)}getStatEvent(){const e=this.value.getStatValue();return e?{type:i.POSTING_TIMELINE_EVENT_TYPES.POST_PUBLISHING_TIME_RANGE,[i.POSTING_TIMELINE_EVENT_TYPES.POST_PUBLISHING_TIME_RANGE]:e}:null}getValue(){return this.value.getValue()}constructor(){this.value=new n.TimeRangeValue}}},55809:(e,t,o)=>{o.d(t,{TimeRangeValue:()=>i});class i{setStartTime(e){null!==this.endTime&&e>this.endTime&&(this.endTime=null),this.startTime=e}setEndTime(e){null!==this.startTime&&this.startTime<=e&&(this.endTime=e)}getStatValue(){return null!==this.startTime&&null!==this.endTime&&this.startTime<=this.endTime?{start_time:this.startTime,end_time:this.endTime}:null}getValue(){const{startTime:e,endTime:t}=this;return{startTime:e,endTime:t}}constructor(){this.startTime=null,this.endTime=null}}},807156:(e,t,o)=>{o.d(t,{ErrorEvent:()=>i.ErrorEvent,FileUploadingErrorEvent:()=>n.FileUploadingErrorEvent,PickerAttachmentAttachingEvent:()=>s.PickerAttachmentAttachingEvent,PostPublishingErrorEvent:()=>r.PostPublishingErrorEvent});var i=o(33132),n=o(439667),s=(o(751281),o(539920)),r=(o(963060),o(252055));o(335927)},36644:(e,t,o)=>{o.d(t,{POSTING_FILE_TYPES:()=>n.POSTING_FILE_TYPES,POSTING_PICKER_TYPES:()=>n.POSTING_PICKER_TYPES,POSTING_TIMELINE_CREATION_ENTRY_POINTS:()=>n.POSTING_TIMELINE_CREATION_ENTRY_POINTS,POSTING_TIMELINE_POST_TYPES:()=>n.POSTING_TIMELINE_POST_TYPES,postingTimelineLogger:()=>s});var i=o(558876),n=o(900181);const s=new i.PostingTimelineLogger},558876:(e,t,o)=>{o.d(t,{PostingTimelineLogger:()=>_});var i=o(305721),n=o(900181),s=o(963060),r=o(751281),a=o(335927),c=o(807156),d=o(428193),l=o(971878),u=o(540462);class _{logStartTimeline(e={}){if(!(0,l.isPostingPerfStatsEnabled)()&&!(0,u.partConfigEnabled)("posting_mvk_perf_stats"))return;if(this.screenStartTime?.time&&(0,d.getCurrentTimeMs)()-this.screenStartTime?.time<=18e7)return;this.resetEventItem();const{isEditing:t,postType:o,creationEntryPoint:i,trackCode:s}=e;this.screenStartTime=(0,d.getCurrentTimeValue)(),this.context={is_editing:t??!1,post_type:o??n.POSTING_TIMELINE_POST_TYPES.REGULAR,creation_entry_point:i??n.POSTING_TIMELINE_CREATION_ENTRY_POINTS.OTHER,track_code:s??""}}logScreenInitialization(){this.screenInitializedTime||(this.screenInitializedTime=(0,d.getCurrentTimeValue)())}logScreenInteractionReady(){this.screenInteractionTime||(this.screenInteractionTime=(0,d.getCurrentTimeValue)())}logScreenClose(){this.finishTimeline(),this.sendCurrentEvent()}logStartSending(){this.currentEvents.postPublishingTimeRange||(this.currentEvents.postPublishingTimeRange=new a.PostPublishingTimeRangeEvent),this.currentEvents.postPublishingTimeRange.setStartTime((0,d.getCurrentTimeMs)())}logSuccessfullySend(){this.currentEvents.postPublishingTimeRange&&(this.currentEvents.postPublishingTimeRange.setEndTime((0,d.getCurrentTimeMs)()),this.events.push(this.currentEvents.postPublishingTimeRange),this.finishTimeline(),this.sendCurrentEvent())}logPostPublishingError({code:e,message:t}){if(!(0,u.partConfigEnabled)("posting_web_perf_stats_post_publishing_enabled"))return;const{postPublishingTimeRange:o}=this.currentEvents;if(!o)return;const i=o.getValue()?.startTime;if(!i)return;const n=new c.PostPublishingErrorEvent;n.setStartTime(i),n.setEndTime((0,d.getCurrentTimeMs)()),n.setCode(e??0),n.setMessage(t??"unknown"),this.events.push(n),delete this.currentEvents.postPublishingTimeRange}finishTimeline(){this.screenCloseTime=(0,d.getCurrentTimeValue)()}logPickerOpening({pickerType:e}){const t=new s.PickerOpeningEvent;t.setStartTime((0,d.getCurrentTimeMs)()),t.setAttachmentType(e),this.currentEvents.pickerOpening=t}logPickerReady(){const{pickerOpening:e}=this.currentEvents;e&&(e.setEndTime((0,d.getCurrentTimeMs)()),this.events.push(e),delete this.currentEvents.pickerOpening)}logStartFileUploading({fileType:e,rawId:t}){this.uploadingFiles[t]||(this.uploadingFiles[t]={startTime:(0,d.getCurrentTimeMs)(),fileType:e})}logFileLoaded({rawId:e}){if(!this.uploadingFiles[e])return;const{startTime:t,fileType:o}=this.uploadingFiles[e],i=new r.FileUploadingEvent;i.setStartTime(t),i.setEndTime((0,d.getCurrentTimeMs)()),i.setFileType(o),delete this.uploadingFiles[e],this.events.push(i)}logFileLoadingError({code:e,message:t,rawId:o}){const i=this.uploadingFiles[o];if(!i)return;const n=i.fileType,s=i.startTime;if(!s||!n)return;const r=new c.FileUploadingErrorEvent;r.setStartTime(s),r.setEndTime((0,d.getCurrentTimeMs)()),r.setFileType(n),e&&r.setCode(e),t&&r.setMessage(t),this.events.push(r),delete this.uploadingFiles[o]}logStartAttaching({pickerType:e}){const t=new c.PickerAttachmentAttachingEvent;t.setStartTime((0,d.getCurrentTimeMs)()),t.setAttachmentType(e),this.currentEvents.pickerAttachmentAttaching=t}logFinishAttaching(){const{pickerAttachmentAttaching:e}=this.currentEvents;e&&(e.setEndTime((0,d.getCurrentTimeMs)()),this.events.push(e),delete this.currentEvents.pickerAttachmentAttaching)}logError({code:e,message:t}){const o=new c.ErrorEvent;e&&o.setCode(e),t&&o.setMessage(t.slice(0,128)),this.events.push(o)}changePostType(e){this.context&&(this.context.post_type=e)}changePostParams(e={}){if(!this.context)return;const{isEditing:t,postType:o,creationEntryPoint:i,trackCode:n}=e,s={};null!=t&&(s.is_editing=t),null!=o&&(s.post_type=o),null!=i&&(s.creation_entry_point=i),null!=n&&(s.track_code=n),this.context={...this.context,...s}}sendCurrentEvent(){const e=this.createStatEventItem();e&&this.postingTimelineCollector.logEvent(e),this.resetEventItem()}createStatEventItem(){const{screenStartTime:e,screenInitializedTime:t,screenInteractionTime:o,screenCloseTime:i,context:n,events:s}=this;if(e&&o&&t&&i&&n){const r=[];s.forEach((e=>{const t=e.getStatEvent();t&&(r.length<50||e instanceof a.PostPublishingTimeRangeEvent)&&r.push(t)}));return{screen_start_time:e,screen_initialized_time:t,screen_interaction_time:o,screen_close_time:i,context:n,events:r}}return null}resetEventItem(){this.screenStartTime=null,this.screenCloseTime=null,this.screenInitializedTime=null,this.screenInteractionTime=null,this.context=null,this.events=[],this.currentEvents={}}constructor(){this.screenStartTime=null,this.screenInteractionTime=null,this.screenInitializedTime=null,this.screenCloseTime=null,this.context=null,this.events=[],this.currentEvents={},this.uploadingFiles={},this.postingTimelineCollector=new i.PostingTimelineCollector}}},900181:(e,t,o)=>{o.d(t,{POSTING_FILE_TYPES:()=>a,POSTING_PICKER_TYPES:()=>r,POSTING_TIMELINE_CREATION_ENTRY_POINTS:()=>n,POSTING_TIMELINE_EVENT_TYPES:()=>s,POSTING_TIMELINE_POST_TYPES:()=>i});const i={REGULAR:"regular",POSTPONED:"postponed",SUGGESTED:"suggested",POST_TEXT_LIVE:"post_text_live",POST_DONUT:"post_donut",EDIT:"edit",COMMENT:"comment",COMMENT_BOARD:"comment_board",COMMENT_MARKET:"comment_market"},n={PROFILE_INPUT:"profile_input",FEED_INPUT:"feed_input",COMMUNITY_INPUT:"community_input",OTHER:"other"},s={FILE_UPLOADING:"file_uploading",FILE_UPLOADING_ERROR:"file_uploading_error",PICKER_OPENING:"picker_opening",PICKER_ATTACHMENT_ATTACHING:"picker_attachment_attaching",POST_PUBLISHING_TIME_RANGE:"post_publishing_time_range",POST_PUBLISHING_ERROR:"post_publishing_error",ERROR:"error"},r={ALBUM:"album",ARTICLE:"article",DOCUMENT:"document",MARKET:"market",MUSIC:"music",PLACE:"place",PHOTO:"photo",PHOTO_VK:"photo_vk",POLL:"poll",SERVICE:"service",TAKE_PHOTO:"take_photo",VIDEO:"video",VIDEO_VK:"video_vk"},a={PHOTO:"photo",VIDEO:"video",DOCUMENT:"document"}},428193:(e,t,o)=>{o.d(t,{getCurrentTimeMs:()=>i,getCurrentTimeValue:()=>n});const i=()=>1e3*Date.now(),n=()=>({time:i()})},971878:(e,t,o)=>{o.d(t,{isPostingPerfStatsEnabled:()=>c,isPostingStatsEnabled:()=>r,sendPostingEvent:()=>a});var i=o(636576),n=o(587258),s=o(540462);const r=()=>(0,s.partConfigEnabled)("posting_web_input_stats"),a=e=>{r()&&(0,i.statlogsValueEvent)(n.POSTING_STATS_NAME,"",e)},c=()=>(0,s.partConfigEnabled)("posting_web_perf_stats")},305721:(e,t,o)=>{o.d(t,{PostingTimelineCollector:()=>s});var i=o(317216),n=o(314309);class s{logEvent(e){const t={...this.productionStatCollector.getBaseEvent(),type:i.ActionProductionStatEventTypes.TYPE_POSTING_TIMELINE,[i.ActionProductionStatEventTypes.TYPE_POSTING_TIMELINE]:e};this.productionStatCollector.logEvent(t)}constructor(){this.productionStatCollector=new n.ProductionStatCollector}}},922105:(e,t,o)=>{o.d(t,{VideoExtraTabsActions:()=>_});var i=o(474848),n=o(296540),s=o(865708),r=o(700272),a=o(507852),c=o(826619),d=o(37710),l=o(713851);const u="default",_=({orderItems:e,commentsTooltipText:t,canSeeComments:o,canSeeOrder:_,onCommentsButtonClick:h,onVideosOrderChange:g})=>{const[v,m]=(0,n.useState)(u),[E,p]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=()=>p(!0),t=()=>p(!1);return window.addEventListener(c.VideoOrderEvents.START_LOADING,e),window.addEventListener(c.VideoOrderEvents.END_LOADING,t),()=>{window.removeEventListener(c.VideoOrderEvents.START_LOADING,e),window.removeEventListener(c.VideoOrderEvents.END_LOADING,t)}}),[]),(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsxs)("div",{className:l.default.actions,children:[o&&(0,i.jsx)(d.VideoActionButton,{tooltipText:t,type:d.VideoActionButtonType.Comments,onClick:h}),_&&(E?(0,i.jsx)(r.Spinner,{size:"regular",className:l.default.spinner}):(0,i.jsx)(a.DropdownActionSheet,{width:200,trigger:"hover",content:(0,i.jsx)(d.VideoOrderPopout,{selected:v,items:e,onChange:e=>{m(e),g(e)}}),children:(0,i.jsx)(d.VideoActionButton,{selected:v!==u,type:d.VideoActionButtonType.Order})}))]})})}},685145:(e,t,o)=>{o.d(t,{VideoActionButton:()=>_,VideoActionButtonType:()=>l});var i=o(474848),n=o(8520),s=o(271036),r=o(578392),a=o(868835),c=o(459218),d=o(970947),l=function(e){return e[e.Comments=0]="Comments",e[e.Order=1]="Order",e}({});const u={0:(0,i.jsx)(a.Icon24CommentOutline,{className:d.default.buttonIcon}),1:(0,i.jsx)(c.Icon24SortOutline,{className:d.default.buttonIcon})},_=({type:e,tooltipText:t,selected:o,getRootRef:a,onClick:c,dataTestId:l})=>{const _=(0,i.jsx)(s.IconButton,{size:36,className:(0,n.classNames)(d.default.button,o&&d.default.buttonSelected),hasHover:!1,hasActive:!1,onClick:c,getRootRef:a,"data-testid":l,children:u[e]});return t?(0,i.jsx)(r.TextTooltip,{text:t,offsetByMainAxis:-3,offsetByCrossAxis:20,appearance:"black",placement:"top-end",children:_}):_}},468816:(e,t,o)=>{o.d(t,{VideoOrderPopout:()=>s});var i=o(474848),n=o(507852);const s=({selected:e,items:t,onChange:o})=>(0,i.jsx)(i.Fragment,{children:t.map((({value:t,label:s})=>{return(0,i.jsx)(n.DropdownActionSheet.Item,{selected:e===t,onClick:()=>o(t),children:(r=s,r.charAt(0).toUpperCase()+r.slice(1))},t);var r}))})},37710:(e,t,o)=>{o.d(t,{VideoActionButton:()=>i.VideoActionButton,VideoActionButtonType:()=>i.VideoActionButtonType,VideoOrderPopout:()=>n.VideoOrderPopout});var i=o(685145),n=o(468816)},205389:(e,t,o)=>{o.d(t,{VideoActionButton:()=>i.VideoActionButton,VideoActionButtonType:()=>i.VideoActionButtonType,initVideoExtraTabsActions:()=>n.initVideoExtraTabsActions,mapRawVideosOrderItemToVideosOrderItem:()=>n.mapRawVideosOrderItemToVideosOrderItem});var i=o(37710),n=o(481279)},481279:(e,t,o)=>{o.d(t,{initVideoExtraTabsActions:()=>a,mapRawVideosOrderItemToVideosOrderItem:()=>c});var i=o(474848),n=o(440961),s=o(342018),r=o(922105);const a=e=>{const t=document.getElementById("VideoExtraTabsActions");t&&(n.render((0,i.jsx)(r.VideoExtraTabsActions,{...e}),t),(0,s.pushNavDestroy)((()=>{t&&n.unmountComponentAtNode(t)})))},c=e=>{const[t,o]=e;return{label:o,value:t}}},3820:(e,t,o)=>{o.d(t,{showWatchLaterSnackbar:()=>c});var i=o(474848),n=o(866467),s=o(432465),r=o(133646),a=o(856289);const c=({isBookmarked:e,rollbackCallback:t})=>{const o=e?{text:`${(0,n.getLang)("video_deleted_from_section")} «${(0,n.getLang)("video_catalog_showcase_section_my_watch_later_title")}»`,before:{content:(0,i.jsx)(r.Icon28ClockOutline,{})},action:{label:(0,n.getLang)("global_cancel"),onClick:(e,o)=>{t&&t(),(0,s.hideSnackbar)(o)}}}:{text:`${(0,n.getLang)("video_added_to_section")} «${(0,n.getLang)("video_catalog_showcase_section_my_watch_later_title")}»`,before:{content:(0,i.jsx)(r.Icon28ClockOutline,{})},action:"my_bookmarks"!==window.cur?.section_id?{label:(0,n.getLang)("global_open_section"),onClick:()=>window.location.href=a.BOOKMARKS_URL}:void 0};(0,s.showSnackbar)(o)}},163068:(e,t,o)=>{o.d(t,{VideoCardLoggerFactory:()=>l});var i=o(314309),n=o(317216),s=o(150585),r=o(740342),a=o(581197),c=o(342018);const d=(e,t)=>{e.track_code&&i.videoViewStatsCollector.logEvent(e,t)},l=function(){class e{saveCardsCollection(){const e=document.querySelectorAll(".VideoCard");e.length!==this.videoCardsCollection.length&&e.forEach(((e,t)=>{const o=this.getTrackCodeFromVideoCardEl(e);if(this.savedTrackCodes.has(o))return;this.savedTrackCodes.add(o);const i=(0,a.isVisibleInViewPort)(e,this.VIDEO_CARD_THRESHOLD);i&&d({type:n.EventItemType.CATALOG_ITEM,track_code:o},t);const s={trackCode:o,el:e,logged:i,position:t};this.videoCardsCollection.push(s)}))}getTrackCodeFromVideoCardEl(e){if(!e)return"";const t=e?.querySelector(".VideoCard__thumbLink");return t?.dataset?.trackCode||""}logVisibleVideoCards(){if(!window.cur?.listNextFrom)return;this.videoCardsCollection.filter((e=>!e.logged)).forEach((e=>{(0,a.isVisibleInViewPort)(e.el,this.VIDEO_CARD_THRESHOLD)&&(e.logged=!0,d({type:n.EventItemType.CATALOG_ITEM,track_code:e.trackCode},e.position))}))}onScroll(){this.logVisibleVideoCards()}onResize(){this.logVisibleVideoCards()}constructor(){this.videoCardsCollection=[],this.savedTrackCodes=new Set,this.DELAY=500,this.VIDEO_CARD_THRESHOLD=.6;const e=(0,s.throttle)(this.onScroll.bind(this),this.DELAY),t=(0,r.debounce)(this.onResize.bind(this),this.DELAY);window.addEventListener("scroll",e),window.addEventListener("resize",t),(0,c.pushNavDestroy)((()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",t)}))}}let t;return{getInstance:()=>(t??(t=new e),t)}}()},975802:(e,t,o)=>{o.d(t,{addVideoToBookmarks:()=>n});var i=o(957994);const n=e=>(0,i.api)("fave.addVideo",e)},532865:(e,t,o)=>{o.d(t,{downloadVideo:()=>s});var i=o(636576),n=o(538522);const s=({oid:e,vid:t,title:o,type:s})=>{const r=Number(e),a=Number(t);window.ajax.post("al_video.php?act=get_download_url",{video_raw_id:(0,n.joinRawId)({ownerId:r,itemId:a})},{onDone:e=>{((e,t,o)=>{if(!e)return!1;const n=document.createElement("a");n.href=e,n.download=`${t}.mp4`,document.body.appendChild(n),n.click(),document.body.removeChild(n),(0,i.statlogsValueEvent)("video_downloads","",o)})(e,o,s)}})}},636826:(e,t,o)=>{o.d(t,{addVideoToBookmarks:()=>i.addVideoToBookmarks,downloadVideo:()=>n.downloadVideo,onAuthorClick:()=>s.onAuthorClick,removeVideoFromAlbum:()=>r.removeVideoFromAlbum,removeVideoFromBookmarks:()=>r.removeVideoFromBookmarks,removeVideoFromLikes:()=>r.removeVideoFromLikes,removeVideoFromMy:()=>r.removeVideoFromMy});var i=o(975802),n=o(532865),s=o(396036),r=o(161629)},396036:(e,t,o)=>{o.d(t,{onAuthorClick:()=>s});var i=o(856289),n=o(540462);const s=e=>{e.stopPropagation(),(0,n.partConfigEnabled)("video_standalone_fix_react_global_nav_handling")&&(0,i.isVideoStandalone)()&&e.target instanceof HTMLAnchorElement&&Boolean(e.target.href)&&(e.preventDefault(),window?.nav?.go(e.target.href))}},161629:(e,t,o)=>{o.d(t,{removeVideoFromAlbum:()=>s,removeVideoFromBookmarks:()=>a,removeVideoFromLikes:()=>r,removeVideoFromMy:()=>n});var i=o(957994);const n=e=>(0,i.api)("video.delete",e),s=e=>(0,i.api)("video.removeFromAlbum",e),r=e=>(0,i.api)("likes.delete",e),a=e=>(0,i.api)("fave.removeVideo",e)},111594:(e,t,o)=>{o.d(t,{createUsersGetFx:()=>n,createUsersSearchFx:()=>s});var i=o(412554);const n=e=>(0,i.createApiEffect)("users.get",e),s=e=>(0,i.createApiEffect)("users.search",e)},669557:(e,t,o)=>{o.d(t,{createEntitiesUsersService:()=>a});var i=o(32489),n=o(310232),s=o(224191),r=o(111594);const a=e=>{const t=(0,r.createUsersGetFx)(e),{domain:o}=e,a=o.createStore({}),c=o.createStore({}),d=o.createStore({}),l=o.createEvent(),u=o.createEvent();return d.on(t,((e,{query:t})=>(0,n.updateEntitiesBy)(e,t.user_ids,!0))),d.on(t.finally,((e,{params:t})=>(0,n.updateEntitiesBy)(e,t.query.user_ids,!1))),c.on(t,((e,{query:t})=>(0,n.updateEntitiesBy)(e,t.user_ids,null))),c.on(t.fail,((e,{error:t,params:o})=>(0,n.updateEntitiesBy)(e,o.query.user_ids,t))),(0,i.sample)({clock:t.done,filter:({result:e})=>Boolean(e),fn:({result:e})=>e,target:l}),(0,i.sample)({clock:l,source:a,fn:(e,t)=>(0,s.mapToEntity)(e,t),target:a}),(0,i.sample)({clock:u,fn:()=>({}),target:a}),{$entitiesUsers:a,$entitiesUsersErrors:c,$entitiesUsersLoading:d,getUsersFx:t,setUsersEvent:l,clearUsersEvent:u}}},224191:(e,t,o)=>{o.d(t,{mapToEntity:()=>i});const i=(e,t,o="id")=>{const i={...e};return t.reduce(((e,t)=>(e["function"==typeof o?o(t):t[o]]=t,e)),i)}},310232:(e,t,o)=>{o.d(t,{updateEntitiesBy:()=>i});const i=(e,t,o)=>{const i=Array.isArray(t)?t:t?.split(",");if(!i?.length)return e;if(void 0!==o){const t=Object.fromEntries(new Map(i.map((e=>[e,o]))));return{...e,...t}}return i.reduce(((e,t)=>(delete e[t],e)),{...e})}},868835:(e,t,o)=>{o.d(t,{Icon24CommentOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon24CommentOutline","comment_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="comment_outline_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path fill="currentColor" fill-rule="nonzero" d="M16.895 4h-9.79c-1.152 0-1.74.113-2.35.44A3.17 3.17 0 0 0 3.44 5.755c-.327.61-.44 1.198-.44 2.35v5.79c0 1.152.113 1.74.44 2.35.302.565.75 1.013 1.315 1.315l.14.071c.517.25 1.05.352 1.954.367L7.1 18v2.215c0 .432.17.846.472 1.155l.116.108a1.65 1.65 0 0 0 2.217-.085L13.366 18h3.53c1.151 0 1.738-.113 2.35-.44a3.17 3.17 0 0 0 1.314-1.315c.327-.61.44-1.198.44-2.35v-5.79c0-1.152-.113-1.74-.44-2.35a3.17 3.17 0 0 0-1.315-1.315c-.61-.327-1.198-.44-2.35-.44M6.912 5.801l9.983-.001c.88 0 1.187.06 1.502.228q.375.2.575.575c.169.315.228.622.228 1.502v5.79l-.004.368c-.017.607-.081.867-.224 1.134q-.2.375-.575.575c-.315.169-.622.228-1.502.228H13l-.117.008a.9.9 0 0 0-.513.25L8.9 19.856V17.1a.9.9 0 0 0-.9-.9h-.895l-.368-.004c-.607-.017-.867-.081-1.134-.224a1.37 1.37 0 0 1-.575-.575c-.169-.315-.228-.622-.228-1.502v-5.79l.004-.368c.017-.607.081-.867.224-1.134q.2-.375.575-.575c.291-.156.574-.218 1.309-.227" /></g></symbol>',24,24,!1,void 0)},818515:(e,t,o)=>{o.d(t,{Icon28ListCheckOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon28ListCheckOutline","list_check_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="list_check_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M26.701 15.287a1 1 0 0 1 .095 1.319l-6.945 7.095a1 1 0 0 1-1.33.086l-4.232-4.272a1 1 0 0 1 1.329-1.49l3.517 3.55 6.152-6.276a1 1 0 0 1 1.414-.012M10 18a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm12-6a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2zm0-6a1 1 0 1 1 0 2H4a1 1 0 0 1 0-2z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},713851:(e,t,o)=>{o.d(t,{default:()=>i});const i={actions:"VideoExtraTabsActions__actions--sjE6a",spinner:"VideoExtraTabsActions__spinner--q3n3I"}},970947:(e,t,o)=>{o.d(t,{default:()=>i});const i={button:"VideoActionButton__button--lGp4H",buttonIcon:"VideoActionButton__buttonIcon--IHqga",buttonSelected:"VideoActionButton__buttonSelected--JTjZE"}}}]);try{stManager?.done("dist/web/chunks/fa526e6a.509399f7.js")}catch(e){}