"use strict";(self.webpackChunkvkwidgets=self.webpackChunkvkwidgets||[]).push([[4038],{506689:(t,e,s)=>{s.d(e,{API_VERSION:()=>r});const r="5.251"},538484:(t,e,s)=>{s.d(e,{browser:()=>i,browserFeatures:()=>c,mobPlatforms:()=>a,redirectToMVK:()=>_});s(126350),s(982499);var r=s(179983),n=s(161933);const o=navigator.userAgent.toLowerCase(),i={version:(o.match(/.+(?:me|ox|on|rv|it|era|opr|ie|edge)[\/: ]([\d.]+)/)||[0,"0"])[1],opera:/opera/i.test(o)||/opr/i.test(o),vivaldi:/vivaldi/i.test(o),amigo:/amigo.*mrchrome soc/i.test(o),msie:/msie/i.test(o)&&!/opera/i.test(o)||/trident\//i.test(o)||/edge/i.test(o),msie6:/msie 6/i.test(o)&&!/opera/i.test(o),msie7:/msie 7/i.test(o)&&!/opera/i.test(o),msie8:/msie 8/i.test(o)&&!/opera/i.test(o),msie9:/msie 9/i.test(o)&&!/opera/i.test(o),msie_edge:/edge/i.test(o)&&!/opera/i.test(o),mozilla:/firefox/i.test(o),yabrowser:/yabrowser/i.test(o),whale:/whale/i.test(o),chrome:/chrome/i.test(o)&&!/edge/i.test(o),safari:!/chrome/i.test(o)&&/webkit|safari|khtml/i.test(o),iphone:/iphone/i.test(o),ipod:/ipod/i.test(o),iphone4:/iphone.*OS 4/i.test(o),ipod4:/ipod.*OS 4/i.test(o),ipad:/ipad/i.test(o),ios:/.+(ipod|ipad|iphone.*os)/i.test(o),android:/android/i.test(o),bada:/bada/i.test(o),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(o),msie_mobile:/iemobile/i.test(o),safari_mobile:/iphone|ipod|ipad/i.test(o),opera_mobile:/opera mini|opera mobi/i.test(o),opera_mini:/opera mini/i.test(o),mac:/mac/i.test(o),windows7:/windows nt 6.1/i.test(o),windowsVista:/windows nt 6.0/i.test(o),windowsXp:/windows nt (5.2|5.1)/i.test(o),search_bot:/(yandex|google|stackrambler|aport|slurp|msnbot|bingbot|twitterbot|ia_archiver|facebookexternalhit)/i.test(o),smart_tv:/smart-tv|smarttv/i.test(o)};const a={1:1,2:1,3:1,4:1,5:1,8:1},c=(window,{wheelEvent:"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":i.mozilla?"MozMousePixelScroll":"DOMMouseScroll",hasBoundingClientRect:"getBoundingClientRect"in document.createElement("div"),cmaEnabled:navigator.credentials&&navigator.credentials.preventSilentAccess&&window.vk&&vk.cma});function _(){const[t,e]=location.href.split("?"),s=new URLSearchParams(e),o={};for(let t of s)o[t[0]]=t[1];if(o){if("1"===o.m)return;if(o.force_redirect_to_mvk){delete o.force_redirect_to_mvk;const e=(0,r.toQueryString)(o);return void(window.location=t.replace(n.VK_ORIGIN_REGEX_STRICT,"https://m."+(0,n.getHostName)())+(e?"?"+e:""))}}if(n.VK_URL_REGEX.test(t)&&!new RegExp("^"+n.VK_HOST_REGEX_UNSAFE.source+"\\/@").test(t)){const e=Object.assign(o,{force_redirect_to_mvk:1}),s=t+"?"+(0,r.toQueryString)(e);window.location=s}}},179983:(t,e,s)=>{s.d(e,{fromQueryString:()=>_,toQueryString:()=>c});let r={};const n=t=>"function"==typeof t,o=t=>Array.isArray(t),i=function(t){if(r[t])return t;try{return encodeURIComponent(t)}catch(t){return""}},a=function(t){try{return decodeURIComponent(t)}catch(e){return r[t]=1,t}};function c(t,e){const s=[];for(const e in t)if(t.hasOwnProperty(e)&&null!=t[e]&&!n(t[e]))if(o(t[e]))for(let r=0,o=0,a=t[e].length;r<a;++r)null==t[e][r]||n(t[e][r])||(s.push(i(e)+"["+o+"]="+i(t[e][r])),++o);else s.push(i(e)+"="+i(t[e]));return e||s.sort(),s.join("&")}function _(t){if(!t)return{};const e={};t=t.split("&");for(let s=0;s<t.length;s++){const r=t[s].split("=");if(r[0]){const t=a(r[1]+"");if("[]"===r[0].substr(r.length-2)){const s=a(r[0].substr(0,r.length-2));e[s]||(e[s]=[]),e[s].push(t)}else e[a(r[0])]=t}}return e}},982499:(t,e,s)=>{s.d(e,{getCookie:()=>a,setCookie:()=>_});var r=s(9467),n=s(419299),o=s(932216),i=s(538484);function a(t){return function(){window._cookies={};const t=document.cookie.split(";"),e=/^[\s]*([^\s]+?)$/i;for(let s=0,r=t.length;s<r;s++){const r=t[s].split("=");2===r.length&&(_cookies[r[0].match(e)[1]]=unescape(r[1].match(e)?r[1].match(e)[1]:""))}}(),"https:"!==location.protocol&&"localhost"!==location.hostname&&(0,n.statlogsValueEvent)("read_unsecure_cookie",t,location.href),_cookies[t]}function c(t,e){const s=(0,r.getCookieGroups)(),n=function(){const t=a("remixcpl");if(!t)return[];const e=t.split(",");return e.forEach(((t,s)=>{e[s]=parseInt(t)})),e}();let i=t,c=null;if(!(0,r.partConfigEnabled)("need_check_allowed_cookie"))return!0;if(!isNaN(parseInt(e))&&parseInt(e)<0)return!0;"remix"===i.substr(0,5)&&(i=i.substr(5)),s.hasOwnProperty(t)?c=parseInt(s[t]):s.hasOwnProperty(i)?c=parseInt(s[i]):"q_"===i.substr(0,2)&&s.hasOwnProperty("q_")&&(c=parseInt(s.q_)),(null===c||isNaN(c))&&(0,o.logError)(`Undefined cookie group for cookie ${t} (${i})`);return 1===c||!(isNaN(c)||!n.includes(c))}function _(t,e,s,n,o="None",a=window.locDomain,_={}){if(!c(t,s))return!1;const d=t+"="+escape(e),u=_.withoutSubdomains?".":"",l="; path=/"+(a?"; domain="+u+a:""),h="https:"===location.protocol;let S=!!n;(0,r.partConfigEnabled)("cookie_secure_default_true")&&(S=!1!==n);const g=h&&S?"; secure":"",p=S&&i.browser.chrome&&parseInt(i.browser.version)>=71&&(0,r.partConfigEnabled)("cookie_class_samesite")?`; SameSite=${o}`:"";let m="";if(s){const t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3),m="; expires="+t.toGMTString()}return document.cookie=d+m+l+p+g,!0}},126350:(t,e,s)=>{function r(t=window.browser){return!(!t.mac||t.iphone||t.ipad||t.ipod||!(navigator.maxTouchPoints>1))}s.d(e,{isIPadOS:()=>r})},801415:(t,e,s)=>{function r(t,e){return new Promise((s=>{setTimeout(s.bind(null,e),1e3*t)}))}function n(t,e,s=null){let n=0;return function o(...i){return Promise.resolve().then((()=>t(...i))).catch((t=>{if(n++,n<=e){const t="function"==typeof s?s(n):0;return 0===t?o(...i):r(t).then((()=>o(...i)))}throw t}))}}function o(t,e,s){let r,n;return function(...o){return new Promise(((t,i)=>{const a=s&&!r;clearTimeout(r),n&&n.reject("debounce"),r=setTimeout((function(){r=null,n=null,s||t(o)}),e),a?t(o):s&&i("debounce"),n={resolve:t,reject:i}})).then((e=>t(...e)))}}function i(t,e){let s,r,n;return function(...o){return new Promise(((t,i)=>{const a=Date.now(),c=()=>{t(o),s=a};!s||s+e<a?c():(n&&(n.reject(),clearTimeout(r)),n={resolve:t,reject:i},r=setTimeout(c,e-(a-s)))})).then((e=>t(...e)))}}function a(t,e){let s;const r=new Promise((r=>{s=r,setTimeout(r.bind(null,e),1e3*t)}));return{pause:()=>r,abort(){s(e)}}}s.d(e,{abortablePause:()=>a,debouncedPromise:()=>o,pause:()=>r,retryFn:()=>n,throttledPromise:()=>i})},419299:(t,e,s)=>{s.d(e,{statlogsValueEvent:()=>p});var r=s(982499),n=s(161933),o=s(126607),i=s(644825),a=s(9467),c=s(853559),_=s(11271);let d,u,l,h;(0,n.isMvk)()?(d="lock_m_stats_cookie_lock",u="remixmstsl",l="lock_m_stats_cookie_locked_stats",h="remixmsts"):(d="lockkk_stats_cookie_lock",h="remixsts",u="remixstsl",l="lock_stats_cookie_locked_stats");const S=[],g={get stats(){return(o.ls.checkVersion()?JSON.parse(o.ls.get(l)):this._stats)||[]},push(t){const e=this.stats;e.push(...t),o.ls.checkVersion()?o.ls.set(l,JSON.stringify(e)):this._stats=e},clear(){o.ls.checkVersion()?o.ls.remove(l):delete this._stats}};function p(t,e,...s){if(void 0===t||void 0===e)return;if(S.forEach((r=>r(t,e,...s))),(0,a.partConfigEnabled)("local_storage_statlogs_value_event")&&![c.ADBLOCK_CONFIG_KEY,_.WASM_SUPPORT_CONFIG_KEY].includes(t))return void(0,i.saveStatlogEvents)({name:t,value:e,keys:s});const n=[Math.round(Date.now()/1e3),t,e].concat(s);E((()=>{if((0,a.partConfigEnabled)("mvk_stats_cookie_soft_clean_up")){if("1"===(0,r.getCookie)(u))return void g.push([n]);(0,r.setCookie)(u,"1")}m(n)}))}function m(t){let e;try{e=JSON.parse((0,r.getCookie)(h)),e=e.data}catch(t){e=[]}if(e=[...e,...g.stats],t&&e.push(t),0===e.length)return;const s=1000000001*Math.random();let n=e.slice(-100);const o=(0,a.getConfigValue)("statlogs_cookie_size_limit")??3500;let i=0,c=0;for(;i<o&&c<e.length;){const t=e[c],s=(_=JSON.stringify(t),encodeURIComponent(_).length);if(s>=o)e.splice(c,1);else{if(i+s>=o)break;i+=s,c++}}var _;n=e.slice(0,c);const d=e.slice(c);g.clear(),d.length>0&&g.push(d),g.clear(),n.length>0&&((0,a.partConfigEnabled)("statlog_host_domain")?((0,a.partConfigEnabled)("statlogs_clear_all_domains_cookie_MVKC-7414")&&(0,r.setCookie)(h,"",-1),(0,r.setCookie)(h,JSON.stringify({data:n,uniqueId:s}),.01,void 0,void 0,window.location.host,{withoutSubdomains:!0})):((0,a.partConfigEnabled)("statlogs_clear_all_domains_cookie_MVKC-7414")&&(0,r.setCookie)(h,"",-1,void 0,void 0,window.location.host,{withoutSubdomains:!0}),(0,r.setCookie)(h,JSON.stringify({data:n,uniqueId:s}),.01)))}function E(t,e){if(o.ls.checkVersion()){if(!0!==o.ls.get(d)){o.ls.set(d,!0);try{t()}catch(t){}return void o.ls.set(d,!1)}e||setTimeout((()=>E(t,!0)),100)}else t()}(0,a.partConfigEnabled)("mvk_stats_cookie_soft_clean_up")&&(window.addEventListener("beforeunload",(()=>{m(null)})),window.ajax&&window.ajax.onResponse((()=>{m(null)})))},9467:(t,e,s)=>{s.d(e,{GROUP_B1:()=>i,GROUP_B2:()=>a,GROUP_C1:()=>c,GROUP_C2:()=>_,calculateTimeOffsets:()=>h,getConfigValue:()=>u,getCookieGroups:()=>l,getTestGroup:()=>d,partConfigEnabled:()=>o,randEnabled:()=>n});var r=s(982499);function n(t){return Math.random()<t}function o(t){const{pe:e={}}=window.vk||{};return!!e[t]}const i=3,a=4,c=5,_=6;function d(t){const{ex:e={}}=window.vk||{};return e[t]||null}function u(t){const{cfg:e={}}=window.vk||{};return e[t]}function l(){const{acl:t={}}=window.vk||{};return t}function h(){const t=window.vk.ts;if(t&&!window.browser.opera_mobile){const e=new Date;let s=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())/1e3-t;s-=10800,s/=60,s=s.toFixed(0),s*=60,s<-55800?s+=86400:s>37800&&(s-=86400);let n=0,o=Math.abs(s);[-12,-11,-10,-9.5,-9,-8,-7,-6,-5,-4.5,-4,-3.5,-3,-2,-1,0,1,2,3,3.5,4,4.5,5,5.5,5.75,6,6.5,7,8,8.75,9,9.5,10,10.5,11,12,12.75,13,14].forEach((t=>{const e=Math.round(3600*(t-3)),r=Math.abs(s-e);r<o&&(o=r,n=e)}));const i=(0,r.getCookie)("remixdt");return void 0!==i&&function(t){if(!0===t)return 1;return parseInt(t)||0}(i)===n||(0,r.setCookie)("remixdt",n,365),n}return 0}},873767:(t,e,s)=>{s.d(e,{api:()=>u,setApiConfig:()=>l});var r=s(713266),n=s(459807),o=s(41775),i=s(70742),a=s(932216),c=s(9327),_=s(9467),d=s(995537);const u=(t,e,s,n={})=>{if(!o.globalState.isApiInited)return Promise.reject(new Error("[VKJS][API]: api didn't init. Use setApiConfig function"));let c=null;(0,_.partConfigEnabled)("send_stack_trace_request_api_error")&&"groups.getById"===t&&(c=new Error("request api error"));const u=()=>((t,e,s,n={})=>{if(!o.globalState.isAuth)return Promise.reject(new Error("[VKJS][API]: missing access_token"));const i=o.globalState.isAuth||(0,_.partConfigEnabled)("loginvk_api_use_anonymous_token")?e:{client_secret:r.clientSecret,...e};return(0,d.api)(t,i,s,n)})(t,e,s,n).then((t=>t),(t=>{throw c&&(t?.error?.error_msg&&(c.message=t.error.error_msg),(0,a.logError)(c,{breadcrumb:{data:t}})),t}));return o.globalState.didFirstLogin?u():(0,i.fetchToken)().then((t=>(o.globalState.didFirstLogin=!0,(0,d.setApiConfig)({accessToken:t.access_token}),u())))},l=t=>{o.globalState.isApiInited?(0,d.setApiConfig)({...t}):((0,d.setApiConfig)({appId:(0,_.partConfigEnabled)("video_client_appid")?r.clientId:n.VK_WEB_APP_ID,version:n.API_VERSION,onTokenExpired:()=>(0,i.fetchToken)(!0).then((({access_token:t})=>t||"")),grouping:c.Ranges.isUserId(window.vk?.id),formattedExecuteResponse:(0,_.partConfigEnabled)("vkid_api_formatted_execute_response"),...t}),o.globalState.isApiInited=!0)}},70742:(t,e,s)=>{s.d(e,{fetchToken:()=>h,login:()=>l,setLoginConfig:()=>u});var r=s(713266),n=s(459807),o=s(41775),i=s(801415),a=s(9467),c=s(161933),_=s(644825),d=s(934928);const u=t=>{o.globalState.isAuthInited||((0,d.setLoginConfig)({appId:n.VK_WEB_APP_ID,...t}),o.globalState.isAuthInited=!0)},l=(t,e,s,r,n={})=>{if(!o.globalState.isAuthInited)return Promise.reject(new Error("[VKJS][LOGIN]: login didn't init. Use setLoginConfig function"));let c;return c=(0,a.partConfigEnabled)("web_api_token_fetch_retry")?(0,i.retryFn)((()=>(0,d.login)(t,e,s,r,n)),2,(t=>[.25,.5][t-1]??.5))():(0,d.login)(t,e,s,r,n),c.then((t=>{if(Boolean(t.access_token)&&(o.globalState.isAuth=!0),window.vk?.id&&!o.globalState.isAuth&&console.error("[VKJS][LOGIN] Token request failed:",t),(0,a.partConfigEnabled)("act_a_check_after_web_token")&&Boolean(t.access_token))try{(0,d.login)("a_check",{access_token:t.access_token})}catch(t){console.error("[VKJS][LOGIN]: a_check act is failed")}return t})).catch((t=>{if(console.error("[VKJS][AUTH]:",t),"unauthorized"===t.error&&"login_error"===t.type){const t=(0,a.partConfigEnabled)("loginvk_unauthorized_force_logout");if(console.error(`[VKJS][AUTH]: logout ${t?"enabled":"disabled"} because `,"loginvk_unauthorized_force_logout = ",t),t)return(0,d.removeLoginCache)(),o.globalState.didFirstLogin=!0,o.globalState.isAuth=!1,(0,_.saveStatlogEvents)({name:"connect_logout_web_link",value:1,keys:[window.location.href]}),window.location.href=window.vk.logoutUrl,new Promise((()=>{}))}return{access_token:"",error:!0,...t}}))},h=(t=!1)=>window.vk?.id<=0&&(0,a.partConfigEnabled)("loginvk_api_use_anonymous_token")?l("get_anonym_token",{client_secret:r.clientSecret,client_id:r.clientId,scopes:"audio_anonymous,video_anonymous,photos_anonymous,profile_anonymous",isApiOauthAnonymEnabled:(0,a.partConfigEnabled)("video_fix_refresh_anonym_token")},{},t):(0,c.isVkVideo)()?(0,c.isMvkVKVideo)()?l("web_token",{},{domain:window.location.hostname,path:"video",appId:r.clientId},t,{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"}}):l("web_token",{},{appId:r.clientId,domain:window.location.hostname,path:"al_video.php"},t):l("web_token",{},{},t)},713266:(t,e,s)=>{s.d(e,{API_VERSION:()=>g,VK_MVK_APP_ID:()=>u,VK_WEB_APP_ID:()=>d,VK_WEB_VKVIDEO_APP_ID:()=>l,clientId:()=>S,clientSecret:()=>h});var r=s(161933),n=s(506689);const o="aR5NKGmm03GYrCiNKsaw",i="QbYic1K3lEV5kTGiqlq2",a="IjjCNl4L4Tf5QZEXIHKK",c="o557NLIkAErNhakXrQ7A",_="WStp4ihWG4l3nmXZgIbC",d=6287487,u=7879029,l=52461373,{clientSecret:h,clientId:S}=(()=>{let t=d,e=i;return(0,r.isMvk)()&&(t=u,e=o),(0,r.isVkMe)()&&(t=51745158,e=a),(0,r.isVkVideo)()&&(t=l,e=c),(0,r.isMvkVKVideo)()&&(t=52649896,e=_),{clientId:t,clientSecret:e}})(),g=n.API_VERSION},41775:(t,e,s)=>{s.d(e,{globalState:()=>r});const r={isApiInited:!1,isAuthInited:!1,didFirstLogin:!1,isAuth:!1}},459807:(t,e,s)=>{s.d(e,{API_VERSION:()=>r.API_VERSION,VK_MVK_APP_ID:()=>r.VK_MVK_APP_ID,VK_WEB_APP_ID:()=>r.VK_WEB_APP_ID,VK_WEB_VKVIDEO_APP_ID:()=>r.VK_WEB_VKVIDEO_APP_ID,clientId:()=>r.clientId,clientSecret:()=>r.clientSecret});s(873767),s(70742);var r=s(713266)},722007:(t,e,s)=>{s.d(e,{api:()=>r,login:()=>n,removeLoginCache:()=>o});const r=(t,e,s,r={})=>window.vkApi?window.vkApi.api(t,e,s,r):Promise.reject(new Error("[VKJS][API]: api didn't allowed. Use makeAuthAndApiGlobal function")),n=(t,e,s,r)=>window.vkApi?window.vkApi.login(t,e,s,r):Promise.reject(new Error("[VKJS]: login didn't allowed. Use makeAuthAndApiGlobal function")),o=(t,e)=>window.vkApi?window.vkApi.removeLoginCache(t,e):console.error("[VKJS]: removeLoginCache didn't allowed. Use makeAuthAndApiGlobal function")},724084:(t,e,s)=>{s.d(e,{getBrowserFingerprint:()=>n});var r=s(982499);function n(){return(0,r.getCookie)("remixgp")}},932216:(t,e,s)=>{s.d(e,{logError:()=>o,logEvalError:()=>a,logUnknownError:()=>i});var r=s(9467),n=s(441878);function o(t,e={}){window?.vk?.static?.init_entries?.includes("sentry.js")||window?.vk?.static?.init_entries?.includes("tracer.js");(0,n.logError)(t,e),(0,r.partConfigEnabled)("webinf_show_error_logs")&&window?.console.error(t)}function i(t){if(t instanceof Error)return void o(t);let e="unknown error";if("string"==typeof t&&(e=t),"object"==typeof t&&null!==t&&"message"in t){const{message:s}=t;"string"==typeof s&&(e=s)}o(new Error(e))}function a(t,e){(0,r.partConfigEnabled)("web_inline_grouping_fix")||(e&&e.length>2e3&&(e=`${e.slice(0,1e3)}...${e.slice(-1e3)}`),t.message+=`: ${e}`),o(t)}},126607:(t,e,s)=>{s.d(e,{ls:()=>c});var r=s(843165);function n(){try{return void 0!==window.localStorage&&null!==window.localStorage&&void 0!==window.JSON}catch(t){return!1}}function o(t,e){if(void 0===t)return!1;a(t);try{return r.vkLocalStorage.setItem(t,JSON.stringify(e))}catch(t){return!1}}function i(t){if(void 0===t)return!1;try{return JSON.parse(r.vkLocalStorage.getItem(t))}catch(t){return!1}}function a(t){try{r.vkLocalStorage.removeItem(t)}catch(t){}}const c={checkVersion:n,remove:a,get:i,set:o},_=t=>void 0!==t?`${t}_@id:${window.vk.id}`:void 0,d=t=>(...e)=>{const[s,...r]=e,n=[_(s),...r];return t(...n)},u={checkVersion:n,remove:d(a),get:t=>{const e=d(i)(t);if(null===e){const e=i(t);if(null!==e)return u.set(t,e),a(t),e}return e},set:d(o)}},161933:(t,e,s)=>{s.d(e,{DOMAIN:()=>r,VK_DOMAIN_REGEX:()=>h,VK_HOST_REGEX_GROUP_UNSAFE:()=>u,VK_HOST_REGEX_UNSAFE:()=>d,VK_ORIGIN_PREFIX_REGEX:()=>g,VK_ORIGIN_REGEX_STRICT:()=>S,VK_POSSIBLE_SITE_HOSTS:()=>o,VK_SITES_REGEX_SOURCE_UNSAFE:()=>_,VK_SITE_REGEX_SOURCE_UNSAFE:()=>c,VK_SITE_RELATIVE_URL:()=>a,VK_URL_REGEX:()=>p,VK_URL_REGEX_STRICT:()=>m,getGlobalObject:()=>w,getHostName:()=>R,isMvk:()=>E,isMvkVKVideo:()=>I,isPWA:()=>O,isVkMe:()=>A,isVkVideo:()=>f});const r="vk.com",n=t=>t.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"),o=["vk.com","vk.ru","vkvideo.ru",R()].filter(((t,e,s)=>s.indexOf(t)===e)),i=o.concat(["vkontakte.ru","vk.me","userapi.com"]),a=["vk.ru",r].includes(R())?"":`https://${r}`,c=n(R()),_=o.map(n).join("|"),d=new RegExp("("+i.map(n).join("|")+")"),u=new RegExp(i.map(n).join("|")),l=(new RegExp("^"+d.source+"$"),new RegExp(`([a-zA-Z0-9\\.\\_\\-]+\\.)?${d.source}`)),h=new RegExp("^"+l.source+"$"),S=(new RegExp(`^(https?:\\/\\/)?${l.source}$`),new RegExp(`^(https?:\\/\\/)${l.source}$`)),g=new RegExp(`^(https?:\\/\\/)${l.source}`),p=new RegExp(`^(https?:\\/\\/)?${l.source}($|\\/(.*))`),m=new RegExp(`^(https?:\\/\\/)${l.source}($|\\/(.*))`);function E(){return!!window.isMVK}function A(){return!!window.vkmeConfig?.anonymBroadcastInitArgs}const f=()=>{const t=w();return Boolean(t.vk?.isVideoStandalone||t.cur?.isVideoStandalone)},I=()=>E()&&f();function O(){return window.vk?.platform?.startsWith?.("pwa")}function R(){return w().vk?.__domain||"vk.com"}function w(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}}},843165:(t,e,s)=>{s.d(e,{bestAvailableStorage:()=>p,getSessionStorage:()=>l,isStorageAvailable:()=>a,vkLocalStorage:()=>d,vkSessionStorage:()=>h});class r{setItem(t,e){this.data[t]=String(e)}removeItem(t){delete this.data[t]}clear(){this.data={}}get length(){return Object.keys(this.data).length}key(t){return Object.keys(this.data)[t]}constructor(){this.data={},this.getItem=t=>this.data.hasOwnProperty(t)?this.data[t]:null,this.keys=()=>Object.keys(this.data)}}const n="vk-ls-dummy",o=Math.random().toString(),i={localStorage:null,sessionStorage:null};function a(t){if(null===i[t])try{const e=window[t];e.setItem(n,o),i[t]=o===e.getItem(n),e.removeItem(n)}catch(e){i[t]=!1}return i[t]}let c;function _(){return c||(c=a("localStorage")?window.localStorage:new r,c)}const d={setItem:(t,e)=>_().setItem(t,e),getItem:t=>_().getItem(t),removeItem:t=>_().removeItem(t),clear:()=>_().clear(),length:()=>_().length,key:t=>_().key(t),keys(){const t=_();return t instanceof r?t.keys():Object.keys(t)},getPrefixedKeys:t=>d.keys().filter((e=>e.startsWith(t)))};let u;function l(){return u||(u=a("sessionStorage")?window.sessionStorage:new r,u)}const h={setItem:(t,e)=>l().setItem(t,e),getItem:t=>l().getItem(t),removeItem:t=>l().removeItem(t),clear:()=>l().clear(),length:()=>l().length,key:t=>l().key(t),keys(){const t=l();return t instanceof r?t.keys():Object.keys(t)},getPrefixedKeys:t=>h.keys().filter((e=>e.startsWith(t)))};let S;function g(){return S||(S=a("localStorage")?window.localStorage:a("sessionStorage")?window.sessionStorage:new r,S)}const p={setItem:(t,e)=>g().setItem(t,e),getItem:t=>g().getItem(t),removeItem:t=>g().removeItem(t),clear:()=>g().clear(),length:()=>g().length,key:t=>g().key(t),keys(){const t=g();return t instanceof r?t.keys():Object.keys(t)},getPrefixedKeys:t=>p.keys().filter((e=>e.startsWith(t)))}},644825:(t,e,s)=>{s.d(e,{saveBenchmarkMainStats:()=>v,saveCustomStats:()=>I,saveNetworkStats:()=>f,saveProductionStats:()=>O,saveStatlogEvents:()=>A,saveStoryViewStats:()=>w,saveWebPerfStats:()=>b,sendWebStats:()=>N,writeAndSendWebStats:()=>R});var r=s(860656),n=s(769685),o=s(142705),i=s(459807),a=s(161933),c=s(9467),_=s(724084),d=s(419299);const u=()=>({get st(){return window.vk.statsMeta.st},get platform(){return window.vk?.statsMeta?.platform?window.vk?.statsMeta?.platform:(0,a.isMvk)()?"mvk":"web2"},get appId(){return(0,c.partConfigEnabled)("video_webstats_appid")?i.clientId:void 0},get time(){return window.vk.statsMeta.time},get hash(){return window.vk.statsMeta.hash},get wsTransport(){return window.vk.wsTransport},get userId(){return window.vk.id},get started(){return window.vk.started},get itemId(){return window.cur?.item_id},get itemOwnerId(){return window.cur?.item_owner_id},get itemType(){return window.cur?.item_type}}),l=()=>({get isDebuggerMode(){return(0,c.partConfigEnabled)("web_stats_transport_debugger")},get isNewQueue(){return(0,c.partConfigEnabled)("webinf_change_queue_analytics")}});function h(t,e){return`${t.wsTransport}/web-stats/${t.st?"s":"p"}${e&&`?${e}`}`}function S(){const t=(0,c.getConfigValue)("akashi_endpoint");return String(t)}const g=(0,r.makeSharedState)("webStats",(()=>new n.WebStats({hostName:(0,a.getHostName)(),options:l(),statlogsValueEvent:d.statlogsValueEvent,getBrowserFingerprint:_.getBrowserFingerprint,statsMeta:u(),smallerChunks:!1,createUrl:h})),{version:1}),p=(0,r.makeSharedState)("akashi",(()=>{const t={hostName:(0,a.getHostName)(),options:l(),localStorage:new o.CustomStorage,sessionStorage:new o.CustomStorage,getBrowserFingerprint:_.getBrowserFingerprint,statsMeta:u(),smallerChunks:!1,createUrl:S};return new n.WebStats(t)}),{version:1}),m=g(),E=p(),A=m.saveStatlogEvents.bind(m),f=m.saveNetworkStats.bind(m),I=m.saveCustomStats.bind(m),O=m.saveProductionStats.bind(m),R=m.writeAndSendWebStats.bind(m),w=(m.saveStoryViewBaseStats.bind(m),m.saveStoryViewStats.bind(m)),b=m.saveWebPerfStats.bind(m),v=m.saveBenchmarkMainStats.bind(m),N=m.sendWebStats.bind(m);E.saveVkResStats.bind(E)},853559:(t,e,s)=>{s.d(e,{ADBLOCK_CONFIG_KEY:()=>r});const r="unique_adblock_users"},11271:(t,e,s)=>{s.d(e,{WASM_SUPPORT_CONFIG_KEY:()=>r});const r="users_wasm_support"},9327:(t,e,s)=>{s.d(e,{Ranges:()=>r.Ranges});s(932216),s(9467);var r=s(415086)},448205:(t,e,s)=>{s.d(e,{API_ERROR_APP_AUTH:()=>a,API_ERROR_AUTH:()=>r,API_ERROR_AUTH_ANONYMOUS_TOKEN_HAS_EXPIRED:()=>_,API_ERROR_CAPTCHA:()=>i,API_ERROR_CUA_2_CONFIRMATION_REQUIRED:()=>d,API_ERROR_FLOOD:()=>o,API_ERROR_RATE_LIMIT:()=>c,API_ERROR_TOO_MANY:()=>n});const r=5,n=6,o=9,i=14,a=28,c=29,_=1114,d=11500},815204:(t,e,s)=>{s.d(e,{PendingTask:()=>r});class r{constructor(){this.get=()=>this.promise,this.resolve=t=>this.resolveHandler(t),this.reject=t=>this.rejectHandler(t),this.promise=new Promise(((t,e)=>{this.resolveHandler=t,this.rejectHandler=e}))}}},946114:(t,e,s)=>{s.d(e,{RequestTask:()=>n});var r=s(960632);class n{setAccessToken(t){this.bodyParams.access_token=t}setGrouping(t){this.grouping=t}setParams(t){this.methodParams=t}canGroupInExecute(){return!this.method.includes("execute")&&(!!this.apiConfig.accessToken&&(!this.methodParams.v&&(!1!==this.grouping&&(void 0===this.fetchOptions.method&&(void 0===this.fetchOptions.headers&&void 0===this.fetchOptions.signal)))))}toString(){const t={};return"object"==typeof this.methodParams&&Object.keys(this.methodParams).forEach((e=>{const s=this.methodParams[e];null!=s&&(t[e]="object"==typeof s?String(s):s)})),`API.${this.method}(${JSON.stringify(t)})`}constructor(t,e,s={},n={},o={}){this.resolve=()=>{},this.reject=()=>{},this.method=t,this.methodParams=e,this.fetchOptions=o,this.overrideApiConfig=n,this.apiConfig=Object.assign({},s,n),this.grouping=this.apiConfig.grouping,this.queryParams=(0,r.getApiQueryParams)(this.apiConfig),this.apiConfig.captureAsyncStacktrace&&(this.asyncBaseError=new Error("Async error"));const i=(0,r.getApiBodyParams)(this.apiConfig);this.bodyParams=Object.assign({},e,i),this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}},49768:(t,e,s)=>{s.d(e,{Retries:()=>n});class r{constructor(t=1/0){this.tries=0,this.increment=()=>{this.tries++},this.get=()=>this.tries,this.isExceeded=()=>this.tries>=this.maxTries,this.maxTries=t}}class n{constructor(){this.retries=new Map,this.get=t=>this.retries.get(t),this.create=(t,e)=>(this.retries.set(t,new r(e)),this.retries.get(t)),this.delete=t=>{this.retries.delete(t)}}}},753667:(t,e,s)=>{s.d(e,{Storage:()=>r});class r{}r.setItemToStorage=(t,e)=>{try{localStorage.setItem(t,e)}catch(t){}},r.getItemFromStorage=t=>{try{return localStorage.getItem(t)}catch(t){}},r.removeItemFromStorage=t=>{try{localStorage.removeItem(t)}catch(t){}}},664224:(t,e,s)=>{s.d(e,{API_VERSION:()=>r});const r="5.131"},995537:(t,e,s)=>{s.d(e,{api:()=>f,apiBeacon:()=>w,setApiConfig:()=>A});var r=s(448205),n=s(815204),o=s(946114),i=s(49768),a=s(424618),c=s(549491),_=s(127814),d=s(386404),u=s(960632);let l={domain:"api.vk.com",maxRetries:10,grouping:!0};const h=new i.Retries,S=new i.Retries;let g=null,p=null,m=null;const E=[];function A(t){t=Object.assign({},l,t),l=t}function f(t,e,s={},r={}){const n=new o.RequestTask(t,e,l,s,r);return n.canGroupInExecute()?(E.push(n),m&&window.clearTimeout(m),m=window.setTimeout((()=>{I(E,s,r,n.apiConfig.enableForks)}),0)):(n.setGrouping(!1),R(n)),n.promise}async function I(t,e,s={},r){if(1===t.length){const e=t.shift();R(e),e.setGrouping(!1)}else{const n=[],i=[],a=[];for(let e=0;e<t.length;e+=1){if(!t[e].canGroupInExecute())continue;const s=t.splice(e,1)[0];if(e-=1,n.push(s),r&&0!==t.length&&(i.push(`'${s.method}': fork(${s})`),a.push(`wait(forks['${s.method}'])`)),n.length>=25)break}let c=`return [${n.join(",")}];`;if(r){const t=n[n.length-1];c=`\n        var forks = { ${i.join(",")} };\n\n        return [${a.join(",")},${t}];\n      `}const _=new o.RequestTask("execute",{code:c},l,e,s);_.setGrouping(!0),R(_);try{const t=await _.promise;let e=0;t.response.forEach(((s,r)=>{!1===s?((0,u.rejectWithApiError)(n[r],{type:d.APIErrorType.API_ERROR,error:t.execute_errors[e]}),e+=1):n[r].resolve(s)}))}catch(t){n.forEach((e=>(0,u.rejectWithApiError)(e,t)))}}t.length>0&&window.setTimeout((()=>I(t,e,s,r)),1e3)}function O(t){try{return window.localStorage?.getItem(t)}catch(t){return null}}async function R(t){const e=t.methodParams.captcha_sid,s=t.methodParams.session;(g&&g.sid!==e||p&&p.session!==s)&&(0,u.rejectWithApiError)(t,{type:d.APIErrorType.API_ERROR,error:{error_code:0,error_msg:"Ddos limit exceeded",error_text:"Ddos limit exceeded"}});const{domain:o,formattedExecuteResponse:i}=t.apiConfig,l=(0,a.makeParams)(t.queryParams),m=`https://${o}/method/${t.method}?${l}`,E=Object.assign({[c.CUA_STATE_PARAM]:(O(c.STORAGE_CUA_STATE)||"").trim()||void 0,[c.CUA_SESSION_PARAM]:s||void 0},t.methodParams,t.bodyParams),f=(0,u.getRequestHash)(m,t.methodParams),I=S.get(f)||S.create(f,t.apiConfig.maxRetries),w=h.get(f)||h.create(f,t.apiConfig.maxRetries);try{await(0,_.waitTimeExp)(I.get()||w.get());const o=await(0,a.corsRequest)(m,E,t.fetchOptions);if(t.apiConfig.challenge?.(o))return void setTimeout((()=>{(0,u.rejectWithApiError)(t,{type:d.APIErrorType.API_ERROR,error:{error_code:0,error_msg:"Unknown",error_text:"Unknown"}})}),1e4);const c=await o.json();if(void 0!==c.response)return S.delete(f),h.delete(f),g&&g.sid===e&&(g.task?.resolve(void 0),g=null,t.apiConfig.onCaptchaSuccess?.()),p&&p.session===s&&(p.task?.resolve(void 0),p=null,t.apiConfig.onCuaSuccess?.()),c.execute_errors?void(i||t.grouping?t.resolve({response:c.response||[],execute_errors:c.execute_errors}):t.resolve({...c.response,execute_errors:c.execute_errors})):void(t.grouping?t.resolve({response:c.response}):t.resolve(c.response));const l=c.error;if(!l)return void(0,u.rejectWithApiError)(t,{type:d.APIErrorType.API_ERROR,error:{error_code:0,error_msg:"Unknown",error_text:"Unknown"}});if(t.apiConfig.onCaptcha&&l?.error_code===r.API_ERROR_CAPTCHA)return void async function(t,e,s){if(!e.apiConfig.onCaptcha)return;const{captcha_sid:r,captcha_img:o,captcha_height:i,captcha_width:a,captcha_attempt:c,captcha_ts:_,is_refresh_enabled:u,is_sound_captcha_available:l,captcha_track:h,is_enabled_vkui:S,uiux_changes:p,redirect_uri:m}=t;if(g){if(g.sid!==s)return await g.task.get(),void await R(e);{const t=new n.PendingTask;t.get().then(g.task.resolve).catch(g.task.reject),g={sid:r,task:t}}}else g={sid:r,task:new n.PendingTask};try{const t=await e.apiConfig.onCaptcha({captcha_sid:r,captcha_img:o,captcha_height:i,captcha_width:a,is_refresh_enabled:u,is_sound_captcha_available:l,captcha_track:h,is_enabled_vkui:S,uiux_changes:p,redirect_uri:m}),s={captcha_ts:_,captcha_attempt:c},n=Object.assign({},e.methodParams,t,s);e.setParams(n),R(e)}catch(t){g=null,e.reject({type:d.APIErrorType.API_ERROR,error:t})}}(l,t,e);if(g&&g.sid===e&&(g.task?.resolve(void 0),g=null,t.apiConfig.onCaptchaSuccess?.()),t.apiConfig.onCua&&l?.error_code===r.API_ERROR_CUA_2_CONFIRMATION_REQUIRED)return void async function(t,e){if(!e.apiConfig.onCua)return;const{cua_session:s}=t;if(p){if(p.session!==s)return await p.task.get(),void await R(e);{const t=new n.PendingTask;t.get().then(p.task.resolve).catch(p.task.reject),p={session:s,task:t}}}else p={session:s,task:new n.PendingTask};try{const t=await e.apiConfig.onCua({cua_session:s}),r=Object.assign({},e.methodParams,t);e.setParams(r),R(e)}catch(t){p=null,e.reject({type:d.APIErrorType.CUA_ERROR,error:t})}}(l,t);if(p&&p.session===e&&(p.task?.resolve(void 0),p=null,t.apiConfig.onCuaSuccess?.()),0===t.apiConfig.maxRetries)return void(0,u.rejectWithApiError)(t,{type:d.APIErrorType.API_ERROR,error:l});if(I.isExceeded()||w.isExceeded())return S.delete(f),h.delete(f),void(0,u.rejectWithApiError)(t,{type:d.APIErrorType.API_ERROR,error:{error_code:l.error_code,error_msg:"Maximum of api retries exceeded",error_text:l.error_text}});if((0,u.isNotAllowedToMakeMoreRequests)(l.error_code))return w.increment(),S.delete(f),void R(t);h.delete(f);const O=!t.overrideApiConfig?.accessToken&&(l.error_code===r.API_ERROR_AUTH||l.error_code===r.API_ERROR_APP_AUTH||l.error_code===r.API_ERROR_AUTH_ANONYMOUS_TOKEN_HAS_EXPIRED);if(t.apiConfig.onTokenExpired&&O){const e=await t.apiConfig.onTokenExpired();return I.increment(),A({accessToken:e}),t.setAccessToken(e),void R(t)}S.delete(f),(0,u.rejectWithApiError)(t,{type:d.APIErrorType.API_ERROR,error:c.error})}catch(s){g&&g.sid===e&&(g=null,t.apiConfig.onCaptchaSuccess?.()),t.reject({type:d.APIErrorType.NETWORK_ERROR,error:s})}}function w(t,e,s){const r=new o.RequestTask(t,e,l,s),{domain:n}=r.apiConfig,i=(0,a.makeParams)(r.queryParams),c=`https://${n}/method/${r.method}?${i}`,_=Object.assign({},r.methodParams,r.bodyParams);return navigator.sendBeacon(c,(0,a.toFormData)(_))}},386404:(t,e,s)=>{s.d(e,{APIErrorType:()=>r});var r=function(t){return t.API_ERROR="api_error",t.NETWORK_ERROR="network_error",t.CUA_ERROR="cua_error",t}({})},960632:(t,e,s)=>{s.d(e,{getApiBodyParams:()=>a,getApiQueryParams:()=>i,getRequestHash:()=>c,isNotAllowedToMakeMoreRequests:()=>_,rejectWithApiError:()=>d});var r=s(448205),n=s(424618),o=s(664224);const i=t=>{const e={v:t.version||o.API_VERSION};return t.appId&&(e.client_id=t.appId),e},a=t=>({access_token:t.accessToken}),c=(t,e={})=>`${t}-${(0,n.makeParams)(Object.assign({},e))}`,_=t=>t===r.API_ERROR_RATE_LIMIT||t===r.API_ERROR_FLOOD||t===r.API_ERROR_TOO_MANY,d=(t,e)=>{if(!t.apiConfig.throwFullErrors)return void t.reject(e);const s=new Error("Api request failed",t.asyncBaseError?{cause:t.asyncBaseError}:void 0);Object.entries(e).forEach((([t,e])=>{s[t]=e})),t.reject(s)}},549491:(t,e,s)=>{s.d(e,{CUA_SESSION_PARAM:()=>o,CUA_STATE_PARAM:()=>n,STORAGE_CUA_STATE:()=>r});const r="cua_state",n="cua_state",o="cua_session"},593069:(t,e,s)=>{s.d(e,{AUTH_VERSION:()=>o,CACHE_KEY_REG_EXP:()=>r,ERROR_TRY_LATER:()=>n});const r=/\d+:[a-zA-Z_]+:login:auth/,n="check result failure",o="1"},934928:(t,e,s)=>{s.d(e,{login:()=>p,removeLoginCache:()=>m,setLoginConfig:()=>l});var r=s(815204),n=s(49768),o=s(753667),i=s(424618),a=s(127814),c=s(593069),_=s(872877);const d=new n.Retries;let u={domain:"login.vk.com",apiDomain:"oauth.vk.com",maxRetries:3};function l(t){t=Object.assign({},u,t),u=t}const h=new Map,S=new Map;let g=!1;function p(t,e,s={},n=!1,l={}){const E=Object.assign({},u,s),A=`${E.appId}:${t}:login:auth`,f=`${A}--request`;let I=h.get(f);if(I)return I.get();const O=d.get(f)||d.create(f,E.maxRetries);return I=new r.PendingTask,h.set(f,I),(async()=>{await(0,_.waitRequestFromOtherTabs)(f),await(0,a.waitTimeExp)(O.get());const r=!S.get(f)||n;let u;E.disableSaveToken||(u=(0,_.loadCache)(A));const R=e&&"isApiOauthAnonymEnabled"in e&&e.isApiOauthAnonymEnabled&&"get_anonym_token"===t;if(R&&u?.access_token&&u?.expires&&(0,_.checkAuthExpires)(Number(u.expires)))return void I.resolve(u);if(!r&&u?.expires&&(0,_.checkAuthExpires)(Number(u.expires)))return o.Storage.removeItemFromStorage(f),h.delete(f),void I.resolve(u);const w={};u?.access_token&&(w.access_token=u.access_token);const{domain:b,apiDomain:v,onCaptcha:N,path:k=""}=E,D=R?`https://${v}/get_anonym_token`:`https://${b}/${k}?act=${t}`,y=(0,_.getLoginParams)(E),P=Object.assign({},e,y,w);m(t,s);try{const r=await(0,i.corsRequest)(D,P,l),n=await r.json();let a=R?(0,_.getApiAnonymLoginResponse)(n):(0,_.getLoginResponse)(n);if("error"in a&&(a=(0,_.getWafCaptchaParams)(a)),"error"===a.type)return h.delete(f),a.error_info===c.ERROR_TRY_LATER?O.isExceeded()?(d.delete(f),I.reject({type:"login_error",error:{error_code:0,error_msg:"Maximum of login retries exceeded"}})):(O.increment(),void(async()=>{try{const r=await p(t,e,s);I.resolve(r)}catch(t){I.reject(t)}})()):(d.delete(f),void I.reject({type:"login_error",error:a.error_info,errorCode:a.error_code??"unknown_error"}));if(d.delete(f),"captcha"===a.type){if(!N)return void I.reject({type:"login_error",error:"captcha"});const{captcha_sid:r,captcha_img:n,captcha_type:o,captcha_height:i,captcha_width:c,captcha_ts:_,captcha_attempt:d,is_refresh_enabled:u,is_sound_captcha_available:l,captcha_track:S,is_enabled_vkui:m,uiux_changes:A,redirect_uri:O}=a;g=!0;try{const a=await N({captcha_sid:r,captcha_img:n,captcha_type:o,captcha_height:i,captcha_width:c,is_refresh_enabled:u,is_sound_captcha_available:l,captcha_track:S,is_enabled_vkui:m,uiux_changes:A,redirect_uri:O}),R={captcha_ts:_,captcha_attempt:d},w=Object.assign({},e,a,R);h.delete(f),(async()=>{try{const e=await p(t,w,s);I.resolve(e)}catch(t){I.reject(t)}finally{g&&(g=!1,E.onCaptchaSuccess?.())}})()}catch{h.delete(f),I.reject({type:"login_error",error:"captcha"})}return}const u=a.data.expires||1/0;E.disableSaveToken||o.Storage.setItemToStorage(A,JSON.stringify({...a.data,expires:u})),o.Storage.removeItemFromStorage(f),S.set(f,!0),h.delete(f),I.resolve(a.data)}catch(t){d.delete(f),h.delete(f),I.reject({type:"network_error",error:t})}})(),I.get()}function m(t,e){if(!t)return void Object.keys(localStorage).forEach((t=>{c.CACHE_KEY_REG_EXP.test(t)&&o.Storage.removeItemFromStorage(t)}));let s=u;e&&(s=Object.assign({},u,e));const r=`${s.appId}:${t}:login:auth`;o.Storage.removeItemFromStorage(r)}},872877:(t,e,s)=>{s.d(e,{checkAuthExpires:()=>l,getApiAnonymLoginResponse:()=>c,getLoginParams:()=>a,getLoginResponse:()=>_,getWafCaptchaParams:()=>h,loadCache:()=>u,waitRequestFromOtherTabs:()=>d});var r=s(448205),n=s(753667),o=s(127814),i=s(593069);const a=t=>({version:t.version||i.AUTH_VERSION,app_id:t.appId}),c=t=>"error"in t?{type:"error",error_code:t.error,error_info:t.error_description}:{type:"okay",data:{access_token:t.token,expires:t.expired_at}},_=t=>{if(!Array.isArray(t))return t;const[e]=t;return{type:"okay",data:e}},d=t=>new Promise((e=>{null===n.Storage.getItemFromStorage(t)?(n.Storage.setItemToStorage(t,"1"),e()):setTimeout(e,(0,o.getRandomWaitTime)())})),u=t=>{let e=n.Storage.getItemFromStorage(t),s={};if(e)try{s=JSON.parse(e)}catch(t){}return s},l=t=>1e3*t-Date.now()>=o.ONE_MINUTE_MS,h=t=>{let e;const{error_code:s,error_msg:n}=t.error;switch(s){case r.API_ERROR_CAPTCHA:const{captcha_sid:o,captcha_img:a,captcha_width:c,captcha_height:_,captcha_attempt:d,captcha_ts:u,is_refresh_enabled:l,is_sound_captcha_available:h,captcha_track:S,is_enabled_vkui:g,uiux_changes:p,redirect_uri:m}=t.error;e={type:"captcha",captcha_type:"regular",captcha_sid:o,captcha_img:a,captcha_track:S,captcha_height:_,captcha_width:c,captcha_attempt:d,captcha_ts:u,is_refresh_enabled:l,is_sound_captcha_available:h,is_enabled_vkui:g,uiux_changes:p,redirect_uri:m};break;case r.API_ERROR_TOO_MANY:e={type:"error",error_info:i.ERROR_TRY_LATER,error_code:String(s)};break;default:e={type:"error",error_info:n,error_code:String(s)}}return e}},424618:(t,e,s)=>{s.d(e,{corsRequest:()=>a,makeParams:()=>o,toFormData:()=>i});var r=s(549491);const n=[r.CUA_STATE_PARAM,r.CUA_SESSION_PARAM];function o(t){return Object.keys(t).map((e=>{let s=t[e];return e=encodeURIComponent(e||""),s=encodeURIComponent(void 0===s?"":s),n.includes(e)&&!s?null:`${e}=${s}`})).filter(Boolean).join("&")}function i(t){const e=new FormData;for(const s in t)t.hasOwnProperty(s)&&("string"==typeof t[s]?e.append(s,t[s]):e.append(s,JSON.stringify(t[s])));return e}function a(t,e,s={}){const r=o(e);return fetch(t,{method:"POST",body:r,mode:"cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},...s})}},127814:(t,e,s)=>{s.d(e,{ONE_MINUTE_MS:()=>r,getRandomWaitTime:()=>n,waitTimeExp:()=>o});const r=6e4,n=(t=500,e=1500)=>window.FORCED_API_WAIT_TIME?window.FORCED_API_WAIT_TIME:~~(Math.random()*(e-t+1)+t),o=t=>{return 0===t?Promise.resolve():(e=(t=>{if(0===t)return 0;if(window.FORCED_API_WAIT_TIME)return window.FORCED_API_WAIT_TIME;const e=Math.random(),s=100*Math.pow(2,t)/2;return s+s*e})(t),new Promise((t=>{setTimeout((()=>t()),e)})));var e}},441878:(t,e,s)=>{s.d(e,{logError:()=>i});var r=s(274328),n=(s(296146),s(399373));function o(t){let e="";return t.timestamp&&(e+=`<${t.timestamp}> `),t.level&&(e+=`[${t.level}] `),e+=[t.type,t.category].join(".")+" ",t.message&&(e+=t.message+" "),t.data&&(e+="\n"+JSON.stringify(t.data)+"\n"),e}function i(t,{breadcrumb:e,environment:s,hasDummyStacktrace:i}={}){i&&t.stack&&delete t.stack,function(t,{breadcrumb:e,environment:s}){const n=(0,r.getClient)();if(n)n.captureException(t,{captureContext:t=>(s&&t.setTags({module:s}),e&&t.addBreadcrumb({message:e.message,category:"custom",data:e.data}),t)})}(t,{breadcrumb:e,environment:s}),function(t,{breadcrumb:e,environment:s}={}){const{log:r,error:i}=(0,n.getTracerModules)();if(!i)return;let a;if(e&&r&&r.log(o(e)),"string"==typeof t)a=new Error(t);else if(t instanceof Error)a=t;else if("object"==typeof t)try{a=new Error(JSON.stringify(t))}catch(t){a=new Error("Unserializable error",{cause:t})}else a=new Error(t?"Unserializable error":"Empty error");i?.error(a,{issueKey:s})}(t,{breadcrumb:e,environment:s})}},860656:(t,e,s)=>{s.d(e,{makeSharedState:()=>a});const r="__SHARED_STATE_KEY";(()=>{const t=self.hasOwnProperty(r)?self[r]:Object.create(null);Object.defineProperty(self,r,{configurable:!0,value:t})})();const n=()=>self[r],o=t=>n()[t],i=(t,e)=>{n()[t]=e};function a(t,e,s){const r=function(t,e){let s=t.replace(/[^a-zA-Z0-9-]/gi,"_").toLowerCase();0!==e&&(s+=`__${e}`);return s}(t,s.version);return r in n()||i(r,e()),()=>o(r)}},415086:(t,e,s)=>{s.d(e,{Ranges:()=>n});var r=s(705671);const n=Object.freeze({getAutotestGroupIdRand(){return a(r.RANGES_IDS.AUTOTEST_GROUP_ID_MIN,r.RANGES_IDS.AUTOTEST_GROUP_ID_MAX)},isAutotestGroup(t){return t>=r.RANGES_IDS.AUTOTEST_GROUP_ID_MIN&&t<=r.RANGES_IDS.AUTOTEST_GROUP_ID_MAX},isGroupId(t){return t<=r.RANGES_IDS.GROUPS_UPPER_BOUND&&t>r.RANGES_IDS.GROUPS_LOWER_BOUND},isUserId(t){return t>=r.RANGES_IDS.USERS_LOWER_BOUND&&t<r.RANGES_IDS.USERS_UPPER_BOUND||t>=r.RANGES_IDS.USERS_LOWER_BOUND_LONG&&t<r.RANGES_IDS.USERS_UPPER_BOUND_LONG},isUserIdTransitional(t){n.isUserId(t);const e=o(t,0,r.RANGES_IDS.CONTACTS_UPPER_BOUND);return e},isRealOwner(t){return n.isGroupId(t)||n.isUserId(t)},isAudioOwner(t){return n.isRealOwner(t)||n.isUMA(t)||n.isFakeWallAudioOwner(t)},isPlaylistOwner(t){return n.isRealOwner(t)||n.isUMA(t)||n.isChatOrChannelPeer(t)},isOfficialPlaylist(t){return n.isUMAReleaseOwner(t)||n.isUMAAlbumOwner(t)},isFakeWallAudioOwner(t){return i(t,r.RANGES_IDS.AUDIO_FAKE_WALL_OWNER_MIN,r.RANGES_IDS.AUDIO_FAKE_WALL_OWNER_MAX)},isUMA(t){return n.isUMAReleaseOwner(t)||n.isUMAAlbumOwner(t)},isUMAAlbumOwner(t){return i(t,r.RANGES_IDS.AUDIO_FAKE_UMA_ALBUM_OWNER_MIN,r.RANGES_IDS.AUDIO_FAKE_UMA_ALBUM_OWNER_MAX)},getUMAAlbumOwnerByShift(t){return r.RANGES_IDS.AUDIO_FAKE_UMA_ALBUM_OWNER_MAX-Math.abs(t%r.RANGES_IDS.AUDIO_FAKE_UMA_OWNERS_COUNT)},isUMAReleaseOwner(t){return i(t,r.RANGES_IDS.AUDIO_FAKE_UMA_RELEASE_OWNER_MIN,r.RANGES_IDS.AUDIO_FAKE_UMA_RELEASE_OWNER_MAX)},getUMAReleaseOwnerByShift(t){return r.RANGES_IDS.AUDIO_FAKE_UMA_RELEASE_OWNER_MAX-Math.abs(t%r.RANGES_IDS.AUDIO_FAKE_UMA_OWNERS_COUNT)},isEmailId(t){return t<r.RANGES_IDS.EMAIL_UPPER_BOUND},isOwnerId(t){return t>=r.RANGES_IDS.USERS_LOWER_BOUND?n.isUserId(t):n.isGroupId(t)},isContactId(t){return t>=r.RANGES_IDS.CONTACTS_LOWER_BOUND&&t<r.RANGES_IDS.CONTACTS_UPPER_BOUND},convertContactIdToPeerId(t){return t+r.RANGES_IDS.USERS_UPPER_BOUND},convertPeerIdToContactId(t){return t-r.RANGES_IDS.USERS_UPPER_BOUND},isChatOrChannelPeer(t){return t>=r.RANGES_IDS.CHAT_OR_CHANNEL_LOWER_BOUND&&t<=r.RANGES_IDS.CHAT_OR_CHANNEL_UPPER_BOUND},isChatId(t){return t>r.RANGES_IDS.MIN_CHAT_ID&&t<=r.RANGES_IDS.MAX_CHAT_ID},convertChatPeerIdToChatId(t){return t-r.RANGES_IDS.CONTACTS_UPPER_BOUND},convertChatIdToChatPeerId(t){return t+r.RANGES_IDS.CONTACTS_UPPER_BOUND},isAppDomain(t){return t>=r.RANGES_IDS.APP_LOWER_BOUND&&t<r.RANGES_IDS.APP_UPPER_BOUND},convertPeerIdToAppId(t){return-t+r.RANGES_IDS.APP_UPPER_BOUND},convertAppIdToPeerId(t){return r.RANGES_IDS.APP_UPPER_BOUND-t},isUnauthLongId(t){return i(t,r.RANGES_IDS.UNAUTH_LONG_ID_MIN,r.RANGES_IDS.UNAUTH_LONG_ID_MAX)},isUnauthLongIdOld(t){return i(t,r.RANGES_IDS.UNAUTH_LONG_ID_MIN_OLD,r.RANGES_IDS.UNAUTH_LONG_ID_MAX_OLD)},isMarusyaUploadOwner(t){return r.RANGES_IDS.MARUSYA_UPLOAD_OWNER_MIN<=t&&t<=r.RANGES_IDS.MARUSYA_UPLOAD_OWNER_MAX},getRandomMarusyaUploadOwnerId(){return a(r.RANGES_IDS.MARUSYA_UPLOAD_OWNER_MIN,r.RANGES_IDS.MARUSYA_UPLOAD_OWNER_MAX)},isFakeDocOwner(t){return i(t,r.RANGES_IDS.FAKE_DOC_OWNER_MIN,r.RANGES_IDS.FAKE_DOC_OWNER_MAX)},getFirstFakeOwnerId(){return r.RANGES_IDS.FAKE_DOC_OWNER_MIN},getRandomFirstFakeOwnerId(){return a(r.RANGES_IDS.FAKE_DOC_OWNER_MIN,r.RANGES_IDS.FAKE_DOC_OWNER_MIN+64e3)},getRandomFakeOwnerId(){return r.RANGES_IDS.FAKE_DOC_OWNER_MIN+(Math.floor(Date.now()/1e3)/173+a(0,999))%64e3},isAdsVideoOwner(t){return i(t,r.RANGES_IDS.ADS_VIDEO_OWNER_MIN,r.RANGES_IDS.ADS_VIDEO_OWNER_MAX)},getRandomAdsVideoOwner(){return a(r.RANGES_IDS.ADS_VIDEO_OWNER_MIN,r.RANGES_IDS.ADS_VIDEO_OWNER_MAX)},isAdsPhotoOwner(t){return i(t,r.RANGES_IDS.ADS_PHOTO_OWNER_MIN,r.RANGES_IDS.ADS_PHOTO_OWNER_MAX)},getRandomAdsPhotoOwner(){return a(r.RANGES_IDS.ADS_PHOTO_OWNER_MIN,r.RANGES_IDS.ADS_PHOTO_OWNER_MAX)},isZeroOwner(t){return 0===t},convertEmailIdToEmailPeerId(t){return n.isEmailId(t)?-t+r.RANGES_IDS.EMAIL_UPPER_BOUND:0},isZeroOwnerDeprecated(t){return!!t||n.isZeroOwner(t)},isExternalUser(t){return o(t,r.RANGES_IDS.EMAIL_UPPER_BOUND,r.RANGES_IDS.EXTERNAL_USER_ID_OFFSET)},isExternalUserDeprecated(t){n.isExternalUser(t);const e=o(t,r.RANGES_IDS.EMAIL_UPPER_BOUND,r.RANGES_IDS.APP_DOMAIN_ID_OFFSET);return e},isAnonymousCallPeerId(t){return t>=r.RANGES_IDS.CALLS_PEER_LOWER_BOUND&&t<r.RANGES_IDS.CALLS_PEER_UPPER_BOUND},isAnonymousUserPeerId(t){return t>=r.RANGES_IDS.ANONYMOUS_USER_PEER_ID_LOWER_BOUND&&t<r.RANGES_IDS.ANONYMOUS_USER_PEER_ID_UPPER_BOUND},getAnonymousCallUserByShift(t){const e=r.RANGES_IDS.CALLS_PEER_UPPER_BOUND-r.RANGES_IDS.CALLS_PEER_LOWER_BOUND,s=(t%e+e)%e;return r.RANGES_IDS.CALLS_PEER_UPPER_BOUND-1-s},isValidAliExpressOrderUserId(t){return!(t<r.RANGES_IDS.ALIEXPRESS_USER_ID_RANGE_START)&&!(t>r.RANGES_IDS.ALIEXPRESS_USER_ID_RANGE_START+r.RANGES_IDS.ALIEXPRESS_USER_ID_RANGE_LENGTH)},generateAliexpressOrderUserId(){return a(r.RANGES_IDS.ALIEXPRESS_USER_ID_RANGE_START,r.RANGES_IDS.ALIEXPRESS_USER_ID_RANGE_LENGTH)},isADBot(t){return t>=r.RANGES_IDS.AD_BOT_ID_RANGE_START&&t<=r.RANGES_IDS.AD_BOT_ID_RANGE_END},getMarusiaAudioFakeId(t){const e=r.RANGES_IDS.MARUSIA_AUDIO_FAKE_ID_MAX-r.RANGES_IDS.MARUSIA_AUDIO_FAKE_ID_MIN;return r.RANGES_IDS.MARUSIA_AUDIO_FAKE_ID_MIN+t%e},isMarusiaAudioFakeId(t){return t>=r.RANGES_IDS.MARUSIA_AUDIO_FAKE_ID_MIN&&t<r.RANGES_IDS.MARUSIA_AUDIO_FAKE_ID_MAX},isOwnerIdTransitional(t){return t>r.RANGES_IDS.USERS_LOWER_BOUND?n.isUserIdTransitional(t):n.isGroupId(t)},convertGroupIdToOwnerId(t){return-t},convertGroupIdToOwnerIdStrict(t){return-Math.abs(t)},convertOwnerIdToGroupId(t){return Math.abs(t)}});function o(t,e,s){return e<t&&t<s}function i(t,e,s){return e<=t&&t<=s}function a(t,e){return t+Math.floor(Math.random()*(e-t))}},705671:(t,e,s)=>{s.d(e,{RANGES_IDS:()=>a});const r=1e8,n=5e16,o=2**56-1,i=2000000001,a=Object.freeze({MIN_CHAT_ID:0,MAX_CHAT_ID:r,UNAUTH_LONG_ID_SUBRANGE_WITH_DEVICE_ID_SIZE:n,UNAUTH_LONG_ID_SUBRANGE_WITHOUT_DEVICE_ID_SIZE:o,UNAUTH_LONG_ID_MIN:9e18,UNAUTH_LONG_ID_MAX:0x7e980f0d11490000,MARUSYA_UPLOAD_OWNER_MIN:593139650,MARUSYA_UPLOAD_OWNER_MAX:593139654,UNAUTH_LONG_ID_MIN_OLD:10000000001,UNAUTH_LONG_ID_MAX_OLD:11e10,FAKE_DOC_OWNER_MIN:2e9,FAKE_DOC_OWNER_MAX:2000063999,ADS_VIDEO_OWNER_MIN:16e6,ADS_VIDEO_OWNER_MAX:16000599,ADS_PHOTO_OWNER_MIN:1698e4,ADS_PHOTO_OWNER_MAX:16999999,AUDIO_FAKE_UMA_RELEASE_OWNER_MIN:-2002e6,AUDIO_FAKE_UMA_RELEASE_OWNER_MAX:-2001e6,AUDIO_FAKE_UMA_ALBUM_OWNER_MIN:-2000999999,AUDIO_FAKE_UMA_ALBUM_OWNER_MAX:-2e9,AUDIO_FAKE_UMA_OWNERS_COUNT:1e6,AUDIO_FAKE_WALL_OWNER_MIN:2e9,AUDIO_FAKE_WALL_OWNER_MAX:2000512e3,USERS_LOWER_BOUND:1,USERS_UPPER_BOUND:19e8,USERS_LOWER_BOUND_LONG:2e11,USERS_UPPER_BOUND_LONG:1e12,EMAIL_UPPER_BOUND:-2e9,CONTACTS_LOWER_BOUND:1900000001,CONTACTS_UPPER_BOUND:2e9,CALLS_PEER_LOWER_BOUND:-1899999999,CALLS_PEER_UPPER_BOUND:-189e7,ANONYMOUS_USER_PEER_ID_LOWER_BOUND:10000000001,ANONYMOUS_USER_PEER_ID_UPPER_BOUND:11e10,CHAT_OR_CHANNEL_LOWER_BOUND:i,CHAT_OR_CHANNEL_UPPER_BOUND:21e8,GROUPS_LOWER_BOUND:-1e9,GROUPS_UPPER_BOUND:-1,APP_LOWER_BOUND:-1999999999,APP_UPPER_BOUND:-1e9,ALIEXPRESS_USER_ID_RANGE_START:2e9,ALIEXPRESS_USER_ID_RANGE_LENGTH:150,AD_BOT_ID_RANGE_START:2e9,AD_BOT_ID_RANGE_END:2000064e3,MARUSIA_AUDIO_FAKE_ID_MIN:2000512001,MARUSIA_AUDIO_FAKE_ID_MAX:2000512051,AUTOTEST_GROUP_ID_MIN:216720807,AUTOTEST_GROUP_ID_MAX:216820807,EXTERNAL_USER_ID_OFFSET:-19e8,APP_DOMAIN_ID_OFFSET:-1e9})},769685:(t,e,s)=>{s.d(e,{WebStats:()=>_});var r=s(402815),n=s(972611),o=s(407674),i=s(966358),a=s(879639),c=s(310808);class _{sendWebStats(t,e){return this.api.sendWebStats(t,e)}writeAndSendWebStats(t,e,s,r){return this.api.writeAndSendWebStats(t,e,s,r)}saveStatlogEvents(t){return this.api.saveStatlogEvents(t)}saveProductionStats(t,e){return this.api.saveProductionStats(t,e)}saveNetworkStats(t){return this.api.saveNetworkStats(t)}saveStoryViewBaseStats(t){return this.api.saveStoryViewBaseStats(t)}saveStoryViewStats(t){return this.api.saveStoryViewStats(t)}saveWebPerfStats(t){return this.api.saveWebPerfStats(t)}saveBenchmarkMainStats(t){return this.api.saveBenchmarkMainStats(t)}saveVkResStats(t){return this.api.saveVkResStats(t)}constructor({options:t,statsMeta:e,hostName:s,statlogsValueEvent:_,getBrowserFingerprint:d,sessionStorage:u,localStorage:l,smallerChunks:h,apiParams:S,createUrl:g}){this.saveCustomStats=t=>this.api.saveCustomStats(t),this.debug=new n.Debug({options:t}),this.webStatsStorage=new o.WebStatsStorage({statsMeta:e,debug:this.debug,sessionStorage:u,localStorage:l}),this.maxBodyChunkSize=h?r.MAX_BODY_SIZE_SMALL_CHUNK:r.MAX_BODY_SIZE_NORMAL_CHUNK,this.batchers=new i.Batchers({statsMeta:e,statlogsValueEvent:_,webStatsStorage:this.webStatsStorage,maxBodyChunkSize:this.maxBodyChunkSize}),this.batchedWebStatsTransport=new a.BatchedWebStatsTransport({options:t,statsMeta:e,hostName:s,debug:this.debug,statlogsValueEvent:_,getBrowserFingerprint:d,batchers:this.batchers,webStatsStorage:this.webStatsStorage,maxBodyChunkSize:this.maxBodyChunkSize,apiParams:S,createUrl:g}),this.api=new c.Api({webStatsStorage:this.webStatsStorage,debug:this.debug,webStatsBatchedTransport:this.batchedWebStatsTransport,options:t,localStorage:l})}}},402815:(t,e,s)=>{s.d(e,{AVAILABLE_STATS:()=>S,BOOST_COOLDOWN_MS:()=>c,BOOST_DEBOUNCE_LIMIT_MS:()=>a,BOOST_DEBOUNCE_MS:()=>i,BOOST_DURATION:()=>d,COOLDOWN_MS:()=>o,DEBOUNCE_LIMIT_MS:()=>n,DEBOUNCE_MS:()=>r,MAX_BODY_SIZE_NORMAL_CHUNK:()=>l,MAX_BODY_SIZE_SMALL_CHUNK:()=>u,PROCESSING_LIMIT:()=>_,Stats:()=>h});const r=1e4,n=2e4,o=2e4,i=1e3,a=2e3,c=5e3,_=500,d=3e4,u=.5*Math.pow(10,6),l=1.8*Math.pow(10,6),h={BenchmarkMainStats:"benchmarkMainStats",CustomStats:"customStats",NetworkStats:"networkStats",ProductionStats:"productionStats",StatlogEvents:"statlogEvents",StoryViewStats:"storyViewStats",WebPerfStats:"webPerfStats",VkResStats:"vkResStats"},S=[h.BenchmarkMainStats,h.CustomStats,h.NetworkStats,h.ProductionStats,h.StatlogEvents,h.StoryViewStats,h.WebPerfStats,h.VkResStats]},310808:(t,e,s)=>{s.d(e,{Api:()=>i});var r=s(142705),n=s(668813),o=s(402815);class i{pushToWebStats(t,e){const s=this.webStatsStorage.getWebStatsStringValue(t);return this.webStatsStorage.getWebStatDataLs().replace(`"${t}":${s}`,`"${t}":${s.replace(/]$/,`${"[]"===s?"":","}${JSON.stringify(e)}]`)}`)}transformStatlogEvent({name:t,value:e,keys:s=[]}){const r=[Math.round(Number(Date.now())/1e3),t,e,...s];return this.options?.isDebuggerMode&&console.log("Data was transformed!"),r}sendWebStats(t,e){t===o.Stats.StatlogEvents&&(e=this.transformStatlogEvent(e));const s=(0,n.getEmptyStatsData)();s[t]=[e];const r=JSON.stringify(s);return new Promise(((t,s)=>{this.webStatsBatchedTransport.sendStat(r,(()=>t()),s),this.debug.logWebStatsEvent("sendWebStatsEvent",e)}))}writeAndSendWebStats(t,e,s,r){const n=this.pushToWebStats(e,s);this.webStatsStorage.writeLocked((()=>{this.localStorage.setItem(this.webStatsStorage.lsDataKey,n),this.webStatsBatchedTransport.saveAndSendStats(n,r)})),this.debug.logWebStatsEvent(t,s)}saveStatlogEvents(t){const e=this.transformStatlogEvent(t);return this.writeAndSendWebStats("saveStatlogEvents",o.Stats.StatlogEvents,e)}saveNetworkStats(t){return this.writeAndSendWebStats("saveNetworkStats",o.Stats.NetworkStats,t)}saveStoryViewBaseStats(t){return this.writeAndSendWebStats("saveStoryViewStats",o.Stats.StoryViewStats,t)}saveStoryViewStats(t){return this.saveStoryViewBaseStats(t)}saveWebPerfStats(t){return this.writeAndSendWebStats("saveWebPerfStats",o.Stats.WebPerfStats,t)}saveBenchmarkMainStats(t){return this.writeAndSendWebStats("saveBenchmarkMainStats",o.Stats.BenchmarkMainStats,t)}saveVkResStats(t){return this.writeAndSendWebStats("saveVkResStats",o.Stats.VkResStats,[...t.details])}constructor({webStatsStorage:t,debug:e,options:s,localStorage:n,webStatsBatchedTransport:i}){this.saveProductionStats=(t,e)=>this.writeAndSendWebStats("saveProductionStats",o.Stats.ProductionStats,t,e),this.saveCustomStats=t=>this.writeAndSendWebStats("saveCustomStats",o.Stats.CustomStats,t),this.webStatsStorage=t,this.debug=e,this.options=s,this.localStorage=n||r.localStorage,this.webStatsBatchedTransport=i}}},879639:(t,e,s)=>{s.d(e,{BatchedWebStatsTransport:()=>i});var r=s(722007),n=s(668813),o=s(402815);class i{isBatchBoostRequired(){const t=this.statsMeta.started||Date.now();return Date.now()-t<=o.BOOST_DURATION}debounceMs(){return this.isBatchBoostRequired()?o.BOOST_DEBOUNCE_MS:o.DEBOUNCE_MS}limitMs(){return this.isBatchBoostRequired()?o.BOOST_DEBOUNCE_LIMIT_MS:o.DEBOUNCE_LIMIT_MS}cooldownMs(){return this.isBatchBoostRequired()?o.BOOST_COOLDOWN_MS:o.COOLDOWN_MS}penaltyMs(){return this.debounceMs()*this.sendAttempt**.5}onCooldown(){return!(Date.now()-this.webStatsStorage.getLastSendTime()>this.cooldownMs()+this.penaltyMs())}tillCooldownMs(){return Math.max(0,this.webStatsStorage.getLastSendTime()+this.cooldownMs()-Date.now()+this.penaltyMs())}tillLimitMs(){return Math.max(0,this.webStatsStorage.getLastSendTime()+this.limitMs()-Date.now())}checkWebStatsLater(){this.isSendingWebStats||this.timeoutID||(this.timeoutID=(0,n.getWindow)()?.setTimeout((()=>{const t=this.webStatsStorage.getWebStatDataLs();this.timeoutID=void 0,t.length>n.emptyStatsDataLs.length&&this.saveAndSendStats(t)}),Math.max(Math.min(this.tillLimitMs(),this.debounceMs()),this.tillCooldownMs())))}sendStatsWithBatching(t){const e=t.length>this.maxBodyChunkSize;let s=e?this.batchers.getMaximumWebStats(t):t,r=!1;if(!s)return this.isSendingWebStats=!1,this.webStatsStorage.clearLsData();s=(0,n.appendStatsMeta)(++this.sendAttempt,s,this.statsMeta),this.sendStats(s,(o=>{const i=Date.now();this.isSendingWebStats=!1,o<500&&(e&&200===o?Object.keys((0,n.getEmptyStatsData)()).forEach((t=>this.webStatsStorage.pullFromWebStats(t,s))):this.webStatsStorage.clearLsData(),this.sendAttempt=0,r=!0),(e||400===o)&&(0,n.logProcessingTime)(Date.now()-i,`${e?"prune":"clean"}${400===o?"-fail":""}`,this.statsMeta,this.statlogsValueEvent,`${t.length>>>20}M ${s.length>>>20}M`),this.checkWebStatsLater()}),(()=>{this.isSendingWebStats=!1,!r&&this.webStatsStorage.clearLsData()}))}idlizeCall(t,e){const s=e=>setTimeout((()=>t()),e);return e?.force?s(0):(0,n.getWindow)()?.requestIdleCallback?window.requestIdleCallback((()=>s(this.debounceMs())),{timeout:this.debounceMs()/2}):s(this.debounceMs())}sendStats(t,e,s){const r=new URLSearchParams,o=this.getBrowserFingerprint();o&&r.set("device_id",o);const i=r.toString(),a=this.createUrl(this.statsMeta,i),c=(t,r)=>{if(r)return void this.sendApi(t,e,s,r);const n=new XMLHttpRequest;n.withCredentials=a.includes(`tau.${this.hostName}`),n.onreadystatechange=()=>{n.readyState===XMLHttpRequest.DONE&&e(n.status)},n.onerror=s,n.open("POST",a,!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(t)};(0,n.getApiConfig)(this.apiParams).then((s=>{(0,n.canSendBeacon)(this.hostName,this.statsMeta)?(0,n.sendBeacon)(a,t,s).then((()=>e(200))).catch((()=>c(t,s))):c(t,s)}))}sendStat(t,e,s){t=(0,n.appendStatsMeta)(1,t,this.statsMeta),this.sendStats(t,e,s)}saveAndSendStats(t,e){return this.options?.isNewQueue?this.saveAndSendStatsNew(t,e):this.saveAndSendStatsOld(t,e)}saveAndSendStatsOld(t,e){const s=t.length>=this.maxBodyChunkSize,r=e?.force||s;if(t.length<=n.emptyStatsDataLs.length)this.debug.logWebStatsEvent("WebStats empty data.","");else{if(!this.isSendingWebStats)return r||this.timeoutID||!this.onCooldown()?(this.isSendingWebStats=!0,this.idlizeCall((()=>{const t=this.webStatsStorage.getWebStatDataLs();if(t.length>n.emptyStatsDataLs.length&&(r||!this.onCooldown()))return this.webStatsStorage.setLastSendTime(),this.sendStatsWithBatching(t);clearTimeout(this.timeoutID),this.isSendingWebStats=!1,this.timeoutID=void 0}),{...e,force:r})):(this.debug.logWebStatsEvent("WebStats delayed.",this.timeoutID),this.checkWebStatsLater());this.debug.logWebStatsEvent("WebStats sending.",this.isSendingWebStats)}}saveAndSendStatsNew(t,e){const s=t.length>=this.maxBodyChunkSize,r=e?.force||s;if(t.length<=n.emptyStatsDataLs.length)this.debug.logWebStatsEvent("WebStats empty data.","");else{if(!this.isSendingWebStats)return!r&&this.onCooldown()?(this.checkWebStatsLater(),void this.debug.logWebStatsEvent("WebStats delayed.",this.timeoutID)):(this.isSendingWebStats=!0,this.idlizeCall((()=>{const t=this.webStatsStorage.getWebStatDataLs();if(t.length>n.emptyStatsDataLs.length&&(!this.onCooldown()||r))return clearTimeout(this.timeoutID),this.timeoutID=void 0,this.webStatsStorage.setLastSendTime(),this.sendStatsWithBatching(t);this.isSendingWebStats=!1}),{...e,force:r}));this.debug.logWebStatsEvent("WebStats sending.",this.isSendingWebStats)}}constructor({options:t,statsMeta:e,hostName:s,debug:o,statlogsValueEvent:i,getBrowserFingerprint:a,batchers:c,webStatsStorage:_,maxBodyChunkSize:d,apiParams:u,createUrl:l}){this.sendAttempt=0,this.isSendingWebStats=!1,this.sendApi=async(t,e,s,o)=>{try{const s=JSON.stringify((0,n.transformEventsToArray)(t));await(0,r.api)(o.method,{events:s,...o.body},o.overrideApiConfig),e(200)}catch{s()}},this.options=t,this.statsMeta=e,this.hostName=s,this.debug=o,this.statlogsValueEvent=i,this.getBrowserFingerprint=a,this.batchers=c,this.webStatsStorage=_,this.maxBodyChunkSize=d,this.apiParams=u,this.createUrl=l}}},966358:(t,e,s)=>{s.d(e,{Batchers:()=>o});var r=s(402815),n=s(668813);class o{batchStaleWebStats(t,e){const[s,r]=e,o=`{"${s}":[${JSON.parse(r).reduce(((e,s,r)=>e.length<this.maxBodyChunkSize-t.length?`${e}${0===r?"":","}${JSON.stringify(s)}`:e),"")}]}`;return"{}"===t?o:(0,n.concatJSONS)(t,o)||t}getMaximumWebStats(t){const e=Date.now(),s=t=>`{${t?.map((([t,e])=>`"${t}":${e}`)).join(",")}}`,[o,i]=Object.keys((0,n.getEmptyStatsData)()).reduce(((e,s)=>{const r=this.webStatsStorage.getWebStatsStringValue(s,t);return"[]"===r?e:[...e,[s,r]]}),[]).sort((([,t],[,e])=>e.length-t.length)).reduce((([t,e],[r,n])=>{const o=[[r,n]];return n.length+s(t).length<this.maxBodyChunkSize?[t.concat(o),e]:[t,e.concat(o)]}),[[],[]]),a=s(o);if((0,n.logProcessingTime)(Date.now()-e,"chunk",this.statsMeta,this.statlogsValueEvent),Date.now()-e<r.PROCESSING_LIMIT&&i[0]&&a.length<.1*this.maxBodyChunkSize){const t=Date.now();try{const e=this.batchStaleWebStats(a,i.reverse()[0]);return(0,n.logProcessingTime)(Date.now()-t,"batch",this.statsMeta,this.statlogsValueEvent),e}catch(e){return(0,n.logProcessingTime)(Date.now()-t,"batch-fail",this.statsMeta,this.statlogsValueEvent),""}}return a}constructor({statsMeta:t,statlogsValueEvent:e,webStatsStorage:s,maxBodyChunkSize:r}){this.statsMeta=t,this.statlogsValueEvent=e,this.webStatsStorage=s,this.maxBodyChunkSize=r}}},972611:(t,e,s)=>{s.d(e,{Debug:()=>r});class r{logWebStatsEvent(t,e){this.options?.isDebuggerMode&&console.log(`[new transport debug] ${t}`,e)}constructor({options:t}){this.options=t}}},407674:(t,e,s)=>{s.d(e,{WebStatsStorage:()=>o});var r=s(142705),n=s(668813);class o{writeLocked(t){if("locked"!==this.sessionStorage.getItem(this.lockName)){this.debug.logWebStatsEvent("writeLocked","lock"),this.sessionStorage.setItem(this.lockName,"locked");try{t()}catch(t){}return this.debug.logWebStatsEvent("writeLocked","free"),void this.sessionStorage.setItem(this.lockName,"free")}setTimeout((()=>this.writeLocked(t)),100)}getWebStatDataLs(){return this.localStorage.getItem(this.lsDataKey)||n.emptyStatsDataLs}serializeDataToLs(t){return this.localStorage.setItem(this.lsDataKey,JSON.stringify(t))}getWebStatsStringValue(t,e=this.getWebStatDataLs()){const s=Object.keys((0,n.getEmptyStatsData)()).filter((e=>e!==t)).join("|"),r=e?.match(new RegExp(`"${t}":(\\[.*?\\])(?:,"(${s})":\\[|}$)`))?.[1]||"";return(0,n.isArrayLike)(r)?r:"[]"}fetchDataFromLs(){let t,e=!0;try{const s=this.getWebStatDataLs();if(!s)throw new Error("empty data");t=(0,n.getEmptyStatsData)();const r=JSON.parse(s);Object.keys(t).forEach((s=>{Array.isArray(r[s])&&(e=!1,t[s]=r[s])}))}catch(e){t=(0,n.getEmptyStatsData)()}return{webStatsData:t,isEmpty:e}}clearLsData(t){t&&this.debug.logWebStatsEvent("WebStats cleared. "+(t?"Reason: LS is broken.":""),t),this.writeLocked((()=>this.localStorage.setItem(this.lsDataKey,"")))}setLastSendTime(t=Number(new Date)){this.sessionStorage.setItem(this.lsMetaKey,t.toString())}getLastSendTime(){return parseInt(`${this.sessionStorage.getItem(this.lsMetaKey)||0}`)}getWebStatsItemsCount(t){return Object.values(t).reduce(((t,e)=>t+=e.length),0)}pullFromWebStats(t,e){const s=this.getWebStatsStringValue(t,e);if("[]"!==s){const t=this.getWebStatDataLs().replace(s.slice(1,-1),"").replace(/\[\,/,"[");this.writeLocked((()=>this.localStorage.setItem(this.lsDataKey,t)))}}constructor({statsMeta:t,debug:e,localStorage:s,sessionStorage:n}){this.lsDataKey=`XHR_STATS_TRANSPORT_DATA_${t.platform}`,this.lsMetaKey=`XHR_STATS_TRANSPORT_META_${t.platform}`,this.lockName=`XHR_STATS_TRANSPORT_DATA_LOCK_${t.platform}`,this.debug=e,this.localStorage=s||r.localStorage,this.sessionStorage=n||r.sessionStorage}}},142705:(t,e,s)=>{s.d(e,{CustomStorage:()=>n,localStorage:()=>u,sessionStorage:()=>S});var r=s(668813);class n{setItem(t,e){this.data[t]=String(e)}getItem(t){return this.data.hasOwnProperty(t)?this.data[t]:null}removeItem(t){delete this.data[t]}clear(){this.data={}}get length(){return Object.keys(this.data).length}key(t){return Object.keys(this.data)[t]}constructor(){this.data={},this.keys=()=>Object.keys(this.data)}}const o="vk-ls-dummy",i=Math.random().toString(),a={localStorage:null,sessionStorage:null};function c(t){if(null===a[t])try{const e=(0,r.getWindow)()?.[t];e?.setItem(o,i),a[t]=i===e?.getItem(o),e?.removeItem(o)}catch(e){a[t]=!1}return a[t]}let _;function d(){return _||(_=c("localStorage")?window.localStorage:new n,_)}const u={setItem:(t,e)=>d().setItem(t,e),getItem:t=>d().getItem(t),removeItem:t=>d().removeItem(t),clear:()=>d().clear(),get length(){return d().length},key:t=>d().key(t),keys(){const t=d();return t instanceof n?t.keys():Object.keys(t)},getPrefixedKeys:t=>u.keys().filter((e=>e.startsWith(t)))};let l;function h(){return l||(l=c("sessionStorage")?window.sessionStorage:new n,l)}const S={setItem:(t,e)=>h().setItem(t,e),getItem:t=>h().getItem(t),removeItem:t=>h().removeItem(t),clear:()=>h().clear(),get length(){return h().length},key:t=>h().key(t),keys(){const t=h();return t instanceof n?t.keys():Object.keys(t)},getPrefixedKeys:t=>S.keys().filter((e=>e.startsWith(t)))}},668813:(t,e,s)=>{s.d(e,{appendStatsMeta:()=>d,canSendBeacon:()=>u,concatJSONS:()=>a,emptyStatsDataLs:()=>S,getApiConfig:()=>p,getEmptyStatsData:()=>h,getWindow:()=>g,isArrayLike:()=>i,logProcessingTime:()=>l,sendBeacon:()=>_,transformEventsToArray:()=>c});var r=s(995537),n=s(402815);const o=t=>t.startsWith("{")&&t.endsWith("}"),i=t=>t.startsWith("[")&&t.endsWith("]"),a=(t,e)=>[t,e].every(o)?`${t.slice(0,-1)},${e.substring(1)}`:"{}",c=t=>{try{const e=JSON.parse(t),s=Object.entries(e),r=[];return s.forEach((t=>{const[e,s]=t;n.AVAILABLE_STATS.includes(e)&&Array.isArray(s)&&r.push(...s)})),r}catch{return[]}};function _(t,e,s){try{if(!(s?(0,r.apiBeacon)(s.method,{events:c(e),...s.body},s.overrideApiConfig):navigator.sendBeacon(t,e)))return Promise.reject(new Error("Beacon not sent"))}catch(t){return Promise.reject(new Error("Beacon fail"))}return Promise.resolve()}const d=(t,e,s)=>{const{userId:r,st:n,platform:i,appId:c,time:_,hash:d,itemId:u,itemOwnerId:l,itemType:h}=s;return a(JSON.stringify({id:r,st:n,platform:i,appId:c,attempt:t,signTime:_,sign:d,...u&&{itemId:u},...h&&{itemType:h},...l&&{itemOwnerId:l}}),o(e)?e:"{}")};function u(t,e){return"sendBeacon"in navigator&&!e.wsTransport.includes(`tau.${t}`)}function l(t,e,s,r,n){r?.("web_stats_batching_time",t,s.platform,e,n)}const h=()=>({statlogEvents:[],productionStats:[],storyViewStats:[],networkStats:[],customStats:[],webPerfStats:[],benchmarkMainStats:[],vkResStats:[]}),S=JSON.stringify(h()),g=()=>"undefined"!=typeof window?window:void 0,p=async t=>{if(!t)return;const{additionalBody:e,method:s,domain:r,version:n,appId:o,getToken:i}=t;return{body:e,overrideApiConfig:{domain:r,version:n,appId:o,accessToken:await i()},method:s}}},680318:(t,e,s)=>{s.d(e,{getAsyncContextStrategy:()=>o});var r=s(222168),n=s(645991);function o(t){const e=(0,r.getSentryCarrier)(t);return e.acs?e.acs:(0,n.getStackAsyncContextStrategy)()}},645991:(t,e,s)=>{s.d(e,{getStackAsyncContextStrategy:()=>l});var r=s(788180),n=s(129092),o=s(383354),i=s(222168);class a{withScope(t){const e=this._pushScope();let s;try{s=t(e)}catch(t){throw this._popScope(),t}return(0,o.isThenable)(s)?s.then((t=>(this._popScope(),t)),(t=>{throw this._popScope(),t})):(this._popScope(),s)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}constructor(t,e){let s,r;s=t||new n.Scope,r=e||new n.Scope,this._stack=[{scope:s}],this._isolationScope=r}}function c(){const t=(0,i.getMainCarrier)(),e=(0,i.getSentryCarrier)(t);return e.stack=e.stack||new a((0,r.getDefaultCurrentScope)(),(0,r.getDefaultIsolationScope)())}function _(t){return c().withScope(t)}function d(t,e){const s=c();return s.withScope((()=>(s.getStackTop().scope=t,e(t))))}function u(t){return c().withScope((()=>t(c().getIsolationScope())))}function l(){return{withIsolationScope:u,withScope:_,withSetScope:d,withSetIsolationScope:(t,e)=>u(e),getCurrentScope:()=>c().getScope(),getIsolationScope:()=>c().getIsolationScope()}}},296146:(t,e,s)=>{s.d(e,{addBreadcrumb:()=>a});var r=s(274328),n=s(243498),o=s(470879);const i=100;function a(t,e){const s=(0,r.getClient)(),a=(0,r.getIsolationScope)();if(!s)return;const{beforeBreadcrumb:c=null,maxBreadcrumbs:_=i}=s.getOptions();if(_<=0)return;const d={timestamp:(0,o.dateTimestampInSeconds)(),...t},u=c?(0,n.consoleSandbox)((()=>c(d,e))):d;null!==u&&(s.emit&&s.emit("beforeAddBreadcrumb",u,e),a.addBreadcrumb(u,_))}},222168:(t,e,s)=>{s.d(e,{getGlobalSingleton:()=>a,getMainCarrier:()=>o,getSentryCarrier:()=>i});var r=s(554728),n=s(420103);function o(){return i(n.GLOBAL_OBJ),n.GLOBAL_OBJ}function i(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||r.SDK_VERSION,e[r.SDK_VERSION]=e[r.SDK_VERSION]||{}}function a(t,e,s=n.GLOBAL_OBJ){const o=s.__SENTRY__=s.__SENTRY__||{},i=o[r.SDK_VERSION]=o[r.SDK_VERSION]||{};return i[t]||(i[t]=e())}},274328:(t,e,s)=>{s.d(e,{getClient:()=>i,getIsolationScope:()=>o});var r=s(680318),n=s(222168);s(129092),s(591409),s(84347);function o(){const t=(0,n.getMainCarrier)();return(0,r.getAsyncContextStrategy)(t).getIsolationScope()}function i(){return function(){const t=(0,n.getMainCarrier)();return(0,r.getAsyncContextStrategy)(t).getCurrentScope()}().getClient()}},788180:(t,e,s)=>{s.d(e,{getDefaultCurrentScope:()=>o,getDefaultIsolationScope:()=>i});var r=s(222168),n=s(129092);function o(){return(0,r.getGlobalSingleton)("defaultCurrentScope",(()=>new n.Scope))}function i(){return(0,r.getGlobalSingleton)("defaultIsolationScope",(()=>new n.Scope))}},129092:(t,e,s)=>{s.d(e,{Scope:()=>u});var r=s(462200),n=s(383354),o=s(243498),i=s(228086),a=s(84347),c=s(470879),_=s(508718),d=s(710613);class u{clone(){const t=new u;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,(0,d._setSpanForScope)(t,(0,d._getSpanForScope)(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&(0,r.updateSession)(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,e){return this._tags={...this._tags,[t]:e},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,e){return this._extra={...this._extra,[t]:e},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return null===e?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const e="function"==typeof t?t(this):t,s=e instanceof u?e.getScopeData():(0,n.isPlainObject)(e)?t:void 0,{tags:r,extra:o,user:i,contexts:a,level:c,fingerprint:_=[],propagationContext:d}=s||{};return this._tags={...this._tags,...r},this._extra={...this._extra,...o},this._contexts={...this._contexts,...a},i&&Object.keys(i).length&&(this._user=i),c&&(this._level=c),_.length&&(this._fingerprint=_),d&&(this._propagationContext=d),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,(0,d._setSpanForScope)(this,void 0),this._attachments=[],this.setPropagationContext({traceId:(0,a.generateTraceId)(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,e){const s="number"==typeof e?e:100;if(s<=0)return this;const r={timestamp:(0,c.dateTimestampInSeconds)(),...t};return this._breadcrumbs.push(r),this._breadcrumbs.length>s&&(this._breadcrumbs=this._breadcrumbs.slice(-s),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:(0,d._getSpanForScope)(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=(0,_.merge)(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,e){const s=e?.event_id||(0,i.uuid4)();if(!this._client)return o.logger.warn("No client configured on scope - will not capture exception!"),s;const r=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:r,...e,event_id:s},this),s}captureMessage(t,e,s){const r=s?.event_id||(0,i.uuid4)();if(!this._client)return o.logger.warn("No client configured on scope - will not capture message!"),r;const n=new Error(t);return this._client.captureMessage(t,e,{originalException:t,syntheticException:n,...s,event_id:r},this),r}captureEvent(t,e){const s=e?.event_id||(0,i.uuid4)();return this._client?(this._client.captureEvent(t,{...e,event_id:s},this),s):(o.logger.warn("No client configured on scope - will not capture event!"),s)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((t=>{t(this)})),this._notifyingListeners=!1)}constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:(0,a.generateTraceId)(),sampleRand:Math.random()}}}},462200:(t,e,s)=>{s.d(e,{updateSession:()=>o});s(591409);var r=s(470879),n=s(228086);function o(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||(0,r.timestampInSeconds)(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=32===e.sid.length?e.sid:(0,n.uuid4)()),void 0!==e.init&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),"number"==typeof e.started&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if("number"==typeof e.duration)t.duration=e.duration;else{const e=t.timestamp-t.started;t.duration=e>=0?e:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),"number"==typeof e.errors&&(t.errors=e.errors),e.status&&(t.status=e.status)}},763648:(t,e,s)=>{s.d(e,{htmlTreeAsString:()=>i});var r=s(383354);const n=s(420103).GLOBAL_OBJ,o=80;function i(t,e={}){if(!t)return"<unknown>";try{let s=t;const r=5,n=[];let i=0,c=0;const _=" > ",d=_.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,h=!Array.isArray(e)&&e.maxStringLength||o;for(;s&&i++<r&&(u=a(s,l),!("html"===u||i>1&&c+n.length*d+u.length>=h));)n.push(u),c+=u.length,s=s.parentNode;return n.reverse().join(_)}catch(t){return"<unknown>"}}function a(t,e){const s=t,o=[];if(!s?.tagName)return"";if(n.HTMLElement&&s instanceof HTMLElement&&s.dataset){if(s.dataset.sentryComponent)return s.dataset.sentryComponent;if(s.dataset.sentryElement)return s.dataset.sentryElement}o.push(s.tagName.toLowerCase());const i=e?.length?e.filter((t=>s.getAttribute(t))).map((t=>[t,s.getAttribute(t)])):null;if(i?.length)i.forEach((t=>{o.push(`[${t[0]}="${t[1]}"]`)}));else{s.id&&o.push(`#${s.id}`);const t=s.className;if(t&&(0,r.isString)(t)){const e=t.split(/\s+/);for(const t of e)o.push(`.${t}`)}}const a=["aria-label","type","name","title","alt"];for(const t of a){const e=s.getAttribute(t);e&&o.push(`[${t}="${e}"]`)}return o.join("")}},948442:(t,e,s)=>{s.d(e,{DEBUG_BUILD:()=>r});const r=!1},383354:(t,e,s)=>{s.d(e,{isElement:()=>d,isError:()=>n,isEvent:()=>_,isInstanceOf:()=>h,isPlainObject:()=>c,isPrimitive:()=>a,isRegExp:()=>u,isString:()=>i,isThenable:()=>l,isVueViewModel:()=>S});const r=Object.prototype.toString;function n(t){switch(r.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return h(t,Error)}}function o(t,e){return r.call(t)===`[object ${e}]`}function i(t){return o(t,"String")}function a(t){return null===t||function(t){return"object"==typeof t&&null!==t&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}(t)||"object"!=typeof t&&"function"!=typeof t}function c(t){return o(t,"Object")}function _(t){return"undefined"!=typeof Event&&h(t,Event)}function d(t){return"undefined"!=typeof Element&&h(t,Element)}function u(t){return o(t,"RegExp")}function l(t){return Boolean(t?.then&&"function"==typeof t.then)}function h(t,e){try{return t instanceof e}catch(t){return!1}}function S(t){return!("object"!=typeof t||null===t||!t.__isVue&&!t._isVue)}},243498:(t,e,s)=>{s.d(e,{consoleSandbox:()=>c,logger:()=>_});var r=s(222168),n=s(948442),o=s(420103);const i=["debug","info","warn","error","log","assert","trace"],a={};function c(t){if(!("console"in o.GLOBAL_OBJ))return t();const e=o.GLOBAL_OBJ.console,s={},r=Object.keys(a);r.forEach((t=>{const r=a[t];s[t]=e[t],e[t]=r}));try{return t()}finally{r.forEach((t=>{e[t]=s[t]}))}}const _=(0,r.getGlobalSingleton)("logger",(function(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return n.DEBUG_BUILD?i.forEach((s=>{e[s]=(...e)=>{t&&c((()=>{o.GLOBAL_OBJ.console[s](`Sentry Logger [${s}]:`,...e)}))}})):i.forEach((t=>{e[t]=()=>{}})),e}))},228086:(t,e,s)=>{s.d(e,{uuid4:()=>n});s(591409),s(357659);var r=s(420103);function n(t=function(){const t=r.GLOBAL_OBJ;return t.crypto||t.msCrypto}()){let e=()=>16*Math.random();try{if(t?.randomUUID)return t.randomUUID().replace(/-/g,"");t?.getRandomValues&&(e=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(t){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(t=>(t^(15&e())>>t/4).toString(16)))}},591409:(t,e,s)=>{s.d(e,{addNonEnumerableProperty:()=>i,dropUndefinedKeys:()=>a});s(763648);var r=s(948442),n=s(383354),o=s(243498);s(357659);function i(t,e,s){try{Object.defineProperty(t,e,{value:s,writable:!0,configurable:!0})}catch(s){r.DEBUG_BUILD&&o.logger.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function a(t){return c(t,new Map)}function c(t,e){if(function(t){if(!(0,n.isPlainObject)(t))return!1;try{const e=Object.getPrototypeOf(t).constructor.name;return!e||"Object"===e}catch{return!0}}(t)){const s=e.get(t);if(void 0!==s)return s;const r={};e.set(t,r);for(const s of Object.getOwnPropertyNames(t))void 0!==t[s]&&(r[s]=c(t[s],e));return r}if(Array.isArray(t)){const s=e.get(t);if(void 0!==s)return s;const r=[];return e.set(t,r),t.forEach((t=>{r.push(c(t,e))})),r}return t}},84347:(t,e,s)=>{s.d(e,{generateSpanId:()=>o,generateTraceId:()=>n});var r=s(228086);function n(){return(0,r.uuid4)()}function o(){return(0,r.uuid4)().substring(16)}},357659:(t,e,s)=>{s.d(e,{snipLine:()=>n,truncate:()=>r});s(383354);function r(t,e=0){return"string"!=typeof t||0===e||t.length<=e?t:`${t.slice(0,e)}...`}function n(t,e){let s=t;const r=s.length;if(r<=150)return s;e>r&&(e=r);let n=Math.max(e-60,0);n<5&&(n=0);let o=Math.min(n+140,r);return o>r-5&&(o=r),o===r&&(n=Math.max(o-140,0)),s=s.slice(n,o),n>0&&(s=`'{snip} ${s}`),o<r&&(s+=" {snip}"),s}},470879:(t,e,s)=>{s.d(e,{dateTimestampInSeconds:()=>o,timestampInSeconds:()=>i});var r=s(420103);const n=1e3;function o(){return Date.now()/n}const i=function(){const{performance:t}=r.GLOBAL_OBJ;if(!t?.now)return o;const e=Date.now()-t.now(),s=null==t.timeOrigin?e:t.timeOrigin;return()=>(s+t.now())/n}()},554728:(t,e,s)=>{s.d(e,{SDK_VERSION:()=>r});const r="9.5.0"},420103:(t,e,s)=>{s.d(e,{GLOBAL_OBJ:()=>r});const r=globalThis},508718:(t,e,s)=>{function r(t,e,s=2){if(!e||"object"!=typeof e||s<=0)return e;if(t&&0===Object.keys(e).length)return t;const n={...t};for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=r(n[t],e[t],s-1));return n}s.d(e,{merge:()=>r})},710613:(t,e,s)=>{s.d(e,{_getSpanForScope:()=>i,_setSpanForScope:()=>o});var r=s(591409);const n="_sentrySpan";function o(t,e){e?(0,r.addNonEnumerableProperty)(t,n,e):delete t[n]}function i(t){return t[n]}},399373:(t,e,s)=>{s.d(e,{getTracerModules:()=>o});function r(){if("undefined"==typeof window)return{data:{},modules:{},version:"2.0.22"};const t="TracerSDK";return window[t]||(window[t]={data:{},modules:{},version:"2.0.22"}),window[t]}function n(t){const e=r().modules;return e[t]||(e[t]={}),e[t]}new Map;function o(){return n("main")}}}]);try{stManager?.done("dist/api/widgets/chunks/863a9c29.7d7403b0.js")}catch(t){}