"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[18728],{817882:(e,t,i)=>{function o(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M16.87 2c1.79 0 2.43.19 3.08.53.66.35 1.17.86 1.52 1.52s.53 1.3.53 3.08v9.74c0 1.79-.19 2.43-.53 3.08a3.63 3.63 0 0 1-1.52 1.52c-.65.34-1.3.53-3.08.53H7.13c-1.79 0-2.43-.19-3.08-.53s-1.17-.86-1.52-1.52C2.2 19.3 2 18.65 2 16.87V7.13c0-1.79.19-2.43.53-3.08.35-.66.86-1.17 1.52-1.52C4.7 2.2 5.35 2 7.13 2zm.57 2H6.56c-.89 0-1.21.1-1.54.27-.32.17-.58.43-.75.75-.18.33-.27.65-.27 1.54v10.88c0 .89.1 1.21.27 1.54.17.32.43.58.75.75.33.18.65.27 1.54.27h10.88c.89 0 1.21-.1 1.54-.27.32-.17.58-.43.75-.75.18-.33.27-.65.27-1.54V6.56c0-.89-.1-1.21-.27-1.54a1.82 1.82 0 0 0-.75-.75c-.33-.18-.65-.27-1.54-.27z" fill="currentColor"/></svg>',name:"check_box_off_24"}}i.d(t,{getIcon24CheckBoxOff:()=>o})},895798:(e,t,i)=>{function o(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.44 4.18C2 5.04 2 6.16 2 8.4v7.2c0 2.24 0 3.36.44 4.22a4 4 0 0 0 1.74 1.74c.86.44 1.98.44 4.22.44h7.2c2.24 0 3.36 0 4.22-.44a4 4 0 0 0 1.74-1.74c.44-.86.44-1.98.44-4.22V8.4c0-2.24 0-3.36-.44-4.22a4 4 0 0 0-1.74-1.74C18.96 2 17.84 2 15.6 2H8.4c-2.24 0-3.36 0-4.22.44a4 4 0 0 0-1.74 1.74zM18.2 9.21a1 1 0 0 0-1.42-1.42L10 14.6l-2.8-2.8a1 1 0 0 0-1.4 1.42l3.5 3.5a1 1 0 0 0 1.4 0z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"check_box_on_24"}}i.d(t,{getIcon24CheckBoxOn:()=>o})},234430:(e,t,i)=>{i.d(t,{CLOSE_BUTTON_MODES:()=>m,UIAction:()=>b,renderCounter:()=>C,setCounter:()=>y});var o=i(105330),r=i(453736),s=i(150585),n=i(950189),a=i(801746),d=i(680208),l=i(936492),c=i(895798),u=i(817882),h=i(540462),p=i(670053);const m={INNER:0,OUTER:1},v="success",g="deny",_="extra",C=e=>{const t=document.createElement("span");return t.classList.add("VkAppModal__buttonCounter"),t.innerText=e,t},y=(e,t)=>{const i=e.find((e=>e.hasCounter));i&&i.counterElement&&(i.counterElement.innerText=t)};class b{addScroll(){(0,r.addPopupScroll)(this.modal.children[0],this.modalParentLayer)}init(){this.containerNode&&this.containerNode.appendChild(this.modal),this.modalParentLayer=this.modal.closest(".layer_wrap"),!1!==this.props.withScroll&&(this.modalParentLayer?this.modalParentLayer.addEventListener("scroll",this.addScroll):window.addEventListener("scroll",this.addScroll))}show(){(0,o.isMvk)()&&document.body.classList.add("vk_app_fixed"),this.props.withoutAnimation?this.modal.classList.add("show"):setTimeout((()=>this.modal.classList.add("show")),300),this.initMvkCloseActions(),this.addScroll()}initMvkCloseActions(){(0,o.isMvk)()&&(window.DirectGames&&(0,p.getCurrentApp)().isDirectGame&&window.DirectGames.onBoxOpen?.(this),this.props.onlyButtonHide||(this.modal.onclick=e=>{e.target===this.modal&&this.onAction(this.props.cancelAction)}))}close(){this.props.onlyButtonHide||this.onAction(this.props.cancelAction)}destroy(){if(!1!==this.props.withScroll&&(window.removeEventListener("scroll",this.addScroll),this.modalParentLayer&&this.modalParentLayer.removeEventListener("scroll",this.addScroll)),!this._destroyed){if((0,o.isMvk)()){document.body.classList.remove("vk_app_fixed");const e=(0,p.getCurrentApp)();window.DirectGames&&e.isDirectGame&&(window.DirectGames.onBoxClose?.(this),e.frame.focus())}this.modal.parentNode.removeChild(this.modal),this.callback&&this.callback(),this._destroyed=!0}}_disableButton(e,t=!0){e.disabled=t,e.element.disabled=t}_lockButton(e,t=!0){const i=(0,o.isMvk)()?(0,n.getIcon24Spinner)().icon:(0,a.getIcon16Spinner)().icon,r=`\n    <span class="vk_app_modal_btn__content">${e.title}</span>\n    <span class="vk_app_modal_btn__spinner">${i}</span>\n    `;e.loading=t,e.element.innerHTML=t?r:e.title,e.element.classList.toggle("vk_app_modal_btn--loading",t)}async onAction(e){await e(),this.destroy()}lockButtons(e=!0){const t={[v]:this._lockButton,[g]:this._disableButton,[_]:this._disableButton};this.props.buttons.forEach((i=>t[i.type](i,e)))}_setCounter(e){y(this.props.buttons,e)}_renderBtn(e){const t=document.createElement("button");if(t.setAttribute("type","button"),t.classList.add("vk_app_modal_btn"),t.classList.add(`vk_app_modal_btn--${e.type}`),t.innerText=e.title,t.addEventListener("click",(()=>e.type===_?e.action():this.onAction(e.action))),e.hasCounter){const i=C(0);t.appendChild(i),e.counterElement=i}return e.dataTestId&&t.setAttribute("data-testid",e.dataTestId),e.element=t,e.disabled&&this._disableButton(e),e.loading&&this._lockButton(e),t}_renderBtns(e){const t=e.querySelector(".vk_app_modal_btns"),{buttons:i}=this.props;if(t){i.forEach((e=>t.appendChild(this._renderBtn(e))));const e=i.find((e=>e.type===_));1===i.length&&t.classList.add("vk_app_modal_btns--single-btn"),e&&t.classList.add("vk_app_modal_btns--hasExtraButton")}}_renderCloseBtn(e){const t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("data-testid","apps_connect_modal_close_button"),t.classList.add("vk_app_modal_close_btn"),(0,o.isMvk)()||this.props.closeButtonMode!==m.OUTER?t.innerHTML=(0,l.getIcon24Cancel)().icon:(t.classList.add("vk_app_modal_close_btn--outer"),t.innerHTML=(0,d.getIcon20Cancel)().icon),t.addEventListener("click",(()=>this.onAction(this.props.cancelAction))),e.children[0].appendChild(t)}_renderCheckboxFields(e,t){const i=document.createElement("div");i.classList.add("MiniAppsCheckbox__fields");const o=document.createElement("h5");if(o.classList.add("MiniAppsCheckbox__fields-title"),o.innerHTML=e,i.appendChild(o),t){const e=document.createElement("h6");e.classList.add("MiniAppsCheckbox__fields-description"),e.innerHTML=t,i.appendChild(e)}return i}_renderCheckbox(e){const{title:t,description:i,...r}=e,s=document.createElement("label");s.classList.add("MiniAppsCheckbox");const n=document.createElement("input");if(n.type="checkbox",n.classList.add("MiniAppsCheckbox__checkbox"),n.addEventListener("change",(t=>e.checked=t.target.checked)),s.appendChild(n),Object.entries(r).forEach((([e,t])=>{n[e]=t})),(0,o.isMvk)()){const e=document.createElement("div");e.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--checked"),e.innerHTML=(0,c.getIcon24CheckBoxOn)().icon,s.appendChild(e);const t=document.createElement("div");t.classList.add("MiniAppsCheckbox__fake_checkbox","MiniAppsCheckbox__fake_checkbox--unchecked"),t.innerHTML=(0,u.getIcon24CheckBoxOff)().icon,s.appendChild(t)}else{const e=document.createElement("div");e.classList.add("MiniAppsCheckbox__fake_checkbox"),s.appendChild(e)}const a=this._renderCheckboxFields(t,i);return s.appendChild(a),s}_renderCheckboxWrap(e){const t=e.querySelector(".MiniAppsModalCheckbox");t&&this.props.checkbox.map((e=>t.appendChild(this._renderCheckbox(e))))}_renderOuter(){const e=document.createElement("div");return e.classList.add("vk_app_modal_outer"),e}_enhanceBtnsWithActions(){this.props.buttons&&this.props.buttons.forEach(((e,t)=>{e.type===g?this.props.buttons[t].action=this.props.cancelAction:e.type===_?this.props.buttons[t].action=this.props.extraAction:this.props.buttons[t].action=this.props.allowAction}))}_renderScopes(e){return e.map(((e,t)=>{const i=getLang(`vkapps_scope_${e}`);return 0===t?i:i.toLowerCase()})).join(", ")}prepareScopes(e){return 0===e.length?["general"]:e}prepareExtraBtn(){const e=document.createElement("button");return e.setAttribute("type","button"),e.setAttribute("data-testid","apps_connect_modal_scopes_edit"),e.classList.add("vk_app_modal_btn","VkAppModal__button--extra","vk_app_modal_btn--transparent"),e.innerHTML=getLang("apps_connect_modal_messages_scopes_edit"),e.addEventListener("click",this.props.extraAction),e}getThumb(){if(this.props.svgIcon)return this.props.svgIcon;const e=this.props.picClass?this.props.picClass:"";return this.props.pic?`<img src="${this.props.pic}" class="vk_app_modal_container__pic MiniAppModalContainer__pic ${e}" alt aria-label="product">`:""}isHorizontalLayoutSupported(){return(0,o.isMvk)()&&(0,h.partConfigEnabled)("vk_bridge_modals_horizontal_layout")}renderModal(){this.props.containerClass=this.props.containerClass||"",this.props.buttonsClass=this.props.buttonsClass||"",this.props.isGradientModal&&(0,o.isMvk)()&&(this.props.containerClass+=" MiniAppsGradientModal"),this.props.isNoWrapButtons&&(0,o.isMvk)()&&(this.props.buttonsClass+=" MiniAppsNoWrapButtons");const e=this.props.scopes&&this.props.scopes.length&&this.props.extraAction;this.isHorizontalLayoutSupported()&&(this.props.containerClass+=" VkAppModal__Container--horizontalSupport",e&&(this.props.containerClass+=" VkAppModal__Container--withExtraButton"));let t=`\n    <div class="vk_app_modal_container vk_app_modal_container--flex ${this.props.containerClass||""}">\n      <div class="vk_app_modal_content">\n        ${this.getThumb()}\n        <h2 class="vk_app_modal_container__heading">${this.props.title}</h2>\n        ${this._renderSubheading()}\n        ${this._renderTextSeparator()}\n        ${this._renderText(this.props.text)}\n      `;this.props.scopes&&(t+=`\n          <p class="vk_app_modal_container__text">${getLang("apps_connect_modal_messages_scopes_text")}</p>\n          <p class="vk_app_modal_container__list">${this._renderScopes(this.prepareScopes(this.props.scopes))}.</p>`),t+=`\n          </div>\n          ${this.props.checkbox?'<div class="MiniAppsModalCheckbox"></div>':""}\n          <div class="vk_app_modal_btns ${this.props.buttonsClass}"></div>\n      </div>`,this._enhanceBtnsWithActions(),this.modal=this._renderOuter(),this.modal.innerHTML=t,this.props.showCloseBtn&&this._renderCloseBtn(this.modal),e&&this.modal.getElementsByClassName("vk_app_modal_content")[0].appendChild(this.prepareExtraBtn()),this._renderBtns(this.modal),this.props.checkbox&&this._renderCheckboxWrap(this.modal),this.props.scopes&&this._setCounter(this.props.scopes.length)}_renderText(e){if(!e)return"";return(Array.isArray(e)?e:[e]).map((e=>`<p class="vk_app_modal_container__text">${e}</p>`)).join("")}_renderSubheading(){return this.props.subheading?`<h3 class="vk_app_modal_container__subheading">${this.props.subheading}</h3>`:""}_renderTextSeparator(){return this.props.isTextSeparated?'<div class="vk_app_modal_container__text_separator"></div>':""}constructor(e,t){this.props={...e},t&&(this.callback=t),this.props.buttons=this.props.buttons||[],this.containerNode=document.getElementById(this.props.containerId),this.modal=null,this.modalParentLayer=null,this.onAction=this.onAction.bind(this),this.addScroll=(0,s.throttle)(this.addScroll.bind(this),r.THROTTLE_TIME),this.renderModal(),this._destroyed=!1}}},453736:(e,t,i)=>{i.d(t,{THROTTLE_TIME:()=>s,addPopupScroll:()=>n});var o=i(105330),r=i(670053);const s=300,n=(e,t)=>{const i=t?t.scrollTop:window.pageYOffset,s=(0,r.getCurrentApp)();if(s&&!(0,o.isMvk)()){const t=50*(Boolean(window.vk?.rtl)?1:-1),o=s.frame.clientHeight-360,r=Math.max(103,Math.min(i,o)+102);requestAnimationFrame((function(){e.style.transform=`translateX(${t}%) translateY(${r}px)`}))}}},975186:(e,t,i)=>{i.d(t,{PlayerComponent:()=>c});var o=i(34692),r=i(866467),s=i(898848),n=i(593159),a=i(754866),d=i(583022),l=i(540462);class c{domListen(e,t,i,{useCapture:o,context:r,once:n}={}){if(!e||!t||!i||u(this._componentDomListeners,e,t,i,o)>-1)return;(0,s.isString)(e)&&(e=(0,a.domByClass)(this.el,e));const d=n?s=>(this.domUnlisten(e,t,i,{useCapture:o}),i.call(r||this,s)):i.bind(r||this);e.addEventListener(t,d,o),this._componentDomListeners.push({elem:e,type:t,handler:i,useCapture:o,realHandler:d})}domListenOnce(e,t,i,o={}){return o.once=!0,this.domListen(e,t,i,o)}domUnlisten(e,t,i,{useCapture:o}={}){if(i&&t){let r=u(this._componentDomListeners,e,t,i,o);h(this._componentDomListeners,r)}else for(let i=0;this._componentDomListeners[i];){let o=this._componentDomListeners[i];e!==o.elem||t&&t!==o.type?i++:h(this._componentDomListeners,i)}}domUnlistenAll(){for(let e;e=this._componentDomListeners[0];)this.domUnlisten(e.elem,e.type,e.handler,{useCapture:e.useCapture})}get tooltip(){return(0,l.partConfigEnabled)("use_uv_videoplayer_on_web")?this._tooltip:this.player.ui.playerTooltip}attachTooltip(e){let t;(0,s.isString)(e.el)&&(e.el=(0,a.domByClass)(this.el,e.el)),(0,s.isFunction)(e.useAutoHide)||(e.useAutoHide=()=>!0),(0,s.isFunction)(e.onHide)&&(this.tooltip.onHide=e.onHide),this.domListen(e.el,"mouseenter",(()=>{const i=e.useAutoHide();this.tooltip.isVisible()||Date.now()-this.tooltip.lastShown<100?this.tooltip.show({...e,useHideTimeOut:i}):t=setTimeout((()=>this.tooltip.show({...e,useHideTimeOut:i})),Number.isInteger(e.showDelay)?e.showDelay:100)})),this.domListen(e.el,"mouseleave",(()=>{e.useAutoHide()&&(clearTimeout(t),e.hideDelay?this.tooltip.hideWithDelay(e.hideDelay):this.tooltip.hide())})),this.domListen(e.el,"click",(()=>{clearTimeout(t),e.hideOnClick?this.tooltip.hide():setTimeout((()=>this.tooltip.show(e)),0)}))}playerListen(e,t,i,o=this){const r=t.bind(o);this.player.on(e,r,i),this._componentPlayerListeners.push({type:e,handler:t,realHandler:r})}playerUnlisten(e,t){const i=function(e,t,i){let o=-1;return(0,n.each)(e,((e,r)=>{if(r.type===t&&r.handler===i)return o=e,!1})),o}(this._componentPlayerListeners,e,t);if(i<0)return;const o=this._componentPlayerListeners[i];this.player.off(e,o.realHandler),this._componentPlayerListeners.splice(i,1)}playerUnlistenAll(){for(let e;e=this._componentPlayerListeners[0];)this.playerUnlisten(e.type,e.handler)}getLang(e,t={},i={}){let o=this.player.langVars[e];return o?(i.sex&&(o=(0,r.langSex)(i.sex,o)),t&&(0,n.each)(t,((e,t)=>{o=o.replace(new RegExp("{"+e+"}","g"),t)})),o):""}getVars(e=!1){return this.player[e?"projectVars":"vars"]||{}}getVar(e,t=!1){return this.getVars(t)[e]}delay(e,t,...i){const o=setTimeout((()=>{e.apply(this,i)}),t);return this._componentTimeouts.push(o),o}undelay(e){if(!e)return;clearTimeout(e);const t=this._componentTimeouts.indexOf(e);t>=0&&this._componentTimeouts.splice(t,1)}request(e,t,i=!0){const o=(0,d.request)(e,t);if(i){this._componentRequests.push(o);const e=()=>{const e=this._componentRequests.indexOf(o);e>=0&&this._componentRequests.splice(e,1)};o.promise.finally(e)}return o}clearComponentTimeouts(){(0,n.each)(this._componentTimeouts,((e,t)=>{clearTimeout(t)})),this._componentTimeouts=[]}abortAllRequests(){(0,n.each)(this._componentRequests,((e,t)=>{t.abort()})),this._componentRequests=[]}destroy(){this.playerUnlistenAll(),this.domUnlistenAll(),this.clearComponentTimeouts(),this.abortAllRequests()}constructor(e){this._componentPlayerListeners=[],this._componentDomListeners=[],this._componentTimeouts=[],this._componentRequests=[],this.player=e,this.playerListen(o._INIT_VIDEO,((...e)=>{this.initVideo&&this.initVideo(...e)})),this.playerListen(o._DEINIT_VIDEO,((...e)=>{this.deinitVideo&&this.deinitVideo(...e)})),this.playerListen(o._RESIZE,((...e)=>{this.resize&&this.resize(...e)})),this.playerListen(o._DESTROY,this.destroy)}}function u(e,t,i,o,r){let s=-1;return(0,n.each)(e,((e,n)=>{if(n.elem===t&&n.type===i&&n.handler===o&&n.useCapture===r)return s=e,!1})),s}function h(e,t){let i=e[t];i&&(i.elem.removeEventListener(i.type,i.realHandler,i.useCapture),e.splice(t,1))}},34692:(e,t,i)=>{i.r(t),i.d(t,{ADS_LINEAR_COMPLETED:()=>_e,ADS_LINEAR_STARTED:()=>ge,ADS_OVERLAY_COMPLETED:()=>ye,ADS_OVERLAY_STARTED:()=>Ce,ADS_REQUEST:()=>be,ADS_TIME_REMAINED:()=>ve,ADS_WAITING:()=>me,AUDIO_LANGUAGES_CHANGE:()=>c,AUDIO_TRACKS_CHANGE:()=>V,AUTOPLAY_SOUND_PROHIBITED:()=>Te,BEFORE_EXPAND:()=>b,CHROMECAST_DEVICE_NAME_CHANGED:()=>p,CHROMECAST_STATE_CHANGED:()=>h,EXPANDED:()=>I,FULLSCREEN_CHANGE:()=>C,INTERACTIVE_CHAPTER_CHANGED:()=>fe,INTERACTIVE_CHAPTER_CHANGED_AFTER:()=>we,INTERACTIVE_CONTAINER_FAKE_REMOVED:()=>Oe,INTERACTIVE_CONTROL_CLICKED:()=>Ae,INTERACTIVE_ERROR:()=>Ee,INTERACTIVE_GRAPH_TOGGLED:()=>ke,INTERACTIVE_GRAPH_WATCH_AGAIN_CLICKED:()=>Pe,INTERACTIVE_HAS_PREV_CHAPTER:()=>xe,INTERACTIVE_INTERACTIVE_EVENT_TRIGGERED:()=>Le,INTERACTIVE_PREPARED:()=>Me,LIVE_DONATION:()=>x,LIVE_DURATION_CHANGE:()=>M,LIVE_PHASE_CHANGE:()=>L,LIVE_TIME:()=>O,MEDIA_DASH_ZERO_TIME_CHANGE:()=>Z,MEDIA_DURATIONCHANGE:()=>U,MEDIA_ENDED:()=>z,MEDIA_ERROR:()=>$,MEDIA_FIRST_BYTES:()=>ee,MEDIA_FIRST_FRAME:()=>te,MEDIA_HLS_FRAG_LOADED:()=>re,MEDIA_HLS_LEVEL_LOADED:()=>oe,MEDIA_LIVE_REWIND:()=>J,MEDIA_MUTED:()=>N,MEDIA_PAUSE:()=>W,MEDIA_PLAYING:()=>H,MEDIA_PROGRESS:()=>D,MEDIA_PROVIDER_CHANGE:()=>Q,MEDIA_REWIND:()=>ie,MEDIA_SEEKED:()=>q,MEDIA_SEEKING:()=>Y,MEDIA_SUBTITLES_LIST_CHANGED:()=>K,MEDIA_SUBTITLE_TRACK_CHANGED:()=>X,MEDIA_TIMEUPDATE:()=>R,MEDIA_TRAFFIC_SAVING_CHANGED:()=>v,MEDIA_VOLUMECHANGE:()=>B,MEDIA_WAITING:()=>G,NEXT_TIMER_RESET:()=>S,NEXT_TIMER_START:()=>f,PIP_CHANGE:()=>j,QUALITIES_FPS_LIST_CHANGE:()=>l,QUALITIES_LIST_CHANGE:()=>d,QUALITY_CHANGE:()=>m,SEEK:()=>y,SPEED_CHANGE:()=>F,STATE_CHANGE:()=>a,SUBSCRIBED:()=>A,SUBTITLES_LIST_CHANGED:()=>u,SUBTITLE_CUE_CHANGE:()=>_,SUBTITLE_TRACK_CHANGED:()=>g,TIME_CODES_CHANGE:()=>T,UI_ACTION_BUTTON_CLICKED:()=>ce,UI_ACTION_BUTTON_SHOWN:()=>ue,UI_CONTROLS_HIDE:()=>ae,UI_CONTROLS_SHOW:()=>de,UI_IN_VIEWPORT:()=>pe,UI_SEEKEND:()=>ne,UI_SEEKSTART:()=>se,UI_SUBTITLES_ENABLED_FROM_BTN:()=>le,UI_TOUCHED_BY_USER:()=>he,VIDEO_ADD:()=>k,VIDEO_BOOKMARK:()=>P,VIDEO_CHAT_HIDDEN:()=>Ie,VIDEO_CHAT_SHOWN:()=>Se,VIDEO_LIKE:()=>w,VIDEO_SHARE:()=>E,_DEINIT_VIDEO:()=>r,_DESTROY:()=>n,_INIT_VIDEO:()=>o,_RESIZE:()=>s});const o="_initVideo",r="_deinitVideo",s="_resize",n="_destroy",a="stateChange",d="qualitiesListChange",l="qualitiesFpsListChange",c="audioLanguagesChange",u="subtitlesListChanged",h="chromecastStateChanged",p="chromecastDeviceNameChanged",m="qualityChange",v="trafficSavingChanged",g="subtitleTrackChanged",_="subtitleCueChange",C="fullscreenChange",y="seek",b="beforeExpand",I="expanded",S="nextTimerReset",f="nextTimerStart",w="videoLike",E="videoShare",k="videoAdd",P="videoBookmark",A="subscribed",L="livePhaseChange",x="liveDonation",M="liveDurationChange",O="liveTime",T="timeCodesChange",V="audioTracksChange",F="speedChange",j="pipChange",R="media.timeupdate",D="media.progress",B="media.volumechange",N="media.muted",U="media.durationchange",G="media.waiting",H="media.playing",W="media.pause",z="media.ended",$="media.error",Y="media.seeking",q="media.seeked",K="media.subtitles.list.changed",X="media.subtitle.track.changed",Q="media.providerChange",J="media.liveRewind",Z="media.dashZeroTimeChange",ee="media.firstBytes",te="media.firstFrame",ie="media.rewind",oe="media.hlsLevelLoaded",re="media.hlsFragLoaded",se="ui.seekstart",ne="ui.seekend",ae="ui.controlsHide",de="ui.controlsShow",le="ui.subtitlesEnabledFromBtn",ce="ui.actionButtonClicked",ue="ui.actionButtonShown",he="ui.touchedByUser",pe="ui.inViewport",me="ads.waiting",ve="ads.timeRemained",ge="ads.linearStarted",_e="ads.linearCompleted",Ce="ads.overlayStarted",ye="ads.overlayCompleted",be="ads.request",Ie="videoChat.hidden",Se="videoChat.shown",fe="interactive.chapterChanged",we="interactive.chapterChangedAfter",Ee="interactive.error",ke="interactive.graphToggled",Pe="interactive.graphWatchAgainClicked",Ae="interactive.controlClicked",Le="interactive.interactiveEventTriggered",xe="interactive.interactiveHasPrevChapter",Me="interactive.prepared",Oe="interactive.interactiveContainerFakeRemoved",Te="autoplaySoundProhibited"},583022:(e,t,i)=>{function o(e){const t=new XMLHttpRequest;return{promise:new Promise(((i,o)=>{t.onload=()=>{i({response:t.responseText,details:t})},t.onerror=()=>{o(new Error("Request failed"))},t.onabort=()=>{o(new Error("Request aborted"))},t.open("GET",e),t.send()})),abort:()=>{t.abort()}}}i.d(t,{request:()=>o})},168066:(e,t,i)=>{i.d(t,{initApi:()=>n});var o=i(367375),r=i(865322),s=i(277495);const n=()=>{window.vkApi||i._dG("vkApi",{api:r.api,login:s.login,setLoginConfig:s.setLoginConfig,setApiConfig:r.setApiConfig,removeLoginCache:o.removeLoginCache})}},864448:(e,t,i)=>{i.d(t,{setApiConfig:()=>r,setLoginConfig:()=>o});const o=e=>window.vkApi?window.vkApi.setLoginConfig(e):console.error("[VKJS]: setLoginConfig didn't allowed. Use makeAuthAndApiGlobal function"),r=e=>window.vkApi?window.vkApi.setApiConfig(e):console.error("[VKJS]: setApiConfig didn't allowed. Use makeAuthAndApiGlobal function")},914421:(e,t,i)=>{i.d(t,{default:()=>r});var o=i(558137);const r=new class{initCallback(){i._dG("cur",window.cur||{}),window.cur.clearVKMiniAppsLayerPopups=this.clearLayerPopups.bind(this)}get vkMiniAppsStack(){return(0,o.makeSharedState)("MiniAppsModalsStack",(()=>[]),{version:0})()}get modalCount(){return this.vkMiniAppsStack.length}push(e){e.init(),0===this.modalCount&&e.show(),this.vkMiniAppsStack.push(e)}clearLayerPopups(){if(this.modalCount>0){const e=this.vkMiniAppsStack.filter((e=>"appNode"in e&&!e.appNode.id.includes("container_layer")));this.vkMiniAppsStack.splice(0,this.modalCount),this.vkMiniAppsStack.push(...e)}}pop(e){const t=this.vkMiniAppsStack.indexOf(e);-1!==t&&(this.vkMiniAppsStack.splice(t,1),this.checkForNext())}shift(){this.vkMiniAppsStack.shift(),this.checkForNext()}checkForNext(){this.modalCount>0&&this.vkMiniAppsStack[0].show()}constructor(){this.initCallback()}}},643401:(e,t,i)=>{i.d(t,{MvkModalRoot:()=>s});var o=i(474848),r=i(220208);const s=e=>(0,o.jsx)(r.SplitLayout,{modal:e.children})},729477:(e,t,i)=>{i.d(t,{ModalRoot:()=>m,WebModalRoot:()=>p});var o=i(474848),r=i(296540),s=i(700272),n=i(234430),a=i(142278),d=i(8520),l=i(19999),c=i(575753),u=i(898848),h=i(581197);const p=e=>(0,o.jsx)(r.Suspense,{fallback:(0,o.jsx)(s.Spinner,{size:"regular"}),children:e.children});class m extends n.UIAction{updatesCoordinates(){if(this.modal&&this.modalContainer){const e=window.innerHeight||document.documentElement.clientHeight||this.modal.offsetHeight,t=c.browser.mobile?(0,u.intval)(window.scrollY):0,i=(0,h.getSize)(this.modalContainer);this.modalContainer.style.marginTop=Math.max(10,t+(e-i[1])/3)+"px"}}destroy(){this.reactInitiator.unmount(),this.props?.containerId||this.modal?.parentElement?.remove(),super.destroy()}addScroll(){this.updatesCoordinates()}createContainer(){const e="message-box-root-"+(0,d.getRandomString)(6),t=document.createElement("div");return t.id=e,document.body.appendChild(t),t}createModalLayer(){const e=document.createElement("div"),t=document.createElement("div");return e.classList.add(l.default.layerOuter),t.classList.add(l.default.layerIn),e.append(t),[e,t]}renderModal(){if(!this.ModalComponent)return;[this.modal,this.modalContainer]=this.createModalLayer();(document.querySelector(`#${this.props?.containerId}`)||this.createContainer()).append(this.modal),this.reactInitiator=(0,a.createReactInitiator)(this.ModalComponent,this.modalContainer),this.reactInitiator.render({...this.modalProps,updateCoordinates:this.updatesCoordinates.bind(this)}),this.applyRenderOptions()}applyRenderOptions(){if(!this.modal)return;const{horizontalPadding:e,verticalPadding:t,width:i,maxWidth:o,fixed:r,zIndex:s}=this.props;this.modal&&r&&this.modal.classList.add(l.default.outerFixed),e&&this.modal.style.setProperty("--modal-horizontal-padding",e),t&&this.modal.style.setProperty("--modal-vertical-padding",t),i&&this.modal.style.setProperty("--modal-width",i),o&&this.modal.style.setProperty("--modal-max-width",o),s&&this.modal.style.setProperty("--modal-z-index",s)}constructor(e,t,i){super(e,null),this.ModalComponent=t,this.modalProps=i,this.renderModal()}}},50175:(e,t,i)=>{i.d(t,{useModalData:()=>o.useModalData,useModalProps:()=>r.useModalProps});var o=i(845991),r=i(494517)},845991:(e,t,i)=>{i.d(t,{useModalData:()=>n});var o=i(293721),r=i(695066),s=i(540462);const n=()=>(0,o.useStore)((0,s.partConfigEnabled)("mini_apps_sdk_together_several_modals")?(0,r.ensureBridgeModalsService)().$modalData:(0,r.ensureBridgeModalsService)().$modalDataOld)},494517:(e,t,i)=>{i.d(t,{useModalProps:()=>n});var o=i(296540),r=i(845991),s=i(540462);const n=(e,t)=>{const i=(0,r.useModalData)(),n=i[t];return(0,o.useMemo)((()=>({...e,...(0,s.partConfigEnabled)("mini_apps_sdk_together_several_modals")?{data:n?.data,actions:n?.actions}:{data:i}})),[n?.data,i])}},534100:(e,t,i)=>{i.d(t,{LazyModalComponent:()=>v,ensureBridgeModalsService:()=>l.ensureBridgeModalsService,registerModalRenderer:()=>m,showBridgeModalBox:()=>g,showModalBox:()=>C,useModalData:()=>p.useModalData,useModalProps:()=>p.useModalProps});var o=i(474848),r=i(865708),s=i(302032),n=i(105330),a=i(142278),d=i(914421),l=i(695066),c=i(643401),u=i(729477),h=i(898848),p=i(50175);const m=e=>{const{setRenderFunction:t,resetModalData:i}=(0,l.ensureBridgeModalsService)();t(((t,o)=>{const r=(0,a.createReactInitiator)(e),s={unmount:()=>{r.unmount(),i(o)},modalId:o};r.render({modalParams:t,modalOptions:s})}))},v=({modalParams:e,loader:t,modalOptions:i,loading:r})=>{const{type:n}=e,a=(0,s.lazyModule)({loader:t(n),name:n});return(0,o.jsx)(a,{loading:r,modalParams:e,modalOptions:i})};function g(e){const t=(0,l.ensureBridgeModalsService)(),{showModal:i,updateModalData:o}=t,r=`${e.type}${(0,h.srand)()}`;return o({data:e.data??{},actions:e.actions??{},modalId:r,force:!0}),i({modalParams:e,modalId:r}),e=>o({data:e?.data??{},modalId:r})}const _=e=>t=>{const i=(0,n.isMvk)()?c.MvkModalRoot:u.WebModalRoot;return(0,o.jsx)(r.AppRootProvider,{children:(0,o.jsx)(i,{onClose:t.onClose,children:(0,o.jsx)(e,{...t})})})};function C(e,t,i){const o=_(e),r=(0,n.isMvk)()?function(e){return(0,a.createReactInitiator)(e)}(o):function(e,t={}){return{render(i){this.modalRoot=new u.ModalRoot(t,e,i),d.default.push(this.modalRoot)},unmount(){d.default.pop(this.modalRoot),this.modalRoot.destroy()}}}(o,i);return new Promise(((e,i)=>{r.render({...t||{},onClose:()=>{t?.onClose?.(),r.unmount(),e(null)},onDone:i=>{t?.onDone?.(i),r.unmount(),e(i)},onError:e=>{t?.onError?.(e),r.unmount(),i(e)}})}))}},572560:(e,t,i)=>{i.d(t,{domain:()=>o});const o=(0,i(32489).createDomain)("MINI_APPS/BRIDGE_MODAL")},695066:(e,t,i)=>{i.d(t,{ensureBridgeModalsService:()=>a});var o=i(558137),r=i(572560),s=i(32489),n=i(540462);const a=(0,o.makeSharedState)("global/bridgeModals",(()=>(({domain:e})=>{const t=e.createStore({}),i=e.createStore({}),o=e.createStore(null,{name:"renderFunction"}),r=e.createEvent("updateModalData"),a=e.createEvent("resetModalData"),d=e.createEvent("setRenderFunction"),l=e.createEvent("showModal"),c=e.createEffect({name:"showModalFx",handler:({modalParams:e,renderFunction:t,modalId:i})=>{t?.(e,i)}});return(0,s.sample)({clock:r,source:t,fn:(e,{data:t,force:i,actions:o={},modalId:r})=>{const s=e[r],n=i||!s?{data:t,actions:o}:{data:{...s?.data,...t},actions:s?.actions};return{...e,[r]:n}},target:t,filter:()=>(0,n.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),(0,s.sample)({clock:r,source:i,fn:(e,{data:t,force:i})=>i?t:{...e,...t},target:i,filter:()=>!(0,n.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),(0,s.sample)({clock:d,target:o}),(0,s.sample)({clock:l,source:o,fn:(e,{modalParams:t,modalId:i})=>({modalParams:t,renderFunction:e,modalId:i}),target:c}),(0,s.sample)({clock:a,source:t,fn:(e,t)=>{const i={...e};return delete i[t],i},target:t,filter:()=>(0,n.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),(0,s.sample)({clock:a,source:i,fn:()=>({}),target:i,filter:()=>!(0,n.partConfigEnabled)("mini_apps_sdk_together_several_modals")}),{$modalData:t,$modalDataOld:i,$renderFunction:o,updateModalData:r,resetModalData:a,setRenderFunction:d,showModal:l}})({domain:r.domain})),{version:1})},44755:(e,t,i)=>{i.d(t,{HASHTAG_ENTITIES_ALL:()=>d,HASHTAG_ENTITIES_NEW:()=>l,RE_HASHTAG_EXTRACTION_PATTERN:()=>a,RE_HASHTAG_EXTRACTION_PATTERN_NEW:()=>u});var o=i(175819);const r="a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’",s="(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)",n=`(?:[${r}_\\d]|${s})`,a=`(^|[s.,:'";>)(]?)(${`(#${n}{0,100}${`(?:[${r}]|${s})`}${n}{0,100})`})(@${o.RE_DOMAIN_PATTERN})?(?=$|[s.,:'"&;?<)(]?)`,d="&#(\\d{3,5});",l="(?:&#\\d{3,5};)",c=`(?:[${r}_\\d]|${l})`,u=`(^|[s.,:'";>)(]?)(${`(#${c}{0,100}${`(?:[${r}]|${l})`}${c}{0,100})`})(@${o.RE_DOMAIN_PATTERN})?(?=$|[s.,:'"&;?<)(]?)`},515360:(e,t,i)=>{i.d(t,{formatCommentText:()=>d});var o=i(839348),r=i(302451),s=i(148636),n=i(898848),a=i(573859);const d=(e,t=!1)=>{let i=(0,n.clean)(e);return i=(0,r.replaceFreeMention)(i,((e,t)=>`<a href="${e}" rel="noreferrer noopener" target="_blank" data-testid="free-mention-link">${t}</a>`)),i=(0,s.replaceHyperLinks)(i,s.linksReplacer),i=(0,o.replaceMentions)(i),t&&(i=(0,a.emojiToHTML)(i,!0)),i}},256252:(e,t,i)=>{i.d(t,{hydrateComponent:()=>n});var o=i(474848),r=i(440961),s=i(384483);function n({component:e,descriptor:t}){const{data:i,target:n}=t.payload,{selector:a}=t;n&&n instanceof HTMLElement&&((0,s.registerReactApplication)(a,(t=>{r.render((0,o.jsx)(e,{...t}),n)})),window.initReactApplication(a,i))}},145697:(e,t,i)=>{i.d(t,{classNames:()=>o.classNames});var o=i(8520)},902235:(e,t,i)=>{i.d(t,{useLazyLoad:()=>s});var o=i(296540),r=i(150585);const s=(e,t,i=window,s)=>{(0,o.useEffect)((()=>{let o;if(i)return e?(o=(0,r.throttle)((()=>{const e=i instanceof Window?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight):Math.max(i.scrollHeight,i.clientHeight),o=i instanceof Window?document.documentElement.clientHeight:i.clientHeight,r=i instanceof Window?i.scrollY:i.scrollTop,n=o+r,a=Math.max(e-2*o,0);(!s&&n>=a||s&&r<o/2)&&t?.()}),34),o(),i.addEventListener("scroll",o)):o&&i.removeEventListener("scroll",o),()=>{o&&i.removeEventListener("scroll",o)}}),[e,t,i,s])}},317835:(e,t,i)=>{i.d(t,{formatFileSize:()=>l});var o=i(866467),r=i(8520);const s=1024,n=Math.pow(s,2),a=Math.pow(s,3),d=Math.pow(s,4);function l(e){let t=0,i="";return e>d?(t=Math.round(e/d*1e3)/1e3,i=(0,o.getLang)("global_tb")):e>a?(t=Math.round(e/a*100)/100,i=(0,o.getLang)("global_gb")):e>n?(t=Math.round(e/n*10)/10,i=(0,o.getLang)("global_mb")):(t=Math.round(e/s),i=(0,o.getLang)("global_kb")),`${(0,r.formatNumber)(t)} ${i}`}},539375:(e,t,i)=>{i.d(t,{getScreenNameFromUrl:()=>o});const o=e=>{const t=e.match(/\/@([^/]+)/);return t?.[1]??null}},485910:(e,t,i)=>{i.d(t,{replaceHashtags:()=>d});var o=i(44755),r=i(540462);let s;const n=[[192,1399],[12352,12543],[19968,40959],[44032,55215]];function a(e){const t=e.match(o.HASHTAG_ENTITIES_ALL)?.[1];if(!t)return!1;const i=parseInt(t);for(const e of n)if(i>=e[0]&&i<=e[1])return!0;return!1}function d(e,t){return e.replace((s||(s=(0,r.partConfigEnabled)("new_hashtags_parser")?new RegExp(o.RE_HASHTAG_EXTRACTION_PATTERN_NEW,"ig"):new RegExp(o.RE_HASHTAG_EXTRACTION_PATTERN,"ig")),s),((e,i,s,n,d)=>{let l="";if((0,r.partConfigEnabled)("new_hashtags_parser")){const e=s.matchAll(new RegExp(o.HASHTAG_ENTITIES_NEW,"ig"));for(const t of e){const[e]=t;if(!a(e)){l=s.slice(t.index),s=s.slice(0,t.index);break}}}return"#"===s?(i||"")+s+(d||"")+l:(i||"")+t(s+(d||""),s)+l}))}},153078:(e,t,i)=>{i.d(t,{setEndOfContentEditable:()=>r});var o=i(298077);const r=e=>{const t=window.getSelection();t?(t.selectAllChildren(e),t.collapseToEnd()):(0,o.logError)(new Error("setEndOfContentEditable: 'selection' must not be null or undefined"))}},835426:(e,t,i)=>{i.d(t,{getPlayFromByDuration:()=>o});const o=e=>{let t="";const i=Math.floor(e/3600);i&&(t+=`${i}h`);const o=Math.floor(e%3600/60);o&&(t+=`${o}m`);const r=e%60;return r&&(t+=`${r}s`),t}},346568:(e,t,i)=>{i.d(t,{Skeleton:()=>a});var o=i(474848),r=(i(296540),i(145697));const s={default:"SkeletonIso--borderRadiusDefault",paper:"SkeletonIso--borderRadiusPaper",promo:"SkeletonIso--borderRadiusPromo"};function n(e){return"string"==typeof e&&Object.keys(s).includes(e)}const a=({className:e,width:t,height:i,children:a,borderRadius:d,circle:l,colorFrom:c,colorTo:u,noAnimation:h=!1,duration:p,fontSize:m,noShrink:v})=>{const g={},_=a;t&&(g.width=t),i&&(g.height=i),m&&(g.fontSize=m),void 0===d||n(d)||(g.borderRadius=d),l&&(g.borderRadius="50%",g.width&&!g.height&&(g.height=g.width),g.height&&!g.width&&(g.width=g.height)),c&&(g["--skeleton-from"]=c),u&&(g["--skeleton-to"]=u),p&&(g["--animation-duration"]=`${p}s`);const C=!!a||!g.height||!g.width;return(0,o.jsx)("span",{className:(0,r.classNames)("SkeletonIso",h&&"SkeletonIso--noAnimation",v&&"SkeletonIso--noShrink",n(d)&&s[d],e),"data-testid":"loading-skeleton","aria-live":"polite","aria-busy":!h,style:g,children:C&&(0,o.jsx)("span",{className:"SkeletonIso__in",children:_})})}},17333:(e,t,i)=>{i.d(t,{StrikeForbidObjectForm:()=>S});var o=i(474848),r=i(296540),s=i(866467),n=i(454919),a=i(454154),d=i(524378),l=i(44544),c=i(387960),u=i(220208),h=i(945206),p=i(944048),m=i(469004),v=i(246429),g=i(540462),_=i(717433),C=i(683234),y=i(538522);const b="strike_system.php",I="https://vk.com/helpdesk?act=show&id=";class S extends r.Component{submit(){if(""!==this.state.comment||10!==this.state.selectedReason)if(""!==this.state.link_to_ticket||!(0,g.partConfigEnabled)("strike_system_delete_with_reason_support")||(0,g.partConfigEnabled)("strike_system_delete_with_reason"))if(0!=this.state.selectedReason){if(this.setState({isLoading:!0}),!this.state.for_copyright_holders_empty){const e={act:"object_delete",owner_id:this.props.objectOwnerId,object_id:this.props.objectId,object_type:this.props.objectType,reason_id:this.state.selectedReason,claim_id:10===this.state.selectedReason?this.state.claimId:0,link_to_ticket:this.state.link_to_ticket,dmca_comment:this.state.comment,only_withdrawal:10===this.state.selectedReason&&0!==this.state.claimId&&this.state.only_withdrawal_checked?1:0,strike:this.state.strike_community_checked?1:0};switch(this.props.objectType){case 7:const e=document.getElementById("post"+this.props.objectOwnerId+"video_"+this.props.objectId+"mv");e&&e.setAttribute("data-action","delete");break;case 10:const t=document.getElementById("post"+this.props.objectOwnerId+"_"+this.props.objectId);window.cur.topicMyDeleted[this.props.objectOwnerId+"_"+this.props.objectId]=1,t&&t.classList.add("bp_loading")}window.ajax.post(b,e,{onDone:(e,t,o)=>{if(e){switch(this.props.objectType){case 12:case 13:case 1:if((0,g.partConfigEnabled)("video_playlist_page_redesign")){const e={videoId:this.props.objectId,ownerId:this.props.objectOwnerId};window.dispatchEvent(new CustomEvent("video_deleted",{detail:e}))}const e=document.getElementById("mv_info");if(!e)break;(0,g.partConfigEnabled)("video_remove_restore_video_act")&&Promise.all([i.e(73538),i.e("langs/web/video_restore_button")]).then(i.bind(i,69727)).then((({initVideoRestoreButton:e})=>{const{objectId:t,objectOwnerId:i}=this.props,o=(0,y.joinRawId)({itemId:t,ownerId:i}),r=document.getElementById(`video-restore-button-widget-${o}-videoviewer`),s=window.Videoview;e(r,{videoId:t,ownerId:i,onClick:()=>{const e=document.getElementById("mv_warning");e&&(e.innerHTML="",(0,C.showProgress)(e,"","pr_medium"))},onRestore:()=>s?.onRestoreVideo(t,i,"videoviewer"),isVideoModal:!0})})),e.classList.contains("mv_info_invisible")||e.classList.add("mv_info_invisible");const o=document.getElementById("mv_warning");null!=o&&(o.innerHTML=t,o.style.display="block");const r=document.getElementById("mv_publish");null!=r&&(r.style.display="none");break;case 2:if(window.Photoview&&window.cur){const e=window.cur,i=window.Photoview,o=e.pvListId,r=e.pvIndex,n=e.pvData[o][r];i.toggleTopInfoPanel((0,s.getLang)("photo_deleted"),t),n.deleted=[e.pvTagInfoText.innerHTML,e.pvTagInfoButtons.innerHTML],i.toggleDeletedState(!0),i.updatePhotoDimensions()}break;case 3:if(window.Wall){const e=window.Wall,i=this.props.objectOwnerId+"_"+this.props.objectId;e.postShowDeletedMessage(i,t)}break;case 4:window.WkView?.hide?.(),(0,_.dispatchItemDeleteEvent)(),(0,v.showDoneBox)((0,s.getLang)("market_item_deleted"));break;case 6:const n=window.Photoview,a=document.getElementById("post"+this.props.objectOwnerId+"photo_"+this.props.objectId);n.commDone(a,t,!0,"");break;case 8:if(window.Wall){const e=window.Wall,i=this.props.objectOwnerId+"_"+this.props.objectId;e.postShowDeletedMessage(i,t)}break;case 7:if(!(0,g.partConfigEnabled)("video_modal_tree_comments")||!(0,g.partConfigEnabled)("video_page_tree_comments")){window.Videoview.commActionDone(this.props.objectOwnerId+"_"+this.props.objectId,"mv",t,!0,"")}break;case 9:const d=window.Market,l=document.getElementById("post"+this.props.objectOwnerId+"market_"+this.props.objectId);d.commDone({node:l,text:t,del:!0,script:""});break;case 10:const c=document.getElementById("post"+this.props.objectOwnerId+"_"+this.props.objectId);if(c){c.classList.remove("bp_loading"),c.classList.add("bp_deleted");const e=c.querySelector(".bp_deleted_text");e&&(e.innerHTML=t)}break;case 11:const u=this.props.story;u?.removeStoryWithReason()}""!==o&&(0,v.showDoneBox)(o),(0,v.showDoneBox)(this.state.successText),this.props.onSubmit&&this.props.onSubmit(),this.props.onClose()}else switch(t){case"error_not_owner_for_ticket":this.setState({not_owner_for_ticket:!0});break;case"error_incorrect_link":this.setState({error_incorrect_link:!0});break;case"error_null_reason":(0,v.showDoneBox)((0,s.getLang)("reports_strike_system_error_null_reason"))}},onFail:()=>((0,v.showDoneBox)((0,s.getLang)("global_error")),!1),showProgress:()=>this.setState({isLoading:!0}),hideProgress:()=>this.setState({isLoading:!1})})}}else(0,v.showDoneBox)("error");else this.setState({link_to_ticket_empty:!0});else this.setState({for_copyright_holders_empty:!0})}close(){this.props.onClose()}changeReason(e){m.ls.set("strike_del_reason",e),this.setState({selectedReason:e})}getDmcaTitle(){const e={act:"get_dmca_title",claim_id:this.state.claimId};window.ajax.post(b,e,{onDone:e=>{this.setState({comment:e})},onFail:()=>((0,v.showDoneBox)((0,s.getLang)("global_error")),!1),showProgress:()=>this.setState({isLoading:!0}),hideProgress:()=>this.setState({isLoading:!1})})}componentDidMount(){0!==this.state.claimId&&(this.getDmcaTitle(),this.setState({link_to_ticket:I+this.state.claimId}));window.ajax.post(b,{act:"get_reasons"},{onDone:e=>{this.setState({reasons:e.reasons});const t=m.ls.get("strike_del_reason"),i=m.ls.get("strike_system_only_withdrawal");this.setState({only_withdrawal_checked:i}),0===this.state.claimId&&window.nav?.objLoc?.claim&&(this.setState({claimId:window.nav.objLoc.claim,link_to_ticket:I+window.nav.objLoc.claim}),this.getDmcaTitle()),0!==this.state.claimId&&-1!==this.state.reasons.findIndex((e=>10===e.key))?this.setState({selectedReason:10}):this.setState({selectedReason:t})},onFail:()=>((0,v.showDoneBox)("error"),!1),showProgress:()=>this.setState({isLoading:!0}),hideProgress:()=>this.setState({isLoading:!1})})}render(){const e=this.state.reasons,t=0!==this.state.claimId&&10===this.state.selectedReason&&1===this.props.objectType,i=10===this.state.selectedReason,r=(0,g.partConfigEnabled)("strike_system_delete_with_reason_support");return(0,o.jsx)(n.ModalBoxFast,{header:(0,s.getLang)("reports_strike_system_delete_with_reason"),onClose:this.props.onClose,closeAriaLabel:"Закрыть",actions:[(0,o.jsx)(a.Button,{size:"m",mode:"secondary",onClick:this.close,loading:this.state.isLoading,children:(0,s.getLang)("reports_strike_system_button_cancel")},"0"),(0,o.jsx)(a.Button,{size:"m",mode:"primary",onClick:this.submit,loading:this.state.isLoading,children:(0,s.getLang)("reports_strike_system_button_delete")},"1")],children:(0,o.jsxs)(d.FormLayout,{children:[(0,o.jsx)(l.FormItem,{top:(0,s.getLang)("reports_strike_system_label_select_reason"),children:e.map((e=>(0,o.jsx)(c.Radio,{checked:this.state.selectedReason===e.key,name:"reason",value:e.key,onChange:()=>{this.changeReason(e.key)},children:e.label},e.key)))}),r&&(0,o.jsx)(l.FormItem,{top:(0,s.getLang)("reports_strike_system_for_support_agent_label"),id:"for_support_agent",status:this.state.link_to_ticket_empty||this.state.not_owner_for_ticket||this.state.error_incorrect_link?"error":"default",bottom:this.state.link_to_ticket_empty?(0,s.getLang)("reports_strike_system_for_support_agent_error"):this.state.not_owner_for_ticket?(0,s.getLang)("reports_strike_system_for_support_agent_not_owner_error"):this.state.error_incorrect_link?(0,s.getLang)("reports_strike_system_error_incorrect_link"):"",children:(0,o.jsx)(u.Input,{id:"link_to_ticket",type:"text",placeholder:"https://vk.com/helpdesk?act=show&id=XXXXXXX",value:this.state.link_to_ticket,onChange:e=>{this.setState({link_to_ticket:e.target.value}),this.state.link_to_ticket_empty&&this.setState({link_to_ticket_empty:!1}),this.state.not_owner_for_ticket&&this.setState({not_owner_for_ticket:!1})}})}),i&&(0,o.jsx)(l.FormItem,{top:(0,s.getLang)("reports_strike_system_strike_textarea_label"),id:"for_copyright_holders",status:this.state.for_copyright_holders_empty?"error":"default",bottom:this.state.for_copyright_holders_empty?(0,s.getLang)("reports_strike_system_strike_textarea_error"):"",children:(0,o.jsx)(h.Textarea,{id:"txt_for_copyright_holders",value:this.state.comment,onChange:e=>{this.setState({comment:e.target.value}),this.state.for_copyright_holders_empty&&this.setState({for_copyright_holders_empty:!1})}})}),(0,o.jsxs)(l.FormItem,{bottom:(0,s.getLang)("reports_strike_system_strike_checkbox_desc"),children:[t&&(0,o.jsx)(p.Checkbox,{name:"only_withdrawal",defaultChecked:this.state.only_withdrawal_checked,onChange:e=>{this.setState({only_withdrawal_checked:e.target.checked}),m.ls.set("strike_system_only_withdrawal",e.target.checked)},children:"Только изьятие"}),(0,o.jsx)(p.Checkbox,{name:"strike_community",defaultChecked:this.state.strike_community_checked,onChange:e=>{this.setState({strike_community_checked:e.target.checked}),m.ls.set("strike_system_strike_community",e.target.checked)},children:(0,s.getLang)("reports_strike_system_strike_checkbox")})]})]})})}constructor(e){super(e),this.props=e;const t=m.ls.get("strike_system_strike_community");this.state={successText:"Успешно",reasons:[],selectedReason:0,claimId:this.props.claimId?this.props.claimId:0,comment:"",isLoading:!1,for_copyright_holders_empty:!1,link_to_ticket:document.referrer.includes("vk.com/helpdesk?act=show&id=")?document.referrer:"",link_to_ticket_empty:!1,error_incorrect_link:!1,not_owner_for_ticket:!1,only_withdrawal_checked:!1,strike_community_checked:null!==t&&t},this.submit=this.submit.bind(this),this.close=this.close.bind(this),this.changeReason=this.changeReason.bind(this),this.getDmcaTitle=this.getDmcaTitle.bind(this)}}},986918:(e,t,i)=>{i.d(t,{fixVideoPlayerScrollPopover:()=>o});const o={onShownChange:e=>{if(e){const e=window.Videoview?.getPlayerObject();e?.el&&(e.el.scrollTop=0)}},restoreFocus:!1}},267377:(e,t,i)=>{i.d(t,{PlaylistCheckbox:()=>u});var o=i(474848),r=i(293721),s=i(335797),n=i(361121),a=i(944048),d=i(412888),l=i(231867),c=i(134128);const u=({playlistId:e,videoId:t,videoPlaylistsModalService:i})=>{const u=(0,s.useEntitiesStore)(i.$entitiesPlaylists,e),{itemId:h}=(0,n.splitRawId)(e),p=(0,l.useVideoInPlaylist)(i.$entitiesVideoBinding,t,h),m=(0,r.useEvent)(i.toggleBindingEvent);return u?(0,o.jsx)(a.Checkbox,{checked:p,onChange:()=>m({album_id:h,video_id:t}),titleAfter:(0,o.jsx)(c.PlaylistCheckboxTooltip,{privacy:u?.privacy?.category}),children:(0,o.jsx)(d.TextClamp,{lines:1,children:u.title})}):null}},134128:(e,t,i)=>{i.d(t,{PlaylistCheckboxTooltip:()=>l});var o=i(474848),r=i(866467),s=i(373206),n=i(562791),a=i(578392),d=i(107528);const l=({privacy:e})=>{const t=(()=>{switch(e){case"all":return{Icon:s.Icon16UnlockOutline,text:(0,r.getLang)("video_playlist_available_to_all_tooltip")};case"only_me":return{Icon:n.Icon16LockOutline,text:(0,r.getLang)("video_playlist_private_tooltip")};default:return}})();if(!t)return null;const{Icon:i,text:l}=t;return(0,o.jsx)(a.TextTooltip,{placement:"top",appearance:"black",offsetByCrossAxis:-56,offsetByMainAxis:4,text:l,children:(0,o.jsx)(i,{className:d.default.playlistPrivateIcon})})}},198258:(e,t,i)=>{i.d(t,{PlaylistCheckbox:()=>o.PlaylistCheckbox});var o=i(267377);i(134128)},889177:(e,t,i)=>{i.d(t,{showPlaylistsModal:()=>M});var o=i(474848),r=i(293721),s=i(296540),n=i(884945),a=i(468073),d=i(694244),l=i(782174),c=i(63614),u=i(944048),h=i(194528),p=i(582192),m=i(303800),v=i(285056),g=i(723723),_=i(299494),C=i(700272),y=i(652862),b=i(908242),I=i(454154),S=i(866467),f=i(540462),w=i(856289),E=i(902235),k=i(211413),P=i(609253),A=i(826619),L=i(198258);const x=({video:e,ownerId:t,isGroupOwner:i=!1,onClose:k,refreshCoordinates:x,videoPlaylistsModalService:M})=>{const{$videosAlbumsIds:O,$videosAlbumsLoading:T,$videoAlbumsFullyLoaded:V,$wasToggled:F,toggleBindingEvent:j,saveChangesEvent:R,fetchMorePlaylists:D,resetBindingsEvent:B,initModalEvent:N,createPlaylistEvent:U}=(0,r.useUnit)(M),[G,H]=(0,s.useState)(null);(0,s.useEffect)((()=>{x(),B()}),[]),(0,s.useEffect)((()=>{N({ownerId:t,isGroupOwner:i,videoId:e.id,videoOwnerId:e.owner_id})}),[]);const W=(0,w.useVideoInPlaylist)(M.$entitiesVideoBinding,e.id,w.MY_VIDEO_ALBUM_ID);return(0,E.useLazyLoad)(!V&&!T,D,G),(0,o.jsxs)(d.ModalBox,{height:365,children:[(0,o.jsx)(l.ModalHeader,{closeAriaLabel:(0,S.getLang)("box_cancel"),onClose:k,children:(0,S.getLang)("video_playlist_modal_header")}),(0,o.jsx)(c.ModalBody,{insetLevel:1,children:O?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Checkbox,{checked:W,disabled:Boolean(T)&&!O?.length,onChange:()=>{j({video_id:e.id,album_id:w.MY_VIDEO_ALBUM_ID})},children:i?(0,S.getLang)("video_all_groups_videos"):(0,S.getLang)("video_my_added_videos_playlist")}),(0,o.jsx)(h.Spacing,{size:8}),(0,o.jsx)(p.Separator,{}),(0,o.jsx)(h.Spacing,{size:8}),(0,o.jsx)(m.Div,{mode:"horizontal",spacing:6,children:(0,o.jsx)(v.Footnote,{className:(0,g.getColorClass)("color_text_subhead"),weight:"3",children:(0,S.getLang)("video_playlists")})}),!!O.length&&(0,o.jsxs)(_.ModalScrollView,{height:108,maxHeight:108,getRef:H,children:[!!O&&O.map((t=>(0,o.jsx)(L.PlaylistCheckbox,{playlistId:t,videoId:e.id,videoPlaylistsModalService:M},t))),(T||!O)&&(0,o.jsx)(m.Div,{mode:"horizontal",spacing:4,children:(0,o.jsx)(C.Spinner,{})})]}),(0,o.jsx)(y.CellButton,{onClick:o=>{k();const r=i?a.Ranges.convertGroupIdToOwnerId(Math.abs(t)):t;(0,f.partConfigEnabled)("video_playlist_redesign_popup")?(0,P.showPlaylistModal)({ownerId:r,onCreate:U,hasOnCreateSnackbar:!1}):(0,A.createPlaylistPopup)({event:o,ownerId:r,videoId:e.id,videoOwnerId:e.owner_id,requestOrigin:A.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL}).catch()},before:(0,o.jsx)(n.Icon28AddOutline,{}),children:(0,S.getLang)("video_add_video_to_new_playlist")}),!O.length&&(0,o.jsx)(h.Spacing,{size:106})]}):(0,o.jsxs)(m.Div,{mode:"horizontal",children:[(0,o.jsx)(h.Spacing,{size:104}),(0,o.jsx)(C.Spinner,{}),(0,o.jsx)(h.Spacing,{size:104})]})}),(0,o.jsx)(b.ModalFooter,{actions:[(0,o.jsx)(I.Button,{mode:"secondary",size:"m",onClick:k,children:(0,S.getLang)("box_cancel")},1),(0,o.jsx)(I.Button,{mode:"primary",size:"m",onClick:()=>{R(),k()},disabled:!F,children:(0,S.getLang)("Save")},2)]})]})},M=({onDestroy:e,ownerId:t,isGroupOwner:i,video:r,videoPlaylistsModalService:s})=>{(0,k.showMessageBoxModal)((e=>(0,o.jsx)(x,{ownerId:t,isGroupOwner:i,video:r,videoPlaylistsModalService:s,...e})),{onDestroy:e,width:420})}},575312:(e,t,i)=>{i.d(t,{showPlaylistsModal:()=>o.showPlaylistsModal});var o=i(889177)},615494:(e,t,i)=>{i.d(t,{MY_COMMUNITIES_MENU_ITEM_ID:()=>u,VIDEO_AUTHORS_LANDING_URL:()=>a,VIDEO_LIVES_CATEGORIES_URL:()=>c,VIDEO_LIVES_URL:()=>d,VIDEO_LIVES_URL_WITHOUT_BACKSLASH:()=>l,VIDEO_REORDER_PLAYLIST_ALBUM_FIX:()=>h,VIDEO_SHOWCASE_REFRESH_SECTION_VIDEO_LIST_EVENT:()=>n,VIDEO_SHOWCASE_SCROLL_TO_TOP_BUTTON_CHANGE_ACTIVITY_EVENT:()=>r,VIDEO_SHOWCASE_WATCH_LATER_TOOLTIP_VIEWED_EVENT:()=>s});var o=i(856289);const r="video showcase scroll to top button change activity",s="video showcase watch later tooltip viewed event",n="video showcase refresh section video list event",a="https://vk.com/video_faq",d=`${(0,o.getVideoPrefix)("doubleSlash")}lives`,l=`${(0,o.getVideoPrefix)("backSlash")}lives`,c=`${d}/categories`,u="main_menu_my_communities",h="video_reorder_playlist_album_fix"},72053:(e,t,i)=>{i.d(t,{addPlaylistVideo:()=>s});var o=i(450927),r=i(826619);const s=async(e,{owner_id:t,id:i})=>{window.VideoUpload||await(0,o.getVideoUploadModule)(),(0,r.uploadVideoPopup)(t,`${i}`,"1")}},243885:(e,t,i)=>{i.d(t,{copyPlaylistUrl:()=>r});var o=i(29593);const r=(e,{owner_id:t,id:i})=>(0,o.copyPlaylistUrl)({owner_id:t,id:i})},564756:(e,t,i)=>{i.d(t,{createClipFromVideo:()=>s});var o=i(450927),r=i(191792);const s=async(e,t)=>{const{id:i,owner_id:s}=t;i&&s&&(window.VideoUpload||await(0,o.getVideoUploadModule)(),window.VideoUpload.showVideoToClip(null,r.EEntryPointName.VideoToClip,{ownerId:s,videoId:i}))}},761986:(e,t,i)=>{i.d(t,{downloadVideo:()=>d});var o=i(538522),r=i(317216),s=i(636576),n=i(761520),a=i(29593);const d=(e,{id:t,owner_id:i,title:d,type:l,track_code:c})=>{d&&l&&(n.ajax.post("al_video.php?act=get_download_url",{video_raw_id:(0,o.joinRawId)({ownerId:i,itemId:t})},{onDone:e=>{(({url:e,title:t,type:i})=>{if(!e)return!1;const o=document.createElement("a");o.href=e,o.download=`${t}.mp4`,document.body.appendChild(o),o.click(),document.body.removeChild(o),(0,s.statlogsValueEvent)("video_downloads","",i)})({title:d,type:l,url:e})}}),(0,a.logDownloadClick)(r.EventItemType.VIDEO,c))}},952671:(e,t,i)=>{i.d(t,{editPlaylistById:()=>r});var o=i(134551);const r=(e,t,i)=>{o.Video.editAlbum(t,e,i,!0)}},817182:(e,t,i)=>{i.d(t,{editVideo:()=>n});var o=i(538522),r=i(270959),s=i(768797);const n=(e,{owner_id:t,id:i,type:n},a)=>{(0,r.showBox)("al_video.php?act=edit_box",{vid:i,oid:t,is_short_video:"short_video"===n?1:0},{containerClass:"video_edit",params:{onHide:()=>{s.entitiesVideoService.videoGetByIdFx({id:(0,o.joinRawId)({ownerId:t,itemId:i}),extended:1,group_id:a?.groupId})}}})}},950885:(e,t,i)=>{i.d(t,{addPlaylistVideo:()=>o.addPlaylistVideo,copyPlaylistUrl:()=>r.copyPlaylistUrl,createClipFromVideo:()=>s.createClipFromVideo,downloadVideo:()=>n.downloadVideo,editPlaylistById:()=>a.editPlaylistById,editVideo:()=>d.editVideo,openPlaylist:()=>l.openPlaylist,openPlaylistFactory:()=>l.openPlaylistFactory,openPlaylistModal:()=>y.openPlaylistModal,openPlaylistPage:()=>g.openPlaylistPage,openVideo:()=>c.openVideo,openVideoExtended:()=>c.openVideoExtended,sendReport:()=>u.sendReport,sendReportExtended:()=>u.sendReportExtended,sendReportWithCallback:()=>u.sendReportWithCallback,shareVideo:()=>h.shareVideo,shareVideoExtended:()=>h.shareVideoExtended,toggleDelete:()=>p.toggleDelete,toggleFav:()=>m.toggleFav,toggleHideAuthor:()=>v.toggleHideAuthor,togglePlaylistSubscribe:()=>_.togglePlaylistSubscribe,updateRestrictionVideos:()=>C.updateRestrictionVideos});var o=i(72053),r=i(243885),s=i(564756),n=i(761986),a=i(952671),d=i(817182),l=i(336695),c=i(494106),u=i(374181),h=i(812695),p=i(548998),m=i(657168),v=i(210358),g=i(90796),_=i(593407),C=i(441424),y=i(502406)},336695:(e,t,i)=>{i.d(t,{openPlaylist:()=>d,openPlaylistFactory:()=>a});var o=i(361121),r=i(538522),s=i(540462),n=i(494106);const a=e=>(t,i)=>{if(!i.first_video_id)return;const{itemId:a,ownerId:d}=(0,o.splitRawId)(i.first_video_id),l={id:a,owner_id:d},c=(0,r.joinRawId)({ownerId:i.owner_id,itemId:i.id});(0,s.partConfigEnabled)("vkvideo_sport_domain")&&i.first_video_url&&(l.direct_url=i.first_video_url),(0,n.openVideoExtended)(t,l,{playlistId:c,playlistTrackCode:i.track_code,module:e,allowModifiedClick:!0})},d=a()},502406:(e,t,i)=>{i.d(t,{openPlaylistModal:()=>n});var o=i(468073),r=i(768797),s=i(575312);const n=e=>{const{owner_id:t}=e;t&&(0,s.showPlaylistsModal)({isGroupOwner:!0,ownerId:o.Ranges.convertOwnerIdToGroupId(t),videoPlaylistsModalService:r.videoPlaylistsModalService,video:e})}},90796:(e,t,i)=>{i.d(t,{openPlaylistPage:()=>r});var o=i(856289);const r=(e,{owner_id:t,id:i})=>{const r=(0,o.getPlaylistURL)(t,i);e.ctrlKey||e.metaKey?window.open(r,"_blank"):window.nav.go(r)}},494106:(e,t,i)=>{i.d(t,{openVideo:()=>p,openVideoExtended:()=>h});var o=i(538522),r=i(835426),s=i(317216),n=i(540462),a=i(856289),d=i(841315),l=i(134551),c=i(29593),u=i(539375);const h=(e,t,{playlistId:i="",playlistTrackCode:h,module:p,searchTrackCode:m,allowModifiedClick:v}={})=>{const{id:g,owner_id:_,track_code:C,viewed_duration:y,type:b,live_status:I}=t;if(!_||!g||l.Video.checkClickEvent(e)&&!v)return;(0,c.logTapClick)(s.EventItemType.VIDEO,C,m),e.preventDefault(),e.stopPropagation();const S=y?(0,r.getPlayFromByDuration)(y):"",f=!(0,a.isVideoStandalone)(),w="music_video"===b&&f,E="live"===b&&I&&["started","waiting"].includes(I),k="short_video"===b,P=(0,n.partConfigEnabled)("video_short_redirect_to_player")?(0,u.getScreenNameFromUrl)(window.location.pathname):null,A=(0,a.isVideoStandalone)()&&(0,n.partConfigEnabled)("video_short_redirect_to_player")&&k&&P,L=k&&!A;if(f&&!(0,a.isVideoSection)()||w||E||L)return void l.Video.show(e,(0,o.joinRawId)({ownerId:_,itemId:g}),{autoplay:1,forceAllVideos:Boolean(i),queue:0,playlistId:i,playFrom:S,addParams:{track_code:C},module:p,shortVideo:k},e.target);const x=window.cur.currentModule?window.cur.currentModule():window.cur.module;(0,n.partConfigEnabled)("video_fix_playlist_source_ref")?window.VideoShowcase?.setVideoPageOpts({module:p??x,trackCode:C??h,context:window.cur.ref_context,source_ref:window.VideoShowcase.videoPageOpts.source_ref}):window.VideoShowcase?.setVideoPageOpts({module:p??x,trackCode:C??h,context:window.cur.ref_context});const M=(0,d.getVideoUrl)(t,{playlistId:i,screenName:P});e.ctrlKey||e.metaKey?window.open(M,"_blank"):(0,n.partConfigEnabled)("vkvideo_sport_domain")?(0,a.navigateToVideo)(M):window.nav.go(M)},p=(e,t)=>h(e,t)},374181:(e,t,i)=>{i.d(t,{sendReport:()=>s,sendReportExtended:()=>r,sendReportWithCallback:()=>n});var o=i(866467);const r=(e,{id:t,owner_id:i,track_code:r},{cardFeedback:s,withoutCardFeedback:n=!1}={})=>{window.stManager.add([window.jsc("web/videoview.js")],(()=>{window.Videoview.showReportVideoForm(i,t,(()=>{n||window.stManager.add([window.jsc("web/video_showcase.js")],(()=>{window.VideoShowcase?.showCardFeedback(String(i),String(t),(0,o.getLang)("global_report_spam")),s?.(e)}))}),r)}))},s=(e,t)=>r(e,t),n=(e,t,i)=>r(e,t,{cardFeedback:i})},812695:(e,t,i)=>{i.d(t,{shareVideo:()=>l,shareVideoExtended:()=>d});var o=i(538522),r=i(540462),s=i(246429),n=i(401244),a=i(856289);const d=(e,t,i,r)=>{window.stManager.add([window.jsc("web/likes.js")],(()=>{window.Likes.share(`video${(0,o.joinRawId)({ownerId:e,itemId:t})}`,{list:i,trackCode:r})}))},l=(e,t,i)=>{if((0,r.partConfigEnabled)("video_new_share_modal")&&(0,a.isVideoStandalone)()){const e=()=>{const e=i?.trackCode||"";d(t.owner_id,t.id,void 0,e)};(0,n.showVideoShareModal)({videoId:t.id,ownerId:t.owner_id,onEmbedClick:e,onClose:()=>(0,s.curBox)()?.hide(),urlPart:"/video"})}else{const e=i?.trackCode||"";d(t.owner_id,t.id,void 0,e)}}},548998:(e,t,i)=>{i.d(t,{toggleDelete:()=>r});var o=i(768797);const r=(e,{owner_id:t,id:i},{groupId:r}={})=>{const s={id:i,ownerId:t},n=r?-Math.abs(r):void 0;t!==n&&(s.targetId=n),o.videoDeletingService.toggleDeleteVideoEvent(s)}},657168:(e,t,i)=>{i.d(t,{toggleFav:()=>n});var o=i(317216),r=i(768797),s=i(29593);const n=(e,{id:t,owner_id:i,is_favorite:n,track_code:a},d)=>{r.faveService.toggleFaveVideoEvent({id:t,ownerId:i,ref:a,source:d?.source}),(0,s.logFaveClick)(!!n,o.EventItemType.VIDEO,a,d?.searchTrackCode)}},210358:(e,t,i)=>{i.d(t,{toggleHideAuthor:()=>s});var o=i(768797),r=i(29593);const s=(e,t,i,s)=>{o.hideAuthorService?.toggleHideAuthorEvent({id:t.owner_id}),(0,r.logHideAuthorClick)(!!s?.is_video_subscription_hidden,{video_id:t.id,video_owner_id:t.owner_id},t.track_code)}},593407:(e,t,i)=>{i.d(t,{togglePlaylistSubscribe:()=>n});var o=i(174269),r=i(540462),s=i(672263);const n=(e,{is_subscribed:t,owner_id:i,id:n})=>{!(0,r.partConfigEnabled)("video_fix_playlist_authorized")||window.vk.id?t?o.appCatalogService.playlistService.unsubscribeFromPlaylist({owner_id:i,album_id:n}):o.appCatalogService.playlistService.subscribeOnPlaylist({owner_id:i,album_id:n}):s.Unauthorized.showMoreBox(null,0,s.UnauthorizedSourceType.SUBSCRIBE_VIDEO_PLAYLIST)}},441424:(e,t,i)=>{i.d(t,{updateRestrictionVideos:()=>n});var o=i(768797),r=i(857551),s=i(873900);const n=async(e,t)=>{const i=(e?.filter((e=>{const i=(0,r.mapRestrictions)(e?.restriction);return i?.action===t}))??[]).map((e=>(0,s.getIdentityRawId)({id:e.id??0,ownerId:e.owner_id??0})));o.entitiesVideoService.videosGetByIdsFx({id:i.join(",")})}},58697:(e,t,i)=>{i.d(t,{getSubscriptionsPageServices:()=>n});var o=i(32489),r=i(558137),s=i(768797);const n=(0,r.makeSharedState)("static/js/modules/web/VideoShowcase/pages/SubscriptionsPage/getSubscriptionsPageServices.ts",(()=>({catalogService:(0,s.createPageCatalogService)((0,o.createDomain)("VideoShowcase/SubscriptionsPage"))})),{version:1})},381149:(e,t,i)=>{i.d(t,{AppCatalogServiceAdapter:()=>n});var o=i(331635),r=i(254328),s=i(664317);class n{constructor(e){this.videoItems=(0,r.store)(e.videoService.$videoItems)}}n=(0,o.__decorate)([(0,s.adapter)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof InstanceAppCatalogService?Object:InstanceAppCatalogService])],n)},909784:(e,t,i)=>{i.d(t,{CatalogServiceAdapter:()=>n});var o=i(331635),r=i(254328),s=i(664317);class n{constructor(e){this.currentSection=(0,r.store)(e.$currentSection),this.currentSectionId=(0,r.store)(e.$currentSectionId),this.isFirstSection=(0,r.store)(e.$isFirstSection),this.refetchCurrentSection=(0,r.event)(e.refetchCurrentSectionEvent),this.setCatalogGetSections=(0,r.event)(e.setCatalogGetSectionsEvent)}}n=(0,o.__decorate)([(0,s.adapter)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof InstanceCatalogService?Object:InstanceCatalogService])],n)},966016:(e,t,i)=>{i.d(t,{OwnerServiceAdapter:()=>n});var o=i(331635),r=i(254328),s=i(664317);class n{constructor(e){this.owner=(0,r.store)(e.$ownerData),this.error=(0,r.store)(e.$ownerError),this.isLoading=(0,r.store)(e.$ownerLoading),this.fetch=(0,r.event)(e.getOwnerEvent),this.dispose=(0,r.event)(e.resetOwnerEvent)}}n=(0,o.__decorate)([(0,s.adapter)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof InstanceOwnerService?Object:InstanceOwnerService])],n)},424932:(e,t,i)=>{i.d(t,{VideoDeletingServiceAdapter:()=>n});var o=i(331635),r=i(254328),s=i(664317);class n{constructor(e){this.removedVideosIds=(0,r.store)(e.$removedVideosIds),this.toggleDeleted=(0,r.event)(e.toggleDeleteVideoEvent)}}n=(0,o.__decorate)([(0,s.adapter)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof InstanceVideoDeletingService?Object:InstanceVideoDeletingService])],n)},830019:(e,t,i)=>{i.d(t,{createAbortControllersService:()=>s});var o=i(32489);const r=e=>Array.isArray(e)?e:[e],s=e=>{const t=e.createStore({}),i=e.createEvent(),s=e.createEvent(),n=e.createEvent();return(0,o.sample)({clock:s,source:t,fn:(e,t)=>r(t).reduce(((e,t)=>(e[t]=null,e)),{...e}),target:t}),(0,o.sample)({clock:i,source:t,fn:(e,t)=>(r(t).forEach((t=>e[t]?.abort())),t),target:s}),(0,o.sample)({clock:n,fn:e=>Object.keys(e),target:i}),(0,o.sample)({clock:n,source:t,fn:(e,t)=>({...e,...t}),target:t}),{$controllers:t,abortRequestEvent:i,clearControllerEvent:s,setControllerEvent:n}}},884022:(e,t,i)=>{i.d(t,{createAuthorUserService:()=>n});var o=i(32489),r=i(831144),s=i(386595);const n=({domain:e,entitiesUsersService:t})=>{const[i,n]=(0,r.createAbortControllerField)(e),a=e.createEvent(),d=e.createStore(""),l=(0,s.combineEntitiesId)(t.$entitiesUsers,d),c=(0,s.combineEntitiesId)(t.$entitiesUsersErrors,d),u=(0,s.combineEntitiesId)(t.$entitiesUsersLoading,d);return(0,o.sample)({clock:a,fn:e=>String(e),target:d}),(0,o.sample)({clock:a,source:i,fn:e=>(e?.abort(),new AbortController),target:i}),(0,o.sample)({clock:a,source:i,fn:(e,t)=>({controller:e,query:{fields:"screen_name,photo_50,photo_100,photo_200",user_ids:String(t)}}),target:t.getUsersFx}),{$userData:l,$userError:c,$userLoading:u,getUserEvent:a,abortUserRequestEvent:n}}},596791:(e,t,i)=>{i.d(t,{createCatalogService:()=>l});var o=i(32489),r=i(980578),s=i(831144),n=i(903274),a=i(963626),d=i(386595);const l=({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:i,entitiesUsersService:l,entitiesVideoAlbumsService:c,entitiesVideoService:u,entitiesPlaceholdersService:h})=>{const{$entitiesCatalogVideo:p,$entitiesCatalogVideoErrors:m,$entitiesCatalogVideoLoading:v,catalogGetVideoFx:g,updateSectionEvent:_}=(0,r.createEntitiesCatalogVideoService)({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:i,entitiesUsersService:l,entitiesVideoAlbumsService:c,entitiesVideoService:u,entitiesPlaceholdersService:h}),C=(0,n.createCurrentSectionService)({domain:e,entitiesCatalogSectionsService:t}),{$replaceBlocksError:y,$loadingBlockId:b,abortReplacementRequestEvent:I,replaceBlocksEvent:S}=(0,a.createBlocksReplacementService)({domain:e,currentSectionService:C,entitiesCatalogSectionsService:t,updateSectionEvent:_}),{$currentSection:f,$currentSectionId:w,$currentSectionError:E,$currentSectionPending:k,abortSectionRequestEvent:P,changeCurrentSectionIdEvent:A,refetchCurrentSectionEvent:L,setCurrentSectionIdEvent:x}=C,M=e.createEvent(),O=e.createEvent(),T=e.createEvent(),V=(0,o.restore)(T,{url:""}),F=e.createEvent(),[j,R]=(0,s.createAbortControllerField)(e);(0,o.sample)({clock:F,target:[R,P,I]});const D=(0,o.sample)({clock:T,source:{loading:v,query:V},filter:({loading:e,query:t},{url:i,noRefetchOnSameLoading:o})=>t.url!==i||!o||!e[i],fn:(e,t)=>({controller:t.url?new AbortController:null,query:t})});(0,o.sample)({clock:D,fn:({query:e})=>e,target:V}),(0,o.sample)({clock:D,fn:({controller:e})=>e,target:R}),(0,o.sample)({clock:D,fn:()=>null,target:[P,I]}),(0,o.sample)({clock:D,filter:({controller:e,query:t})=>Boolean(t.url&&e),fn:({controller:e,query:{url:t,trackCode:i}})=>({controller:e,query:{need_blocks:1,owner_id:0,url:t,...i&&{from_trackcode:i}}}),target:g}),(0,o.sample)({clock:[g.done,g.fail],fn:()=>null,target:j}),(0,o.sample)({clock:g.done,fn:e=>e.result.catalog?.default_section||"",target:x});const B=(0,o.combine)({currentSectionId:w,entities:p,query:V},(({currentSectionId:e,entities:t,query:i})=>{const o=null!==i.url&&t[i.url];return o?{...o,default_section:e,sections:[]}:null})),N=(0,o.combine)({entities:p,query:V},(({entities:e,query:t})=>e[t.url]??null)),U=(0,o.combine)({catalogEntities:v,currentSectionPending:k,query:V},(({catalogEntities:e,currentSectionPending:t,query:i})=>t||e[i.url]||null)),G=(0,o.combine)({catalogEntities:v,query:V},(({catalogEntities:e,query:t})=>e[t.url]||!1)),H=(0,o.combine)({catalogEntities:m,currentSectionError:E,replaceBlocksError:y,query:V},(({catalogEntities:e,currentSectionError:t,replaceBlocksError:i,query:o})=>!(0,d.isAbortApiError)(i)&&i||!(0,d.isAbortApiError)(t)&&t||!(0,d.isAbortApiError)(e[o.url])&&e[o.url]||null)),W=(0,o.combine)({section:f,deletedAlbums:c.$entitiesVideoDeletedAlbums},(({section:e,deletedAlbums:t})=>{if(!e)return[];const i=e.blocks?.map((e=>({...e,albums_ids:e.albums_ids?.filter((e=>!t[e]))})));return[{...e,blocks:i}]})),z=(0,o.combine)({catalog:B,sections:t.$entitiesCatalogSections},(({sections:e,catalog:t})=>{const i=t?.buttons?.[0];return i?.section_id&&e[i.section_id]||null})),$=(0,o.combine)(N,w,((e,t)=>e?.sections[0]?.id===t));(0,o.sample)({clock:M,source:(0,o.combine)([N,V]),filter:([e])=>Boolean(e?.sections),fn:([e,t],i)=>({id:e?.sections?.find((e=>e.url===i))?.id??"",trackCode:t.trackCode??""}),target:A}),(0,o.sample)({clock:O,source:(0,o.combine)([z,V]),filter:([e])=>Boolean(e?.subsections?.length),fn:([e,t],i)=>({id:e?.subsections?.find((e=>e.url===i))?.id??"",trackCode:t.trackCode??""}),target:A});const{setCatalogGetSectionsEvent:Y}=t;return{$catalog:N,$catalogGetVideoPending:G,$currentSection:f,$currentSectionId:w,$currentSectionError:E,$currentSectionPending:k,$isFirstSection:$,$pageStructureSection:z,$data:B,$error:H,$loadingBlockId:b,$pending:U,$sections:W,abortRequestEvent:F,changeCurrentSectionIdEvent:A,changeCurrentSectionUrlEvent:M,changeCurrentSubsectionUrlEvent:O,changeUrlEvent:T,refetchCurrentSectionEvent:L,replaceBlocksEvent:S,setCatalogGetSectionsEvent:Y,updateSectionEvent:_}}},903274:(e,t,i)=>{i.d(t,{createCurrentSectionService:()=>n});var o=i(32489),r=i(831144),s=i(386595);const n=({domain:e,entitiesCatalogSectionsService:t})=>{const i=e.createEvent(),n=e.createEvent(),a=e.createEvent(),d=e.createEvent(),l=e.createStore(""),c=e.createStore(!1),[u,h]=(0,r.createAbortControllerField)(e),{$entitiesCatalogSections:p,$entitiesSectionsErrors:m,$entitiesSectionsLoading:v,catalogGetSectionFx:g,setCatalogGetSectionsEvent:_}=t,C=(0,o.attach)({effect:g,mapParams:({silent:e,...t})=>t}),y=(0,o.combine)({entities:p,currentSectionId:l},(({entities:e,currentSectionId:t})=>e[t]??null)),b=(0,o.combine)({entities:v,currentSectionId:l,silentPending:c},(({entities:e,currentSectionId:t,silentPending:i})=>Boolean(!i&&e[t]))),I=(0,o.combine)({entities:m,currentSectionId:l},(({entities:e,currentSectionId:t})=>e[t]??null));return(0,o.sample)({clock:n,source:l,filter:(e,{id:t})=>e!==t,fn:(e,{id:t,trackCode:i})=>({controller:t?new AbortController:null,id:t,trackCode:i}),target:d}),(0,o.sample)({clock:a,target:l}),(0,o.sample)({clock:i,source:{currentSectionId:l,currentSection:y},filter:({currentSectionId:e,currentSection:t},{filter:i}={})=>!!e&&(!t||!i||i(t)),fn:({currentSectionId:e},{silent:t}={})=>({controller:new AbortController,id:e,silent:t}),target:d}),(0,o.sample)({clock:d,fn:({id:e})=>e,target:a}),(0,o.sample)({clock:d,fn:({controller:e})=>e,target:h}),(0,o.sample)({clock:d,source:p,filter:(e,{id:t,silent:i})=>Boolean(!i&&e[t]?.blocks),fn:(e,{id:t})=>{const{id:i,title:o,url:r}=e[t];return[{id:i,title:o,url:r}]},target:_}),(0,o.sample)({clock:d,source:p,filter:(e,{controller:t,id:i,silent:o})=>Boolean((o||!e[i]?.blocks)&&t),fn:(e,{controller:t,id:i,silent:o,trackCode:r})=>({controller:t,query:r?{section_id:i,from_track_code:r}:{section_id:i},silent:o}),target:C}),(0,o.sample)({clock:C.done.filterMap((({params:e,result:t})=>e.silent&&t.section?[t.section]:void 0)),target:_}),(0,o.sample)({clock:C,filter:({silent:e})=>Boolean(e),fn:()=>!0,target:c}),(0,o.sample)({clock:C.finally,filter:({params:e})=>Boolean(e.silent),fn:()=>!1,target:c}),(0,o.sample)({clock:[C.done,C.fail],filter:e=>!(0,s.isAbortError)(e),fn:()=>null,target:u}),{$currentSection:y,$currentSectionId:l,$currentSectionError:I,$currentSectionPending:b,abortSectionRequestEvent:h,changeCurrentSectionIdEvent:n,refetchCurrentSectionEvent:i,setCurrentSectionIdEvent:a}}},802369:(e,t,i)=>{i.d(t,{createEntitiesVideoSyncService:()=>r});var o=i(32489);const r=e=>{const t=new Map;return(0,o.sample)({clock:e.setVideosEvent,fn:e=>{t.forEach((t=>{t(e)}))}}),{subscribe:e=>{t.set(e,e)},unsubscribe:e=>{t.delete(e)}}}},988765:(e,t,i)=>{i.d(t,{createExtendedService:()=>s});var o=i(32489);const r=e=>Object.values(e).filter((e=>Boolean(e))),s=({entitiesGroupsService:e,entitiesUsersService:t,entitiesVideoAlbumsService:i,entitiesVideoService:s,entitiesPlaceholdersService:n,entitiesCatalogLiveChannelsService:a,entitiesCatalogLiveCategoriesService:d})=>{const{$entitiesGroups:l}=e,{$entitiesUsers:c}=t,{$entitiesVideo:u}=s,{$entitiesVideoAlbums:h}=i,{$entitiesPlaceholders:p}=n,{$entitiesCatalogLiveChannels:m}=a,{$entitiesCatalogLiveCategories:v}=d;return{$data:(0,o.combine)({albums:h,groups:l,placeholders:p,profiles:c,videos:u,liveChannels:m,liveCategories:v},(({albums:e,groups:t,placeholders:i,profiles:o,videos:s,liveChannels:n,liveCategories:a})=>({albums:r(e),groups:r(t),placeholders:r(i),profiles:r(o),videos:r(s),vklive_channels:r(n),vklive_categories:r(a)})))}}},122974:(e,t,i)=>{i.d(t,{createFaveService:()=>l});var o=i(32489),r=i(188386),s=i(538522),n=i(314309),a=i(317216),d=i(231450);const l=({domain:e,entitiesVideoService:t,onAddFave:i,onRemoveFave:l})=>{const{$entitiesVideo:c,patchVideosEvent:u}=t,{faveAddVideoFx:h,faveRemoveVideoFx:p}=(0,r.createEntitiesFaveVideoService)({domain:e}),m=e.createStore({}),v=e.createEvent(),g=e.createEffect((({controller:e,currentFav:t,query:i,trackCode:o})=>{const r={controller:e,query:i};return(0,d.getFromType)("search")&&n.searchStatsCollector.logEvent({track_code:o,action:t?a.SearchClickActionMap.UNFAVE_OUT:a.SearchClickActionMap.FAVE_OUT,type:a.EventItemType.VIDEO}),t?p(r):h(r)}));return(0,o.sample)({clock:v,source:c,fn:(e,{id:t,ownerId:i,ref:o,source:r})=>{const n=(0,s.joinRawId)({ownerId:i,itemId:t}),a=Boolean(e[n]?.is_favorite),d=e[n]?.track_code;return{controller:new AbortController,currentFav:a,fullId:n,query:{id:t,owner_id:i,ref:o,source:r},trackCode:d}},target:g}),(0,o.sample)({clock:g,source:m,fn:(e,{controller:t,fullId:i})=>(e[i]?.abort(),{...e,[i]:t}),target:m}),(0,o.sample)({clock:g,fn:({currentFav:e,query:t})=>[{id:t.id,owner_id:t.owner_id,is_favorite:!e}],target:u}),(0,o.sample)({clock:[g.done,g.fail],filter:e=>"error"in e||!e.result,fn:({params:e})=>[{id:e.query.id,owner_id:e.query.owner_id,is_favorite:e.currentFav}],target:u}),(0,o.sample)({clock:[g.done,g.fail],source:m,fn:(e,{params:t})=>{const i={...e};return delete i[t.fullId],i},target:m}),(0,o.sample)({clock:h.done,target:i}),(0,o.sample)({clock:p.done,fn:e=>({rollbackCallback:t=>{const{query:i}=e.params;v({id:i.id,ownerId:i.owner_id,ref:i.ref,source:t??i.source})}}),target:l}),{toggleFaveVideoEvent:v}}},906784:(e,t,i)=>{i.d(t,{createGroupOwnerService:()=>n});var o=i(32489),r=i(162951),s=i(8520);const n=({domain:e})=>{const t=(0,r.createUtilsResolveScreenNameFx)({domain:e}),i=e.createStore(null),n=e.createStore(null),a=e.createEvent(),d=e.createEvent();return(0,o.sample)({clock:a,source:n,fn:(e,t)=>{e?.abort();return{controller:new AbortController,query:{screen_name:t}}},target:t}),(0,o.sample)({clock:t,fn:({controller:e})=>e||null,target:n}),(0,o.sample)({clock:d,source:n,fn:e=>(e?.abort(),null),target:i}),(0,o.sample)({clock:[t.doneData],filter:e=>(0,s.isNumber)(e?.object_id),fn:({object_id:e})=>e,target:i}),(0,o.sample)({clock:[t.done,t.fail],fn:()=>null,target:n}),{resolveGroupOwnerByScreenNameEvent:a,resetGroupOwnerStore:d,$groupOwnerId:i}}},214587:(e,t,i)=>{i.d(t,{createHideAuthorService:()=>n});var o=i(32489),r=i(468073),s=i(733920);const n=({domain:e,entitiesGroupsService:t})=>{const{$entitiesGroups:i,patchGroupsEvent:n}=t,{hideAuthorVideoFx:a,chooseAuthorVideoFx:d,resetHideAuthorVideoByIdEvent:l}=(0,s.createEntitiesSubscribeToggleHideAuthorService)({domain:e}),c=e.createStore({}),u=e.createEvent(),h=e.createEffect((({controller:e,currentHide:t,query:i})=>{const o={controller:e,query:i};return t?d(o):a(o)}));return(0,o.sample)({clock:u,source:i,fn:(e,{id:t})=>{const i=r.Ranges.convertOwnerIdToGroupId(t),o=Boolean(e[i]?.is_video_subscription_hidden);return{controller:new AbortController,currentHide:o,fullId:i,query:{author_ids:String(t)}}},target:h}),(0,o.sample)({clock:h,source:c,fn:(e,{controller:t,fullId:i})=>(e[i]?.abort(),{...e,[i]:t}),target:c}),(0,o.sample)({clock:h,fn:({currentHide:e,fullId:t})=>[{id:t,is_video_subscription_hidden:!e}],target:n}),(0,o.sample)({clock:[h.done,h.fail],filter:e=>"error"in e||!e.result,fn:({params:e})=>[{id:e.fullId,is_video_subscription_hidden:e.currentHide}],target:n}),(0,o.sample)({clock:[h.done,h.fail],source:c,fn:(e,{params:t})=>{const{[t.fullId]:i,...o}=e;return o},target:c}),{toggleHideAuthorEvent:u,resetHideAuthorVideoByIdEvent:l}}},44975:(e,t,i)=>{i.d(t,{createOwnerService:()=>n});var o=i(32489),r=i(468073),s=i(386595);const n=({domain:e,entitiesGroupsService:t,entitiesUsersService:i})=>{const n=e.createEvent(),a=e.createEvent(),d=e.createStore(null).reset(n);return(0,o.sample)({clock:a,fn:({ownerId:e})=>e,target:d}),(0,o.sample)({clock:a,filter:({ownerId:e})=>r.Ranges.isGroupId(e),fn:({controller:e,ownerId:t})=>({controller:e,query:{groupIds:[r.Ranges.convertOwnerIdToGroupId(t)]}}),target:t.groupsGetByIdFx}),(0,o.sample)({clock:a,filter:({ownerId:e})=>r.Ranges.isUserId(e),fn:({controller:e,ownerId:t})=>({controller:e,query:{fields:"screen_name,photo_50",user_ids:String(t)}}),target:i.getUsersFx}),{$ownerData:(0,s.$selectUserOrGroupStoreById)(i.$entitiesUsers,t.$entitiesGroups,d),$ownerError:(0,s.$selectUserOrGroupStoreById)(i.$entitiesUsersErrors,t.$entitiesGroupsErrors,d),$ownerLoading:(0,s.$selectUserOrGroupStoreById)(i.$entitiesUsersLoading,t.$entitiesGroupsLoading,d),getOwnerEvent:a,resetOwnerEvent:n}}},497663:(e,t,i)=>{i.d(t,{createPinService:()=>d});var o=i(32489),r=i(264874),s=i(986125),n=i(361121),a=i(29593);const d=({domain:e,catalogService:t,entitiesVideoService:i,groupOwnerService:d,onPin:l,onUnpin:c})=>{const{$entitiesVideo:u,patchVideosEvent:h}=i,p=(0,s.createVideoPinVideoFx)({domain:e}),m=(0,s.createVideoUnpinVideoFx)({domain:e}),v=e.createStore({}),g=e.createStore(null),{$catalog:_,$currentSection:C,refetchCurrentSectionEvent:y}=t,b=e.createEvent(),I=e.createEffect((({controller:e,isPinned:t,query:i})=>{const o={controller:e,query:i};return t?m(o):p(o)}));(0,o.sample)({clock:(0,r.once)(b),source:u,fn:e=>{const t=Object.values(e).findIndex((e=>e?.is_pinned)),i=Object.values(e)[t];if(!i)return null;const{id:o,owner_id:r}=i;return o&&r?(0,a.getVideoCardKey)(r,o):null},target:g}),(0,o.sample)({clock:b,source:{videos:u,groupOwnerId:d.$groupOwnerId},fn:({videos:e,groupOwnerId:t},{videoId:i,ownerId:o})=>{const r=(0,a.getVideoCardKey)(o,i),s=Boolean(e[r]?.is_pinned);return{controller:new AbortController,isPinned:s,fullId:r,query:{video_id:i,owner_id:o,group_id:t}}},target:I}),(0,o.sample)({clock:I,source:v,fn:(e,{controller:t,fullId:i})=>(e[i]?.abort(),{...e,[i]:t}),target:v}),(0,o.sample)({clock:I,fn:({isPinned:e,query:{video_id:t,owner_id:i}})=>[{owner_id:i,id:t,is_pinned:!e}],target:h}),(0,o.sample)({clock:I.done,filter:e=>!("error"in e),fn:({params:{isPinned:e,query:{video_id:t,owner_id:i}}})=>e?null:(0,a.getVideoCardKey)(i,t),target:g}),(0,o.sample)({clock:I,source:g,filter:(e,{isPinned:t,query:{video_id:i,owner_id:o}})=>Boolean(e)&&!t&&(0,a.getVideoCardKey)(o,i)!==e,fn:e=>{const{ownerId:t,itemId:i}=(0,n.splitRawId)(e);return[{owner_id:t,id:i,is_pinned:!1}]},target:h}),(0,o.sample)({clock:p.done,fn:l}),(0,o.sample)({clock:m.done,fn:c}),(0,o.sample)({clock:[p.done,m.done],source:{$catalog:_,$currentSection:C},filter:({$catalog:e,$currentSection:t})=>e?.sections[0]?.id===t?.id,fn:()=>({silent:!0}),target:y});return{togglePin:(e,{id:t,owner_id:i})=>{b({videoId:t,ownerId:i})},toggleVideoPinEvent:b}}},963626:(e,t,i)=>{i.d(t,{createBlocksReplacementService:()=>d});var o=i(32489),r=i(876761),s=i(831144),n=i(782399),a=i(386595);const d=({domain:e,entitiesCatalogSectionsService:t,currentSectionService:i,updateSectionEvent:d})=>{const l=e.createStore(null).reset(t.initCatalog),c=e.createStore(!1),u=e.createStore(null),h=e.createStore(null),p=e.createEvent(),m=(0,r.createCatalogReplaceBlocksFx)({domain:e}),[v,g]=(0,s.createAbortControllerField)(e),{$currentSection:_,changeCurrentSectionIdEvent:C}=i;(0,o.sample)({clock:C,fn:()=>null,target:g});const y=(0,o.sample)({clock:p,fn:e=>({controller:e?new AbortController:null,id:e})});(0,o.sample)({clock:y,fn:({controller:e})=>e,target:g}),(0,o.sample)({clock:y,fn:()=>null,target:h}),(0,o.sample)({clock:y,source:u,filter:(e,{id:t})=>e!==t,fn:(e,{controller:t,id:i})=>({controller:t,query:{replacement_ids:i}}),target:m}),(0,o.sample)({clock:y,fn:({id:e})=>e,target:u}),(0,o.sample)({clock:m,fn:()=>!0,target:c}),(0,o.sample)({clock:[m,C],fn:()=>null,target:l}),(0,o.sample)({clock:m.fail,filter:({error:e})=>!(0,n.isNetworkError)(e)||"AbortError"!==e.error.name,fn:({error:e})=>e,target:l});const b=(0,o.sample)({clock:m.doneData,source:_,filter:(e,{replacements:t})=>Boolean(e&&t),fn:(e,{replacements:t,...i})=>{const o={...e,next_from:t.new_next_from},r={...i,section:o};return o.blocks?.length?(o.blocks=t.replacements.reduce(((e,{from_block_ids:t,to_blocks:i})=>(t?.forEach(((t,r)=>{const s=i?.[r];if(!s)return;const n=o.blocks?.findIndex((({id:e})=>e===t));void 0!==n&&(e[n]=s)})),e)),[...o.blocks]),r):r}});return(0,o.sample)({clock:b,fn:({section:e})=>{const{id:t,title:i,url:o}=e;return[{id:t,title:i,url:o}]},target:t.setCatalogGetSectionsEvent}),(0,o.sample)({clock:b,target:d}),(0,o.sample)({clock:[m.fail,b],fn:()=>!1,target:c}),(0,o.sample)({clock:[m.fail,m.done],filter:e=>!(0,a.isAbortError)(e),fn:()=>null,target:v}),(0,o.sample)({clock:m,fn:({query:e})=>e?.replacement_ids?.split("/")[0]||null,target:h}),(0,o.sample)({clock:[m.fail,m.done],filter:e=>!(0,a.isAbortError)(e),fn:()=>null,target:h}),{$currentReplacementId:u,$replaceBlocksError:l,$replaceBlocksPending:c,$loadingBlockId:h,abortReplacementRequestEvent:g,replaceBlocksEvent:p}}},704555:(e,t,i)=>{i.d(t,{createVideoDeletingService:()=>a});var o=i(32489),r=i(538522),s=i(361121),n=i(386595);const a=({domain:e,entitiesVideoService:t})=>{const{$entitiesVideo:i,patchVideosEvent:a,videoAddFx:d,videoDeleteFx:l,videoRestoreFx:c}=t,u=e.createStore({}),h=e.createEvent(),p=e.createEvent(),m=(0,o.restore)(p,{}),v=(e,t)=>({...e,[t]:!e[t]}),g=e.createEffect((({controller:e,deleted:t,query:i})=>{const o={controller:e,query:{video_id:i.id,owner_id:i.owner_id,target_id:i.target_id}};return t?i.target_id&&i.owner_id!==i.target_id?d(o):c(o):l(o)}));(0,o.sample)({clock:h,source:i,fn:(e,{id:t,ownerId:i,targetId:o})=>{const s=(0,r.joinRawId)({ownerId:i,itemId:t}),n=Boolean(e[s]?.localDeleted);return{controller:new AbortController,deleted:n,fullId:s,query:{id:t,owner_id:i,target_id:o}}},target:g}),(0,o.sample)({clock:g,source:u,fn:(e,{controller:t,fullId:i})=>(e[i]?.abort(),{...e,[i]:t}),target:u}),(0,o.sample)({clock:g,fn:({deleted:e,query:{target_id:t,...i}})=>[{...i,localDeleted:!e}],target:a}),(0,o.sample)({clock:g,source:m,fn:(e,{fullId:t})=>v(e,t),target:p}),(0,o.sample)({clock:[g.done,g.fail],filter:e=>"error"in e||!e.result,fn:({params:{deleted:e,query:{target_id:t,...i}}})=>[{...i,localDeleted:e}],target:a}),(0,o.sample)({clock:[g.done,g.fail],source:m,filter:(e,t)=>"error"in t||!t.result,fn:(e,{params:{fullId:t}})=>v(e,t),target:p}),(0,o.sample)({clock:[g.done,g.fail],source:u,fn:(e,{params:t})=>{const i={...e};return delete i[t.fullId],i},target:u}),(0,o.sample)({clock:g.done,filter:({params:e,result:t})=>Boolean(!e.deleted&&t),fn:({params:e})=>(0,n.showVideoDeletedSnackbar)((()=>{const{ownerId:t,itemId:i}=(0,s.splitRawId)(e.fullId),{target_id:o}=e.query;h({ownerId:t,id:i,targetId:o})}))});return{$removedVideosIds:m,$removedVideosCount:(0,o.sample)({clock:m,fn:e=>Object.values(e).filter(Boolean).length}),toggleDeleteVideoEvent:h}}},996713:(e,t,i)=>{i.d(t,{createVideoPlaylistsModalService:()=>p});var o=i(474848),r=i(178317),s=i(530040),n=i(986125),a=i(468073),d=i(866467),l=i(32489),c=i(432465),u=i(818515),h=i(856289);const p=e=>{const t=e.createEvent(),i=(0,l.restore)(t,null),p=e.createEvent(),m=(0,l.restore)(p,null),v=e.createEvent(),g=(0,l.restore)(v,null),_=e.createEvent(),C=(0,l.restore)(_,null),y=e.createStore(!1),b=e.createEvent(),I=(0,r.createEntitiesVideoAlbumService)({domain:e}),S=(0,s.createListsVideosAlbumsService)({domain:e,entitiesVideoAlbumService:I}),{$listIds:f,$loading:w,$fullyLoaded:E}=S.selectStores(i.map((e=>e||""))),k=(0,n.createVideoGetAlbumsByVideoFx)({domain:e}),P=(0,n.createVideoAddToAlbumFx)({domain:e}),A=(0,n.createVideoRemoveFromAlbumFx)({domain:e}),L=e.createEvent(),x=e.createEvent(),M=e.createEvent(),O=e.createEvent(),{$entitiesVideoBinding:T,addBindingsEvent:V,toggleBindingEvent:F,resetBindingsEvent:j}=(0,h.createVideoBindingsService)(e);return(0,l.sample)({clock:b,fn:({videoId:e})=>e,target:v}),(0,l.sample)({clock:b,fn:({ownerId:e})=>e,target:t}),(0,l.sample)({clock:b,fn:({isGroupOwner:e})=>e,target:p}),(0,l.sample)({clock:b,fn:({videoOwnerId:e})=>e,target:_}),(0,l.sample)({clock:b,fn:()=>!1,target:y}),(0,l.sample)({clock:F,fn:()=>!0,target:y}),(0,l.sample)({clock:b,fn:({ownerId:e,isGroupOwner:t})=>{const i={query:{count:50,extended:1},controller:new AbortController,entityKey:e};return t?i.query.group_id=e:i.query.owner_id=e,i},target:S.fetchVideosAlbumsFx}),(0,l.sample)({clock:b,fn:({ownerId:e,videoId:t,videoOwnerId:i,isGroupOwner:o})=>({query:{video_id:t,owner_id:i,target_id:o&&e?a.Ranges.convertGroupIdToOwnerId(e):e},controller:new AbortController}),target:k}),(0,l.sample)({clock:k.done,fn:({params:e,result:t})=>({video_id:e.query.video_id,album_ids:t}),target:V}),(0,l.sample)({clock:L,source:{bindings:T,videoId:g},filter:({videoId:e})=>Boolean(e),fn:({bindings:e,videoId:t})=>{const i=[],o=[],r=t??0;return Object.keys(e[r]).forEach((t=>{const s=Number(t);if(isNaN(s)||!(s in e[r]))return;e[r][s]?i.push(s):o.push(s)})),{toAdd:i.join(","),toRemove:o.join(",")}},target:x}),(0,l.sample)({clock:[L,O],fn:()=>{(0,c.showSnackbar)({text:(0,d.getLang)("video_changes_saved"),before:{content:(0,o.jsx)(u.Icon28ListCheckOutline,{})},timeout:h.SNACKBAR_TIMEOUT}).catch()}}),(0,l.sample)({clock:x,source:{videoId:g,videoOwnerId:C,targetId:i,isGroupOwner:m},filter:(e,{toAdd:t})=>Boolean(t),fn:({videoId:e,videoOwnerId:t,targetId:i,isGroupOwner:o},{toAdd:r})=>({query:{target_id:(i=o&&i?a.Ranges.convertGroupIdToOwnerId(i):i)??0,owner_id:t??0,video_id:e??0,album_ids:r},controller:new AbortController}),target:P}),(0,l.sample)({clock:O,source:{videoId:g,videoOwnerId:C,targetId:i,isGroupOwner:m},fn:({videoId:e,videoOwnerId:t,targetId:i,isGroupOwner:o},{id:r})=>({query:{target_id:(i=o&&i?a.Ranges.convertGroupIdToOwnerId(i):i)??0,owner_id:t??0,video_id:e??0,album_ids:r.toString()},controller:new AbortController}),target:P}),(0,l.sample)({clock:x,source:{videoId:g,videoOwnerId:C,targetId:i,isGroupOwner:m},filter:(e,{toRemove:t})=>Boolean(t),fn:({videoId:e,videoOwnerId:t,targetId:i,isGroupOwner:o},{toRemove:r})=>({query:{target_id:(i=o&&i?a.Ranges.convertGroupIdToOwnerId(i):i)??0,owner_id:t??0,video_id:e??0,album_ids:r},controller:new AbortController}),target:A}),(0,l.sample)({clock:M,source:i,filter:e=>Boolean(e),fn:e=>({entityKey:e??0,count:50}),target:S.fetchMoreVideosAlbumsEvent}),{$entitiesVideoBinding:T,$videosAlbumsIds:f,$entitiesPlaylists:I.$entitiesVideoAlbums,$videosAlbumsLoading:w,$videoAlbumsFullyLoaded:E,toggleBindingEvent:F,resetBindingsEvent:j,initModalEvent:b,saveChangesEvent:L,fetchMorePlaylists:M,removeFromAlbumDoneEvent:A.done,$wasToggled:y,createPlaylistEvent:O}}},733920:(e,t,i)=>{i.d(t,{createEntitiesSubscribeToggleHideAuthorService:()=>l});var o=i(32489),r=i(986125),s=i(401464),n=i(564479);const a=({query:e})=>e.author_ids,d=(e,{query:t},i)=>({...e,[t.author_ids]:i}),l=({domain:e})=>{const t=(0,r.createVideoSubscribeHideAuthor)({domain:e}),i=(0,r.createVideoSubscribeUnhideAuthor)({domain:e}),l=(0,s.errors)({effect:t,getKey:a,store:e.createStore({})}),c=(0,n.pendings)({effect:t,getKey:a,store:e.createStore({})}),u=(0,s.errors)({effect:i,getKey:a,store:e.createStore({})}),h=(0,n.pendings)({effect:i,getKey:a,store:e.createStore({})}),p=e.createStore({}),m=e.createEvent(),v=e.createEvent();return p.on(m,(()=>({}))),p.on(v,((e,{id:t,value:i})=>({...e,[t]:i}))),(0,o.sample)({clock:t.done,source:p,filter:(e,{result:t})=>Boolean(t),fn:(e,{params:t})=>d(e,t,!0),target:p}),(0,o.sample)({clock:i.done,source:p,filter:(e,{result:t})=>Boolean(t),fn:(e,{params:t})=>d(e,t,!1),target:p}),{$entitiesHideAuthorVideoErrors:l,$entitiesHideAuthorVideoLoading:c,$entitiesChooseAuthorVideoLoading:h,$entitiesChooseAuthorVideoFxVideoErrors:u,$entitiesHideAuthorVideo:p,chooseAuthorVideoFx:i,hideAuthorVideoFx:t,setHideAuthorVideoByIdEvent:v,resetHideAuthorVideoByIdEvent:m}}},89783:(e,t,i)=>{i.d(t,{registerPlaylistUpdateEventListener:()=>o.registerPlaylistUpdateEventListener});var o=i(367133)},367133:(e,t,i)=>{i.d(t,{registerPlaylistUpdateEventListener:()=>r});var o=i(826619);const r=e=>{const t=({detail:t})=>{e.patchVideoAlbumsEvent([{id:t.id,owner_id:t.ownerId,title:t.title}]),e.getVideoAlbumByIdFx({query:{owner_id:t.ownerId,album_id:t.id}})};return window.addEventListener(o.PlaylistFormEvents.UPDATE,t),()=>window.removeEventListener(o.PlaylistFormEvents.UPDATE,t)}},768797:(e,t,i)=>{i.d(t,{AppCatalogServiceAdapter:()=>O.AppCatalogServiceAdapter,CatalogServiceAdapter:()=>L.CatalogServiceAdapter,OwnerServiceAdapter:()=>x.OwnerServiceAdapter,PlaylistServiceAdapter:()=>k.PlaylistServiceAdapter,PlaylistVideoRemovingServiceAdapter:()=>k.PlaylistVideoRemovingServiceAdapter,VideoDeletingServiceAdapter:()=>M.VideoDeletingServiceAdapter,authorUserService:()=>B,createBlocksReplacementService:()=>V.createBlocksReplacementService,createCurrentSectionService:()=>T.createCurrentSectionService,createPageCatalogService:()=>R,createPagePinService:()=>D,entitiesGroupsService:()=>N,entitiesUsersService:()=>G,entitiesVideoAlbumsService:()=>H,entitiesVideoService:()=>W,entitiesVideoSyncService:()=>z,extendedService:()=>$,faveService:()=>Y,getVideoShowcaseServices:()=>j,groupOwnerService:()=>K,hideAuthorService:()=>q,ownerService:()=>Q,playlistDeletingService:()=>J,playlistService:()=>Z,playlistSubscriptionService:()=>ee,playlistVideoRemovingService:()=>te,playlistVideoReorderService:()=>ie,videoDeletingService:()=>oe,videoPlaylistsModalService:()=>re});var o=i(32489),r=i(12563),s=i(669557),n=i(178317),a=i(906085),d=i(583855),l=i(296627),c=i(87029),u=i(750988),h=i(424424),p=i(558137),m=i(996713),v=i(869071),g=i(884022),_=i(596791),C=i(802369),y=i(988765),b=i(122974),I=i(44975),S=i(704555),f=i(497663),w=i(906784),E=i(214587),k=i(947360),P=i(89783),A=i(386595),L=i(909784),x=i(966016),M=i(424932),O=i(381149),T=i(903274),V=i(963626);const F=e=>{const t=(0,r.createEntitiesGroupsService)({domain:e}),i=(0,s.createEntitiesUsersService)({domain:e}),o=(0,n.createEntitiesVideoAlbumService)({domain:e}),h=(0,a.createEntitiesPlaceholdersService)({domain:e}),p=(0,d.createEntitiesCatalogLiveChannelsService)({domain:e}),_=(0,l.createEntitiesCatalogLiveCategoriesService)({domain:e}),f=(0,c.createEntitiesVideoService)({domain:e,entitiesGroupsService:t,entitiesUsersService:i}),L=(0,y.createExtendedService)({entitiesGroupsService:t,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesVideoService:f,entitiesPlaceholdersService:h,entitiesCatalogLiveChannelsService:p,entitiesCatalogLiveCategoriesService:_}),x=(0,b.createFaveService)({domain:e,entitiesVideoService:f,onAddFave:A.showAddedFaveSnackbarFx,onRemoveFave:A.showRemovedFaveSnackbarFx}),M=(0,E.createHideAuthorService)({domain:e,entitiesGroupsService:t}),O=(0,S.createVideoDeletingService)({domain:e,entitiesVideoService:f}),T=(0,u.createListsVideosService)({domain:e,entitiesVideoService:f}),V=(0,I.createOwnerService)({domain:e,entitiesGroupsService:t,entitiesUsersService:i}),F=(0,k.createPlaylistService)({domain:e,entitiesVideoAlbumsService:o,listsVideosService:T,ownerService:V}),j=(0,k.createPlaylistSubscriptionService)({domain:e,entitiesVideoAlbumsService:o,playlistService:F,onSubscribe:A.showPlaylistSubscribeSnackbar,onUnsubscribe:A.showPlaylistUnsubscribeSnackbar}),R=(0,k.createPlaylistDeletingService)({entitiesVideoAlbumsService:o,onDeleted:e=>{(0,A.sendPlaylistDeletedEvents)(),(0,A.showPlaylistDeletedSnackbar)(e)}}),D=(0,m.createVideoPlaylistsModalService)(e),B=(0,k.createPlaylistVideoRemovingService)({domain:e,entitiesVideoAlbumsService:o,entitiesVideoService:f,playlistService:F,videoPlaylistsModalService:D,onVideoRemove:A.showPlaylistVideoRemoveSnackbar}),N=(0,g.createAuthorUserService)({domain:e,entitiesUsersService:i}),U=(0,k.createPlaylistVideoReorderService)({domain:e,playlistService:F,entitiesVideoAlbumsService:o}),G=(0,w.createGroupOwnerService)({domain:e}),H=(0,C.createEntitiesVideoSyncService)(f);return(0,P.registerPlaylistUpdateEventListener)(o),(0,v.connectTrackTmrGroupsJoin)(t.groupsJoinFx),{entitiesGroupsService:t,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesPlaceholdersService:h,entitiesVideoService:f,entitiesVideoSyncService:H,extendedService:L,faveService:x,listsVideosService:T,ownerService:V,playlistService:F,groupOwnerService:G,playlistSubscriptionService:j,playlistDeletingService:R,videoPlaylistsModalService:D,videoDeletingService:O,playlistVideoRemovingService:B,authorUserService:N,playlistVideoReorderService:U,hideAuthorService:M,entitiesCatalogLiveChannelsService:p,entitiesCatalogLiveCategoriesService:_}},j=(0,p.makeSharedState)("static/js/modules/web/VideoShowcase/store/index.ts",(()=>{const e=(0,o.createDomain)("VideoShowcase/VideoCatalog");return{domain:e,...F(e)}}),{version:1}),R=e=>{const{entitiesGroupsService:t,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesVideoService:r,entitiesPlaceholdersService:s}=j(),n=(0,h.createEntitiesCatalogSectionsService)({domain:e});return(0,_.createCatalogService)({domain:e,entitiesCatalogSectionsService:n,entitiesGroupsService:t,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesVideoService:r,entitiesPlaceholdersService:s})},D=(e,t)=>{const{entitiesVideoService:i,groupOwnerService:o}=j();return(0,f.createPinService)({domain:e,catalogService:t,entitiesVideoService:i,groupOwnerService:o,onPin:A.showVideoPinnedSnackbar,onUnpin:A.showVideoUnpinnedSnackbar})},{authorUserService:B,entitiesGroupsService:N,entitiesPlaceholdersService:U,entitiesUsersService:G,entitiesVideoAlbumsService:H,entitiesVideoService:W,entitiesVideoSyncService:z,extendedService:$,faveService:Y,hideAuthorService:q,groupOwnerService:K,listsVideosService:X,ownerService:Q,playlistDeletingService:J,playlistService:Z,playlistSubscriptionService:ee,playlistVideoRemovingService:te,playlistVideoReorderService:ie,videoDeletingService:oe,videoPlaylistsModalService:re}=j()},284994:(e,t,i)=>{i.d(t,{PlaylistServiceAdapter:()=>n});var o=i(331635),r=i(254328),s=i(664317);class n{constructor(e){this.playlistData=(0,r.store)(e.$playlistData),this.fetch=(0,r.event)(e.processPlaylistEvent)}}n=(0,o.__decorate)([(0,s.adapter)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof PlaylistServiceInstance?Object:PlaylistServiceInstance])],n)},445416:(e,t,i)=>{i.d(t,{PlaylistVideoRemovingServiceAdapter:()=>n});var o=i(331635),r=i(254328),s=i(664317);class n{constructor(e){this.removedVideosCount=(0,r.store)(e.$removedVideosCount),this.removedVideosIds=(0,r.store)(e.$removedVideosIds),this.removeVideoForUser=(0,r.event)(e.removeVideoForUserEvent),this.toggleVideoRemoved=(0,r.event)(e.toggleVideoRemovedEvent)}}n=(0,o.__decorate)([(0,s.adapter)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof PlaylistVideoRemovingServiceInstance?Object:PlaylistVideoRemovingServiceInstance])],n)},667229:(e,t,i)=>{i.d(t,{createPlaylistDeletingService:()=>r});var o=i(32489);const r=({entitiesVideoAlbumsService:e,onDeleted:t})=>{const{$entitiesVideoDeletedAlbums:i,$entitiesVideoDeletedAlbumsErrors:r,$entitiesVideoDeletedAlbumsPending:s,deleteVideoAlbumByIdFx:n}=e;return(0,o.sample)({clock:n.done,source:e.$entitiesVideoAlbums,fn:(e,{params:i})=>{const o=e[i.id];o&&t(o)}}),{$entitiesVideoDeletedAlbums:i,$entitiesVideoDeletedAlbumsErrors:r,$entitiesVideoDeletedAlbumsPending:s,deleteVideoAlbumByIdFx:n}}},404965:(e,t,i)=>{i.d(t,{createPlaylistService:()=>l});var o=i(32489),r=i(831144),s=i(361121),n=i(538522),a=i(386595),d=i(231450);const l=({domain:e,entitiesVideoAlbumsService:t,listsVideosService:i,ownerService:l})=>{const[c,u]=(0,r.createAbortControllerField)(e),h=e.createEvent(),p=e.createEvent(),m=e.createEvent(),v=e.createEvent(),g=e.createStore("").reset(h),_=e.createStore("").reset(h),C=(0,a.combineEntitiesId)(t.$entitiesVideoAlbums,_),y=(0,a.combineEntitiesId)(t.$entitiesVideoAlbumsErrors,_),b=(0,a.combineEntitiesId)(t.$entitiesVideoAlbumsLoading,_),{getOwnerEvent:I,...S}=l;(0,o.sample)({clock:p,source:{playlistId:_,playlistLoading:b},filter:({playlistId:e,playlistLoading:t})=>Boolean(e&&!t),fn:({playlistId:e})=>{const{itemId:t,ownerId:i}=(0,s.splitRawId)(e);return{ownerId:i,playlistId:t}},target:m}),(0,o.sample)({clock:m,source:c,fn:e=>(e?.abort(),new AbortController),target:c}),(0,o.sample)({clock:m,source:c,fn:(e,{ownerId:t})=>({controller:e,ownerId:t}),target:I}),(0,o.sample)({clock:m,fn:()=>{},target:i.resetVideosEvent}),(0,o.sample)({clock:m,fn:({ownerId:e,playlistId:t})=>(0,n.joinRawId)({itemId:t,ownerId:e}),target:_}),(0,o.sample)({clock:m,fn:({ownerId:e})=>String(e),target:g}),(0,o.sample)({clock:m,source:c,fn:(e,{ownerId:t,playlistId:i})=>({controller:e,query:{album_id:i,owner_id:t}}),target:t.getVideoAlbumByIdFx}),(0,o.sample)({clock:m,source:c,fn:(e,{ownerId:t,playlistId:i})=>({controller:e,entityKey:(0,n.joinRawId)({itemId:i,ownerId:t}),query:{album_id:i,count:25,extended:1,owner_id:t,fields:"verified,photo_50,is_esia_verified,is_sber_verified,is_tinkoff_verified",track_code:(0,d.getTrackCode)("search_track_code")||""}}),target:i.fetchVideosFx}),(0,o.sample)({clock:v,source:_,fn:e=>({entityKey:e}),target:i.fetchMoreVideosEvent});const f=i.selectStores(_.map(String));return{...S,$playlistId:_,$playlistData:C,$playlistError:y,$playlistLoading:b,$videosCount:f.$count,$videosError:f.$error,$videosFullyLoaded:f.$fullyLoaded,$videosIds:f.$listIds,$videosLoading:f.$loading,abortRequestEvent:u,resetPlaylistEvent:h,processPlaylistEvent:m,fetchMoreVideosEvent:v,refetchPlaylistEvent:p}}},669662:(e,t,i)=>{i.d(t,{createPlaylistSubscriptionService:()=>n});var o=i(32489),r=i(830019),s=i(386595);const n=({domain:e,entitiesVideoAlbumsService:t,playlistService:i,onSubscribe:n,onUnsubscribe:a})=>{const{$playlistId:d}=i,l=(0,r.createAbortControllersService)(e),c=(0,s.createPlaylistSubscriptionEffect)({$playlistId:d,abortControllersService:l,targetFx:(0,s.createCorrectingPlaylistEffect)({correction:1,effectFx:t.subscribeToVideoAlbumFx,entitiesVideoAlbumsService:t}),onDone:n}),u=(0,s.createPlaylistSubscriptionEffect)({$playlistId:d,abortControllersService:l,targetFx:(0,s.createCorrectingPlaylistEffect)({correction:-1,effectFx:t.unsubscribeFromVideoAlbumFx,entitiesVideoAlbumsService:t}),onDone:a}),h=e.createEvent(),p=(0,o.sample)({source:{controllers:l.$controllers,playlistId:d},fn:({controllers:e,playlistId:t})=>e[t]??null});return(0,o.sample)({clock:h,source:d,fn:e=>e,target:l.abortRequestEvent}),{$abortController:p,abortRequestEvent:h,subscribeFx:c,unsubscribeFx:u}}},810779:(e,t,i)=>{i.d(t,{createPlaylistVideoRemovingService:()=>s});var o=i(32489),r=i(538522);const s=({domain:e,entitiesVideoAlbumsService:t,entitiesVideoService:i,playlistService:s,videoPlaylistsModalService:n,onVideoRemove:a})=>{const{$playlistData:d,$playlistId:l,processPlaylistEvent:c,refetchPlaylistEvent:u}=s,h=e.createEvent(),p=(0,o.restore)(h,{}),m=e.createStore({}),v=e.createEvent();(0,o.sample)({clock:v,source:{playlistData:d,removedVideosIds:p},filter:({playlistData:e},{vkId:t})=>void 0!==t&&t===e?.owner_id,fn:({removedVideosIds:e},{videoId:t})=>({...e,[t]:!0}),target:p}),(0,o.sample)({clock:v,source:d,filter:(e,{vkId:t})=>void 0!==t&&t!==e?.owner_id,fn:(e,{videoId:t})=>({id:t}),target:i.videoGetByIdFx});const g=e.createEvent(),_=t.addVideoToAlbumFx,C=t.removeVideoFromAlbumFx,y=e.createEffect((({controller:e,currentIsRemoved:t,query:i})=>{const o={controller:e,query:i.params};return t?C(o):_(o)})),b=(e,t)=>({...e,[t]:!e[t]});(0,o.sample)({clock:[c,u],fn:()=>({}),target:p}),(0,o.sample)({clock:g,source:p,fn:(e,{params:t})=>{const i=(0,r.joinRawId)({ownerId:t.owner_id,itemId:t.video_id});return b(e,i)},target:p}),(0,o.sample)({clock:g,source:p,fn:(e,t)=>{const i=(0,r.joinRawId)({ownerId:t.params.owner_id,itemId:t.params.video_id});return{controller:new AbortController,currentIsRemoved:!!e[i],query:t}},target:y}),(0,o.sample)({clock:y,source:m,fn:(e,{controller:t,query:i})=>{const o=i.params.video_id;return e[o]?.abort(),{...e,[o]:t}},target:m}),(0,o.sample)({clock:[y.done,y.fail],source:p,filter:(e,t)=>("error"in t||!t.result)&&!t.params?.controller?.signal?.aborted,fn:(e,{params:t})=>{const i=t.query.params,o=(0,r.joinRawId)({ownerId:i.owner_id,itemId:i.video_id});return b(e,o)},target:h}),(0,o.sample)({clock:[y.done,y.fail],source:m,fn:(e,{params:t})=>{if(t?.controller?.signal?.aborted)return e;const i=t.query.params.video_id,o={...e};return delete o[i],o},target:m}),(0,o.sample)({clock:C.done,source:d,fn:(e,{params:t})=>{e&&a(e,(()=>{g({params:t.query})}))}}),(0,o.sample)({clock:n.removeFromAlbumDoneEvent,source:{playlistId:l,removedVideosIds:p},filter:({playlistId:e,removedVideosIds:t},{params:i})=>{if(t[(0,r.joinRawId)({itemId:i.query.video_id,ownerId:i.query.owner_id})])return!1;const{album_id:o,album_ids:s="",target_id:n}=i.query;if(void 0===n)return!1;const a=s.split(",");return o&&a.push(o),a.some((t=>(0,r.joinRawId)({itemId:Number(t),ownerId:n})===e))},fn:({removedVideosIds:e},{params:t})=>({...e,[(0,r.joinRawId)({itemId:t.query.video_id,ownerId:t.query.owner_id})]:!0}),target:h});return{$removedVideosCount:(0,o.sample)({clock:p,fn:e=>Object.values(e).filter(Boolean).length}),$removedVideosIds:p,removeVideoForUserEvent:v,toggleVideoRemovedEvent:g}}},90923:(e,t,i)=>{i.d(t,{createPlaylistVideoReorderService:()=>d});var o=i(32489),r=i(986125),s=i(361121),n=i(540462),a=i(615494);const d=({domain:e,playlistService:t,entitiesVideoAlbumsService:i})=>{const d=(0,n.partConfigEnabled)(a.VIDEO_REORDER_PLAYLIST_ALBUM_FIX),l=(0,r.createVideoReorderVideosFx)({domain:e}),c=(0,o.attach)({effect:i.getVideoAlbumByIdFx}),u=e.createEvent(),h=e.createEvent(),p=(0,o.combine)(l.pending,c.pending,((e,t)=>e||t));return(0,o.sample)({clock:u,source:t.$playlistId,fn:(e,t)=>{const{ownerId:i,videoId:o,beforeVideoId:r,beforeOwnerId:n,afterVideoId:a,afterOwnerId:d}=t,{ownerId:l,itemId:c}=(0,s.splitRawId)(e),u={target_id:l,album_id:c,owner_id:i,video_id:o};return void 0!==r&&(u.before_video_id=r,u.before_owner_id=n),void 0!==a&&(u.after_video_id=a,u.after_owner_id=d),{query:u}},target:l}),(0,o.sample)({clock:l.doneData,filter:()=>d,target:h}),(0,o.sample)({clock:h,source:t.$playlistId,filter:()=>d,fn:e=>{const{ownerId:t,itemId:i}=(0,s.splitRawId)(e);return{query:{owner_id:t,album_id:i}}},target:c}),{reorderVideosEvent:u,$isReordering:p}}},947360:(e,t,i)=>{i.d(t,{PlaylistServiceAdapter:()=>d.PlaylistServiceAdapter,PlaylistVideoRemovingServiceAdapter:()=>l.PlaylistVideoRemovingServiceAdapter,createPlaylistDeletingService:()=>r.createPlaylistDeletingService,createPlaylistService:()=>o.createPlaylistService,createPlaylistSubscriptionService:()=>s.createPlaylistSubscriptionService,createPlaylistVideoRemovingService:()=>n.createPlaylistVideoRemovingService,createPlaylistVideoReorderService:()=>a.createPlaylistVideoReorderService});var o=i(404965),r=i(667229),s=i(669662),n=i(810779),a=i(90923),d=i(284994),l=i(445416)},30332:(e,t,i)=>{i.d(t,{combineEntitiesId:()=>r});var o=i(32489);function r(e,t,i){return(0,o.combine)({entities:e,id:t},(({entities:e,id:t})=>t&&e[t]||i||null))}},65426:(e,t,i)=>{i.d(t,{createCorrectingPlaylistEffect:()=>s});var o=i(32489),r=i(538522);const s=({correction:e,effectFx:t,entitiesVideoAlbumsService:i})=>{const s=(0,o.attach)({effect:t});return(0,o.sample)({clock:s.done,source:i.$entitiesVideoAlbums,filter:(e,{params:t})=>"number"==typeof t.query.album_id,fn:(t,{params:i})=>{const o=(0,r.joinRawId)({itemId:i.query.album_id,ownerId:i.query.owner_id}),s=t[o]?.followers_count??0;return[{id:i.query.album_id,owner_id:i.query.owner_id,followers_count:Math.max(0,s+e)}]},target:i.patchVideoAlbumsEvent}),s}},301085:(e,t,i)=>{i.d(t,{createPlaylistSubscriptionEffect:()=>n});var o=i(32489),r=i(361121),s=i(204643);const n=({$playlistId:e,abortControllersService:t,targetFx:i,onDone:n,onEventFired:a})=>{const{clearControllerEvent:d,setControllerEvent:l}=t,c=(0,o.attach)({effect:i,source:e,mapParams:(e,t)=>{const{itemId:i,ownerId:o}=(0,r.splitRawId)(t);return{controller:e,query:{owner_id:o,album_id:i}}}});return(0,o.sample)({clock:c,source:e,fn:(e,t)=>(a?.(),{[e]:t}),target:l}),(0,o.sample)({clock:[c.done,c.fail],source:e,filter:(e,t)=>!(0,s.isAbortError)(t),fn:e=>e,target:d}),(0,o.sample)({clock:c.done,fn:()=>{n?.()}}),(0,o.attach)({effect:c,mapParams:()=>new AbortController})}},386595:(e,t,i)=>{i.d(t,{$selectUserOrGroupStoreById:()=>a.$selectUserOrGroupStoreById,combineEntitiesId:()=>o.combineEntitiesId,createCorrectingPlaylistEffect:()=>r.createCorrectingPlaylistEffect,createPlaylistSubscriptionEffect:()=>s.createPlaylistSubscriptionEffect,isAbortApiError:()=>n.isAbortApiError,isAbortError:()=>n.isAbortError,sendPlaylistDeletedEvents:()=>d.sendPlaylistDeletedEvents,showAddedFaveSnackbarFx:()=>l.showAddedFaveSnackbarFx,showPlaylistDeletedSnackbar:()=>c.showPlaylistDeletedSnackbar,showPlaylistSubscribeSnackbar:()=>u.showPlaylistSubscribeSnackbar,showPlaylistUnsubscribeSnackbar:()=>h.showPlaylistUnsubscribeSnackbar,showPlaylistVideoRemoveSnackbar:()=>p.showPlaylistVideoRemoveSnackbar,showRemovedFaveSnackbarFx:()=>l.showRemovedFaveSnackbarFx,showVideoDeletedSnackbar:()=>m.showVideoDeletedSnackbar,showVideoPinnedSnackbar:()=>v.showVideoPinnedSnackbar,showVideoUnpinnedSnackbar:()=>g.showVideoUnpinnedSnackbar});var o=i(30332),r=i(65426),s=i(301085),n=i(204643),a=i(521045),d=i(260167),l=i(544283),c=i(313124),u=i(533835),h=i(57536),p=i(434442),m=i(933789),v=i(204918),g=i(948159)},204643:(e,t,i)=>{i.d(t,{isAbortApiError:()=>s,isAbortError:()=>n});var o=i(664331),r=i(782399);const s=e=>e&&(0,r.isNetworkError)(e)&&(0,o.isRequestAbortError)(e.error),n=e=>"error"in e&&s(e.error)},831064:(e,t,i)=>{i.d(t,{selectEntityById:()=>r});var o=i(468073);const r=(e,t,i)=>{if(null===i)return null;const r=Number(i);return isNaN(r)?null:o.Ranges.isUserId(r)?e[i]??null:o.Ranges.isGroupId(r)?t[o.Ranges.convertOwnerIdToGroupId(r)]??null:null}},521045:(e,t,i)=>{i.d(t,{$selectUserOrGroupStoreById:()=>s});var o=i(32489),r=i(831064);const s=(e,t,i)=>(0,o.combine)(e,t,i,r.selectEntityById)},260167:(e,t,i)=>{i.d(t,{sendPlaylistDeletedEvents:()=>r});var o=i(826619);const r=()=>{window.dispatchEvent(new CustomEvent(o.PlaylistFormEvents.DELETE))}},544283:(e,t,i)=>{i.d(t,{showAddedFaveSnackbarFx:()=>c,showRemovedFaveSnackbarFx:()=>u});var o=i(474848),r=i(866467),s=i(432465),n=i(32489),a=i(13966),d=i(856289),l=i(373594);const c=(0,n.createEffect)((()=>{const e={text:(0,r.getLang)("video_added_to_watch_later"),before:{content:(0,o.jsx)(a.Icon24ClockOutline,{})},action:window.location.href.includes(d.BOOKMARKS_URL)?void 0:{label:(0,r.getLang)("global_open_section"),onClick:()=>window.location.href=d.BOOKMARKS_URL}};(0,s.showSnackbar)(e)})),u=(0,n.createEffect)((e=>{const t={text:(0,r.getLang)("video_deleted_from_my_watch_later"),before:{content:(0,o.jsx)(a.Icon24ClockOutline,{})},action:e.rollbackCallback?{label:(0,r.getLang)("global_cancel"),onClick:(t,i)=>{e.rollbackCallback?.(l.FAVORITE_SOURCES.SNACKBAR),(0,s.hideSnackbar)(i)}}:void 0};(0,s.showSnackbar)(t)}))},313124:(e,t,i)=>{i.d(t,{showPlaylistDeletedSnackbar:()=>s});var o=i(866467),r=i(432465);const s=e=>{const t=e?`«${e.title}»`:"",i=(0,o.langReplace)((0,o.getLang)("video_playlist_name_deleted"),{name:t});(0,r.showSnackbar)({text:i})}},533835:(e,t,i)=>{i.d(t,{showPlaylistSubscribeSnackbar:()=>a});var o=i(474848),r=i(432465),s=i(866467),n=i(629775);const a=()=>(0,r.showSnackbar)({text:(0,s.getLang)("video_you_subscribed_to_playlist"),before:{content:(0,o.jsx)(n.Icon20CheckAlt,{})}})},57536:(e,t,i)=>{i.d(t,{showPlaylistUnsubscribeSnackbar:()=>a});var o=i(474848),r=i(432465),s=i(866467),n=i(629775);const a=()=>(0,r.showSnackbar)({text:(0,s.getLang)("video_you_unsubscribed_from_playlist"),before:{content:(0,o.jsx)(n.Icon20CheckAlt,{})}})},434442:(e,t,i)=>{i.d(t,{showPlaylistVideoRemoveSnackbar:()=>a});var o=i(474848),r=i(866467),s=i(432465),n=i(818515);const a=(e,t)=>{const i=e?.title?` «${e.title}»`:"",a=`${(0,r.getLang)("video_deleted_from_playlist")}${i}`,d=(0,s.showSnackbar)({text:a,before:{content:(0,o.jsx)(n.Icon28ListCheckOutline,{})},action:{label:(0,r.getLang)("global_cancel"),onClick:async()=>{t(),(0,s.hideSnackbar)(await d)}}})}},933789:(e,t,i)=>{i.d(t,{showVideoDeletedSnackbar:()=>s});var o=i(866467),r=i(432465);const s=e=>{(0,r.showSnackbar)({text:(0,o.getLang)("video_video_deleted_snackbar_text"),action:{label:(0,o.getLang)("global_cancel"),onClick:async(t,i)=>{e(),(0,r.hideSnackbar)(i)}}})}},204918:(e,t,i)=>{i.d(t,{showVideoPinnedSnackbar:()=>s});var o=i(432465),r=i(866467);const s=()=>(0,o.showSnackbar)({text:(0,r.getLang)("video_pin_video_snackbar"),type:"ok"})},948159:(e,t,i)=>{i.d(t,{showVideoUnpinnedSnackbar:()=>s});var o=i(432465),r=i(866467);const s=()=>(0,o.showSnackbar)({text:(0,r.getLang)("video_unpin_video_snackbar"),type:"ok"})},244299:(e,t,i)=>{i.d(t,{cleanUrlForRequest:()=>o});const o=e=>(e=>e.endsWith("/")?e.slice(0,-1):e)((e=>e.split("?")[0])(e))},431725:(e,t,i)=>{i.d(t,{ensureEventPropagationStopping:()=>o});const o=(e,t)=>(e.stopPropagation(),t(e))},245238:(e,t,i)=>{i.d(t,{getOwnerPlaylistsUrl:()=>r});var o=i(172479);const r=(e,t)=>{const i=(0,o.getOwnerUrl)(e,t);return e?.id?[i,"playlists"].join("/"):i}},567255:(e,t,i)=>{i.d(t,{getShowcaseUrl:()=>o});const o=()=>"/video"},380277:(e,t,i)=>{i.d(t,{getVideoCardKey:()=>r});var o=i(538522);const r=(e,t)=>(0,o.joinRawId)({ownerId:e,itemId:t})},29593:(e,t,i)=>{i.d(t,{VideoCardLoggerFactory:()=>s.VideoCardLoggerFactory,canDeletePlaylistVideo:()=>g.canDeletePlaylistVideo,canDeletePlaylistVideoFromPlaylist:()=>g.canDeletePlaylistVideoFromPlaylist,cleanUrlForRequest:()=>o.cleanUrlForRequest,copyPlaylistUrl:()=>_.copyPlaylistUrl,ensureEventPropagationStopping:()=>r.ensureEventPropagationStopping,getFullAlbumId:()=>_.getFullAlbumId,getOwnerPlaylistsUrl:()=>n.getOwnerPlaylistsUrl,getShowcaseUrl:()=>a.getShowcaseUrl,getVerifiedBadge:()=>d.getVerifiedBadge,getVideoCardKey:()=>l.getVideoCardKey,initDestroyablePage:()=>c.initDestroyablePage,initVideoSubscriptionsBadgeQueue:()=>y.initVideoSubscriptionsBadgeQueue,isAccessDenied:()=>u.isAccessDenied,isIdInvalid:()=>h.isIdInvalid,isMyVideoAlbum:()=>_.isMyVideoAlbum,isServiceAlbumId:()=>_.isServiceAlbumId,isSystemPlaylist:()=>p.isSystemPlaylist,isVideosEnabled:()=>m.isVideosEnabled,logAddToMeClick:()=>v.logAddToMeClick,logAuthorClick:()=>v.logAuthorClick,logDownloadClick:()=>v.logDownloadClick,logFaveClick:()=>v.logFaveClick,logHideAuthorClick:()=>v.logHideAuthorClick,logShareClick:()=>v.logShareClick,logSubscribeClick:()=>v.logSubscribeClick,logTapClick:()=>v.logTapClick,mapAlbumsWithInclusionsToPlaylists:()=>_.mapAlbumsWithInclusionsToPlaylists,processLivesCatalogCardsGrid:()=>C.processLivesCatalogCardsGrid,showPlaylistActionSnackbar:()=>_.showPlaylistActionSnackbar});var o=i(244299),r=i(431725),s=i(163068),n=i(245238),a=i(567255),d=i(608802),l=i(380277),c=i(205914),u=i(858084),h=i(574669),p=i(748874),m=i(142396),v=i(642119),g=i(489211),_=i(305081),C=i(595071),y=i(908961)},205914:(e,t,i)=>{i.d(t,{initDestroyablePage:()=>s});var o=i(440961),r=i(256252);function s({descriptor:e,component:t}){var i,s,n;const a=()=>{(0,r.hydrateComponent)({descriptor:e,component:t})};a(),(i=window.cur)._back??(i._back={}),(s=window.cur._back).hide??(s.hide=[]),window.cur._back.hide.push((()=>{const{target:t}=e.payload;t&&o.unmountComponentAtNode(t)})),(n=window.cur._back).show??(n.show=[]),window.cur._back.show.push(a)}},858084:(e,t,i)=>{i.d(t,{isAccessDenied:()=>o});const o=e=>"api_error"===e?.type&&204===Number(e.error?.error_code)},574669:(e,t,i)=>{i.d(t,{isIdInvalid:()=>o});const o=e=>"api_error"===e?.type&&100===Number(e.error?.error_code)},748874:(e,t,i)=>{i.d(t,{isSystemPlaylist:()=>o});const o=e=>1===e?.is_system},142396:(e,t,i)=>{i.d(t,{isVideosEnabled:()=>o});const o=e=>"api_error"===e?.type&&15===Number(e.error?.error_code)},642119:(e,t,i)=>{i.d(t,{logAddToMeClick:()=>p,logAuthorClick:()=>u,logDownloadClick:()=>v,logFaveClick:()=>h,logHideAuthorClick:()=>a,logShareClick:()=>m,logSubscribeClick:()=>l,logTapClick:()=>c});i(174269);var o=i(314309),r=i(317216),s=i(231450);const n=()=>(0,s.getTrackCode)("search_track_code"),a=(e,t,i,s)=>{o.videoSubscribesHideAuthorStatsCollector.logEvent({event_type:e?r.VideoSubscribesHideAuthorEventTypes.UNDO_HIDE_CREATOR_FROM_SUBSCRIPTIONS:r.VideoSubscribesHideAuthorEventTypes.HIDE_CREATOR_FROM_SUBSCRIPTIONS,...t},s,i)},d=(e,t,i,r)=>{(r=n()||r)&&o.searchStatsCollector.logEvent({action:e,type:t,track_code:i||r})},l=(e,t,i)=>{d(e?r.SearchClickActionMap.UNSUBSCRIBE_OUT:r.SearchClickActionMap.SUBSCRIBE_OUT,t,i)},c=(e,t,i)=>{d(r.SearchClickActionMap.TAP,e,t,i)},u=(e,t,i)=>{d(r.SearchClickActionMap.OPEN_OWNER_OUT,e,t,i)},h=(e,t,i,o)=>{d(e?r.SearchClickActionMap.UNFAVE_OUT:r.SearchClickActionMap.FAVE_OUT,t,i,o)},p=(e,t,i,o)=>{d(e?r.SearchClickActionMap.REMOVE_FROM_ME_OUT:r.SearchClickActionMap.ADD_TO_ME_OUT,t,i,o)},m=(e,t)=>{d(r.SearchClickActionMap.SHARE_OUT,e,t)},v=(e,t)=>{d(r.SearchClickActionMap.DOWNLOAD_OUT,e,t)}},489211:(e,t,i)=>{i.d(t,{canDeletePlaylistVideo:()=>r,canDeletePlaylistVideoFromPlaylist:()=>o});const o=e=>Boolean(e.can_remove_videos),r=(e,t)=>Boolean(e.can_delete&&t.is_system)},305081:(e,t,i)=>{i.d(t,{copyPlaylistUrl:()=>I,getFullAlbumId:()=>_,isMyVideoAlbum:()=>v,isServiceAlbumId:()=>g,mapAlbumsWithInclusionsToPlaylists:()=>y,showPlaylistActionSnackbar:()=>b});var o=i(474848),r=i(538522),s=i(856289),n=i(866467),a=i(432465),d=i(540462),l=i(818515),c=i(629775),u=i(8520),h=i(105330),p=i(450927),m=i(451549);const v=e=>e===s.MY_VIDEO_ALBUM_ID,g=e=>e&&e<=0,_=({albumId:e,ownerId:t})=>e&&t?(0,r.joinRawId)({ownerId:t,itemId:e}):"",C=(e,t=!1)=>({id:e.id,title:e.title,isPrivate:"all"!==e?.privacy?.category||!!e?.privacy?.owners?.excluded?.length,containsVideo:t}),y=({albumsByVideo:e,albums:t,ownerId:i})=>{return e.reduce(((e,o)=>{const r=_({albumId:o,ownerId:i}),s=t[r];return s&&(e[r]=C(s,!0)),e}),{...(o=t,Object.keys(o).reduce(((e,t)=>{const i=o[t];return i&&(e[t]=C(i)),e}),{}))});var o},b=async({playlistId:e,ownerId:t,playlistTitle:i,added:r})=>{const c=v(e);if(!i&&!c)return;const h=c?await(async()=>(window.Video||await(0,p.getVideoModule)(),window.Video._getMyAddedVideosPath()))():(0,s.getPlaylistURL)(t,e);let m;m=r?(0,d.partConfigEnabled)("video_add_to_playlist_modal_mobx_move")?(0,n.getLang)("video_changes_saved"):c?(0,n.getLang)("video_added_to_section"):(0,n.getLang)("video_added_to_playlist"):(0,d.partConfigEnabled)("video_add_to_playlist_modal_mobx_move")?(0,n.getLang)("video_changes_saved"):c?(0,n.getLang)("video_deleted_from_section"):(0,n.getLang)("video_deleted_from_playlist");const g=c?(0,n.getLang)("video_catalog_showcase_section_my_video_added_title"):(0,u.decodeHTMLEntities)(i||"");(0,a.showSnackbar)({text:m,before:{content:(0,o.jsx)(l.Icon28ListCheckOutline,{})},action:(0,d.partConfigEnabled)("video_add_to_playlist_modal_mobx_move")?void 0:{label:g,onClick:()=>window.location.href=h},timeout:s.SNACKBAR_TIMEOUT}).catch()},I=({owner_id:e,id:t})=>{(0,u.copyTextToClipboard)(`https://${(0,h.getHostName)()}${(0,s.getPlaylistURL)(e,t)}`);(0,m.isVKUserAnonymous)()||(0,a.showSnackbar)({text:(0,n.getLang)("video_playlist_url_copied"),before:{content:(0,o.jsx)(c.Icon20CheckAlt,{})}})}},595071:(e,t,i)=>{i.d(t,{processLivesCatalogCardsGrid:()=>o});const o=(e,t=!1)=>{t?e.classList.add("VideoGrid--verticalThumbs"):e.classList.remove("VideoGrid--verticalThumbs")}},908961:(e,t,i)=>{i.d(t,{initVideoSubscriptionsBadgeQueue:()=>o.initVideoSubscriptionsBadgeQueue});var o=i(349237)},423236:(e,t,i)=>{i.d(t,{ASIDE_SUBSCRIPTIONS_ITEM_BADGE_CLASSNAME:()=>o,ASIDE_SUBSCRIPTIONS_ITEM_ID_ATTR_NAME:()=>r,VIDEO_SUBSCRIPTIONS_BADGE_QUEUE_NAME:()=>s});const o="MenuList__item--unseen",r="data-item-id",s="videosubscriptionbadge"},349237:(e,t,i)=>{i.d(t,{initVideoSubscriptionsBadgeQueue:()=>o.initVideoSubscriptionsBadgeQueue});var o=i(66746)},66746:(e,t,i)=>{i.d(t,{initVideoSubscriptionsBadgeQueue:()=>c});var o=i(328959),r=i(127609),s=i(712347),n=i(108315),a=i(14330),d=i(423236),l=i(150123);const c=()=>{const e=window.vk.id,t=`${d.VIDEO_SUBSCRIPTIONS_BADGE_QUEUE_NAME}_${e}`,i=()=>{const d=new o.QueueManager;(0,l.registerListeners)();const c=()=>{d.destroy(),(0,l.unregisterListeners)()};d.addQueue(t,(0,a.credentialsGetter)(t,e)).subscribe(((e,t)=>{(0,s.checkIsSuccessResponse)(t)&&(0,n.processEvents)(t,l.fireBadgeEvent)}),(()=>{c(),i()}));const u=(0,r.subscribeNavLocationChange)((()=>{c(),u()}))};i()}},595562:(e,t,i)=>{i.d(t,{fireBadgeEvent:()=>r});var o=i(693679);const r=({data:e})=>{const{author_id:t,type:i}=e;switch(i){case o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_TYPES.ADD_BADGE:case o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_TYPES.RM_BADGE:const e={detail:{author_id:t,type:i}},r=new CustomEvent(o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_NAME,e);document.dispatchEvent(r)}}},150123:(e,t,i)=>{i.d(t,{fireBadgeEvent:()=>o.fireBadgeEvent,registerListeners:()=>r.registerListeners,unregisterListeners:()=>s.unregisterListeners});var o=i(595562),r=(i(279435),i(944061)),s=i(218304)},279435:(e,t,i)=>{i.d(t,{onBadgeEvent:()=>s});var o=i(693679),r=i(423236);const s=e=>{(({detail:e})=>{const{author_id:t,type:i}=e,s=`${o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_NAME}_${t}`,n=`[${r.ASIDE_SUBSCRIPTIONS_ITEM_ID_ATTR_NAME}=${s}]`,a=document.querySelector(n);if(a)switch(i){case o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_TYPES.ADD_BADGE:a.classList.add(r.ASIDE_SUBSCRIPTIONS_ITEM_BADGE_CLASSNAME);break;case o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_TYPES.RM_BADGE:a.classList.remove(r.ASIDE_SUBSCRIPTIONS_ITEM_BADGE_CLASSNAME)}})(e)}},944061:(e,t,i)=>{i.d(t,{registerListeners:()=>s});var o=i(693679),r=i(279435);const s=()=>{document.addEventListener(o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_NAME,r.onBadgeEvent)}},218304:(e,t,i)=>{i.d(t,{unregisterListeners:()=>s});var o=i(693679),r=i(279435);const s=()=>{document.removeEventListener(o.VIDEO_SUBSCRIPTIONS_BADGE_EVENT_NAME,r.onBadgeEvent)}},712347:(e,t,i)=>{i.d(t,{checkIsSuccessResponse:()=>o});const o=e=>"events"in e},14330:(e,t,i)=>{i.d(t,{credentialsGetter:()=>r});var o=i(667891);const r=(e,t)=>async()=>{const i=await(0,o.queueSubscribe)({queue_ids:e}),{base_url:r}=i,{key:s,timestamp:n}=i.queues[0];return{id:t,key:s,ts:n,url:r}}},108315:(e,t,i)=>{i.d(t,{processEvents:()=>o});const o=({events:e},t)=>{e.forEach((e=>t(e)))}},352986:(e,t,i)=>{i.d(t,{ACCEPT_THUMB_FILES:()=>I,DEFAULT_VIDEO_GROUPS_PRIVACY:()=>u,DEFAULT_VIDEO_PRIVACY:()=>c,ENCODE_ATTEMPTS:()=>w,EUsersPrivacyCategories:()=>h,GROUPS_PRIVACY_BY_LINK:()=>l,GROUPS_PRIVACY_LIST:()=>m,MAX_COUNT_REQUEST_TO_ENCODE_PROGRESS:()=>b,MAX_LENGTH_OF_DESCRIPTION:()=>y,MAX_LENGTH_OF_TITLE:()=>C,MAX_SUBTITLES_COUNT:()=>v,PREVIEW_COLUMN_WIDTH:()=>d,SUBTITLES_INPUT_ACCEPT:()=>g,TAB_NAME_TO_VIDEO_PUBLISH_ACTION_EVENT_TYPE_MAPPER:()=>E,THUMB_HEIGHT:()=>f,THUMB_WIDTH:()=>S,UPLOAD_PATHNAME:()=>n,UPLOAD_SDK_SETTINGS:()=>_,USERS_PRIVACY_LIST:()=>p,VIDEO_LAZY_LOAD_PLAYLISTS_IN_UPLOADER:()=>k,YANDEX_DISK_ORIGIN:()=>a});var o=i(395846),r=i(210986),s=i(317216);const n=`${(0,i(856289).getVideoPrefix)("backSlash")}upload`,a="https://disk.yandex.ru",d=319,l=3,c=[0,1,[0],[]],u=[1,1,[1],[]];var h=function(e){return e[e.all=0]="all",e[e.friends=1]="friends",e[e.friendsOfFriends=2]="friendsOfFriends",e[e.onlyMe=3]="onlyMe",e[e.allExcept=4]="allExcept",e[e.someFriends=5]="someFriends",e[e.someFriendLists=6]="someFriendLists",e[e.byLink=8]="byLink",e}({});const p=[{alias:"all",value:0},{alias:"by_link",value:8},{alias:"friends_of_friends",value:2},{alias:"friends",value:1},{alias:"only_me",value:3},{alias:"all_except",value:4},{alias:"some_friends",value:5},{alias:"some_friend_lists",value:6}];const m=[{alias:"all",value:0},{alias:"members",value:1},{alias:"editors",value:2},{alias:"by_link",value:3},{alias:"nobody",value:4},{alias:"donut",value:5},{alias:"not_published",value:-1}],v=5,g=".srt",_={chunkSize:o.VIDEO_UPLOAD_CHUNK_SIZE,threadNumber:o.VIDEO_UPLOAD_FILE_THREAD_NUMBER,maxRetryNumber:o.VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER,debugMode:window.videoUploadSdkConfig&&!0===window.videoUploadSdkConfig.debugMode},C=128,y=5e3,b=18,I=".jpg,.jpeg,.png",S=142,f=80,w=4,E={[r.TabType.Information]:s.VideoPublishActionEventTypes.EVENT_TYPE_GO_TO_INFORMATION,[r.TabType.Additional]:s.VideoPublishActionEventTypes.EVENT_TYPE_GO_TO_ADDITIONAL,[r.TabType.Publication]:s.VideoPublishActionEventTypes.EVENT_TYPE_GO_TO_PUBLICATION},k="video_lazy_load_playlists_in_uploader"},210986:(e,t,i)=>{i.d(t,{EditSubtitleAction:()=>r,TabType:()=>o});var o=function(e){return e.Information="Information",e.Additional="Additional",e.Publication="Publication",e}({}),r=function(e){return e.Remove="remove",e.EditLang="edit_lang",e.SetDefault="set_default",e}({})},72966:(e,t,i)=>{i.d(t,{checkFileParams:()=>q,filterBatchedEditVideoResponse:()=>U,filterBatchedPublishVideoRejectedResponse:()=>N,filterBatchedPublishVideoResponse:()=>B,filterRejectedResponse:()=>W,filterRejectedResponseWithErrorSubcode:()=>z,getBatchedRequestsResponsesMapper:()=>D,getEncodeProgressTimeoutValue:()=>K,getExitConfirmInfo:()=>x,getFormattedOrdData:()=>E,getMyVideosUrl:()=>j,getPlaylistOption:()=>A,getPrivacyLabel:()=>O,getResponseForCurrentVideo:()=>F,getUploadFormId:()=>w,getValidVideoFiles:()=>L,getVideoEditParams:()=>H,getVideoPrivacyKey:()=>M,getVideoPublishParams:()=>G,hasUnpublishedVideos:()=>Y,isAbortApiError:()=>I,isSuccessfulVideoDeletingResponseForCurrentVideo:()=>R,ordMiniAppOpen:()=>k,parsePrivacyNewFormatToOld:()=>V,parsePrivacyOldFormatToNew:()=>T,shouldDisableDate:()=>P,showNotification:()=>$,videoUploadLogEvent:()=>S});var o=i(60411),r=i(866467),s=i(636576),n=i(889369),a=i(272880),d=i(782399),l=i(538522),c=i(615650),u=i(352986),h=i(664331),p=i(395846),m=i(856289),v=i(172479),g=i(898848),_=i(807978),C=i(540462),y=i(652547),b=i(248812);const I=e=>e&&(0,d.isNetworkError)(e)&&(0,h.isRequestAbortError)(e.error),S=(e,t)=>{let i;"boolean"==typeof t&&(i=t?"on":"off"),(0,s.statlogsValueEvent)("video_upload_page","",e,i)},f=(e=!0)=>{const t=e?"visible":"hidden",i=e?"1":"0",o=document.getElementById("box_layer_bg"),r=document.getElementById("box_layer_wrap");r&&o&&(r.style.visibility=t,o.style.visibility=t,r.style.opacity=i)},w=e=>e.fileObject?(0,l.joinRawId)({ownerId:e.fileObject.owner_id||0,itemId:e.fileObject.video_id||0}):e.externalFileObject?String(e.externalFileObject.extraData):"",E=e=>JSON.stringify({is_ads:e.is_ad,advertisers:[{ord_pred_id:e.ord_pred_id,er_id:e.erid}]}),k=(e,t,i,s=!0,n)=>{const a={edit:!1,options:{noLocChange:1,skipBoxesHide:1,hideBackButton:1,hideCloseButton:1,noClickHide:1,onLoaded:()=>{const e=document.querySelector(".app_actions_menu_wrap");e&&(e.style.display="none"),window.wkcur.onFail=f,window.wkcur.onHide=()=>{f(),window.cur.onExternalAppDone=null,window.wkcur.onFail=null,window.wkcur.onHide=null},window.cur.onExternalAppDone=()=>{window?.WkView.hide(!1,!0)},f(!1)},onFail:()=>f()},isSnackbar:!1};(0,o.handleOrdMiniappOpen)(e,(e=>{e&&(t(e),e.is_ad?i((0,r.getLang)("video_clip_ads_from_author_added")):i((0,r.getLang)("video_clip_ads_from_author_empty")),f()),s&&S("onAddAdvertisement")}),a,n)},P=e=>{const t=new Date,i=new Date;return t.setDate(t.getDate()-1),i.setFullYear(i.getFullYear()+1),(0,n.isAfter)(e,i)||(0,a.isBefore)(e,t)},A=e=>({label:e.title,value:e.id,preview:e.image?.[0]?.url||"",privacy:"all"!==e.privacy?.category}),L=e=>{const t=new DataTransfer;if(e?.length)for(let i=0;i<e.length;i++){const o=e.item(i);o&&(0,c.checkFileType)(o,p.SHORT_VIDEO_UPLOAD_EXTS)&&t.items.add(o)}return t.files},x=({notUploadedVideosCount:e=0,unsavedVideosCount:t=0,unsavedPostponedVideosCount:i=0,externalVideosCount:o=0,notUploadedClipCount:s=0,unsavedClipCount:n=0,unsavedClipPostponedCount:a=0,publishedNotUploadedVideosCount:d=0})=>{let l="",c="",u=(0,r.getLang)("video_publish_btn"),h=(0,r.getLang)("video_upload_come_back_later");return 1!==e||1!==o||t||i?o>1&&e===o&&!t&&!i?(l=(0,r.getLang)("video_upload_publish_video"),c=(0,r.getLang)("video_upload_cancel_externals_uploading"),h=(0,r.getLang)("global_cancel")):d?(l=(0,r.getLang)("video_uploader_page_exit_title"),c=(0,r.getLang)("video_uploader_page_exit_message"),u=(0,r.getLang)("video_uploader_leave"),h=(0,r.getLang)("global_cancel")):e&&e!==o||s?(l=(0,r.getLang)("video_upload_cancel_uploading"),c=(0,r.getLang)("video_upload_cancel_uploading_exit"),u=(0,r.getLang)("video_upload_interrupt_and_exit"),h=(0,r.getLang)("global_cancel")):t&&!i&&n&&!a?(l=(0,r.getLang)("video_upload_publish_video"),c=(0,r.getLang)("video_upload_publish_video_clip_text")):!t&&i&&!n&&a?(l=(0,r.getLang)("video_upload_schedule_publication"),c=(0,r.getLang)("video_upload_schedule_publication_video_clip_text"),u=(0,r.getLang)("video_upload_schedule_post")):(t||i)&&(n||a)?(l=(0,r.getLang)("video_upload_publish_video"),c=(0,r.getLang)("video_upload_publish_many_video_clip_text")):1!==t||i?1!==i||t?i>1&&!t?(l=(0,r.getLang)("video_upload_schedule_publications"),c=(0,r.getLang)("video_upload_schedule_publications_text"),u=(0,r.getLang)("video_upload_schedule_publications_btn")):i||t||o?(l=(0,r.getLang)("video_upload_publish_video"),c=(0,r.getLang)("video_upload_publish_many_videos_text")):n?(l=(0,r.getLang)("video_upload_publish_clip"),c=(0,r.getLang)("video_upload_publish_clip_text"),h=(0,r.getLang)("global_cancel")):n||1!==a?!n&&a>1&&(l=(0,r.getLang)("video_upload_schedule_publications"),c=(0,r.getLang)("video_upload_schedule_publications_text"),u=(0,r.getLang)("video_upload_schedule_publications_btn"),h=(0,r.getLang)("global_cancel")):(l=(0,r.getLang)("video_upload_schedule_publication"),c=(0,r.getLang)("video_upload_schedule_publication_modal_text"),u=(0,r.getLang)("video_upload_schedule_post"),h=(0,r.getLang)("global_cancel")):(l=(0,r.getLang)("video_upload_schedule_publication"),c=(0,r.getLang)("video_upload_schedule_publication_modal_text"),u=(0,r.getLang)("video_upload_schedule_post")):(l=(0,r.getLang)("video_upload_publish_video"),c=(0,r.getLang)("video_upload_publish_video_modal_text")):(l=(0,r.getLang)("video_upload_publish_video"),c=(0,r.getLang)("video_upload_cancel_external_uploading"),h=(0,r.getLang)("global_cancel")),{title:l,text:c,primaryBtn:u,secondaryBtn:h}},M=(e,t="",i="")=>t+[e.ownerId,e.fileObject?.video_id??e.externalFileObject?.extraData??0,i].filter(Boolean).join("_"),O=e=>{switch(e){case"all":return(0,r.getLang)("privacy_options_all_users");case"members":return(0,C.partConfigEnabled)("video_channel_rename")?(0,r.getLang)("video_privacy_group_for_channel_members"):(0,r.getLang)("video_privacy_group_for_members");case"editors":return(0,r.getLang)("video_privacy_group_for_editors");case"by_link":return(0,r.getLang)("video_privacy_group_by_link");case"donut":return(0,r.getLang)("video_privacy_group_for_donut");case"friends":return(0,r.getLang)("privacy_options_friends_only");case"friends_of_friends":return(0,r.getLang)("privacy_options_friends_and_friends");case"only_me":return(0,r.getLang)("privacy_options_only_me");case"nobody":return(0,r.getLang)("privacy_options_nobody");case"all_except":return(0,r.getLang)("privacy_options_advanced_settings");case"some_friends":return(0,r.getLang)("privacy_options_some_friends");case"some_friend_lists":return(0,r.getLang)("privacy_options_some_friend_lists");case"best_friends":return(0,r.getLang)("video_clips_privacy_options_best_friends_only");default:return""}},T=(e,t)=>{const i=(window.Privacy.getValue(e)||"").split("_");if(1===i.length)return t.find((e=>String(e.value)===i[0]))?.alias||"";if(2===i.length)return Number(i[0])+1===u.EUsersPrivacyCategories.someFriendLists?i[1].split(",").map((e=>`list${e}`)).join(","):i[1];if(4===i.length){const e=i[3].split(",").map((e=>Number(e)<0?`-list${Math.abs(Number(e))}`:String(-e))).join(",");if("0"===i[1]){return`${i[2].split(",").map((e=>Number(e)<0?`list${Math.abs(Number(e))}`:e)).join(",")},${e}`}return`${t.find((e=>String(e.value)===i[2]))?.alias||""},${e}`}return""},V=(e,t)=>{const i=e.owners?.allowed||[],o=e.owners?.excluded||[],r=e.lists?.allowed?.map((e=>-e))||[],s=e.lists?.excluded?.map((e=>-e))||[],n=e.category;if(n&&"list28"!==n){const e=String(t.find((e=>e.alias===n))?.value||0);return o.length||s.length?[u.EUsersPrivacyCategories.allExcept,1,[e],s.concat(o)]:[e,1,[e],[]]}return o.length||s.length?[u.EUsersPrivacyCategories.allExcept,0,r.concat(i),s.concat(o)]:i.length?[String(u.EUsersPrivacyCategories.someFriends),0,i,[]]:r.length?[String(u.EUsersPrivacyCategories.someFriendLists),0,r,[]]:["0",1,["0"],[]]},F=(e,t)=>{const i=t?.fileObject;if(!t||!i)return!1;const o=i.owner_id,r=i.video_id;if(!o||!r)return!1;return e[(0,l.joinRawId)({ownerId:o,itemId:r})]},j=(e,t)=>{const i="group"===e?.type||"page"===e?.type||"event"===e?.type,o=(0,v.getOwnerUrl)(e,(0,m.getOwnerVideosPageBasePath)());return e?.id&&t?i?`${o}/${t}`:[o,new URLSearchParams({section:t}).toString()].join("?"):o},R=(e,t)=>{const i=F(e,t);return i&&"fulfilled"===i?.status&&1===i?.value},D=(e,t)=>t.reduce(((t,i,o)=>{const r=e[o];if(r&&"owner_id"in r&&"number"==typeof r.owner_id&&"video_id"in r&&"number"==typeof r.video_id){const e=(0,l.joinRawId)({ownerId:r.owner_id,itemId:r.video_id});return{...t,[e]:{...i,query:r}}}return t}),{}),B=({uploadData:e},t)=>{const i=F(t,e);return i&&"fulfilled"===i?.status&&!!i?.value?.video},N=({uploadData:e},t)=>{const i=F(t,e);if(!i||"rejected"!==i?.status)return!1;const{error:o}=i?.reason;return o&&"error_subcode"in o&&-1!==Number(o.error_subcode)},U=({uploadData:e},t)=>{const i=F(t,e);if(!i||"fulfilled"!==i.status)return!1;const o=i?.value;return!!o.success},G=({uploadData:e,title:t,description:i,isRepeat:o,publishDate:r,ordInfo:s,selectedThumb:n,uploadedThumb:a,isHideAutoSubs:d,actionLink:c,actionLinkError:u,isPublishOnWall:h,checkContentId:p,privacyVideoList:m,privacyCommentsList:v,clipsForVideo:g,donutSelectedLevelId:C})=>{const y=e?.fileName||"",b={owner_id:Number(e?.fileObject?.owner_id),video_id:Number(e?.fileObject?.video_id),title:t,description:i,repeat:o?1:0,hide_auto_subs:d?1:0,add_to_wall:h?1:0,file_ext:y.match(/\.([^.]+)$/)?.[1],check_content_id:p?1:0,donut_level_id:C??void 0};!u&&c&&(b.action_link=c,S("onLinkInVideo")),r&&(b.publish_at=Math.floor(r.getTime()/_.SECOND)),n&&(b.thumb_id=String(n),n===a?.photo_id&&(b.thumb_id=(0,l.joinRawId)({ownerId:n,itemId:Number(a?.photo_owner_id)}),b.thumb_hash=a.photo_hash)),s&&(b.ord_info=E(s)),window.nav?.objLoc?.ocl&&(b.ocl=1),e&&(b.privacy_video=T(M(e,"video"),m),b.privacy_video_comments=T(M(e,"videocomm"),v));const I=g.map((e=>(0,l.joinRawId)({itemId:Number(e.id),ownerId:Number(e.owner_id)})));return b.attach_short_videos=I.join(","),S(i.length?"onSaveWithDesc":"onSaveVideo"),b},H=({uploadData:e,title:t,description:i,isRepeat:o,publishDate:r,ordInfo:s,selectedThumb:n,uploadedThumb:a,isHideAutoSubs:d,actionLink:c,isPublished:u,savedVideo:h,isExternal:p,privacyVideoList:m,privacyCommentsList:v,actionLinkError:g})=>{const C={owner_id:h?.owner_id?h.owner_id:Number(e?.fileObject?.owner_id),video_id:h?.id?h.id:Number(e?.fileObject?.video_id),name:t,desc:i};return p||(C.repeat=o?1:0,C.hide_auto_subs=d?1:0,n&&(C.thumb_id=String(n),n===a?.photo_id&&(C.thumb_id=(0,l.joinRawId)({ownerId:n,itemId:Number(a?.photo_owner_id)}),C.thumb_hash=a.photo_hash)),u||(C.publish_date=Math.floor((r?r.getTime():Date.now())/_.SECOND)),!g&&c&&(C.action_link=c,S("onLinkInVideo"))),s&&(C.ord_info=E(s)),u&&e&&(C.privacy_view=T(M(e,"video"),m),C.privacy_comment=T(M(e,"videocomm"),v)),S(i.length?"onSaveWithDesc":"onSaveVideo"),C},W=({uploadData:e},t)=>{const i=F(t,e);return i&&"rejected"===i?.status},z=({uploadData:e},t)=>{const i=F(t,e);if(!i||"rejected"!==i?.status)return!1;const{error:o}=i?.reason;return o&&"error_subcode"in o&&-1!==Number(o.error_subcode)},$=({fileType:e,ownerType:t,groupName:i,amount:o})=>{if(!("Notifier"in window)||!("showEvent"in window.Notifier))return;const s=(({ownerType:e,groupName:t,amount:i})=>{if("multiple"===i)return"user"===e?(0,r.getLang)("global_video_uploader_success_videos_publication_notification_for_user"):t?(0,r.langReplace)((0,r.getLang)("global_video_uploader_success_videos_publication_notification_for_community"),{name:t}):void 0})({ownerType:t,groupName:i,amount:o})??(({fileType:e,ownerType:t,groupName:i})=>{if("video"===e)return"user"===t?(0,r.getLang)("global_video_uploader_success_video_publication_notification_for_user"):i?(0,r.langReplace)((0,r.getLang)("global_video_uploader_success_video_publication_notification_for_community"),{name:i}):void 0})({fileType:e,ownerType:t,groupName:i})??(({fileType:e,ownerType:t,groupName:i})=>{if("clip"===e)return"user"===t?(0,r.getLang)("global_video_uploader_success_clip_publication_notification_for_user"):i?(0,r.langReplace)((0,r.getLang)("global_video_uploader_success_clip_publication_notification_for_community"),{name:i}):void 0})({fileType:e,ownerType:t,groupName:i})??"";window.Notifier.showEvent({type:"done_box",preventHideByClick:!0,text:`<div style="min-height: 32px; display: flex; align-items: center;"><div className="notifier_snackbar_text">${(0,g.clean)(s)}</div></div>`,avatar_custom_content:(0,b.getIcon24CheckCircleOutline)().icon,tooltipHandler:e=>{e.classList.add("notifier_snackbar_with_custom_before"),e.classList.add("notifier_snackbar_type_ok")}})},Y=e=>e.unsavedClipCount>0||e.unsavedVideosCount>0||e.externalVideosCount>0||e.notUploadedClipCount>0||e.notUploadedVideosCount>0||e.unsavedClipPostponedCount>0||e.unsavedPostponedVideosCount>0||e.publishedNotUploadedVideosCount>0;async function q(e,t){const i=await(0,c.getVideoMetadata)(e),o=(0,C.getConfigValue)("short_video_publish_video_to_clips_duration_min")??y.CLIP_MIN_LIMIT,r=(0,C.getConfigValue)("short_video_publish_video_to_clips_duration_max")??y.CLIP_MAX_LIMIT;return{hasMetadata:!!i&&"duration"in i&&"height"in i&&"width"in i,isVideoAsClip:!t?.is_closed&&(null!==i&&i.duration<r&&i.duration>o&&i.height>=i.width)}}const K=(e=0,t=1)=>(Math.floor(e/u.MAX_COUNT_REQUEST_TO_ENCODE_PROGRESS)+Math.ceil(t/u.MAX_COUNT_REQUEST_TO_ENCODE_PROGRESS))*_.SECOND*2},541864:(e,t,i)=>{i.d(t,{MARKET_ITEM_CREATE_EVENT:()=>r,MARKET_ITEM_DELETE_EVENT:()=>o,MARKET_ITEM_UPDATE_EVENT:()=>s,MARKET_SERVICE_UPDATE_EVENT:()=>n,RUSSIA_ID:()=>a});const o="MarketItemDelete",r="MarketItemCreate",s="MarketItemUpdate",n="MarketServiceUpdate",a=1},717433:(e,t,i)=>{i.d(t,{dispatchItemDeleteEvent:()=>r});var o=i(541864);const r=e=>{window.dispatchEvent(new CustomEvent(o.MARKET_ITEM_DELETE_EVENT,{detail:e}))}},805102:(e,t,i)=>{i.d(t,{constructProductLink:()=>r});var o=i(831762);function r({screen:e,refSource:t,refScreen:i,itemId:r,ownerId:s,ref:n,type:a,withGroupHeader:d,seoSlug:l="",adsLabel:c}){const u=new URLSearchParams;return t&&u.set("ref_source",t),i&&u.set("ref_screen",i),n&&u.set("ref",n),e&&u.set("screen",e),c&&u.set("ads_label",c),a&&u.set("type",a),d&&u.set(o.GROUP_HEADER_QUERY_PARAM,"1"),`${window.location.origin}/market/product/${l??""}${s}-${r}${u.toString()?`?${u.toString()}`:""}`}},391566:(e,t,i)=>{i.d(t,{useModuleReady:()=>s});var o=i(296540),r=i(871873);const s=e=>{const[t,i]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{(0,r.onModuleReady)(e,(()=>i(!0)))}),[]),t}},99752:(e,t,i)=>{i.d(t,{ExternalLink:()=>n});var o=i(474848),r=i(279734),s=i(449299);function n({goAwayUrl:e,children:t,href:i,onClick:n,...a}){return(0,o.jsx)(r.Link,{target:"_blank",rel:"noopener",href:i,onClick:t=>{n?.(),(0,s.goAway)(e,{},t)},...a,children:t})}},176530:(e,t,i)=>{i.d(t,{MemLink:()=>a});var o=i(474848),r=i(568775),s=i(458840),n=i(279734);function a({children:e,href:t,mentionId:i,mention:a,onClick:d,disableMentionHover:l,...c}){return(0,o.jsx)(n.Link,{target:"_blank",rel:"noopener",href:t,mention_id:i,mention:a,onMouseOver:e=>{l||(0,r.mentionOver)(e.currentTarget,e.nativeEvent)},onClick:e=>(d?.(),(0,s.mentionClick)(e.currentTarget,e.nativeEvent)),...c,children:e})}},667716:(e,t,i)=>{i.d(t,{MemOrExternalLink:()=>a});var o=i(474848),r=i(176530),s=i(99752),n=i(279734);function a({href:e,children:t,goAwayUrl:i,mentionId:a,mention:d,onClick:l,disableMentionHover:c,...u}){return i?(0,o.jsx)(s.ExternalLink,{onClick:l,href:e,goAwayUrl:i,...u,children:t}):a?(0,o.jsx)(r.MemLink,{onClick:l,href:e,mentionId:a,mention:d,disableMentionHover:c,...u,children:t}):(0,o.jsx)(n.Link,{onClick:l,href:e,...u,children:t})}},136883:(e,t,i)=>{i.d(t,{MemLink:()=>o.MemLink,MemOrExternalLink:()=>r.MemOrExternalLink});i(99752);var o=i(176530),r=i(667716)},60411:(e,t,i)=>{i.d(t,{handleOrdMiniappOpen:()=>l});var o=i(494565),r=i(52905),s=i(866467),n=i(310338),a=i(432465),d=i(545537);const l=(e,t,i,l)=>{const c=l?{...e,service:l}:e,u=c?(0,o.objectToQuerystring)(c,"#"):"",h=(0,n.getStore)().onOrdData.watch((o=>{i?.isSnackbar&&(o?.is_ad&&!e?.is_ad?(0,a.showSnackbar)({text:(0,s.getLang)("global_ads_wall_post_ord_mark_as_ads_added"),timeout:3e3,type:"ok28"}):!o?.is_ad&&e?.is_ad&&(0,a.showSnackbar)({text:(0,s.getLang)("global_ads_wall_post_ord_mark_as_ads_removed"),timeout:3e3,type:"loudspeaker28"})),t(o,i?.ref),h()}));i=i||{};const p={...i,options:{...i.options||{}}},{onDestroy:m,onLoaded:v}=p.options;p.options.asBox?p.options.onDestroy=(...e)=>{m?.(...e),h()}:p.options.onLoaded=(...e)=>{v?.(...e),(0,d.addWkViewHideQueue)((()=>h()))},window.showWiki?.({w:`app${r.ORD_APP_ID}${u}`},p?.edit,p?.ev,p?.options)}},279515:(e,t,i)=>{i.d(t,{VideoCardWrapper:()=>y});var o=i(474848),r=i(618068),s=i(296540),n=i(174269),a=i(351137),d=i(317216),l=i(856289),c=i(370420),u=i(29593),h=i(950885),p=i(401244),m=i(35674),v=i(290874),g=i(867783),_=i(540462),C=i(246429);const y=({controls:e,owner:t,video:i,onVideoOpen:y,onToggleFav:b,onAuthorClick:I,collectClick:S,videoContainerWidth:f,direction:w,...E})=>{const{videoCardProps:k,onOpenPlaylistModal:P}=(0,a.useCatalogDesktopVideo)(),{onVideoDelete:A,videoDeleteText:L}=k,x=(0,s.useRef)(null),M=(0,_.partConfigEnabled)("video_card_controls_focus_fix"),O=function({video:e,onToggleFav:t}){return(0,s.useMemo)((()=>{const{owner_id:i,id:o}=e;if(!i||!o)return;const r=()=>(0,h.shareVideoExtended)(i,o);return c.getMenuItems(c.watchLater(e,(()=>t(n.FAVORITE_SOURCES.VIDEO_CARD_MODAL))),c.share(e,(()=>(0,p.showVideoShareModal)({videoId:o,ownerId:i,onEmbedClick:r,onClose:()=>(0,C.curBox)()?.hide(),urlPart:"/video"}))),c.report(e,(()=>(0,g.reportHandler)(String(o),String(i)))))}),[e,t])}({video:i,onToggleFav:b}),T=(0,v.useControls)({video:i,controls:e??[],onToggleFav:b,onOpenPlaylistModal:P,onVideoDelete:A,videoDeleteText:L}),V=(0,n.useRefLogView)({type:d.EventItemType.VIDEO,trackCode:i?.track_code});return(0,o.jsx)(r.VideoCard,{getRef:M?e=>{V?.(e),x.current=e}:V,controlItems:(0,o.jsx)(m.VideoCardControls,{video:i,cardRef:M?x:void 0,collectClick:S,controls:T??[]}),menuItems:O,video:{...(0,l.mapVideoToVideoCardItem)(i),owner:{...(0,l.mapArtistToVideoCardOwner)(i)??(0,l.mapUserOrGroupToVideoCardOwner)(t,(0,l.getOwnerVideosPageBasePath)()),badge:(0,u.getVerifiedBadge)(t)}},onVideoOpen:y,onAuthorClick:I,direction:w,videoContainerWidth:"horizontal"===w?f:void 0,...E})}},172344:(e,t,i)=>{i.d(t,{VideoCardControls:()=>n});var o=i(474848),r=i(618068),s=i(642311);const n=({video:e,controls:t,collectClick:i,cardRef:n})=>t?.length?(0,o.jsx)(o.Fragment,{children:t.map((t=>{if(t.type===s.ControlTypes.ICON){const{text:i,onClick:s,component:n}=t;return(0,o.jsx)(r.VideoCard.IconControl,{tooltipText:i,onClick:t=>s(t,e),icon:n},i)}if(t.type===s.ControlTypes.PLAYLIST_POPOVER){const{component:r}=t;return(0,o.jsx)(r,{video:e,collectClick:i,cardRef:n},e.id)}}))}):null},331934:(e,t,i)=>{i.d(t,{VideoCardControls:()=>o.VideoCardControls});var o=i(172344)},35674:(e,t,i)=>{i.d(t,{VideoCardControls:()=>o.VideoCardControls});var o=i(331934)},524236:(e,t,i)=>{i.d(t,{showEditVideoForm:()=>r});var o=i(270959);const r=({oid:e,vid:t})=>{const i={vid:t,oid:e};(0,o.showBox)("al_video.php?act=edit_box",i,{containerClass:"video_edit"})}},867783:(e,t,i)=>{i.d(t,{reportHandler:()=>o.reportHandler,showEditVideoForm:()=>r.showEditVideoForm});var o=i(269533),r=i(524236)},269533:(e,t,i)=>{i.d(t,{reportHandler:()=>r});var o=i(866467);const r=async(e,t,i)=>{e&&t&&(window.Videoview||await window.stManager.add([window.jsc("web/videoview.js")]),window.Videoview.showReportVideoForm(t,e,(()=>{window.VideoShowcase?.showCardFeedback(t,e,(0,o.getLang)("global_report_spam"))}),i))}},290874:(e,t,i)=>{i.d(t,{useControls:()=>o.useControls});var o=i(277553)},277553:(e,t,i)=>{i.d(t,{useControls:()=>C});var o=i(296540),r=i(868687),s=i(48876),n=i(379539),a=i(719619),d=i(947962),l=i(866467),c=i(109889),u=i(642311),h=i(142553),p=i(540462),m=i(174269),v=i(53731),g=i(666384),_=i(636826);const C=({video:e,controls:t,onToggleFav:i,onOpenPlaylistModal:C,onVideoDelete:y,videoDeleteText:b})=>{const{id:I,owner_id:S,can_edit:f,can_add:w,can_delete:E,can_download:k,title:P,type:A}=e,L=Array.isArray(t)?t:[],x=(0,p.partConfigEnabled)("video_bookmarks_renaming_to_watch_later"),M=(0,p.partConfigEnabled)("video_can_show_playlist_popover_with_watch_later"),O=(0,p.partConfigEnabled)("video_in_community_by_search");return(0,o.useMemo)((()=>(window.location.href.includes(g.IS_ALL_QUERY_IN_URL_BY_SEARCH)&&window.location.href.includes(g.IS_CLUB_IN_URL_BY_SEARCH)||!O?(0,p.partConfigEnabled)("video_control_actions_for_editor_or_administrator_community")&&(f&&I&&S&&L.push({component:n.Icon16PenOutline,text:(0,l.getLang)("video_edit"),onClick:()=>(0,c.showEditVideoForm)({oid:String(S),vid:String(I)}),type:u.ControlTypes.ICON}),I&&S&&w&&C&&(M||!x)&&L.push({component:a.Icon16ListPlayOutline,text:(0,l.getLang)("video_move_to_playlist"),onClick:()=>C(e),type:u.ControlTypes.ICON}),e.id&&e.owner_id&&1===E&&y&&L.push((0,v.getDeleteControl)((t=>y(t,e)),b))):(x&&e.can_add_to_faves&&L.push({type:u.ControlTypes.ICON,component:e.is_favorite?r.Icon16Clock:s.Icon16ClockOutline,text:e.is_favorite?(0,l.getLang)("video_remove_from_watch_later"):(0,l.getLang)("video_catalog_showcase_section_my_watch_later_title"),onClick:()=>i(m.FAVORITE_SOURCES.VIDEO_CARD_BUTTON)}),w&&M&&L.push({type:u.ControlTypes.PLAYLIST_POPOVER,component:h.AddToPlaylistControl})),(0,p.partConfigEnabled)("video_can_download_by_control_actions")&&3===k&&I&&S&&P&&A&&L.push({component:d.Icon16DownloadOutline,text:(0,l.getLang)("video_download_short"),onClick:()=>(0,_.downloadVideo)({oid:String(S),title:P,type:A,vid:String(I)}),type:u.ControlTypes.ICON}),L)),[e,t])}},109889:(e,t,i)=>{i.d(t,{VideoCardControls:()=>r.VideoCardControls,VideoCardWrapper:()=>o.VideoCardWrapper,reportHandler:()=>n.reportHandler,showEditVideoForm:()=>n.showEditVideoForm,useControls:()=>s.useControls});var o=i(279515),r=i(35674),s=i(290874),n=i(867783)},916637:(e,t,i)=>{i.d(t,{showVideo:()=>l});var o=i(896412),r=i(174269),s=i(134551),n=i(856289),a=i(841315),d=i(540462);const l=({event:e,id:t,video:i,videoUrlWithParams:l})=>{(0,o.cancelEvent)(e);const c=l??(0,a.getVideoUrl)(i);if(e.ctrlKey||e.metaKey)return void window.open(c,"_blank");const u=i.viewed_duration?(0,r.getPlayFromByDuration)(i.viewed_duration):"",h=!(0,n.isVideoStandalone)(),p="music_video"===i.type&&h,m="live"===i.type&&i.live_status&&["started","waiting"].includes(i.live_status),v="short_video"===i.type;h&&!(0,n.isVideoSection)()||p||m||v?s.Video.show(e,t,{autoplay:1,queue:0,playFrom:u,addParams:{track_code:i.track_code}},e.target):(window.VideoShowcase?.setVideoPageOpts({module:window.cur.currentModule?window.cur.currentModule():window.cur.module,trackCode:i.track_code,context:window.cur.ref_context}),(0,d.partConfigEnabled)("vkvideo_sport_domain")?(0,n.navigateToVideo)(c):window.nav.go(c))}},92600:(e,t,i)=>{i.d(t,{AddToPlaylistControl:()=>I});var o=i(474848),r=i(293721),s=i(296540),n=i(618068),a=i(335797),d=i(344634),l=i(711032),c=i(866467),u=i(856289),h=i(574479),p=i(464939),m=i(29593),v=i(826619),g=i(296761),_=i(317216),C=i(540462),y=i(450927),b=i(609253);const I=({video:e,collectClick:t,cardRef:i,searchTrackCode:I,...S})=>{const[f,w]=(0,s.useState)(!1),{owner_id:E=0,id:k=0,added:P}=e,A=(0,p.ensurePlaylistPopoverService)(),L=(0,m.getVideoCardKey)(E,k),x=(0,a.useEntitiesStore)(A.videoCardEntities,L),M=(0,g.usePlaylists)(A.$playlistEntityStore),O=(0,r.useStore)(A.$playlistsLoading),T=(0,r.useStore)(A.$playlistsFullyLoaded),V=(0,r.useStore)(A.$ownerId),F=(0,r.useEvent)(A.addVideoCardEntity),j=(0,r.useEvent)(A.togglePlaylistAddedEvent),R=(0,r.useEvent)(A.fetchPlaylistsEvent),D=(0,r.useEvent)(A.fetchMorePlaylistsEvent),B=(0,r.useStore)(A.$curVideoAddedToMy),N=(0,r.useEvent)(A.clearStoreEvent),U=(0,r.useEvent)(A.createPlaylistEvent),G=(0,C.partConfigEnabled)("video_can_show_playlist_popover_with_watch_later"),H=x?.added?(0,c.getLang)("video_card_added_button_label"):(0,c.getLang)("video_card_add_button_label"),W=G?void 0:H,z=(0,C.partConfigEnabled)("video_can_add_to_my_from_card"),$=e=>{w(e),e||N()};(0,s.useEffect)((()=>{F({added:Boolean(P),oid:E,vid:k})}),[]),(0,s.useEffect)((()=>{f&&R(L)}),[f]),(0,s.useEffect)((()=>{(0,C.partConfigEnabled)("video_playlist_redesign_popup")||window.VideoShowcase||(0,y.getVideoShowcaseModule)()}),[]);const Y=(o=Boolean(B),r=u.MY_VIDEO_ALBUM_ID)=>{if(!O)return t?.({action:o?_.SearchClickActionMap.REMOVE_FROM_ME:_.SearchClickActionMap.ADD_TO_ME,track_code:e?.track_code,type:_.EventItemType.VIDEO}),(0,m.logAddToMeClick)(o,_.EventItemType.VIDEO,e?.track_code,I),i?.current?.parentElement?.focus(),j({key:L,album_id:r,isAdded:o})},q=z?()=>Y():void 0;return(0,o.jsx)(h.PlaylistPopover,{trigger:"hover",shown:f,cardRef:i,addedToMy:Boolean(B),onToggleVideoAdded:(e,t)=>Y(e,t),onCreateNewPlaylist:e=>{$(!1),(0,C.partConfigEnabled)("video_playlist_redesign_popup")?(0,b.showPlaylistModal)({ownerId:V,onCreate:e=>U({...e,ownerId:V,videoId:k,videoOwnerId:E}),hasOnCreateSnackbar:!1}):(0,v.createPlaylistPopup)({event:e,ownerId:V,videoId:k,videoOwnerId:E,requestOrigin:v.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL}).catch()},addedToMyCheckboxDisabled:O,playlistsLoading:O,playlists:M,width:u.PLAYLIST_POPOVER_WIDTH,maxWidth:u.PLAYLIST_POPOVER_WIDTH,offsetByMainAxis:u.PLAYLIST_POPOVER_VERTICAL_OFFSET,placement:"bottom-end",fetchMorePlaylistEvent:T?void 0:D,onShownChange:$,...S,children:(0,o.jsx)(n.VideoCard.ExpandingControl,{icon:x?.added?(0,o.jsx)(d.Icon16CheckOutline,{onClick:q,"data-testid":S["data-testid"]}):(0,o.jsx)(l.Icon16Add,{onClick:q,"data-testid":S["data-testid"]}),text:W,expanded:f})})}},142553:(e,t,i)=>{i.d(t,{AddToPlaylistControl:()=>o.AddToPlaylistControl});var o=i(92600)},348904:(e,t,i)=>{i.d(t,{PlaylistPopover:()=>y});var o=i(474848),r=i(296540),s=i(625528),n=i(303800),a=i(194528),d=i(582192),l=i(285056),c=i(700272),u=i(744440),h=i(866467),p=i(982184),m=i(856289),v=i(245321),g=i(482479),_=i(42770),C=i(902235);const y=({addedToMy:e,noPublicAdd:t=!1,playlists:i,onToggleVideoAdded:y,children:b,trigger:I="hover",videoId:S,videoOwnerId:f,playlistsLoading:w,onCreateNewPlaylist:E,addedToMyCheckboxDisabled:k,fetchMorePlaylistEvent:P,cardRef:A,...L})=>{const[x,M]=(0,r.useState)(null);(0,C.useLazyLoad)(Boolean(P),P,x);return(0,o.jsx)(s.Popover,{trigger:I,restoreFocus:!1,content:(0,o.jsxs)(n.Div,{mode:"vertical",spacing:8,paddingTop:8,paddingBottom:8,children:[(0,o.jsx)(g.PlaylistPopoverHeader,{addedToMy:e,noPublicAdd:t,onToggleMyAlbum:()=>{A?.current?.parentElement?.focus(),y(e,m.MY_VIDEO_ALBUM_ID)},addedToMyCheckboxDisabled:k}),(0,o.jsx)(a.Spacing,{size:8}),(0,o.jsx)(d.Separator,{wide:!0}),(0,o.jsx)(a.Spacing,{size:8}),(Boolean(i?.length)||w)&&!t&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.Div,{mode:"vertical",spacing:8,paddingTop:4,paddingBottom:6,children:(0,o.jsx)(l.Footnote,{className:p.default.playlistSubhead,weight:"3",children:(0,h.getLang)("video_playlists")})})}),w&&!i?.length&&(0,o.jsx)("div",{className:p.default.scrollHeight,children:(0,o.jsx)(c.Spinner,{})}),Boolean(i?.length)&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(u.CustomScrollView,{className:p.default.maxScrollHeight,boxRef:M,children:[i?.map((e=>(0,o.jsx)(v.PlaylistPopoverItem,{playlist:e,handleToggleVideoAdded:y},e.id))),w&&(0,o.jsx)(c.Spinner,{})]})}),(0,o.jsx)(_.PlaylistPopoverCreatePlaylistButton,{onCreateNewPlaylist:E})]}),...L,children:b})}},42770:(e,t,i)=>{i.d(t,{PlaylistPopoverCreatePlaylistButton:()=>h});var o=i(474848),r=i(296540),s=i(220208),n=i(303800),a=i(724648),d=i(723723),l=i(285056),c=i(866467),u=i(549318);const h=(0,r.memo)((function({onCreateNewPlaylist:e}){return(0,o.jsx)(s.Tappable,{onClick:e,hasHover:!0,hasActive:!0,"data-testid":"create_playlist_from_video_card_checkbox_button",children:(0,o.jsx)(n.Div,{mode:"vertical",spacing:8,paddingTop:8,paddingBottom:8,children:(0,o.jsxs)(a.Flex,{align:"center",direction:"row",gap:12,children:[(0,o.jsx)(u.Icon20Add,{className:(0,d.getColorClass)("color_icon_accent")}),(0,o.jsx)(l.Headline,{className:(0,d.getColorClass)("color_icon_accent"),children:(0,c.getLang)("video_create_new_playlist_btn")})]})})})}))},482479:(e,t,i)=>{i.d(t,{PlaylistPopoverHeader:()=>c});var o=i(474848),r=i(296540),s=i(285056),n=i(723723),a=i(303800),d=i(944048),l=i(866467);const c=(0,r.memo)((function({addedToMy:e,addedToMyCheckboxDisabled:t,noPublicAdd:i,onToggleMyAlbum:r}){return i?(0,o.jsx)(s.Footnote,{className:(0,n.getColorClass)("color_text_subhead"),weight:"3",children:(0,o.jsx)(a.Div,{mode:"vertical",spacing:8,paddingTop:4,paddingBottom:4,children:(0,l.getLang)("video_only_private_playlists")})}):(0,o.jsx)(d.Checkbox,{checked:e,disabled:t,onChange:r,children:(0,l.getLang)("video_my_added_videos_playlist")})}))},245321:(e,t,i)=>{i.d(t,{PlaylistPopoverItem:()=>h});var o=i(474848),r=i(296540),s=i(944048),n=i(578392),a=i(412888),d=i(866467),l=i(562791),c=i(8520),u=i(982184);const h=(0,r.memo)((({playlist:e,handleToggleVideoAdded:t})=>(0,o.jsx)(s.Checkbox,{checked:e.containsVideo,onChange:()=>t(e.containsVideo,e.id),titleAfter:e.isPrivate&&(0,o.jsx)(n.TextTooltip,{placement:"top",appearance:"black",offsetByCrossAxis:-56,offsetByMainAxis:4,text:(0,d.getLang)("video_playlist_private_tooltip"),children:(0,o.jsx)(l.Icon16LockOutline,{className:u.default.playlistPrivateIcon})}),children:(0,o.jsx)(a.TextClamp,{lines:1,children:(0,c.decodeHTMLEntities)(e.title)})},e.id)))},574479:(e,t,i)=>{i.d(t,{PlaylistPopover:()=>o.PlaylistPopover});var o=i(348904)},296761:(e,t,i)=>{i.d(t,{useOwner:()=>o.useOwner,usePlaylists:()=>r.usePlaylists,useVideoMenuItems:()=>s.useVideoMenuItems});var o=i(345611),r=i(918847),s=i(601362)},345611:(e,t,i)=>{i.d(t,{useOwner:()=>o.useOwner});var o=i(856289)},918847:(e,t,i)=>{i.d(t,{usePlaylists:()=>r});var o=i(293721);const r=e=>(0,o.useStoreMap)(e,(e=>Object.values(e).filter((e=>Boolean(e)))))},601362:(e,t,i)=>{i.d(t,{useVideoMenuItems:()=>x});var o=i(474848),r=i(296540),s=i(629775),n=i(829713),a=i(289150),d=i(549318),l=i(490363),c=i(485749),u=i(490639),h=i(917919),p=i(8520),m=i(866467),v=i(451549),g=i(432465),_=i(575312),C=i(609253),y=i(950885),b=i(768797),I=i(29593),S=i(540462),f=i(841315),w=i(636826),E=i(370420),k=i(317216),P=i(314309),A=i(231450);const L=({onClick:e,...t})=>{const i={...t};return e&&(i.onClick=t=>(0,I.ensureEventPropagationStopping)(t,e)),i},x=({video:e,handlers:t,playlistOwnerId:i=window.vk.id,canUserAddToGroupPlaylists:I=!1,playlistId:x})=>{const{onDeleteFromPlaylist:M,onDeleteVideo:O,onAddToGroup:T,onExportVideo:V,onToggleFave:F,onComplaintSuccess:j}=t||{},[R,D]=(0,r.useState)(!1),B=(0,f.getVideoUrl)(e),N=()=>{(0,p.copyTextToClipboard)(`https://${window.location.host}${B}`),(0,A.getFromType)("search")&&P.searchStatsCollector.logEvent({track_code:e.track_code,action:k.SearchClickActionMap.COPY_LINK_OUT,type:k.EventItemType.VIDEO}),(0,g.showSnackbar)({text:(0,m.getLang)("video_copied_to_clipboard"),before:{content:(0,o.jsx)(s.Icon20CheckAlt,{})}})},U=t=>{(0,A.getFromType)("search")&&P.searchStatsCollector.logEvent({track_code:e.track_code,action:k.SearchClickActionMap.SHARE_OUT,type:k.EventItemType.VIDEO}),(0,y.shareVideo)(t,e,{trackCode:e.track_code})},G=t=>{(0,y.sendReportWithCallback)(t,e,j)},H=t=>{(0,y.editVideo)(t,{owner_id:e.owner_id,id:e.id})},W=()=>{(0,A.getFromType)("search")&&P.searchStatsCollector.logEvent({track_code:e.track_code,action:k.SearchClickActionMap.ADD_TO_ME_OUT,type:k.EventItemType.VIDEO}),(0,S.partConfigEnabled)("video_add_to_album_group")?(0,C.showAddToGroupAlbumModal)({ownerId:i,videoId:e.id,isGroupOwner:I,videoOwnerId:e.owner_id}):(0,S.partConfigEnabled)("video_add_to_playlist_modal_mobx_move")?(0,C.showPlaylistModalWidget)({ownerId:i,videoId:e.id,isGroupOwner:I,videoOwnerId:e.owner_id,playlistId:x}):(0,_.showPlaylistsModal)({ownerId:i,videoPlaylistsModalService:b.videoPlaylistsModalService,video:e,isGroupOwner:I})};return{menuItems:(0,r.useMemo)((()=>{const t=[];if(!(0,v.isVKUserAnonymous)())return e.can_edit&&t.push({before:(0,o.jsx)(n.Icon20WriteOutline,{}),children:(0,m.getLang)("video_edit"),onClick:H,"data-testid":"video_edit_button"}),t.push(E.watchLater(e,F)),3===e.can_download&&"interactive"!==e.type&&t.push({before:(0,o.jsx)(a.Icon20DownloadOutline,{}),children:(0,m.getLang)("video_download_video_from_modal"),onClick:t=>{t.stopPropagation(),(0,w.downloadVideo)({oid:String(e.owner_id),vid:String(e.id),title:String(e.title),type:"video"})},"data-testid":"video_download_button"}),T&&t.push({before:(0,o.jsx)(d.Icon20Add,{}),children:(0,m.getLang)("video_add_to_group"),onClick:T,"data-testid":"video_card_add_to_group_button"}),e.can_add&&t.push({before:(0,o.jsx)(l.Icon20ListPlusOutline,{}),children:(0,m.getLang)("video_move_to_playlist"),onClick:W,"data-testid":"video_move_to_playlist"}),t.push({before:(0,o.jsx)(c.Icon20CopyOutline,{}),children:(0,m.getLang)("video_copy_video_link"),onClick:N,"data-testid":"video_card_copy_video_link_button"}),V&&t.push({before:(0,o.jsx)(a.Icon20DownloadOutline,{}),children:(0,m.getLang)("video_export_action"),onClick:V,"data-testid":"video_card_export_button"}),t.push(E.share(e,U)),M&&t.push({before:(0,o.jsx)(u.Icon20DeleteOutline,{}),children:(0,m.getLang)("video_delete_from_playlist"),onClick:M,"data-testid":"video_card_delete_from_playlist_button"}),O&&t.push({before:(0,o.jsx)(h.Icon20Cancel,{}),children:(0,m.getLang)("video_delete_video"),onClick:O,"data-testid":"video_card_delete_button"}),t.push(E.report(e,G)),E.getMenuItems(...t)?.map(L)}),[R]),onMenuPopoverShownChanged:e=>{D(e)}}}},196241:(e,t,i)=>{i.d(t,{createPlaylistPopoverService:()=>h});var o=i(29593),r=i(986125),s=i(178317),n=i(530040),a=i(224191),d=i(32489),l=i(377850),c=i(856289),u=i(838658);const h=(e,t)=>{const i=(0,r.createVideoGetAlbumsByVideoFx)({domain:e}),h=e.createEvent(),p=(0,r.createVideoAddToAlbumFx)({domain:e}),m=(0,r.createVideoRemoveFromAlbumFx)({domain:e}),v=e.createStore({}),g=e.createEffect((({controller:e,isAdded:t,query:i})=>{const o={controller:e,query:i};return t?m(o):p(o)})),_=e.createStore(t),C=e.createStore([]),y=e.createEvent(),b=(0,d.restore)(y,{}),I=e.createEvent(),S=e.createEvent(),f=e.createEvent(),w=e.createEvent(),E=(0,s.createEntitiesVideoAlbumService)({domain:e}),k=(0,n.createListsVideosAlbumsService)({domain:e,entitiesVideoAlbumService:E}),{videoCardEntities:P,addEntity:A,updateEntity:L}=(0,u.createVideoCardEntitiesService)({domain:e}),{$entitiesVideoAlbums:x}=E,{resetVideosAlbumsEvent:M,$videosAlbumsFullyLoaded:O}=k,T=(0,d.combine)(O,_,((e,t)=>Boolean(e[t])));x.reset(h);const V=e.createEvent(),F=e.createEvent(),j=(0,d.restore)(F,null).reset(h),R=e.createEvent(),D=(0,d.restore)(R,null).reset(h);(0,d.sample)({clock:V,target:A});const B=(0,d.combine)(b,j,((e,t)=>!!t||Object.values(e).some((e=>e&&e.containsVideo)))),N=(0,d.combine)(k.fetchVideosAlbumsFx.pending,i.pending,((e,t)=>e||t)),U=(0,l.combineEvents)({events:{albumsByVideo:i.done,albums:k.fetchVideosAlbumsFx.done},reset:h});return(0,d.sample)({clock:U,source:{videoEntities:x,ownerId:_},fn:({videoEntities:e,ownerId:t},{albumsByVideo:i})=>(0,o.mapAlbumsWithInclusionsToPlaylists)({albumsByVideo:i.result,albums:e,ownerId:t||0}),target:y}),(0,d.sample)({clock:U,fn:({albumsByVideo:{result:e}})=>e.includes(c.MY_VIDEO_ALBUM_ID),target:F}),(0,d.sample)({clock:I,source:_,filter:e=>Boolean(e),fn:e=>({query:{owner_id:e||0,extended:1},controller:new AbortController,entityKey:e||0}),target:k.fetchVideosAlbumsFx}),(0,d.sample)({clock:S,source:_,fn:e=>({entityKey:e,count:50}),target:k.fetchMoreVideosAlbumsEvent}),(0,d.sample)({clock:k.fetchVideosAlbumsFx.done,source:{ownerId:_,videoEntities:x,albumsByVideo:C,playlistEntityStore:b},filter:(e,{params:t})=>Boolean(t.query.offset),fn:({ownerId:e,albumsByVideo:t,playlistEntityStore:i},{result:r})=>{const s=(0,a.mapToEntity)({},r.items,(({id:t})=>(0,o.getFullAlbumId)({albumId:t,ownerId:e})));return{...i,...(0,o.mapAlbumsWithInclusionsToPlaylists)({albumsByVideo:t,albums:s,ownerId:e||0})}},target:y}),(0,d.sample)({clock:I,source:{videoCardEntities:P,$ownerId:_},filter:({videoCardEntities:e},t)=>!!e[t],fn:({videoCardEntities:e,$ownerId:t},i)=>{const{vid:o,oid:r}=e[i];return{query:{video_id:o,owner_id:r,target_id:t},controller:new AbortController}},target:i}),(0,d.sample)({clock:i.doneData,target:C}),(0,d.sample)({clock:I,target:R}),(0,d.sample)({clock:M,fn:()=>({}),target:b}),(0,d.sample)({clock:f,source:{videoCardEntities:P,$ownerId:_},filter:({videoCardEntities:e},{key:t,videoOwnerId:i,videoId:o})=>Boolean(e[t]||i||o),fn:({videoCardEntities:e,$ownerId:t},{key:i,album_id:r,isAdded:s,videoOwnerId:n,videoId:a})=>{const d=(0,o.getFullAlbumId)({albumId:r,ownerId:t}),{vid:l=0,oid:c=0}=e[i]?e[i]:{oid:n,vid:a};return{controller:new AbortController,fullId:d,query:{target_id:t,album_id:r,video_id:l,owner_id:c},isAdded:s}},target:g}),(0,d.sample)({clock:w,fn:({ownerId:e,id:t,videoId:i,videoOwnerId:r})=>{const s=(0,o.getFullAlbumId)({albumId:t,ownerId:e});return{controller:new AbortController,fullId:s,query:{target_id:e,album_id:t,video_id:i||0,owner_id:r||0},isAdded:!1}},target:g}),(0,d.sample)({clock:g,source:b,filter:(e,t)=>!(0,o.isMyVideoAlbum)(t.query.album_id),fn:(e,{query:t,isAdded:i})=>{const r={...e},s=(0,o.getFullAlbumId)({albumId:t.album_id,ownerId:t.target_id}),n=e[s];return n&&(r[s]={...n,containsVideo:!i}),r},target:y}),(0,d.sample)({clock:g,filter:({query:{album_id:e}})=>(0,o.isMyVideoAlbum)(e),fn:({isAdded:e})=>!e,target:F}),(0,d.sample)({clock:B,source:D,filter:e=>!!e,fn:(e,t)=>({key:e,updates:{added:t}}),target:L}),(0,d.sample)({clock:g,source:v,fn:(e,{controller:t,fullId:i})=>(e[i]?.abort(),{...e,[i]:t}),target:v}),(0,d.sample)({clock:h,source:i,fn:({controller:e})=>{e?.abort()}}),(0,d.sample)({clock:h,fn:()=>{},target:M}),(0,d.sample)({clock:[g.done,g.fail],source:b,filter:(e,t)=>("error"in t||!t.result)&&!(0,o.isMyVideoAlbum)(t.params.query.album_id),fn:(e,{params:{query:t,isAdded:i}})=>{const r={...e},s=(0,o.getFullAlbumId)({albumId:t.album_id,ownerId:t.owner_id}),n=e[s];return n&&(r[s]={...n,containsVideo:i}),r},target:y}),(0,d.sample)({clock:[g.done,g.fail],filter:e=>("error"in e||!e.result)&&(0,o.isMyVideoAlbum)(e.params.query.album_id),fn:({params:{isAdded:e}})=>e,target:F}),(0,d.sample)({clock:f,source:{playlists:b,ownerId:_},fn:({playlists:e,ownerId:t},{isAdded:i,album_id:r,albumTitle:s})=>{const n=(0,o.getFullAlbumId)({albumId:r,ownerId:t});(0,o.showPlaylistActionSnackbar)({ownerId:t||0,playlistId:r,playlistTitle:s||e[n]?.title,added:!i})}}),(0,d.sample)({clock:w,filter:({videoId:e,videoOwnerId:t})=>Boolean(e&&t),fn:({videoId:e,videoOwnerId:t})=>({key:(0,o.getVideoCardKey)(t||0,e||0),updates:{added:!0}}),target:L}),(0,d.sample)({clock:w,source:_,fn:(e,{id:t,title:i})=>{(0,o.showPlaylistActionSnackbar)({ownerId:e||0,playlistId:t,playlistTitle:i,added:!0})}}),{addVideoCardEntity:V,videoCardEntities:P,togglePlaylistAddedEvent:f,fetchPlaylistsEvent:I,fetchMorePlaylistsEvent:S,resetVideosAlbumsEvent:M,$ownerId:_,$playlistsLoading:N,$playlistsFullyLoaded:T,$curVideoAddedToMy:j,clearStoreEvent:h,$playlistEntityStore:b,createPlaylistEvent:w}}},838658:(e,t,i)=>{i.d(t,{createVideoCardEntitiesService:()=>n});var o=i(32489),r=i(29593),s=i(679005);const n=({domain:e})=>{const t=e.createEvent(),i=(0,o.restore)(t,{}),n=e.createEvent(),a=e.createEvent();return(0,o.sample)({clock:n,source:i,fn:(e,t)=>{const i=(0,r.getVideoCardKey)(t.oid,t.vid);return{...e,[i]:t}},target:t}),(0,o.sample)({clock:a,source:i,fn:(e,{key:t,updates:i})=>{const o={...e[t],...i};return"object"==typeof(r=o)&&null!==r&&"vid"in r&&"oid"in r&&"added"in r?(0,s.produce)(e,(e=>{e[t]=o})):e;var r},target:t}),{addEntity:n,updateEntity:a,videoCardEntities:i}}},675307:(e,t,i)=>{i.d(t,{ensurePlaylistPopoverService:()=>s});var o=i(196241),r=i(32489);const s=(0,i(558137).makeSharedState)("global/video/playlists/popover",(()=>(0,o.createPlaylistPopoverService)((0,r.createDomain)("global/video/playlists/popover"),window.vk.id)),{version:1})},464939:(e,t,i)=>{i.d(t,{ensurePlaylistPopoverService:()=>o.ensurePlaylistPopoverService});var o=i(675307);i(196241),i(838658)},420052:(e,t,i)=>{i.d(t,{AdvancedPIP:()=>l});var o=i(575753),r=i(800361),s=i(666384),n=i(206769),a=i(34692),d=i(975186);class l extends d.PlayerComponent{static isActive(){return n.PictureInPictureApi.isActive()}static isAllowedVideoType(){const e=window?.nav?.strLoc??"",t=s.VIDEO_CLIP_STANDALONE_PATH_REGEXP.test(e),i=window?.cur?.videoInlinePlayer?.isInteractive;return!t&&!i}static isAvailable(){return Boolean((0,r.isVideoStandalone)()&&n.PictureInPictureApi.isSupported())}static isPlaying(){const e=l.getPictureInPictureVideoElement();return Boolean(e&&!e.paused&&!e.ended&&e.readyState>2&&e.currentTime>0)}static getPictureInPictureVideoElement(){return n.PictureInPictureApi.getPictureInPictureVideoElement()}static pause(){l.getPictureInPictureVideoElement()?.pause()}static play(){l.getPictureInPictureVideoElement()?.play()}init(e){this.videoElement=e,this.API.assignVideoElement(e),this.API.registryExternalEventHandlers({enterpictureinpicture:this.onExternalEnterPictureInPicture.bind(this),leavepictureinpicture:this.onExternalLeavePictureInPicture.bind(this)})}isCurrentVideoActive(){return this.API.isCurrentVideoActive()}keepActivePIPAlive(){this.isCurrentVideoActive()&&!o.browser.yabrowser&&(this.makeGhostVideoContainer(),this.moveCurrentVideoToGhostVideoContainer())}async toggle(){this.isCurrentVideoActive()?await this.leave():await this.enter()}async enter(){await this.API.enter()}async leave(){await this.API.leave()}makeGhostVideoContainer(){this.ghostVideoContainer=document.createElement("div"),this.ghostVideoContainer.style.display="none",document.body.appendChild(this.ghostVideoContainer)}moveCurrentVideoToGhostVideoContainer(){this.ghostVideoContainer&&this.videoElement&&this.ghostVideoContainer.appendChild(this.videoElement)}onExternalEnterPictureInPicture(){this.player.trigger(a.PIP_CHANGE,this.isCurrentVideoActive())}onExternalLeavePictureInPicture(){this.player.trigger(a.PIP_CHANGE,this.isCurrentVideoActive()),this.removeGhostVideoContainer()}removeGhostVideoContainer(){this.ghostVideoContainer?.remove()}constructor(e){super(e),this.ghostVideoContainer=void 0,this.videoElement=void 0,this.API=new n.PictureInPictureApi}}},923475:(e,t,i)=>{i.d(t,{AdvancedPIP:()=>o.AdvancedPIP});var o=i(420052)},206769:(e,t,i)=>{i.d(t,{PictureInPictureApi:()=>o});class o{static isActive(){return Boolean(document.pictureInPictureElement)}static isSupported(){return Boolean(document.pictureInPictureEnabled)}static getPictureInPictureVideoElement(){return o.isSupported()&&o.isActive()&&document.pictureInPictureElement instanceof HTMLVideoElement?document.pictureInPictureElement:null}assignVideoElement(e){o.isSupported()&&(this.videoElement=e)}isCurrentVideoActive(){return Boolean(o.isSupported()&&document.pictureInPictureElement&&document.pictureInPictureElement===this.videoElement)}async enter(){!o.isSupported()||this.isRequested||0===this.videoElement?.readyState||this.videoElement?.disablePictureInPicture||this.isCurrentVideoActive()||(this.isRequested=!0,await this.request())}async leave(){if(o.isSupported()&&this.isCurrentVideoActive())try{await document.exitPictureInPicture()}catch(e){}}registryEventHandlers(){this.videoElement?.addEventListener("enterpictureinpicture",this.eventHandlers.enterpictureinpicture),this.videoElement?.addEventListener("leavepictureinpicture",this.eventHandlers.leavepictureinpicture)}registryExternalEventHandlers(e){this.externalEventHandlers={...e}}unregistryEventHandlers(){this.videoElement?.removeEventListener("enterpictureinpicture",this.eventHandlers.enterpictureinpicture),this.videoElement?.removeEventListener("leavepictureinpicture",this.eventHandlers.leavepictureinpicture)}onEnterPictureInPicture(e){this.externalEventHandlers.enterpictureinpicture?.(e)}onLeavePictureInPicture(e){this.externalEventHandlers.leavepictureinpicture?.(e),this.unregistryEventHandlers()}async request(){this.registryEventHandlers();try{await(this.videoElement?.requestPictureInPicture())}catch(e){this.unregistryEventHandlers()}this.isRequested=!1}constructor(){this.eventHandlers={enterpictureinpicture:this.onEnterPictureInPicture.bind(this),leavepictureinpicture:this.onLeavePictureInPicture.bind(this)},this.externalEventHandlers={},this.isRequested=!1,this.videoElement=void 0}}},799540:(e,t,i)=>{i.d(t,{AudioPlayerEventType:()=>o.AudioPlayerEventType,events:()=>o.events});var o=i(392358)},673569:(e,t,i)=>{i.d(t,{audioTupleToApiAudio:()=>o.audioTupleToApiAudio});var o=i(245778)},202799:(e,t,i)=>{i.d(t,{Catalog:()=>o.Catalog,CatalogBlockDataType:()=>o.CatalogBlockDataType,CatalogBlockLayoutName:()=>o.CatalogBlockLayoutName,CatalogDesktopVideoProvider:()=>o.CatalogDesktopVideoProvider,CatalogGroupsProvider:()=>o.CatalogGroupsProvider,CatalogHandlersProvider:()=>o.CatalogHandlersProvider,CatalogLogProvider:()=>o.CatalogLogProvider,CatalogSearchProvider:()=>o.CatalogSearchProvider,CatalogType:()=>o.CatalogType,FAVORITE_SOURCES:()=>o.FAVORITE_SOURCES,GROUP_REDESIGN_SLIDER_SCROLL:()=>o.GROUP_REDESIGN_SLIDER_SCROLL,MARKET_ITEM_SLIDER_SCROLL:()=>o.MARKET_ITEM_SLIDER_SCROLL,SLIDER_SCROLL:()=>o.SLIDER_SCROLL,appCatalogService:()=>o.appCatalogService,createAppCatalogService:()=>o.createAppCatalogService,extractItemsIds:()=>o.extractItemsIds,getUrlWithTrackCode:()=>o.getUrlWithTrackCode,useCatalogCommonFriends:()=>o.useCatalogCommonFriends,useRefLogView:()=>o.useRefLogView,videoLayoutResolver:()=>o.videoLayoutResolver,videoListShowcaseLayoutResolver:()=>o.videoListShowcaseLayoutResolver,withCatalogStoreOwner:()=>o.withCatalogStoreOwner});var o=i(174269)},119629:(e,t,i)=>{i.d(t,{VideoShowcaseFaveEvents:()=>o.VideoShowcaseFaveEvents});var o=i(506011)},151972:(e,t,i)=>{i.d(t,{DynamicPagination:()=>o.DynamicPagination});var o=i(564508)},8443:(e,t,i)=>{i.r(t),i.d(t,{MY_TRACKER_COUNT_EVENT_IDS:()=>o.MY_TRACKER_COUNT_EVENT_IDS,getScreenTimespentCollector:()=>o.getScreenTimespentCollector,getServiceTimespentCollector:()=>o.getServiceTimespentCollector,tmrSendTimespentEvent:()=>o.tmrSendTimespentEvent});var o=i(251703)},23513:(e,t,i)=>{i.d(t,{formatCommentText:()=>o.formatCommentText});var o=i(515360)},350485:(e,t,i)=>{i.d(t,{usePageBlockOffset:()=>o.usePageBlockOffset});var o=i(907678)},599520:(e,t,i)=>{i.d(t,{checkIfInternal:()=>o.checkIfInternal,wrapAway:()=>o.wrapAway,wrapAwayIfExternal:()=>o.wrapAwayIfExternal});var o=i(34231)},558845:(e,t,i)=>{i.d(t,{getLang:()=>o.getLang,getShortDate:()=>o.getShortDate,langDate:()=>o.langDate,langLink:()=>o.langLink,langNumeric:()=>o.langNumeric,langReplace:()=>o.langReplace,langSex:()=>o.langSex,langStr:()=>o.langStr});var o=i(866467)},220503:(e,t,i)=>{i.d(t,{getCurrentScreen:()=>o.getCurrentScreen,setCurrentScreen:()=>o.setCurrentScreen});var o=i(471180)},272428:(e,t,i)=>{i.d(t,{formatNumberTranslation:()=>o.formatNumberTranslation,getThumb:()=>o.getThumb,hashtagReplaceReact:()=>o.hashtagReplaceReact});var o=i(652547)},597521:(e,t,i)=>{i.d(t,{isPopUpStickersEnabled:()=>o.isPopUpStickersEnabled});var o=i(224194)},136306:(e,t,i)=>{i.d(t,{formatDateTime:()=>o.formatDateTime});var o=i(224241)},666e3:(e,t,i)=>{i.d(t,{formatFileSize:()=>o.formatFileSize});var o=i(317835)},437822:(e,t,i)=>{i.d(t,{getOwnerAvatar:()=>o.getOwnerAvatar});var o=i(591485)},110518:(e,t,i)=>{i.d(t,{getVideoCopyLink:()=>o.getVideoCopyLink,getVideoUrl:()=>o.getVideoUrl});var o=i(841315)},319835:(e,t,i)=>{i.d(t,{replaceHashtags:()=>o.replaceHashtags});var o=i(485910)},186093:(e,t,i)=>{i.d(t,{mentionReplaceReact:()=>o.mentionReplaceReact,replaceMentions:()=>o.replaceMentions});var o=i(839348)},514683:(e,t,i)=>{i.d(t,{setEndOfContentEditable:()=>o.setEndOfContentEditable});var o=i(153078)},406751:(e,t,i)=>{i.d(t,{MY_VIDEO_ALBUM_ID:()=>o.MY_VIDEO_ALBUM_ID,UPLOADED_ALBUM_ID:()=>o.UPLOADED_ALBUM_ID,getFormattedFullVideoViews:()=>o.getFormattedFullVideoViews,getFormattedUpdatedTime:()=>o.getFormattedUpdatedTime,getFormattedVideoDate:()=>o.getFormattedVideoDate,getOwnerVideosPageBasePath:()=>o.getOwnerVideosPageBasePath,getThumbSrcFromImages:()=>o.getThumbSrcFromImages,getVideoPrefix:()=>o.getVideoPrefix,isPrivacyLocked:()=>o.isPrivacyLocked,isVideoStandalone:()=>o.isVideoStandalone,mapArtistToVideoCardOwner:()=>o.mapArtistToVideoCardOwner,mapPlaylistToPlaylistCardItem:()=>o.mapPlaylistToPlaylistCardItem,mapThumbsDataEpisodes:()=>o.mapThumbsDataEpisodes,mapUserOrGroupToPlaylistCardOwner:()=>o.mapUserOrGroupToPlaylistCardOwner,mapUserOrGroupToVideoCardOwner:()=>o.mapUserOrGroupToVideoCardOwner,mapVideoToVideoCardItem:()=>o.mapVideoToVideoCardItem});var o=i(856289)},732340:(e,t,i)=>{i.d(t,{StrikeForbidObjectForm:()=>o.StrikeForbidObjectForm});var o=i(17333)},195604:(e,t,i)=>{i.d(t,{getSubscriptionsPageServices:()=>o.getSubscriptionsPageServices});var o=i(58697)},708370:(e,t,i)=>{i.d(t,{CatalogServiceAdapter:()=>o.CatalogServiceAdapter});var o=i(768797)},394005:(e,t,i)=>{i.d(t,{getPrivacyLabel:()=>o.getPrivacyLabel,getValidVideoFiles:()=>o.getValidVideoFiles,shouldDisableDate:()=>o.shouldDisableDate});var o=i(72966)},298590:(e,t,i)=>{i.d(t,{Emoji:()=>o.Emoji});var o=i(489245)},777446:(e,t,i)=>{i.d(t,{curBox:()=>o.curBox,showDoneBox:()=>o.showDoneBox});var o=i(246429)},631112:(e,t,i)=>{i.d(t,{showBox:()=>o.showBox,showFastBox:()=>o.showFastBox});var o=i(270959)},272231:(e,t,i)=>{i.d(t,{useModuleReady:()=>o.useModuleReady});var o=i(391566)},627445:(e,t,i)=>{i.d(t,{MemLink:()=>o.MemLink,MemOrExternalLink:()=>o.MemOrExternalLink});var o=i(136883)},742554:(e,t,i)=>{i.d(t,{showInlineVideo:()=>o.showInlineVideo,showVideo:()=>o.showVideo});var o=i(432081)},6286:(e,t,i)=>{i.d(t,{Likes:()=>o.Likes});var o=i(867317)},330320:(e,t,i)=>{i.d(t,{handleOrdMiniappOpen:()=>o.handleOrdMiniappOpen});var o=i(60411)},183628:(e,t,i)=>{i.d(t,{openStickersLayerView:()=>o.openStickersLayerView});var o=i(1497)},364796:(e,t,i)=>{i.d(t,{fixVideoPlayerScrollPopover:()=>o.fixVideoPlayerScrollPopover});var o=i(986918)},178907:(e,t,i)=>{i.d(t,{AdvancedPIP:()=>o.AdvancedPIP});var o=i(923475)},246361:(e,t,i)=>{i.d(t,{ClipsPlayerStatsRef:()=>r,ClipsStatEventType:()=>o});var o=function(e){return e.VIDEO="videoEvent",e.PLAY="playEvent",e.EFFECTIVE_DAILY_ACTIVE_USER="effectiveDailyActiveUserEvent",e.SHORT_VIDEO_VIEW="shortVideoViewEvent",e.SHORT_VIDEO_PUBLISH="shortVideoPublishEvent",e}({}),r=function(e){return e.TOP="clips_top",e.SUBSCRIPTIONS="clips_subscription",e.OWNER="clips_owner",e.VIDEO="video",e}({})},874320:(e,t,i)=>{i.d(t,{PlayingContextProvider:()=>n,usePlayingContext:()=>a});var o=i(474848),r=i(296540);const s=(0,r.createContext)(new Set),n=({children:e})=>{const t=(0,r.useRef)(new Set);return(0,o.jsx)(s.Provider,{value:t.current,children:e})};function a(){return(0,r.useContext)(s)}},821434:(e,t,i)=>{i.d(t,{PlayingContextProvider:()=>o.PlayingContextProvider,usePlayingContext:()=>o.usePlayingContext});var o=i(874320)},109605:(e,t,i)=>{i.d(t,{usePlayerStats:()=>o.usePlayerStats});var o=i(315775)},315775:(e,t,i)=>{i.d(t,{usePlayerStats:()=>o.usePlayerStats});var o=i(557946)},557946:(e,t,i)=>{i.d(t,{usePlayerStats:()=>d});var o=i(296540),r=i(246361),s=i(851627),n=i(651863),a=i(425041);function d({isPlaying:e,isMuted:t,video:i,statsRef:d},l,c="carousel"){const u=d===r.ClipsPlayerStatsRef.OWNER&&i?String(i.data.owner_id):"",h=(0,o.useRef)([]),{onVideoCurQualityChanged:p,onVideoDurationChanged:m,onVideoFormatChanged:v,onVideoBitrateChanged:g,videoMetaRef:_}=(0,n.useVideoMetaRef)(i?.rawId),{onStalledChanged:C,videoStalledRef:y}=(0,a.useVideoStalledRef)(i?.rawId),b=(0,o.useRef)([]),I=(0,o.useRef)(!1);(0,o.useEffect)((()=>()=>{b.current=[],I.current=!1}),[i?.rawId]);const S=(0,o.useCallback)((()=>i&&_.current&&!I.current?{autoplay:1,bitrate:_.current.videoBitrate??0,context:u,e:"video_play",eventType:r.ClipsStatEventType.PLAY,media_provider:_.current.videoFormat,ov_id:i.data.ov_id??"",player_type:c,quality:"auto",ref:d,speed:"normal",stall_count:y.current?.stalledCount??0,stall_duration:y.current?.stalledDuration??0,track_code:i.data.track_code??"",ts:Math.trunc(Date.now()/1e3),video_id:i.rawId,volume:t?0:100}:null),[i,t,d]),f=(0,o.useCallback)((()=>i?{context:u,e:"video_event",eventType:r.ClipsStatEventType.VIDEO,ov_id:i.data.ov_id??"",ref:d,track_code:i.data.track_code??"",ts:Math.trunc(Date.now()/1e3),video_id:i.rawId}:null),[i,d]),w=(0,o.useCallback)((t=>{const i=S();if(i&&e&&void 0!==t&&void 0!==_.current?.videoDuration){const e=(0,s.secondsPositionToTrackPositions)(t,_.current.videoDuration);if(!e.length||e.length===b.current.length)return;const o=e.filter((e=>!b.current.includes(e)));o.length&&(l([...h.current,...o.map((e=>({...i,position:e,position_sec:Math.trunc(t)})))]),h.current=[]),o.includes("100")&&l([{eventType:r.ClipsStatEventType.SHORT_VIDEO_VIEW}]),b.current=[...e]}}),[S,e]),E=(0,o.useCallback)((e=>{const t=f();t&&h.current.push({...t,event:"first_bytes",value:e})}),[f]),k=(0,o.useCallback)((e=>{const t=f();t&&h.current.push({...t,event:"first_frame",value:e})}),[f]),P=(0,o.useCallback)((()=>{_.current?.videoDuration&&w(_.current?.videoDuration),I.current=!0}),[w]);return{onVideoCurQualityChanged:p,onStalledChanged:C,onVideoFormatChanged:v,onVideoBitrateChanged:g,onVideoDurationChanged:m,onVideoPositionChanged:w,onEnded:P,onFirstBytes:E,onFirstFrame:k}}},651863:(e,t,i)=>{i.d(t,{useVideoMetaRef:()=>r});var o=i(296540);function r(e){const t=(0,o.useRef)({}),i=(0,o.useCallback)((e=>{t.current.curVideoQuality=e}),[]),r=(0,o.useCallback)((e=>{t.current.videoDuration=e}),[]),s=(0,o.useCallback)((e=>{t.current.videoFormat=e}),[]),n=(0,o.useCallback)((e=>{t.current.videoBitrate=e?1e3*e:void 0}),[]);return(0,o.useEffect)((()=>()=>{t.current={}}),[e]),{onVideoCurQualityChanged:i,onVideoDurationChanged:r,onVideoFormatChanged:s,onVideoBitrateChanged:n,videoMetaRef:t}}},425041:(e,t,i)=>{i.d(t,{useVideoStalledRef:()=>r});var o=i(296540);function r(e){const t=(0,o.useRef)({stalledCount:0,stalledDuration:0}),i=(0,o.useRef)(null),r=(0,o.useCallback)((e=>{e?(t.current.stalledCount+=1,i.current=setInterval((()=>{t.current.stalledDuration+=1}),1e3)):i.current&&clearInterval(i.current)}),[]);return(0,o.useEffect)((()=>()=>{t.current={stalledCount:0,stalledDuration:0},i.current&&clearInterval(i.current)}),[e]),{onStalledChanged:r,videoStalledRef:t}}},222790:(e,t,i)=>{i.d(t,{ClipsPlayingFullScreenStatsModel:()=>r.ClipsPlayingFullScreenStatsModel,ClipsPlayingStatsModel:()=>r.ClipsPlayingStatsModel,ClipsStatsService:()=>r.ClipsStatsService,PlayingContextProvider:()=>s.PlayingContextProvider,usePlayerStats:()=>o.usePlayerStats,usePlayingContext:()=>s.usePlayingContext});var o=i(109605),r=i(231461),s=(i(246361),i(821434))},301047:(e,t,i)=>{i.d(t,{ClipsPlayingFullScreenStatsModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(27344);class a{startTimespent(){this.timespentCollector.start(this.refSymbol,n.StatTimespentType.SHORT_VIDEO_PLAYING_FULL_SCREEN)}endTimespent(){this.timespentCollector.end(this.refSymbol,n.StatTimespentType.SHORT_VIDEO_PLAYING_FULL_SCREEN)}constructor(e){this.timespentCollector=e,this.refSymbol=Symbol(),(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.ClipsTimespentService?Object:n.ClipsTimespentService])],a)},831274:(e,t,i)=>{i.d(t,{ClipsPlayingStatsModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(27344);class a{startTimespent(){this.timespentCollector.start(this.refSymbol,n.StatTimespentType.SHORT_VIDEO_PLAYING)}endTimespent(){this.timespentCollector.end(this.refSymbol,n.StatTimespentType.SHORT_VIDEO_PLAYING)}constructor(e){this.timespentCollector=e,this.refSymbol=Symbol(),(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.ClipsTimespentService?Object:n.ClipsTimespentService])],a)},215416:(e,t,i)=>{i.d(t,{ClipsStatsService:()=>u});var o=i(331635),r=i(327813),s=i(995340),n=i(951652),a=i(132028),d=i(8443),l=i(246361);const c={[l.ClipsStatEventType.EFFECTIVE_DAILY_ACTIVE_USER]:4,[l.ClipsStatEventType.SHORT_VIDEO_PUBLISH]:19,[l.ClipsStatEventType.SHORT_VIDEO_VIEW]:18};class u{trackEvents(e){if(!this.authService.isAuthorized)return;const t=e.filter((({eventType:e})=>[l.ClipsStatEventType.PLAY,l.ClipsStatEventType.VIDEO].includes(e)));t.length&&this.apiTrackEvents(t);const i=e.filter((({eventType:e})=>[l.ClipsStatEventType.SHORT_VIDEO_VIEW,l.ClipsStatEventType.SHORT_VIDEO_PUBLISH,l.ClipsStatEventType.EFFECTIVE_DAILY_ACTIVE_USER].includes(e)));i.length&&this.myTrackEvents(i)}apiTrackEvents(e){return this.statsApi.trackEvents({events:JSON.stringify(e)})}myTrackEvents(e){for(const t of e)(0,d.tmrSendTimespentEvent)(c[t.eventType])}constructor(e,t){this.statsApi=e,this.authService=t,(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.StatsApi?Object:s.StatsApi,void 0===n.AuthService?Object:n.AuthService])],u)},27344:(e,t,i)=>{i.d(t,{ClipsTimespentService:()=>d,StatTimespentType:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(8443),a=function(e){return e.SHORT_VIDEO_PLAYING="shortVideoPlayingTimespent",e.SHORT_VIDEO_SECTION="shortVideoSectionTimespent",e.SHORT_VIDEO_PLAYING_FULL_SCREEN="shortVideoPlayingFullScreenTimespent",e}({});class d{start(e,t){switch(t){case"shortVideoPlayingTimespent":if(this.playingSet.has(e))break;this.playingSet.add(e),1===this.playingSet.size&&this.screenTimespentCollector.start(96);break;case"shortVideoPlayingFullScreenTimespent":if(this.playingSet.has(e))break;this.playingSet.add(e),1===this.playingSet.size&&(this.screenTimespentCollector.start(97),this.screenTimespentCollector.start(96));break;case"shortVideoSectionTimespent":this.screenTimespentCollector.start(98)}}end(e,t){switch(t){case"shortVideoPlayingTimespent":if(!this.playingSet.has(e))break;this.playingSet.delete(e),0===this.playingSet.size&&this.screenTimespentCollector.finish(96);break;case"shortVideoPlayingFullScreenTimespent":if(!this.playingSet.has(e))break;this.playingSet.delete(e),0===this.playingSet.size&&(this.screenTimespentCollector.finish(97),this.screenTimespentCollector.finish(96));break;case"shortVideoSectionTimespent":this.screenTimespentCollector.finish(98)}}constructor(){this.playingSet=new Set,this.screenTimespentCollector=(0,n.getScreenTimespentCollector)(),(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[])],d)},231461:(e,t,i)=>{i.d(t,{ClipsPlayingFullScreenStatsModel:()=>r.ClipsPlayingFullScreenStatsModel,ClipsPlayingStatsModel:()=>o.ClipsPlayingStatsModel,ClipsStatsService:()=>s.ClipsStatsService});var o=i(831274),r=i(301047),s=i(215416)},851627:(e,t,i)=>{function o(e,t){const i=e/t*100,o=[];return 0===e&&o.push("start"),e>=3&&o.push("3s"),e>=10&&o.push("10s"),i>=25&&o.push("25"),i>=50&&o.push("50"),i>=75&&o.push("75"),i>=95&&o.push("95"),i>=100&&o.push("100"),o}i.d(t,{secondsPositionToTrackPositions:()=>o})},478470:(e,t,i)=>{i.d(t,{useFormatPublishedDatetime:()=>o.useFormatPublishedDatetime});var o=i(399311)},399311:(e,t,i)=>{i.d(t,{useFormatPublishedDatetime:()=>s});var o=i(149333),r=i(296540);const s=()=>{const e=(0,o.useLangs)(),[t]=(0,r.useState)((()=>(new Date).getFullYear()));return{formatPublishedDatetime:i=>{const o=new Date(1e3*i);return e.date(o,o.getFullYear()===t?e.getLang("global_short_date_time",!0):e.getLang("global_date",!0),e.getLang("months_sm_of",!0),{onlyDate:!1,offset:0})}}}},662213:(e,t,i)=>{i.d(t,{normalizeAttachments:()=>r.normalizeAttachments,parseCommentProps:()=>r.parseCommentProps,useFormatPublishedDatetime:()=>o.useFormatPublishedDatetime});var o=i(478470),r=i(964315)},964315:(e,t,i)=>{i.d(t,{normalizeAttachments:()=>o.normalizeAttachments,parseCommentProps:()=>r.parseCommentProps});var o=i(698808),r=i(915817)},698808:(e,t,i)=>{i.d(t,{normalizeAttachments:()=>n});var o=i(538522),r=i(866467),s=i(540462);const n=e=>{if(e)return e.reduce(((e,t)=>{const{type:i}=t;let n;switch(i){case"photo":n=(e=>{const t=e.photo;if(!t)return;const i=(0,o.joinRawId)({ownerId:t.owner_id,itemId:t.id}),r=`/photo${i}?list=${t.web_view_token??(0,o.joinRawId)({ownerId:t.owner_id,itemId:t.album_id})}&from=comments`;if(!t.sizes)return;return{type:"photo",photo:{...t,photo_id:i,photo_url:r}}})(t);break;case"video":n=(e=>{const t=e.video;if(!t)return;if(!t.owner_id)return;if(!t.id)return;const i=(0,o.joinRawId)({ownerId:t.owner_id,itemId:t.id}),n=t.access_key||(0,o.joinRawId)({ownerId:t.owner_id,itemId:t.album_id}),a=`/${"short_video"===t.type?"clip":"video"}${i}?list=${n}&from=access_hash`;let d;return(0,s.partConfigEnabled)("interactive_video_redesign_badge_mvk")&&"interactive"===t.type&&(d=(0,r.getLang)("video_interactive_label")),{type:"video",video:{...t,video_id:i,video_url:a,label:d}}})(t);break;case"doc":n=(e=>{const t=e.doc;if(t)return{type:"doc",doc:{...t,doc_id:(0,o.joinRawId)({ownerId:t.owner_id,itemId:t.id})}}})(t);break;case"sticker":n=(e=>{const t=e.sticker;if(t)return{type:"sticker",sticker:t}})(t);break;default:n={type:"custom",original_type:i,custom:t[i]}}return n&&e.push(n),e}),[])}},915817:(e,t,i)=>{i.d(t,{parseCommentProps:()=>s});var o=i(698808);function r(e=[],t=[]){return e.length&&t.length?e.map((e=>{const i=(e=>Object.hasOwn(e,"custom")&&Object.hasOwn(e,"original_type")&&"custom"===e.type)(e)?e.original_type:e.type;return"unsupported"===i?e:t.includes(i)?{type:"custom",original_type:"unsupported",custom:{isUnsupported:!0}}:e})):e}const s=(e,t)=>{const{attachments:i,...s}=e,n=t?.length;return{...s,attachments:n?r((0,o.normalizeAttachments)(i),t):(0,o.normalizeAttachments)(i)}}},831762:(e,t,i)=>{i.d(t,{EMOJI_REG_EXP:()=>m,EMPTY_PRICE:()=>a,FILTER_MAX_PRICE:()=>o,GROUP_HEADER_QUERY_PARAM:()=>r,MARKET_BASE_URL:()=>s,MARKET_ROOT_CATEGORY_ID:()=>n,MAX_PRICE:()=>l,MIN_ORDER_PRICE_LIMIT:()=>c,MIN_PRICE:()=>d,REVIEW_CREATED_EVENT:()=>u,REVIEW_SUBMITTED_EVENT:()=>h,REVIEW_UPDATED_EVENT:()=>p});const o=5e9,r="with_group_header",s="/market",n="9000",a="",d=0,l=999999999999,c=999999,u="MARKET_ITEM_REVIEW_CREATED",h="MARKET_REVIEW_SUBMITTED_EVENT",p="MARKET_ITEM_REVIEW_UPDATED",m=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g},48324:(e,t,i)=>{i.d(t,{PRIVACY_CATEGORY_BY_OPTION:()=>r,PRIVACY_OPTION_BY_CATEGORY:()=>s});var o=i(632560);const r={[o.SETTINGS_PRIVACY_ALL]:"all",[o.SETTINGS_PRIVACY_FRIENDS]:"friends",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"friends_of_friends",[o.SETTINGS_PRIVACY_ONLY_ME]:"only_me"},s={all:o.SETTINGS_PRIVACY_ALL,friends:o.SETTINGS_PRIVACY_FRIENDS,friends_of_friends:o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,only_me:o.SETTINGS_PRIVACY_ONLY_ME}},509429:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>r.PrivacyDropdown,PrivacyFormModal:()=>r.PrivacyFormModal,PrivacyFriendsListsModel:()=>o.PrivacyFriendsListsModel,PrivacyFriendsModal:()=>r.PrivacyFriendsModal,PrivacyFriendsModel:()=>o.PrivacyFriendsModel,SETTINGS_PRIVACY_ALL:()=>s.SETTINGS_PRIVACY_ALL,SETTINGS_PRIVACY_FRIENDS:()=>s.SETTINGS_PRIVACY_FRIENDS,SETTINGS_PRIVACY_ONLY_ME:()=>s.SETTINGS_PRIVACY_ONLY_ME});var o=i(278180),r=i(805035),s=i(632560)},69097:(e,t,i)=>{i.d(t,{PrivacyFriendsListsModel:()=>r});var o=i(327813);class r{get friendsLists(){return this._friendsLists}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}dispose(){this._abortController?.abort(),this.friendsListsProvider.reset()}constructor(e,t,i){this.authService=e,this.friendsService=t,this.friendsListsProvider=i,this.fetch=async()=>{if(this.authService.userId){this._abortController?.abort(),this._abortController=new AbortController;try{const e=await this.friendsListsProvider.ensure({userId:this.authService.userId,returnSystem:!0}),t=await Promise.all(e.map((async({id:e,name:t})=>{if(!this.authService.userId)throw new Error("Unexpected friends.get empty user param");const{items:i,count:o}=await this.friendsService.fetchFields({user_id:this.authService.userId,list_id:e,fields:"photo_50",count:3},{signal:this._abortController?.signal});return{id:e,name:t,count:o,friends:i}})));(0,o.runInAction)((()=>{this._friendsLists=t}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}},this._abortController=null,this._friendsLists=null,this._error=null,(0,o.makeAutoObservable)(this)}}},719330:(e,t,i)=>{i.d(t,{PrivacyFriendsModel:()=>r});var o=i(327813);class r{get friends(){return this._friends}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}dispose(){this._abortController?.abort(),this._abortController=null}constructor(e){this.usersProvider=e,this.setFriends=e=>{const t=new Set;this._friends=Array.from([...this._friends||[],...e].filter((e=>!t.has(e.id)&&(t.add(e.id),!0))))},this.fetch=async e=>{if(e.length){this._abortController?.abort(),this._abortController=new AbortController;try{this._friends=await this.usersProvider.fetchUsersByIds({userIds:e},{signal:this._abortController.signal})}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}},this._abortController=null,this._friends=null,this._error=null,(0,o.makeAutoObservable)(this)}}},278180:(e,t,i)=>{i.d(t,{PrivacyFriendsListsModel:()=>o.PrivacyFriendsListsModel,PrivacyFriendsModel:()=>r.PrivacyFriendsModel});var o=i(69097),r=i(719330)},632560:(e,t,i)=>{i.d(t,{SETTINGS_PRIVACY_ALL:()=>o,SETTINGS_PRIVACY_EVERYONE_EXCEPT:()=>l,SETTINGS_PRIVACY_FRIENDS:()=>r,SETTINGS_PRIVACY_FRIENDS_EXCEPT:()=>c,SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS:()=>s,SETTINGS_PRIVACY_ONLY_ME:()=>n,SETTINGS_PRIVACY_SOME_FRIENDS:()=>a,SETTINGS_PRIVACY_SOME_LISTS:()=>d});const o="all",r="friends",s="friends_of_friends",n="only_me",a="some_friends",d="some_lists",l="everyone_except",c="friends_except"},805740:(e,t,i)=>{i.d(t,{getPrivacyValueByBasePrivacy:()=>s});var o=i(632560),r=i(48324);const s=({category:e,lists:t,owners:i})=>{if(e===o.SETTINGS_PRIVACY_ALL&&i?.excluded?.length){const e=new Set(i.excluded.map(String));return{option:o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,excluded:e}}if(e){const t=r.PRIVACY_OPTION_BY_CATEGORY[e];return t?{option:t}:null}if(t?.allowed?.length){const e=new Set(t.allowed.map(String));return{option:o.SETTINGS_PRIVACY_SOME_LISTS,allowed:e}}if(i?.allowed?.length){const e=new Set(i.allowed.map(String));return{option:o.SETTINGS_PRIVACY_SOME_FRIENDS,allowed:e}}return null}},443115:(e,t,i)=>{i.d(t,{getPrivacyValueByBasePrivacy:()=>o.getPrivacyValueByBasePrivacy});var o=i(805740)},121596:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>m});var o=i(474848),r=i(456921),s=i(507852),n=i(260546),a=i(723723),d=i(140083),l=i(132028),c=i(316948),u=i(31700),h=i(988767);const p=(0,r.observer)((function(){const e=(0,c.usePrivacyDropdownModel)();return(0,o.jsx)(s.DropdownActionSheet,{width:260,placement:e.props.current.placement,content:(0,o.jsx)(u.PrivacyDropdownContent,{}),trigger:"click",children:(0,o.jsx)(n.SimpleCell,{after:(0,o.jsx)(d.Icon24ChevronCompactRight,{className:(0,a.getColorClass)("color_icon_tertiary")}),subtitle:(0,o.jsx)(h.PrivacyDropdownSubtitle,{}),multiline:!0,children:e.props.current.title})})})),m=(0,l.createWidget)(c.PrivacyDropdownModelProvider,p)},79872:(e,t,i)=>{i.d(t,{PrivacyDropdownContent:()=>a});var o=i(474848),r=i(456921),s=i(316948),n=i(527710);const a=(0,r.observer)((function(){const{filteredOptions:e}=(0,s.usePrivacyDropdownModel)();return(0,o.jsx)(o.Fragment,{children:e.map((e=>(0,o.jsx)(n.PrivacyDropdownOption,{option:e},e)))})}))},31700:(e,t,i)=>{i.d(t,{PrivacyDropdownContent:()=>o.PrivacyDropdownContent});var o=i(79872)},213234:(e,t,i)=>{i.d(t,{PrivacyDropdownOption:()=>u});var o=i(474848),r=i(456921),s=i(507852),n=i(149333),a=i(632560),d=i(572925),l=i(316948),c=i(598420);const u=(0,r.observer)((function({option:e}){const t=(0,n.useLangs)(),{props:i,setPrivacyFromOption:r}=(0,l.usePrivacyDropdownModel)(),{onClickExceptFriends:u,onClickSomeFriends:h}=i.current,p=t.getLang(c.PRIVACY_OPTION_LANG_KEY_BY_OPTION[e]);switch(e){case a.SETTINGS_PRIVACY_SOME_LISTS:return(0,o.jsx)(d.PrivacyDropdownOptionList,{option:e,children:p});case a.SETTINGS_PRIVACY_EVERYONE_EXCEPT:case a.SETTINGS_PRIVACY_FRIENDS_EXCEPT:return(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:u,children:p});case a.SETTINGS_PRIVACY_SOME_FRIENDS:return(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:h,children:p});default:return(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:()=>r(e),children:p})}}))},739944:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionContent:()=>a});var o=i(474848),r=i(456921),s=i(316948),n=i(568286);const a=(0,r.observer)((function(){const{props:e}=(0,s.usePrivacyDropdownModel)(),{friendsLists:t}=e.current;return t?.length?(0,o.jsx)(o.Fragment,{children:t.map((e=>(0,o.jsx)(n.PrivacyDropdownOptionListItem,{friendsList:e},e.id)))}):null}))},937159:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionList:()=>n});var o=i(474848),r=i(161134),s=i(739944);const n=({option:e,children:t})=>(0,o.jsx)(r.DropdownActionSubSheet,{maxHeight:180,sheet:(0,o.jsx)(s.PrivacyDropdownOptionContent,{}),children:t},e)},568286:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionListItem:()=>d});var o=i(474848),r=i(456921),s=i(161134),n=i(846342),a=i(316948);const d=(0,r.observer)((function({friendsList:e}){const{checkedFriendsLists:t,selectFriendsList:i}=(0,a.usePrivacyDropdownModel)(),{id:r,name:d}=e,l=t.has(String(r));return(0,o.jsx)(s.DropdownActionSubSheet.Item,{onClick:()=>i(String(r)),after:l&&(0,o.jsx)(n.Icon20CheckCircleOn,{}),keepOpen:!0,children:d})}))},572925:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionList:()=>o.PrivacyDropdownOptionList});var o=i(937159)},527710:(e,t,i)=>{i.d(t,{PrivacyDropdownOption:()=>o.PrivacyDropdownOption});var o=i(213234)},643490:(e,t,i)=>{i.d(t,{PrivacyDropdownSubtitle:()=>d});var o=i(474848),r=i(724648),s=i(456921),n=i(316948),a=i(611344);const d=(0,s.observer)((function(){const{subtitle:e}=(0,n.usePrivacyDropdownModel)();return(0,o.jsxs)(r.Flex,{align:"center",noWrap:!0,children:[(0,o.jsx)(a.PrivacyDropdownSubtitleLockIcon,{}),e]})}))},611344:(e,t,i)=>{i.d(t,{PrivacyDropdownSubtitleLockIcon:()=>l});var o=i(474848),r=i(456921),s=i(723723),n=i(194528),a=i(725772),d=i(316948);const l=(0,r.observer)((function(){const{hasPrivacy:e}=(0,d.usePrivacyDropdownModel)();return e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Icon12Lock,{className:(0,s.getColorClass)("color_icon_tertiary")}),(0,o.jsx)(n.Spacing,{mode:"vertical",size:4})]}):null}))},988767:(e,t,i)=>{i.d(t,{PrivacyDropdownSubtitle:()=>o.PrivacyDropdownSubtitle});var o=i(643490)},598420:(e,t,i)=>{i.d(t,{PRIVACY_ONLY_PRIVATE_OPTIONS:()=>n,PRIVACY_OPTIONS:()=>r,PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:()=>s,PRIVACY_OPTION_LANG_KEY_BY_OPTION:()=>d,PRIVACY_SUBTITLE_LANG_KEY_BY_OPTION:()=>a});var o=i(632560);const r=[o.SETTINGS_PRIVACY_ALL,o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME,o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,o.SETTINGS_PRIVACY_SOME_FRIENDS,o.SETTINGS_PRIVACY_SOME_LISTS],s=[o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME,o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,o.SETTINGS_PRIVACY_SOME_FRIENDS,o.SETTINGS_PRIVACY_SOME_LISTS],n=[o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME,o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,o.SETTINGS_PRIVACY_SOME_FRIENDS,o.SETTINGS_PRIVACY_SOME_LISTS],a={[o.SETTINGS_PRIVACY_ALL]:"privacy_options_all_users",[o.SETTINGS_PRIVACY_EVERYONE_EXCEPT]:"global_privacy_settings_everyone_except_subtitle",[o.SETTINGS_PRIVACY_FRIENDS]:"privacy_options_friends_only",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"privacy_options_friends_and_friends",[o.SETTINGS_PRIVACY_ONLY_ME]:"privacy_options_only_me",[o.SETTINGS_PRIVACY_SOME_FRIENDS]:"global_privacy_settings_some_friends_subtitle",[o.SETTINGS_PRIVACY_SOME_LISTS]:"global_privacy_settings_some_friend_lists_subtitle",[o.SETTINGS_PRIVACY_FRIENDS_EXCEPT]:"global_privacy_settings_some_friends_subtitle"},d={[o.SETTINGS_PRIVACY_ALL]:"privacy_options_all_users",[o.SETTINGS_PRIVACY_EVERYONE_EXCEPT]:"privacy_options_advanced_settings",[o.SETTINGS_PRIVACY_FRIENDS]:"privacy_options_friends_only",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"privacy_options_friends_and_friends",[o.SETTINGS_PRIVACY_ONLY_ME]:"privacy_options_only_me",[o.SETTINGS_PRIVACY_SOME_FRIENDS]:"privacy_options_some_friends",[o.SETTINGS_PRIVACY_SOME_LISTS]:"privacy_options_some_friend_lists",[o.SETTINGS_PRIVACY_FRIENDS_EXCEPT]:"settings_privacy_options_advanced_friends_settings"}},791525:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>o.PrivacyDropdown});var o=i(121596)},642216:(e,t,i)=>{i.d(t,{PrivacyDropdownModel:()=>h});var o=i(331635),r=i(327813),s=i(132028),n=i(712600),a=i(641495),d=i(48324),l=i(632560),c=i(598420),u=i(443115);class h{get subtitle(){if(!this.privacyValue)return;const e=this.getPrivacyLists(this.privacy.lists?.allowed),t=this.getPrivacyOwners(this.privacy.owners?.allowed),i=this.getPrivacySubtitle(e,t),o=this.getPrivacyLists(this.privacy.lists?.excluded),r=this.getPrivacyOwners(this.privacy.owners?.excluded),s=this.getPrivacySubtitle(o,r),n=this.langs.getLang(c.PRIVACY_SUBTITLE_LANG_KEY_BY_OPTION[this.privacyValue.option]),a=`${i}${s?`, ${this.langs.getLang("global_privacy_settings_besides_subtitle")} ${s}`:""}`;return n.concat(a)}get filteredOptions(){return this.props.current.isProfileClosed?c.PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:this.props.current?.noPublicAdd?c.PRIVACY_ONLY_PRIVATE_OPTIONS:c.PRIVACY_OPTIONS}get checkedFriendsLists(){return this._checkedFriendsLists}get hasPrivacy(){return this.privacyValue?.option!==l.SETTINGS_PRIVACY_ALL}[s.update](){this._checkedFriendsLists=this.getCheckedFriendsLists()}getCheckedFriendsLists(){return this.privacyValue?.allowed&&this.privacyValue.option===l.SETTINGS_PRIVACY_SOME_LISTS?this.privacyValue.allowed:new Set}getPrivacyOwners(e){const t=this.props.current.friends;if(!t||!e)return[];const i=new Set(e);return t.filter((e=>i.has(e.id)))}getPrivacyLists(e){const t=this.props.current.friendsLists;if(!t||!e)return[];const i=new Set(e);return t.filter((e=>i.has(e.id)))}get defaultPrivacy(){return{category:this.props.current.isProfileClosed?l.SETTINGS_PRIVACY_FRIENDS:l.SETTINGS_PRIVACY_ALL}}get privacy(){return this.props.current.privacy||this.defaultPrivacy}get privacyValue(){return(0,u.getPrivacyValueByBasePrivacy)(this.privacy)}constructor(e,t){this.langs=e,this.props=t,this.setPrivacyFromOption=e=>{const t=d.PRIVACY_CATEGORY_BY_OPTION[e];t&&this.props.current.setPrivacy({category:t})},this.selectFriendsList=e=>{this._checkedFriendsLists.has(e)?this._checkedFriendsLists.delete(e):this._checkedFriendsLists.add(e);const t=this._checkedFriendsLists.size?{lists:{allowed:Array.from(this._checkedFriendsLists,(e=>Number(e)))}}:this.defaultPrivacy;this.props.current.setPrivacy(t)},this._checkedFriendsLists=this.getCheckedFriendsLists(),this.getPrivacySubtitle=(e,t)=>{const i=e.length+t.length;if(i>2){const o=e[0]?.name||(0,a.getOwnerName)(t[0]),r=t.length?"global_privacy_settings_N_person_subtitle":"global_privacy_settings_N_list_subtitle",s=this.langs.numeric(i-1,this.langs.getLang(r,!0));return this.langs.langReplace(s,{name:o})}const o=e.map((e=>e.name)),r=t.map((e=>(0,a.getOwnerName)(e)));return o.concat(r).join(", ")},(0,r.makeAutoObservable)(this)}}h=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Langs?Object:n.Langs,void 0===s.Props?Object:s.Props])],h)},316948:(e,t,i)=>{i.d(t,{PrivacyDropdownModelProvider:()=>s,usePrivacyDropdownModel:()=>n});var o=i(132028),r=i(642216);const{Provider:s,useModel:n}=(0,o.createProvider)(r.PrivacyDropdownModel,{isolatedContext:!1,onlyTransient:!1})},700274:(e,t,i)=>{i.d(t,{PrivacyFormAllowed:()=>l});var o=i(474848),r=i(456921),s=i(296540),n=i(44544),a=i(272126),d=i(386894);const l=(0,r.observer)((function(){const{error:e,setAllowedFriends:t,allowedFriendsModel:{value:i,options:r,setSearchValue:l,isLoading:c}}=(0,a.usePrivacyFormModel)(),u=(0,s.useRef)(null);return(0,s.useEffect)((()=>{e&&u.current?.focus()}),[e]),(0,o.jsx)(n.FormItem,{status:e?"error":"default",children:(0,o.jsx)(d.PrivacyFormSelect,{getRef:u,value:i,options:r,onChange:t,onInputChange:e=>l(e.target.value),isPending:c})})}))},829454:(e,t,i)=>{i.d(t,{PrivacyFormAllowed:()=>o.PrivacyFormAllowed});var o=i(700274)},194228:(e,t,i)=>{i.d(t,{PrivacyFormCategory:()=>a});var o=i(474848),r=i(260546),s=i(149333),n=i(889482);const a=()=>{const e=(0,s.useLangs)();return(0,o.jsx)(r.SimpleCell,{hasActive:!1,hasHover:!1,maxHeight:36,after:(0,o.jsx)(n.PrivacyFormCategoryDropdown,{}),children:e.getLang("global_privacy_settings_allowed")})}},210663:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdown:()=>m});var o=i(474848),r=i(456921),s=i(149333),n=i(507852),a=i(285056),d=i(279734),l=i(723723),c=i(274034),u=i(272126),h=i(326602),p=i(89216);const m=(0,r.observer)((function(){const e=(0,s.useLangs)(),{selectedPrivacyOption:t}=(0,u.usePrivacyFormModel)();return(0,o.jsx)(n.DropdownActionSheet,{trigger:"click",placement:"bottom-end",content:(0,o.jsx)(p.PrivacyFormCategoryDropdownContent,{}),children:(0,o.jsx)(a.Paragraph,{children:(0,o.jsxs)(d.Link,{color:(0,l.getColorClass)("color_text_accent"),children:[e.getLang(h.PRIVACY_LANG_KEY_BY_OPTION[t]).toLowerCase(),(0,o.jsx)(c.Icon16Dropdown,{})]})})})}))},89216:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdownContent:()=>a});var o=i(474848),r=i(456921),s=i(272126),n=i(218836);const a=(0,r.observer)((function(){const{options:e}=(0,s.usePrivacyFormModel)();return(0,o.jsx)(o.Fragment,{children:e.map((e=>(0,o.jsx)(n.PrivacyFormCategoryDropdownOption,{option:e},e)))})}))},218836:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdownOption:()=>c});var o=i(474848),r=i(456921),s=i(507852),n=i(846342),a=i(149333),d=i(272126),l=i(326602);const c=(0,r.observer)((function({option:e}){const t=(0,a.useLangs)(),{selectedPrivacyOption:i,setSelectedPrivacyOption:r}=(0,d.usePrivacyFormModel)();return(0,o.jsx)(s.DropdownActionSheet.Item,{after:e===i?(0,o.jsx)(n.Icon20CheckCircleOn,{}):null,onClick:()=>r(e),children:t.getLang(l.PRIVACY_LANG_KEY_BY_OPTION[e])})}))},889482:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdown:()=>o.PrivacyFormCategoryDropdown});var o=i(210663)},460766:(e,t,i)=>{i.d(t,{PrivacyFormCategory:()=>o.PrivacyFormCategory});var o=i(194228)},667492:(e,t,i)=>{i.d(t,{PrivacyFormExcluded:()=>d});var o=i(474848),r=i(456921),s=i(44544),n=i(272126),a=i(386894);const d=(0,r.observer)((function(){const{setExcludedFriends:e,excludedFriendsModel:{value:t,options:i,setSearchValue:r,isLoading:d}}=(0,n.usePrivacyFormModel)();return(0,o.jsx)(s.FormItem,{children:(0,o.jsx)(a.PrivacyFormSelect,{value:t,options:i,onChange:e,onInputChange:e=>r(e.target.value),isPending:d})})}))},972040:(e,t,i)=>{i.d(t,{PrivacyFormExcluded:()=>o.PrivacyFormExcluded});var o=i(667492)},613272:(e,t,i)=>{i.d(t,{PrivacyFormFooter:()=>c});var o=i(474848),r=i(456921),s=i(908242),n=i(175400),a=i(454154),d=i(149333),l=i(272126);const c=(0,r.observer)((function({onClose:e}){const t=(0,d.useLangs)(),{saveForm:i}=(0,l.usePrivacyFormModel)();return(0,o.jsx)(s.ModalFooter,{actions:(0,o.jsxs)(n.ButtonGroup,{gap:"m",align:"right",children:[(0,o.jsx)(a.Button,{mode:"secondary",size:"m",onClick:e,children:t.getLang("global_cancel")}),(0,o.jsx)(a.Button,{mode:"primary",size:"m",onClick:()=>{i(e)},children:t.getLang("global_save")})]})})}))},794165:(e,t,i)=>{i.d(t,{PrivacyFormFooter:()=>o.PrivacyFormFooter});var o=i(613272)},594644:(e,t,i)=>{i.d(t,{PrivacyFormModal:()=>b});var o=i(474848),r=i(456921),s=i(211413),n=i(694244),a=i(782174),d=i(303800),l=i(557992),c=i(194528),u=i(582192),h=i(149333),p=i(132028),m=i(272126),v=i(460766),g=i(701825),_=i(972040),C=i(794165);const y=(0,r.observer)((function(){const e=(0,h.useLangs)(),{props:t}=(0,m.usePrivacyFormModel)();return(0,o.jsx)(s.MessageBoxModal,{width:640,onDestroy:t.current.onDestroy,children:({onClose:t})=>(0,o.jsxs)(n.ModalBox,{children:[(0,o.jsx)(a.ModalHeader,{onClose:t,closeAriaLabel:e.getLang("global_close"),children:e.getLang("global_privacy_modal_title")}),(0,o.jsxs)(d.Div,{mode:"horizontal",spacing:0,children:[(0,o.jsx)(l.Header,{children:e.getLang("friends_privacy_show")}),(0,o.jsx)(v.PrivacyFormCategory,{}),(0,o.jsx)(g.PrivacyFormSomeFriendsAllowed,{}),(0,o.jsx)(c.Spacing,{size:6}),(0,o.jsx)(u.Separator,{}),(0,o.jsx)(l.Header,{children:e.getLang("friends_privacy_hide")}),(0,o.jsx)(_.PrivacyFormExcluded,{}),(0,o.jsx)(c.Spacing,{})]}),(0,o.jsx)(C.PrivacyFormFooter,{onClose:t})]})})})),b=(0,p.createWidget)(m.PrivacyFormModelProvider,y)},128088:(e,t,i)=>{i.d(t,{PrivacyFormSelect:()=>a});var o=i(474848),r=i(220208),s=i(149333),n=i(690595);const a=({isPending:e,value:t,options:i,onChange:a,onInputChange:d,getRef:l})=>{const c=(0,s.useLangs)();return(0,o.jsx)(r.ChipsSelect,{getRef:l,value:t,onChange:a,onInputChange:d,options:i,fetching:e,placeholder:c.getLang("friends_privacy_choose"),filterFn:!1,renderOption:(e,t)=>(0,o.jsx)(n.PrivacyFormSelectOption,{option:t,...e})})}},690595:(e,t,i)=>{i.d(t,{PrivacyFormSelectOption:()=>d});var o=i(474848),r=i(456921),s=i(220208),n=i(612196),a=i(412888);const d=(0,r.observer)((function({option:e,...t}){return(0,o.jsx)(s.CustomSelectOption,{...t,before:e.friend?(0,o.jsx)(n.Avatar,{size:24,src:e.friend.photo_50}):null,description:e.friendsList?e.description:null,children:(0,o.jsx)(a.TextClamp,{lines:1,children:e.label})})}))},386894:(e,t,i)=>{i.d(t,{PrivacyFormSelect:()=>o.PrivacyFormSelect});var o=i(128088)},576456:(e,t,i)=>{i.d(t,{PrivacyFormSomeFriendsAllowed:()=>a});var o=i(474848),r=i(456921),s=i(829454),n=i(272126);const a=(0,r.observer)((function(){const{isSomeFriends:e}=(0,n.usePrivacyFormModel)();return e&&(0,o.jsx)(s.PrivacyFormAllowed,{})}))},701825:(e,t,i)=>{i.d(t,{PrivacyFormSomeFriendsAllowed:()=>o.PrivacyFormSomeFriendsAllowed});var o=i(576456)},326602:(e,t,i)=>{i.d(t,{PRIVACY_LANG_KEY_BY_OPTION:()=>n,PRIVACY_OPTIONS:()=>r,PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:()=>s});var o=i(632560);const r=[o.SETTINGS_PRIVACY_ALL,o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_SOME_FRIENDS],s=[o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_SOME_FRIENDS],n={[o.SETTINGS_PRIVACY_ALL]:"global_privacy_settings_all_dative",[o.SETTINGS_PRIVACY_FRIENDS]:"global_privacy_settings_friends_dative",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"global_privacy_settings_friends_of_friends_dative",[o.SETTINGS_PRIVACY_SOME_FRIENDS]:"global_privacy_settings_some_friends_dative",[o.SETTINGS_PRIVACY_EVERYONE_EXCEPT]:"",[o.SETTINGS_PRIVACY_ONLY_ME]:"",[o.SETTINGS_PRIVACY_SOME_LISTS]:"",[o.SETTINGS_PRIVACY_FRIENDS_EXCEPT]:""};o.SETTINGS_PRIVACY_ALL,o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME},227503:(e,t,i)=>{i.d(t,{PrivacyFormModal:()=>o.PrivacyFormModal});var o=i(594644)},633135:(e,t,i)=>{i.d(t,{PrivacyFormModel:()=>m});var o=i(331635),r=i(327813),s=i(712600),n=i(951652),a=i(889781),d=i(132028),l=i(632560),c=i(48324),u=i(443115),h=i(326602),p=i(1275);class m{get selectedPrivacyOption(){return this._selectedPrivacyOption}get error(){return this._error}get isSomeFriends(){return this.selectedPrivacyOption===l.SETTINGS_PRIVACY_SOME_FRIENDS}get options(){return this.props.current.isProfileClosed?h.PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:h.PRIVACY_OPTIONS}dispose(){this.allowedFriendsModel.dispose(),this.excludedFriendsModel.dispose()}[d.init](){this.allowedFriendsModel.search(),this.excludedFriendsModel.search()}get allowedValue(){return this._selectedPrivacyOption!==l.SETTINGS_PRIVACY_SOME_FRIENDS?[]:this.allowedFriendsModel.value}get excludedValue(){return this.excludedFriendsModel.value}get selectedPrivacyFromProps(){if(!this.props.current.privacy)return l.SETTINGS_PRIVACY_ALL;const e=(0,u.getPrivacyValueByBasePrivacy)(this.props.current.privacy);if(!e)return l.SETTINGS_PRIVACY_ALL;switch(e.option){case l.SETTINGS_PRIVACY_SOME_LISTS:return l.SETTINGS_PRIVACY_SOME_FRIENDS;case l.SETTINGS_PRIVACY_ONLY_ME:return l.SETTINGS_PRIVACY_FRIENDS;case l.SETTINGS_PRIVACY_EVERYONE_EXCEPT:return l.SETTINGS_PRIVACY_ALL;default:return e.option}}get privacy(){return{category:c.PRIVACY_CATEGORY_BY_OPTION[this._selectedPrivacyOption],owners:this.privacyOwners,lists:this.privacyLists}}get privacyOwners(){const e=e=>e.reduce(((e,t)=>(t.friend&&e.push(t.value),e)),[]);return{allowed:e(this.allowedValue),excluded:e(this.excludedValue)}}get privacyLists(){const e=e=>e.reduce(((e,t)=>(t.friendsList&&e.push(t.value),e)),[]);return{allowed:e(this.allowedValue),excluded:e(this.excludedValue)}}get privacyFriends(){return[...this.allowedValue,...this.excludedValue].reduce(((e,t)=>(t.friend&&e.push(t.friend),e)),[])}constructor(e,t,i,o){this.langs=e,this.authService=t,this.friendsSearchProvider=i,this.props=o,this.allowedFriendsModel=new p.PrivacyFormSearchModel(this.langs,this.authService,this.friendsSearchProvider,this.props.current.friendsLists,this.props.current.friends,this.props.current.privacy?.lists?.allowed,this.props.current.privacy?.owners?.allowed),this.excludedFriendsModel=new p.PrivacyFormSearchModel(this.langs,this.authService,this.friendsSearchProvider,this.props.current.friendsLists,this.props.current.friends,this.props.current.privacy?.lists?.excluded,this.props.current.privacy?.owners?.excluded),this.setAllowedFriends=e=>{const t=new Set(e.map((e=>e.value))),i=this.excludedFriendsModel.value.filter((e=>!t.has(e.value)));i.length!==this.excludedFriendsModel.value.length&&this.excludedFriendsModel.setValue(i),this.allowedFriendsModel.setValue(e)},this.setExcludedFriends=e=>{const t=new Set(e.map((e=>e.value))),i=this.allowedFriendsModel.value.filter((e=>!t.has(e.value)));i.length!==this.allowedFriendsModel.value.length&&this.allowedFriendsModel.setValue(i),this.excludedFriendsModel.setValue(e)},this.setSelectedPrivacyOption=e=>{this._selectedPrivacyOption=e},this.saveForm=e=>{this._error=this.isSomeFriends&&!this.allowedFriendsModel.value.length,this._error||(this.props.current.setFriends(this.privacyFriends),this.props.current.setPrivacy(this.privacy),e?.())},this._error=!1,this._selectedPrivacyOption=this.selectedPrivacyFromProps,(0,r.makeAutoObservable)(this)}}m=(0,o.__decorate)([d.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Langs?Object:s.Langs,void 0===n.AuthService?Object:n.AuthService,void 0===a.FriendsSearchService?Object:a.FriendsSearchService,void 0===d.Props?Object:d.Props])],m)},1275:(e,t,i)=>{i.d(t,{PrivacyFormSearchModel:()=>n});var o=i(327813),r=i(8520),s=i(641495);class n{get value(){return this._value}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}get options(){const e=this.getFriendsOptions(this._friends),t=this.friendsLists?.filter((({name:e,count:t})=>t>0&&e.toLowerCase().includes(this._searchValue.toLowerCase()))),i=this.getFriendsListOptions(t);return e.concat(i)}dispose(){this._abortController?.abort()}get friendsValue(){const e=this.friends?.filter((e=>this.ownerIds?.includes(e.id))),t=this.getFriendsOptions(e),i=this.friendsLists?.filter((e=>this.listsIds?.includes(e.id))),o=this.getFriendsListOptions(i);return t.length||o.length?t.concat(o):[]}constructor(e,t,i,n,a,d,l){this.langs=e,this.authService=t,this.friendsSearchProvider=i,this.friendsLists=n,this.friends=a,this.listsIds=d,this.ownerIds=l,this.setValue=e=>{this._value=e},this.setSearchValue=(0,r.debounce)((e=>{this._searchValue=e.trim(),this.search()}),300),this.search=async()=>{if(!this.authService.userId)return;this._abortController?.abort(),this._abortController=new AbortController;const e={user_id:this.authService.userId,fields:"photo_50",q:this._searchValue};try{const t=await this.friendsSearchProvider.search(e,{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._friends=t.items}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}},this.getFriendsOptions=e=>e?e.map((e=>({value:e.id,label:(0,s.getOwnerName)(e),friend:e}))):[],this.getFriendsListOptions=e=>e?e.map((e=>{const{id:t,name:i,count:o,friends:r}=e,n=r?.map((e=>(0,s.getOwnerName)(e))).join(", ");return{friendsList:e,value:t,label:i,description:n&&o>10?this.langs.langReplace(this.langs.getLang("global_privacy_settings_friends_list_others"),{users:n}):n}})):[],this._abortController=null,this._friends=null,this._error=null,this._value=this.friendsValue,this._searchValue="",(0,o.makeAutoObservable)(this)}}},272126:(e,t,i)=>{i.d(t,{PrivacyFormModelProvider:()=>s,usePrivacyFormModel:()=>n});var o=i(132028),r=i(633135);const{Provider:s,useModel:n}=(0,o.createProvider)(r.PrivacyFormModel,{isolatedContext:!1,onlyTransient:!1})},483645:(e,t,i)=>{i.d(t,{PrivacyFriendsFooter:()=>c});var o=i(474848),r=i(456921),s=i(908242),n=i(175400),a=i(454154),d=i(149333),l=i(216189);const c=(0,r.observer)((function({onClose:e}){const t=(0,d.useLangs)(),{saveForm:i}=(0,l.usePrivacyFriendsFormModel)();return(0,o.jsx)(s.ModalFooter,{actions:(0,o.jsxs)(n.ButtonGroup,{gap:"m",align:"right",children:[(0,o.jsx)(a.Button,{mode:"secondary",size:"m",onClick:e,children:t.getLang("global_cancel")}),(0,o.jsx)(a.Button,{mode:"primary",size:"m",onClick:()=>{i(),e()},children:t.getLang("global_save")})]})})}))},163237:(e,t,i)=>{i.d(t,{PrivacyFriendsFooter:()=>o.PrivacyFriendsFooter});var o=i(483645)},842395:(e,t,i)=>{i.d(t,{PrivacyFriendsForm:()=>c});var o=i(474848),r=i(456921),s=i(303800),n=i(194528),a=i(862139),d=i(456838),l=i(289954);const c=(0,r.observer)((function(){return(0,o.jsxs)(s.Div,{mode:"horizontal",spacing:0,children:[(0,o.jsx)(a.PrivacyFriendsFormHeader,{}),(0,o.jsx)(d.PrivacyFriendsFormSearch,{}),(0,o.jsx)(n.Spacing,{size:4}),(0,o.jsx)(l.PrivacyFriendsFormList,{})]})}))},367943:(e,t,i)=>{i.d(t,{PrivacyFriendsFormHeader:()=>a});var o=i(474848),r=i(557992),s=i(149333),n=i(318855);const a=()=>{const e=(0,s.useLangs)();return(0,o.jsx)(r.Header,{aside:(0,o.jsx)(n.PrivacyFriendsFormSelectedButton,{}),children:e.getLang("global_privacy_settings_friends_in_list")})}},318855:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSelectedButton:()=>d});var o=i(474848),r=i(456921),s=i(279734),n=i(149333),a=i(216189);const d=(0,r.observer)((function(){const e=(0,n.useLangs)(),{selectedFriends:t,friends:i,isSelectedOnly:r,toggleSelectedOnly:d}=(0,a.usePrivacyFriendsFormModel)();return t.size&&i&&i.length?(0,o.jsx)(s.Link,{onClick:d,children:r?e.getLang("friends_privacy_show_all"):e.getLang("friends_privacy_show_selected")}):null}))},862139:(e,t,i)=>{i.d(t,{PrivacyFriendsFormHeader:()=>o.PrivacyFriendsFormHeader});var o=i(367943)},301711:(e,t,i)=>{i.d(t,{PrivacyFriendsFormContainer:()=>c});var o=i(474848),r=i(456921),s=i(159618),n=i(216189),a=i(587683),d=i(71578),l=i(794819);const c=(0,r.observer)((function(){const{friends:e}=(0,n.usePrivacyFriendsFormModel)();return e?.length?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.SpacedList,{spacing:4,children:e.map((e=>(0,o.jsx)(a.PrivacyFriendsFormItem,{friend:e},e.id)))}),(0,o.jsx)(l.PrivacyFriendsFormContainerLoading,{})]}):(0,o.jsx)(d.PrivacyFriendsFormStatus,{})}))},794819:(e,t,i)=>{i.d(t,{PrivacyFriendsFormContainerLoading:()=>d});var o=i(474848),r=i(456921),s=i(303800),n=i(700272),a=i(216189);const d=(0,r.observer)((function(){const{searchFriendsModel:{isLoading:e}}=(0,a.usePrivacyFriendsFormModel)();return e?(0,o.jsx)(s.Div,{children:(0,o.jsx)(n.Spinner,{size:"small"})}):null}))},699251:(e,t,i)=>{i.d(t,{PrivacyFriendsFormContainer:()=>o.PrivacyFriendsFormContainer});var o=i(301711)},359321:(e,t,i)=>{i.d(t,{PrivacyFriendsFormItem:()=>l});var o=i(474848),r=i(456921),s=i(398586),n=i(612196),a=i(641495),d=i(216189);const l=(0,r.observer)((function({friend:e}){const{selectedFriends:t,toggleSelectedFriend:i}=(0,d.usePrivacyFriendsFormModel)();return(0,o.jsx)(s.SelectableCell,{checked:t.has(e.id),onChange:()=>i(e.id),before:(0,o.jsx)(n.Avatar,{size:32,src:e.photo_50}),maxHeight:36,children:(0,a.getOwnerName)(e)})}))},587683:(e,t,i)=>{i.d(t,{PrivacyFriendsFormItem:()=>o.PrivacyFriendsFormItem});var o=i(359321)},690497:(e,t,i)=>{i.d(t,{PrivacyFriendsFormList:()=>u});var o=i(474848),r=i(456921),s=i(296540),n=i(744440),a=i(8520),d=i(216189),l=i(699251),c=i(426955);const u=(0,r.observer)((function(){const{searchFriendsModel:{handleScrollSearch:e}}=(0,d.usePrivacyFriendsFormModel)(),t=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const i=(0,a.throttle)((({target:t})=>{const i=t;i.scrollHeight-i.scrollTop<=2*i.clientHeight&&e()}),200);return t.current?.addEventListener("scroll",i),()=>{t.current?.removeEventListener("scroll",i)}}),[]),(0,o.jsx)(n.CustomScrollView,{boxRef:t,className:c.default.scroll,children:(0,o.jsx)(l.PrivacyFriendsFormContainer,{})})}))},146339:(e,t,i)=>{i.d(t,{PrivacyFriendsFormStatus:()=>u});var o=i(474848),r=i(456921),s=i(724648),n=i(700272),a=i(720836),d=i(149333),l=i(216189),c=i(451097);const u=(0,r.observer)((function(){const e=(0,d.useLangs)(),{searchFriendsModel:{isLoading:t}}=(0,l.usePrivacyFriendsFormModel)();return(0,o.jsx)(s.Flex,{align:"center",justify:"center",className:c.default.status,children:t?(0,o.jsx)(n.Spinner,{size:"medium"}):(0,o.jsx)(a.Placeholder,{children:e.getLang("global_privacy_settings_no_friends_found_for_query")})})}))},71578:(e,t,i)=>{i.d(t,{PrivacyFriendsFormStatus:()=>o.PrivacyFriendsFormStatus});var o=i(146339)},289954:(e,t,i)=>{i.d(t,{PrivacyFriendsFormList:()=>o.PrivacyFriendsFormList});var o=i(690497)},903825:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSearch:()=>a});var o=i(474848),r=i(456921),s=i(264458),n=i(216189);const a=(0,r.observer)((function(){const{searchFriendsModel:{setValue:e}}=(0,n.usePrivacyFriendsFormModel)();return(0,o.jsx)(s.Search,{onChange:t=>e(t.target.value)})}))},456838:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSearch:()=>o.PrivacyFriendsFormSearch});var o=i(903825)},525324:(e,t,i)=>{i.d(t,{PrivacyFriendsForm:()=>o.PrivacyFriendsForm});var o=i(842395)},370948:(e,t,i)=>{i.d(t,{PrivacyFriendsModal:()=>m});var o=i(474848),r=i(456921),s=i(694244),n=i(782174),a=i(149333),d=i(211413),l=i(216189),c=i(525324),u=i(163237),h=i(132028);const p=(0,r.observer)((function(){const e=(0,a.useLangs)(),{props:t}=(0,l.usePrivacyFriendsFormModel)();return(0,o.jsx)(d.MessageBoxModal,{width:640,onDestroy:t.current.onDestroy,children:({onClose:t})=>(0,o.jsxs)(s.ModalBox,{children:[(0,o.jsx)(n.ModalHeader,{onClose:t,closeAriaLabel:e.getLang("global_close"),children:e.getLang("global_privacy_settings_select_friends_modal_title")}),(0,o.jsx)(c.PrivacyFriendsForm,{}),(0,o.jsx)(u.PrivacyFriendsFooter,{onClose:t})]})})})),m=(0,h.createWidget)(l.PrivacyFriendsFormModelProvider,p)},770254:(e,t,i)=>{i.d(t,{PrivacyFriendsModal:()=>o.PrivacyFriendsModal});var o=i(370948)},816873:(e,t,i)=>{i.d(t,{PrivacyFriendsFormModel:()=>l});var o=i(331635),r=i(327813),s=i(951652),n=i(889781),a=i(132028),d=i(604801);class l{get friends(){return this._isSelectedOnly&&this.searchFriendsModel.friends?this.searchFriendsModel.friends.filter((e=>this._selectedFriends.has(e.id))):this.searchFriendsModel.friends}get selectedFriends(){return this._selectedFriends}get isSelectedOnly(){return this._isSelectedOnly}dispose(){this.searchFriendsModel.dispose()}[a.init](){this.setCurrentFriends(),this.searchFriendsModel.search()}[a.update](){this.setCurrentFriends()}[a.destroy](){this.dispose()}constructor(e,t,i){this.authService=e,this.friendsSearchProvider=t,this.props=i,this.toggleSelectedOnly=()=>{this._isSelectedOnly=!this._isSelectedOnly},this.toggleSelectedFriend=e=>{this._selectedFriends.has(e)?this._selectedFriends.delete(e):this._selectedFriends.add(e)},this.setCurrentFriends=()=>{const{privacy:e,friends:t}=this.props.current;if(e?.lists?.excluded?.length||e?.lists?.allowed?.length||e?.owners?.excluded?.length||!e?.owners?.allowed?.length||!t)return void(this._selectedFriends=new Set);const i=t.reduce(((t,i)=>(e?.owners?.allowed?.includes(i.id)&&t.push(i.id),t)),[]);this._selectedFriends=new Set(i)},this.saveForm=()=>{if(!this._selectedFriends.size)return void this.props.current.setPrivacy({category:"only_me"});const e=this.searchFriendsModel.friends?.filter((e=>this._selectedFriends.has(e.id)));e&&(this.props.current.setFriends(e),this.props.current.setPrivacy({owners:{allowed:Array.from(this._selectedFriends)}}))},this.searchFriendsModel=new d.PrivacyFriendsFormSearchModel(this.authService,this.friendsSearchProvider),this._isSelectedOnly=!1,this._selectedFriends=new Set,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([a.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.AuthService?Object:s.AuthService,void 0===n.FriendsSearchService?Object:n.FriendsSearchService,void 0===a.Props?Object:a.Props])],l)},604801:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSearchModel:()=>s});var o=i(327813),r=i(740342);class s{get friends(){return this._friends}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}resetData(){this._friends=null,this._error=null,this._totalCount=null}dispose(){this._abortController?.abort()}constructor(e,t){this.authService=e,this.friendsSearchProvider=t,this.setValue=(0,r.debounce)((e=>{const t=e.trim();this._value!==t&&(this.resetData(),this._value=t,this.search())}),300),this.search=async()=>{if(!this.authService.userId||this._totalCount&&this._friends&&this._friends.length>=this._totalCount)return;this._abortController?.abort(),this._abortController=new AbortController;const e={user_id:this.authService.userId,offset:this._friends?.length,count:50,fields:"photo_50",q:this._value};try{const t=await this.friendsSearchProvider.search(e,{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._friends=this._friends||[],this._friends.push(...t.items),this._totalCount=t.count}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}},this.handleScrollSearch=()=>{this.isLoading||this.search()},this._abortController=null,this._friends=null,this._error=null,this._value="",this._totalCount=null,(0,o.makeAutoObservable)(this)}}},216189:(e,t,i)=>{i.d(t,{PrivacyFriendsFormModelProvider:()=>s,usePrivacyFriendsFormModel:()=>n});var o=i(132028),r=i(816873);const{Provider:s,useModel:n}=(0,o.createProvider)(r.PrivacyFriendsFormModel,{isolatedContext:!1,onlyTransient:!1})},805035:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>o.PrivacyDropdown,PrivacyFormModal:()=>r.PrivacyFormModal,PrivacyFriendsModal:()=>s.PrivacyFriendsModal});var o=i(791525),r=i(227503),s=i(770254)},131256:(e,t,i)=>{i.d(t,{getEpisodeLink:()=>r});var o=i(22421);const r=(e,t)=>{const i=Math.floor(e/3600),r=Math.floor(e%3600/60),s=Math.floor(e%3600%60);return(0,o.makeUrl)(t,{t:`${i}h${r}m${s}s`})}},46611:(e,t,i)=>{i.d(t,{getStickerRichProps:()=>o.getStickerRichProps,isPopupStickerAttachment:()=>o.isPopupStickerAttachment});var o=i(380449)},699572:(e,t,i)=>{i.d(t,{getStickerRichProps:()=>a});var o=i(474848),r=i(478091),s=i(46611),n=i(597521);const a=({attachment:e,popupStore:t,wrapperProps:i={}})=>{if((0,s.isPopupStickerAttachment)(e)&&(0,n.isPopUpStickersEnabled)()){const s=e.sticker.popup.layers;return{wrapperProps:{icon:(0,o.jsx)(r.Icon12Play,{}),iconPosition:"rightRelative",iconWrapperRef:void 0,contentClassName:"popupStickerIcon",onContentClick:e=>{e.stopPropagation();const i=e.target;t?.prepareWithDestroyEvent({layers:s,stickerElement:i})},...i}}}}},380449:(e,t,i)=>{i.d(t,{getStickerRichProps:()=>o.getStickerRichProps,isPopupStickerAttachment:()=>r.isPopupStickerAttachment});var o=i(699572),r=i(257357)},257357:(e,t,i)=>{i.d(t,{isPopupStickerAttachment:()=>s});var o=i(642849),r=i(344527);const s=e=>!!e&&((0,o.isStickerAttachment)(e)&&e?.sticker&&(0,r.isPopupSticker)(e.sticker))},358639:(e,t,i)=>{i.d(t,{VideoToggle:()=>r});var o=i(327813);class r{get state(){return this._isEnabled}constructor(e=!1){this.set=e=>{this._isEnabled=e},this.enable=()=>{this._isEnabled=!0},this.disable=()=>{this._isEnabled=!1},this.toggle=()=>{this._isEnabled=!this._isEnabled},this._isEnabled=e,(0,o.makeAutoObservable)(this)}}},597876:(e,t,i)=>{i.d(t,{InputEmojiButton:()=>a});var o=i(474848),r=i(456921),s=i(8520),n=i(275143);const a=(0,r.observer)((function({className:e,children:t}){const{onMouseEnter:i,onMouseLeave:r,ref:a}=(0,n.useHandleEmojiButton)();return(0,o.jsx)("div",{className:(0,s.classNames)(e,"_emoji_wrap"),children:t({className:"_emoji_btn",ref:a,onMouseEnter:i,onMouseLeave:r})})}))},275143:(e,t,i)=>{i.d(t,{useHandleEmojiButton:()=>r});var o=i(296540);const r=()=>{const e=(0,o.useRef)(null),t=(0,o.useRef)(),i=(0,o.useCallback)((i=>{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e.current&&window.Emoji.show(e.current,i)}),300)}),[]),r=(0,o.useCallback)((i=>{t.current&&clearTimeout(t.current),e.current&&window.Emoji.hide(e.current,i)}),[]);return{ref:e,onMouseEnter:i,onMouseLeave:r}}},751423:(e,t,i)=>{i.d(t,{InputEmojiButton:()=>o.InputEmojiButton,useEmoji:()=>r.useEmoji});var o=i(597876),r=i(204356)},204356:(e,t,i)=>{i.d(t,{useEmoji:()=>n});var o=i(296540),r=i(514683),s=i(446327);const n=({inputValue:e,inputRef:t,onChangeInput:i,emojiOpts:n})=>{(0,o.useLayoutEffect)((()=>{t.current&&window.Emoji&&e!==window.Emoji.val(t.current)&&(window.Emoji.val(t.current,window.Emoji.emojiToHTML((0,s.clean)(e))),(0,r.setEndOfContentEditable)(t.current))}),[e]),(0,o.useEffect)((()=>{let e=null;return window.stManager.add([window.jsc("web/emoji.js")],(function(){t?.current?e=window.Emoji.init(t.current,n):console.error("Не удалось инициализировать эмодзи из-за отсутствия ref")})),()=>{e&&window.Emoji&&window.Emoji.destroy(e)}}),[]);return{handleInput:e=>{e.preventDefault();const t=e.target;t instanceof HTMLElement&&window.Emoji&&i(window.Emoji.val(t))}}}},50489:(e,t,i)=>{i.d(t,{PopupStickerRoot:()=>a});var o=i(474848),r=i(280401),s=i(597521),n=i(780387);const a=({children:e,allowUseCommon:t,isUseAsFullscreen:i,position:a,popUpStore:d,setElementRef:l,className:c=n.default.wrapper,HtmlElement:u="div",...h})=>(0,s.isPopUpStickersEnabled)()?(0,o.jsx)(r.PopupRoot,{setElementRef:l,popUpStore:d,className:c,position:a,allowUseCommon:t,isUseAsFullscreen:i,HtmlElement:u,...h,children:e}):(0,o.jsx)(u,{ref:l,className:c,...h,children:e})},93120:(e,t,i)=>{i.d(t,{PopupStickerRoot:()=>o.PopupStickerRoot});var o=i(50489)},8371:(e,t,i)=>{i.d(t,{AuthorName:()=>s});var o=i(474848),r=i(699032);const s=({name:e,isVerified:t})=>(0,o.jsx)("span",{"data-testid":"clips-author-name",children:t?(0,o.jsx)(r.VerifiedLabel,{children:e}):e})},818781:(e,t,i)=>{i.d(t,{AuthorName:()=>o.AuthorName});var o=i(8371)},173381:(e,t,i)=>{i.d(t,{ClipsAuthorSkeleton:()=>a});var o=i(474848),r=i(260546),s=i(55366),n=i(157643);const a=()=>(0,o.jsx)(r.SimpleCell,{before:(0,o.jsx)(s.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:48,height:48,circle:!0})}),subtitle:(0,o.jsx)(n.Skeleton,{width:200}),hasHover:!1,hasActive:!1,children:(0,o.jsx)(n.Skeleton,{width:320})})},963245:(e,t,i)=>{i.d(t,{ClipsCommentsScrollWrapper:()=>s});var o=i(474848),r=i(529247);const s=({children:e})=>(0,o.jsx)("div",{className:r.default.wrapper,children:e})},511806:(e,t,i)=>{i.d(t,{ClipsCommentsScrollWrapper:()=>o.ClipsCommentsScrollWrapper});var o=i(963245)},326957:(e,t,i)=>{i.d(t,{ClipsCommentsSkeleton:()=>u});var o=i(474848),r=i(172656),s=i(303800),n=i(157643),a=i(260546),d=i(55366),l=i(8520),c=i(334655);const u=()=>(0,o.jsxs)(r.Group,{separator:"hide",className:c.default.clipsCommentsSkeleton,children:[(0,o.jsx)(s.Div,{children:(0,o.jsx)(n.Skeleton,{width:220})}),(0,l.createArray)(5).map((e=>(0,o.jsxs)(a.SimpleCell,{multiline:!0,before:(0,o.jsx)(d.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:48,height:48,circle:!0})}),hasHover:!1,hasActive:!1,children:[(0,o.jsx)(n.Skeleton,{width:320}),(0,o.jsx)(n.Skeleton,{width:200}),(0,o.jsx)(n.Skeleton,{width:180}),(0,o.jsx)(n.Skeleton,{width:220})]},e)))]})},849089:(e,t,i)=>{i.d(t,{ClipsCommentsSkeleton:()=>o.ClipsCommentsSkeleton});var o=i(326957)},222074:(e,t,i)=>{i.d(t,{ClipsFadeWrapper:()=>n});var o=i(474848),r=i(923836),s=i(766031);const n=({children:e,id:t})=>(0,o.jsx)(r.LazyFramerMotion,{children:(0,o.jsx)(s.m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e},t)})},97044:(e,t,i)=>{i.d(t,{ClipsFeedComponent:()=>l});var o=i(474848),r=i(776416),s=i(907678),n=i(302951),a=i(839361),d=i(326300);function l({feed:e,listIds:t,isLoadingBefore:i,isLoadingNext:l,emptyPlaceholder:c,loadNext:u,loadBefore:h,itemSize:p,activeItemId:m,onActiveItemChanged:v,itemRender:g,after:_,scrollRef:C,itemsOffset:y,itemsGap:b,isFlex:I}){const S=(0,s.usePageBlockOffset)(),f=void 0===b?S:b,w=Boolean(i||l);return t.length?m?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:I?d.default.feedWrapperFlex:d.default.feedWrapper,children:(0,o.jsx)(a.AsyncCarousel,{activeItem:m,calcItemSize:()=>p,getItemKey:e=>e.toString(),items:t,itemRender:g,itemsGap:f,loadMore:u,loadBefore:h,onActiveItemChange:v,pending:w,swipeComponentRef:C,itemsOffset:y})},e),_]}):(0,o.jsx)(r.FeedSkeleton,{startOffset:f}):(0,o.jsxs)(o.Fragment,{children:[w&&(0,o.jsx)(r.FeedSkeleton,{startOffset:f}),"empty"===c&&(0,o.jsx)(n.EmptyFeedPlaceholder,{feed:e}),"error"===c&&(0,o.jsx)(n.GlobalErrorPlaceholder,{})]})}},732434:(e,t,i)=>{i.d(t,{AsyncCarousel:()=>h});var o=i(474848),r=i(296540),s=i(209808),n=i(265032),a=i(579780),d=i(289475),l=i(475451);const c=Symbol(),u={width:100,height:l.ITEM_BOTTOM_OFFSET},h=({activeItem:e,calcItemSize:t,getItemKey:i,itemRender:l,items:h,loadMore:p,loadBefore:m,itemsGap:v,onActiveItemChange:g,pending:_,prefetchOn:C=3,swipeComponentRef:y,itemsOffset:b})=>{const I=(0,r.useRef)(!0),S=h.length,f=e?h.indexOf(e):-1,w=f>-1?f:0,E=S,[k,P]=(0,r.useState)(!1),[A,L]=(0,r.useState)(""),x=(0,r.useMemo)((()=>_?[...h,c]:h),[h,_]);(0,r.useEffect)((()=>{f>=S-C&&p(),f<C&&m?.()}),[f,S,C,p]),(0,r.useEffect)((()=>{(w<E-1||!_)&&P(!1)}),[w,S,_]);const M=(0,r.useCallback)((e=>e!==E?t(e):{...t(e),height:u.height}),[_,t,E]),O=(0,r.useCallback)(((t,i)=>t!==c?l(t,i,A===t,e===t):(0,o.jsx)(s.PanelSpinner,{height:u.height})),[l,A,e]),T=(0,r.useCallback)(((e,t)=>e!==c?i?.(e,t)??t:"PENDING"),[i]),V=(0,r.useCallback)((t=>{t&&e&&L(String(e))}),[e]);return(0,o.jsx)(n.ClipsCarousel,{activeItemIndex:k&&_?E:w,calcItemSize:M,getItemKey:T,items:x,renderItem:O,itemsGap:v,startGap:!0,overscan:4,lastToStart:!0,onItemIndexChange:t=>{(0,d.partConfigEnabled)("search_enabled_clips_block_new_url_video_search")&&I.current&&(I.current=!1,0===t)||(t<h.length&&h[t]!==e&&g(h[t]),P(t>=E))},swipeComponentRef:y,snapScrollBlockRender:!a.browser.safari,onSnapScrollIdle:V,itemsOffset:b})}},584260:(e,t,i)=>{i.d(t,{AsyncCarousel:()=>o.AsyncCarousel});var o=i(732434)},219782:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>m});var o=i(474848),r=i(296540),s=i(202350),n=i(271036),a=i(723723),d=i(225583),l=i(578192),c=i(149333),u=i(548511);const h=["ArrowUp","KeyW"],p=["ArrowDown","KeyS"],m=({isFirstActive:e,isLastActive:t,handler:i})=>{const m=(0,c.useLangs)(),v=(0,r.useCallback)((()=>i(-1)),[i]),g=(0,r.useCallback)((()=>i(1)),[i]);return(0,u.useKeyPress)(h,v),(0,u.useKeyPress)(p,g),(0,o.jsxs)(s.RoundedGroup,{direction:"vertical",gap:16,children:[(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",children:(0,o.jsx)(n.IconButton,{className:(0,a.getColorClass)("color_icon_secondary"),size:52,disabled:e,"aria-controls":"clips-carousel",label:m.getLang("video_clips_prev_video"),"data-testid":"clips-controls-prev-button",onClick:()=>i(-1),children:(0,o.jsx)(d.Icon28ArrowUpOutline,{})})}),(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",children:(0,o.jsx)(n.IconButton,{className:(0,a.getColorClass)("color_icon_secondary"),size:52,disabled:t,"aria-controls":"clips-carousel",label:m.getLang("video_clips_next_video"),"data-testid":"clips-controls-next-button",onClick:()=>i(1),children:(0,o.jsx)(l.Icon28ArrowDownOutline,{})})})]})}},548511:(e,t,i)=>{i.d(t,{useKeyPress:()=>r});var o=i(296540);const r=(e,t)=>{(0,o.useEffect)((()=>{const i=i=>{i.target!==document.body&&"clips-carousel"!==i.target?.getAttribute("aria-controls")||!(Array.isArray(e)?e.includes(i.code):e===i.code)||(i.preventDefault(),t?.())};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}}),[e,t])}},692021:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>o.ClipsFeedCarouselControls});var o=i(219782)},173030:(e,t,i)=>{i.d(t,{ClipsFeedControlsLayout:()=>a});var o=i(474848),r=i(724648),s=i(967480),n=i(725930);const a=({itemSize:e,topControls:t,bottomControls:i,itemsOffset:a,topControlsDirection:d,bottomControlsDirection:l,itemsGapSize:c})=>{const u={"--clips-feed-controlslayout-height":`${e.height}px`,left:window.vk.rtl?"auto":(0,s.getControlsLeftPosition)(e.width,a),right:window.vk.rtl?(0,s.getControlsLeftPosition)(e.width,a):"auto"};return(0,o.jsxs)(r.Flex,{direction:"column",justify:"space-between",align:"baseline",className:n.default.root,style:u,margin:"none",children:[(0,o.jsx)(r.Flex.Item,{alignSelf:"start",children:(0,o.jsx)(r.Flex,{direction:d,gap:c,margin:"none",children:t})}),(0,o.jsx)(r.Flex.Item,{alignSelf:"start",children:(0,o.jsx)(r.Flex,{direction:l,gap:c,align:"end",margin:"none",children:i})})]})}},2385:(e,t,i)=>{i.d(t,{ClipsFeedControlsLayout:()=>o.ClipsFeedControlsLayout});var o=i(173030)},967480:(e,t,i)=>{i.d(t,{getControlsLeftPosition:()=>r});var o=i(475451);const r=(e,t=0)=>e+t+o.FEED_CLIP_CONTROLS_OFFSET-(e-o.ITEM_MAX_WIDTH)/(o.ITEM_MAX_WIDTH-o.ITEM_MIN_WIDTH)*o.FEED_CLIP_CONTROLS_OFFSET_RANGE},839361:(e,t,i)=>{i.d(t,{AsyncCarousel:()=>o.AsyncCarousel,ClipsFeedCarouselControls:()=>r.ClipsFeedCarouselControls,ClipsFeedControlsLayout:()=>s.ClipsFeedControlsLayout});var o=i(584260),r=i(692021),s=i(2385)},475451:(e,t,i)=>{i.d(t,{FEED_CLIP_CONTROLS_OFFSET:()=>d,FEED_CLIP_CONTROLS_OFFSET_RANGE:()=>l,FEED_CLIP_CONTROLS_WIDTH:()=>c,ITEM_BOTTOM_OFFSET:()=>r,ITEM_MAX_WIDTH:()=>s,ITEM_MIN_HEIGHT:()=>a,ITEM_MIN_WIDTH:()=>n,ITEM_RATIO:()=>o});const o=9/16,r=30,s=450,n=380,a=450,d=30,l=20,c=100},896079:(e,t,i)=>{i.d(t,{useClipSize:()=>o.useClipSize});var o=i(141699)},141699:(e,t,i)=>{i.d(t,{useClipSize:()=>a});var o=i(296540),r=i(469821),s=i(604743),n=i(475451);const a=()=>{const e=(0,s.useNarrowColumnOffset)(),[t,i]=(0,r.useElementSize)(),[a,d]=(0,o.useMemo)((()=>{let t=i.width?i.width-n.FEED_CLIP_CONTROLS_WIDTH:0,o=window.innerHeight-e-n.ITEM_BOTTOM_OFFSET;o=Math.min(t/n.ITEM_RATIO,o);const r=Math.min(Math.max(o,n.ITEM_MIN_HEIGHT),n.ITEM_MAX_WIDTH/n.ITEM_RATIO),s=Math.max(r*n.ITEM_RATIO,n.ITEM_MIN_WIDTH);return[t,{height:r,width:s,ratio:s/r,mode:s===n.ITEM_MIN_WIDTH?"cover":"contain"}]}),[i]);return{setRoot:t,itemSize:d,maxWidth:a}}},525940:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>r.ClipsFeedCarouselControls,ClipsFeedComponent:()=>o.ClipsFeedComponent,ClipsFeedControlsLayout:()=>r.ClipsFeedControlsLayout,ITEM_MAX_WIDTH:()=>n.ITEM_MAX_WIDTH,ITEM_RATIO:()=>n.ITEM_RATIO,useClipSize:()=>s.useClipSize});var o=i(97044),r=i(839361),s=i(896079),n=i(475451)},36943:(e,t,i)=>{i.d(t,{ClipsFeedMoreMenu:()=>u});var o=i(474848),r=i(507852),s=i(202350),n=i(271036),a=i(723723),d=i(296540),l=i(225853),c=i(149333);const u=({children:e})=>{const t=(0,d.useRef)(null),i=(0,c.useLangs)();return(0,o.jsx)(r.DropdownActionSheet,{trigger:"hover",padding:"s",content:e,children:(0,o.jsx)("div",{children:(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",appearance:"default",getRootRef:t,children:(0,o.jsx)(n.IconButton,{size:52,className:(0,a.getColorClass)("color_icon_secondary"),label:i.getLang("global_more"),"data-testid":"clips-controls-more-actions-button",children:(0,o.jsx)(l.Icon28MoreHorizontal,{})})})})})}},196713:(e,t,i)=>{i.d(t,{ClipsOrdTitle:()=>d});var o=i(474848),r=i(456921),s=i(285056),n=i(578392),a=i(149333);const d=(0,r.observer)((function({ordInfo:e,maxWidth:t}){const i=(0,a.useLangs)();return e?.moderated?(0,o.jsx)(s.Headline,{weight:"2",inline:!0,children:e.title}):(0,o.jsx)(n.TextTooltip,{appearance:"neutral",maxWidth:t,placement:"bottom",text:i.getLang("video_clip_ord_tooltip_text"),children:(0,o.jsx)(s.Headline,{weight:"2",inline:!0,children:e.title})})}))},24395:(e,t,i)=>{i.d(t,{ClipsOrdTitle:()=>o.ClipsOrdTitle});var o=i(196713)},573233:(e,t,i)=>{i.d(t,{ClipsShowMoreDescription:()=>p});var o=i(474848),r=i(923228),s=i(303800),n=i(285056),a=i(14756),d=i(279734),l=i(724244),c=i(296540),u=i(558845),h=i(104259);const p=({text:e,isExpanded:t,expand:i,onLinkClick:p,ordTitleNode:m,maxHeight:v,maskHeight:g})=>{const _=(0,c.useMemo)((()=>(0,h.replaceHashtagsMentions)(e,p)),[e,p]);return(0,o.jsx)(r.ClipFadeDescription,{bottomOnly:!0,maxHeight:t?v:void 0,maskHeight:g,children:(0,o.jsx)(s.Div,{mode:"horizontal",children:(0,o.jsx)(n.Headline,{weight:"3",children:(0,o.jsxs)(a.ShowMoreText,{lines:2,mode:"inline",expanded:t,expandElement:(0,o.jsx)(d.Link,{mode:"secondary",onClick:()=>i(!0),children:(0,u.getLang)("video_clips_author_description_more")}),collapseElement:(0,o.jsx)(d.Link,{mode:"secondary",onClick:()=>i(!1),children:(0,u.getLang)("global_min")}),children:[m&&(0,o.jsxs)(o.Fragment,{children:[m,(0,o.jsx)(l.InterpunctSeparator,{})]}),_]})})})})}},557078:(e,t,i)=>{i.d(t,{ClipsShowMoreDescription:()=>o.ClipsShowMoreDescription});var o=i(573233)},331043:(e,t,i)=>{i.d(t,{EmptyFeedPlaceholder:()=>d});var o=i(474848),r=i(720836),s=i(910551),n=i(149333),a=i(296540);const d=({feed:e})=>{const t=(0,n.useLangs)(),i=(0,a.useMemo)((()=>({subscriptions:t.getLang("video_clip_subscriptions_placeholder"),ownerFeed:t.getLang("video_clip_grid_placeholder"),postponed:t.getLang("video_clip_grid_postponed_placeholder")})),[]);return(0,o.jsx)(r.Placeholder,{icon:(0,o.jsx)(s.Icon56LogoClipsOutline,{}),header:i[e]??""})}},641597:(e,t,i)=>{i.d(t,{GlobalErrorPlaceholder:()=>a});var o=i(474848),r=i(720836),s=i(525652),n=i(149333);const a=({stretched:e})=>{const t=(0,n.useLangs)();return(0,o.jsx)(r.Placeholder,{stretched:e,icon:(0,o.jsx)(s.Icon56ErrorOutline,{}),header:t.getLang("vkconnect_auth_security_error_title"),children:t.getLang("vkconnect_auth_security_error_text")})}},302951:(e,t,i)=>{i.d(t,{EmptyFeedPlaceholder:()=>o.EmptyFeedPlaceholder,GlobalErrorPlaceholder:()=>r.GlobalErrorPlaceholder});var o=i(331043),r=i(641597)},938981:(e,t,i)=>{i.d(t,{PublishDate:()=>s});var o=i(474848),r=i(406751);const s=({date:e,mode:t})=>(0,o.jsx)("span",{"data-testid":"clips-author-publish-date",children:"compact"===t?(0,r.getFormattedUpdatedTime)(e,!0):(0,r.getFormattedVideoDate)(e)})},384272:(e,t,i)=>{i.d(t,{PublishDate:()=>o.PublishDate});var o=i(938981)},194397:(e,t,i)=>{i.d(t,{PublishMeta:()=>d});var o=i(474848),r=i(285056),s=i(723723),n=i(815138),a=i(724244);const d=({children:e,type:t,...i})=>(0,o.jsx)(r.Text,{className:"description"===t?(0,s.getColorClass)("color_text_secondary"):void 0,inline:!0,...i,children:(0,o.jsx)(n.Join,{separator:(0,o.jsx)(a.InterpunctSeparator,{spacing:4}),children:e})})},71589:(e,t,i)=>{i.d(t,{PublishMeta:()=>o.PublishMeta});var o=i(194397)},532871:(e,t,i)=>{i.d(t,{SubscribersCount:()=>n});var o=i(474848),r=i(272428),s=i(558845);const n=({count:e})=>(0,o.jsx)("span",{"data-testid":"clips-author-subscribers-count",children:(0,r.formatNumberTranslation)(e,(0,s.getLang)("video_clips_author_followers","raw"))})},505375:(e,t,i)=>{i.d(t,{SubscribersCount:()=>o.SubscribersCount});var o=i(532871)},872021:(e,t,i)=>{i.d(t,{ViewsCount:()=>a});var o=i(474848),r=i(272428),s=i(406751),n=i(558845);const a=({count:e,mode:t})=>(0,o.jsx)("span",{"data-testid":"clips-author-publish-views-count",children:"compact"===t?(0,r.formatNumberTranslation)(e,(0,n.getLang)("video_clips_views_count","raw")):(0,s.getFormattedFullVideoViews)(e)})},130032:(e,t,i)=>{i.d(t,{ViewsCount:()=>o.ViewsCount});var o=i(872021)},142648:(e,t,i)=>{i.d(t,{AuthorName:()=>u.AuthorName,ClipsAuthorSkeleton:()=>d.ClipsAuthorSkeleton,ClipsCommentsScrollWrapper:()=>n.ClipsCommentsScrollWrapper,ClipsCommentsSkeleton:()=>a.ClipsCommentsSkeleton,ClipsFadeWrapper:()=>g.ClipsFadeWrapper,ClipsFeedCarouselControls:()=>r.ClipsFeedCarouselControls,ClipsFeedComponent:()=>r.ClipsFeedComponent,ClipsFeedControlsLayout:()=>r.ClipsFeedControlsLayout,ClipsFeedMoreMenu:()=>s.ClipsFeedMoreMenu,ClipsOrdTitle:()=>l.ClipsOrdTitle,ClipsShowMoreDescription:()=>c.ClipsShowMoreDescription,EmptyFeedPlaceholder:()=>o.EmptyFeedPlaceholder,GlobalErrorPlaceholder:()=>o.GlobalErrorPlaceholder,ITEM_MAX_WIDTH:()=>r.ITEM_MAX_WIDTH,ITEM_RATIO:()=>r.ITEM_RATIO,PublishDate:()=>m.PublishDate,PublishMeta:()=>p.PublishMeta,SubscribersCount:()=>h.SubscribersCount,ViewsCount:()=>v.ViewsCount,useClipSize:()=>r.useClipSize});var o=i(302951),r=i(525940),s=i(36943),n=i(511806),a=i(849089),d=i(173381),l=i(24395),c=i(557078),u=i(818781),h=i(505375),p=i(71589),m=i(384272),v=i(130032),g=i(222074)},661466:(e,t,i)=>{i.d(t,{StackedList:()=>a});var o=i(474848),r=i(456921),s=i(303800),n=i(591378);const a=(0,r.observer)((({items:e,block:t,ItemComponent:i,spacingByDataType:r={},rowSpacingByDataType:a={},columnSpacingByDataType:d={},columnsByDataType:l={},verticalPaddingByDataType:c={},horizontalPaddingByDataType:u={},itemStyle:h})=>{const p=l[t.data.data_type],m=a[t.data.data_type],v=d[t.data.data_type],g=r[t.data.data_type]??0,_=c[t.data.data_type]??0,C=u[t.data.data_type]??0,y=void 0!==m||void 0!==v?{rowSpacing:m??0,columnSpacing:v??0}:{spacing:g};return(0,o.jsx)(s.Div,{mode:"vertical",spacing:C,paddingTop:_,paddingBottom:_,"data-testid":`stacked_list_${t.data.data_type}`,children:(0,o.jsx)(n.Grid,{columns:p??"dynamic",...y,children:e.map(((e,r)=>(0,o.jsx)(n.Grid.Item,{style:h,children:(0,o.jsx)(i,{...e,index:r,block:t})},e.id)))})})}))},506195:(e,t,i)=>{i.d(t,{StackedList:()=>o.StackedList});var o=i(661466)},515593:(e,t,i)=>{i.d(t,{useCommentsScroll:()=>o.useCommentsScroll});var o=i(600425)},600425:(e,t,i)=>{i.d(t,{useCommentsScroll:()=>n});var o=i(8520),r=i(296540);const s="100%",n=e=>{const t=(0,r.useRef)(null),i=(0,r.useRef)(null),[n,a]=(0,r.useState)(null),d=(0,r.useRef)(s),l=(0,r.useRef)(0),c=(0,r.useRef)(!1),u=(0,r.useRef)(!1),h=(0,r.useCallback)((e=>{d.current=e,n?.parentElement?.parentElement?.style.setProperty("--scrollWrap-height",`${d.current}`)}),[n]),p=(0,r.useCallback)((()=>{const e=n?.parentElement?.parentElement,o=n?.scrollHeight||0,r=t.current?.offsetHeight||0,a=i.current?.offsetHeight||0;if(e&&u.current){h(o-a-100>r?`${a+(0===l.current?r:0)}px`:s)}}),[n]);(0,r.useEffect)((()=>{u.current=!1,h(s)}),[e]);const m=(0,r.useCallback)((()=>{u.current=!0,n&&(n.dataset.bypassScrollHandler="1",p(),n.scrollTop=n.scrollHeight)}),[n]);(0,r.useEffect)((()=>{const e=new ResizeObserver((()=>{c.current||(p(),u.current&&n&&0===l.current&&(n.dataset.bypassScrollHandler="1",n.scrollTop=n.scrollHeight))}));return i.current&&e.observe(i.current),()=>{e.disconnect()}}),[n]),(0,r.useEffect)((()=>{const e=e=>{c.current="transitionend"!==e.type};return t.current?.addEventListener("transitionstart",e),t.current?.addEventListener("transitionend",e),()=>{t.current?.removeEventListener("transitionstart",e),t.current?.removeEventListener("transitionend",e)}}),[]);const v=(0,r.useCallback)((e=>{l.current=e,t.current?.style.setProperty("--hiddenContent-margin-top",`${l.current}px`)}),[]),g=(0,r.useCallback)((()=>{if(!n||!t.current||c.current||u.current&&d.current===s)return;const{scrollHeight:e,clientHeight:i,scrollTop:o}=n,r=u.current?e-i-100:100;n.dataset.bypassScrollHandler?o<r&&delete n.dataset.bypassScrollHandler:u.current?o>=e-i-1?v(0):o<r&&v(-t.current?.offsetHeight):o<1?v(0):o>r&&v(-t.current?.offsetHeight)}),[n]),_=(0,r.useCallback)((0,o.throttle)(g,20),[n]),C=(0,r.useCallback)((e=>{if(n&&0!==l.current){if(e?.currentTarget){const t=e.currentTarget.getBoundingClientRect(),i=e.clientX,o=e.clientY;if(i>t.left&&i<t.right&&o>t.top&&o<t.bottom)return}v(0)}}),[n]);return{hiddenBlockRef:t,onCommentsScroll:_,commentsRootRef:i,commentsBlockRef:n,setCommentsBlockRef:a,resetPosition:C,onReverse:m}}},83426:(e,t,i)=>{i.d(t,{useCommentsScroll:()=>o.useCommentsScroll});var o=i(515593)},33802:(e,t,i)=>{i.d(t,{replaceHashtagsMentions:()=>o.replaceHashtagsMentions});var o=i(47112)},47112:(e,t,i)=>{i.d(t,{replaceHashtagsMentions:()=>p});var o=i(474848),r=i(279734),s=i(768355),n=i(70515),a=i(942981),d=i(627445),l=i(186093),c=i(319835),u=i(272428),h=i(83940);const p=(e,t)=>{const i=new s.ReactReplacer(e);return i.call(h.replaceFreeMention,(0,h.freeMentionReplacerReact)((({key:e,text:i,href:s})=>(0,o.jsx)(r.Link,{href:s,onClick:()=>{t?.({type:n.ClipDescriptionLinkTypes.LINK,value:s})},"data-testid":"link",children:i},e)))),i.call(a.replaceHyperLinks,(0,a.linksReplacerReact)((({key:e,text:i,...r})=>(0,o.jsx)(d.MemOrExternalLink,{onClick:()=>t?.({type:r.mentionId?n.ClipDescriptionLinkTypes.MENTION:n.ClipDescriptionLinkTypes.LINK,value:r.mentionId||r.href}),"data-testid":"link",...r,children:i},e)))),i.call(l.replaceMentions,(0,l.mentionReplaceReact)((({key:e,text:i,...r})=>(0,o.jsx)(d.MemLink,{onClick:()=>t?.({type:n.ClipDescriptionLinkTypes.MENTION,value:r.mentionId}),"data-testid":"mention",...r,children:i},e)))),i.call(c.replaceHashtags,((e,i,o)=>(0,u.hashtagReplaceReact)(e,i,o,(()=>t?.({type:n.ClipDescriptionLinkTypes.HASHTAG,value:i}))))),i.getComponent()}},104259:(e,t,i)=>{i.d(t,{getOwnerProfileUrl:()=>r.getOwnerProfileUrl,replaceHashtagsMentions:()=>s.replaceHashtagsMentions,useCommentsScroll:()=>o.useCommentsScroll});var o=i(83426),r=i(49435),s=i(33802)},49435:(e,t,i)=>{i.d(t,{getOwnerProfileUrl:()=>o});const o=e=>`/${e}`},776416:(e,t,i)=>{i.d(t,{AuthorSkeleton:()=>y,CatalogSkeleton:()=>E,ClipsPageSkeleton:()=>k,FeedSkeleton:()=>w,GridChallengeMenuSkeleton:()=>I,GridLayoutSkeleton:()=>f,GridSkeleton:()=>S});var o=i(474848),r=i(172656),s=i(303800),n=i(157643),a=i(591378),d=i(194528),l=i(441600),c=i(43e4),u=i(260546),h=i(55366),p=i(8520),m=i(604743),v=i(142648),g=i(794970),_=i(994832),C=i(75976);const y=()=>(0,o.jsxs)(r.Group,{children:[(0,o.jsx)(v.ClipsAuthorSkeleton,{}),(0,o.jsx)(s.Div,{children:(0,o.jsx)(n.Skeleton,{width:300})})]}),b=()=>(0,o.jsx)(s.Div,{children:(0,o.jsx)(n.Skeleton,{height:16,maxWidth:"30%"})}),I=()=>(0,o.jsx)(s.Div,{children:(0,o.jsx)(n.Skeleton,{height:182,maxWidth:"100%"})}),S=()=>(0,o.jsx)(a.Grid,{columns:_.GRID_COLUMNS,spacing:_.GRID_SPACING,children:(0,p.createArray)(3*_.GRID_COLUMNS).map((e=>(0,o.jsx)(a.Grid.Item,{children:(0,o.jsx)("div",{className:C.default.gridItem,children:(0,o.jsx)(n.Skeleton,{height:"100%"})})},e)))}),f=({isChallenge:e})=>(0,o.jsxs)(o.Fragment,{children:[e?(0,o.jsx)(I,{}):(0,o.jsx)(b,{}),(0,o.jsx)(s.Div,{children:(0,o.jsx)(S,{})})]}),w=({startOffset:e})=>(0,o.jsxs)("div",{children:[e&&(0,o.jsx)(d.Spacing,{size:e}),(0,o.jsx)("div",{className:C.default.feed,children:(0,o.jsxs)("div",{className:C.default.carousel,children:[(0,o.jsx)("div",{className:C.default.carouselItem,children:(0,o.jsx)(n.Skeleton,{height:"100%"})}),(0,o.jsx)(m.PageBlockOffsetSpacing,{}),(0,o.jsx)("div",{className:C.default.carouselItem,children:(0,o.jsx)(n.Skeleton,{height:"100%"})})]})})]}),E=({hasQuery:e=!1,isSectionPage:t=!1})=>{const i=(0,o.jsxs)(r.Group,{children:[(0,o.jsx)(g.HeaderSkeleton,{aside:!1}),(0,o.jsx)(g.ShortVideoGridSkeleton,{itemsCount:12,isClipPage:!0})]});return t?(0,o.jsxs)(r.Group,{children:[(0,o.jsx)(g.HeaderSkeleton,{aside:!1}),(0,p.createArray)(8).map((()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.AuthorItemSkeleton,{}),(0,o.jsx)(d.Spacing,{size:4})]})))]}):e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.Group,{children:[(0,o.jsx)(g.HeaderSkeleton,{}),(0,o.jsx)(g.AuthorItemSkeleton,{}),(0,o.jsx)(d.Spacing,{size:4}),(0,o.jsx)(g.AuthorItemSkeleton,{}),(0,o.jsx)(d.Spacing,{size:4}),(0,o.jsx)(g.AuthorItemSkeleton,{}),(0,o.jsx)(d.Spacing,{size:16})]}),i]}):i},k=()=>(0,o.jsxs)("div",{className:C.default.app,children:[(0,o.jsx)(m.PageBlockOffsetSpacing,{}),(0,o.jsxs)(l.TwoColumnLayout,{children:[(0,o.jsx)(l.TwoColumnLayout.Main,{role:"main",children:(0,o.jsx)(w,{})}),(0,o.jsxs)(l.TwoColumnLayout.Narrow,{children:[(0,o.jsx)(c.RightMenu,{items:(()=>{const e=e=>({type:"custom",id:e,content:(0,o.jsx)(s.Div,{mode:"horizontal",spacing:4,children:(0,o.jsx)(n.Skeleton,{width:"100%",height:36})})});return[e("1"),e("2"),e("3")]})()}),(0,o.jsx)(r.Group,{children:(0,o.jsx)(n.Skeleton,{height:36})}),(0,o.jsxs)(r.Group,{children:[(0,o.jsx)(u.SimpleCell,{before:(0,o.jsx)(h.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:40,height:40,circle:!0})}),subtitle:(0,o.jsx)(n.Skeleton,{width:200}),hasHover:!1,hasActive:!1,children:(0,o.jsx)(n.Skeleton,{width:320})}),(0,o.jsx)(n.Skeleton,{height:36})]}),(0,o.jsxs)(r.Group,{children:[(0,o.jsx)(n.Skeleton,{height:36}),(0,o.jsx)(n.Skeleton,{height:36})]})]})]})]})},994832:(e,t,i)=>{i.d(t,{FEEDS_NAMED:()=>n,GRID_CHALLENGE_FEEDS:()=>d,GRID_COLUMNS:()=>r,GRID_OWNER_FEEDS:()=>a,GRID_SPACING:()=>s,ITEM_RATIO:()=>o});const o=9/16,r=3,s=10,n={TOP:"top",SUBSCRIPTIONS:"subscriptions",OWNER_FEED:"ownerFeed",POSTPONED:"postponed",PLAYLIST:"playlist",COMPILATION:"compilation",HASHTAG:"hashtag",MUSIC:"music",EFFECT:"effect",PLACE:"place",SEARCH:"search"},a=(n.TOP,n.SUBSCRIPTIONS,n.TOP,[n.OWNER_FEED,n.POSTPONED]),d=[n.PLAYLIST,n.COMPILATION,n.HASHTAG,n.MUSIC,n.EFFECT,n.PLACE]},189649:(e,t,i)=>{i.d(t,{createLink:()=>s});var o=i(87848),r=i(348882);function s(e,t,i){return(0,r.createLink)(o.routesConfig,e,t,i)}},690993:(e,t,i)=>{i.d(t,{createLink:()=>o.createLink,parsePathParams:()=>r.parsePathParams});var o=i(189649),r=i(334409)},601663:(e,t,i)=>{function o(e){return Boolean("userId"in e&&e.userId)}function r(e){return Boolean("ownerId"in e&&e.ownerId)}function s(e){return function(e){return Boolean("groupId"in e&&e.groupId)}(e)||o(e)||r(e)}function n(e){return Boolean("videoId"in e&&e.videoId)&&r(e)}function a(e){return Boolean("compilationId"in e&&e.compilationId)}function d(e){return Boolean("hashtagId"in e&&e.hashtagId)}function l(e){return Boolean("effectId"in e&&e.effectId)&&r(e)}function c(e){return Boolean("musicId"in e&&e.musicId)&&r(e)}function u(e){return Boolean("placeId"in e&&e.placeId)}function h(e){return Boolean("playlistId"in e&&e.playlistId)&&r(e)}function p(e){return Boolean("screenName"in e&&e.screenName)}i.d(t,{isClipParams:()=>n,isCompilationParams:()=>a,isEffectParams:()=>l,isHashtagParams:()=>d,isMusicParams:()=>c,isOwnerParams:()=>r,isOwnerSource:()=>s,isPlaceParams:()=>u,isPlaylistParams:()=>h,isScreenNameParams:()=>p,isUserParams:()=>o})},334409:(e,t,i)=>{i.d(t,{parsePathParams:()=>o.parsePathParams});var o=i(566435)},123785:(e,t,i)=>{i.d(t,{parseClipId:()=>r});var o=i(873900);function r(e){return(0,o.getIdentityRawId)({id:parseInt(e.videoId),ownerId:parseInt(e.ownerId)})}},827906:(e,t,i)=>{function o(e){return e.compilationId}i.d(t,{parseCompilationId:()=>o})},545722:(e,t,i)=>{i.d(t,{parseEffectId:()=>r});var o=i(873900);function r(e){return(0,o.getIdentityRawId)({id:parseInt(e.effectId),ownerId:parseInt(e.ownerId)})}},124877:(e,t,i)=>{function o(e){return decodeURIComponent(e.hashtagId)}i.d(t,{parseHashtagId:()=>o})},372290:(e,t,i)=>{i.d(t,{parseMusicId:()=>r});var o=i(873900);function r(e){return(0,o.getIdentityRawId)({id:parseInt(e.musicId),ownerId:parseInt(e.ownerId)})}},948890:(e,t,i)=>{i.d(t,{parseOwnerId:()=>s});var o=i(601663),r=i(468073);function s(e){return(0,o.isOwnerParams)(e)?e.ownerId:(0,o.isUserParams)(e)?e.userId:r.Ranges.convertGroupIdToOwnerId(parseInt(e.groupId)).toString()}},566435:(e,t,i)=>{i.d(t,{parsePathParams:()=>p});var o=i(601663),r=i(948890),s=i(123785),n=i(827906),a=i(124877),d=i(545722),l=i(372290),c=i(996790),u=i(332105),h=i(803925);function p(e,t){const i=e.map((e=>[e,v(e,t)]));return Object.fromEntries(i)}const m={clipId:[o.isClipParams,s.parseClipId],ownerId:[o.isOwnerSource,r.parseOwnerId],compilationId:[o.isCompilationParams,n.parseCompilationId],hashtagId:[o.isHashtagParams,a.parseHashtagId],effectId:[o.isEffectParams,d.parseEffectId],musicId:[o.isMusicParams,l.parseMusicId],placeId:[o.isPlaceParams,c.parsePlaceId],playlistId:[o.isPlaylistParams,u.parsePlaylistId],screenName:[o.isScreenNameParams,h.parseScreenName]};function v(e,t){const[i,o]=m[e];return i(t)?o(t):void 0}},996790:(e,t,i)=>{function o(e){return e.placeId}i.d(t,{parsePlaceId:()=>o})},332105:(e,t,i)=>{i.d(t,{parsePlaylistId:()=>r});var o=i(873900);function r(e){return(0,o.getIdentityRawId)({id:parseInt(e.playlistId),ownerId:parseInt(e.ownerId)})}},803925:(e,t,i)=>{function o(e){return e.screenName}i.d(t,{parseScreenName:()=>o})},520266:(e,t,i)=>{i.d(t,{AppItemSkeleton:()=>I,AppSliderSkeleton:()=>S,AuthorItemSkeleton:()=>v,HeaderSkeleton:()=>f,OwnerItemSkeleton:()=>g,ProductGridSkeleton:()=>b,ShortVideoGridSkeleton:()=>C});var o=i(474848),r=i(276898),s=i(55366),n=i(157643),a=i(194528),d=i(220208),l=i(303800),c=i(591378),u=i(552292),h=i(557992),p=i(8520),m=i(289475);const v=()=>(0,o.jsx)(r.RichCell,{before:(0,o.jsx)(s.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:80,height:80,circle:!0})}),caption:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:2}),(0,o.jsx)(n.Skeleton,{width:96,height:12})]}),hasHover:!1,hasActive:!1,children:(0,o.jsx)(n.Skeleton,{width:192,height:18})}),g=()=>(0,o.jsx)(r.RichCell,{before:(0,o.jsx)(s.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:80,height:80,circle:!0})}),caption:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:2}),(0,o.jsx)(n.Skeleton,{width:96,height:12}),(0,o.jsx)(a.Spacing,{size:2}),(0,o.jsx)(n.Skeleton,{width:192,height:12})]}),after:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:12}),(0,o.jsx)(n.Skeleton,{width:134,height:28,borderRadius:8})]}),hasHover:!1,hasActive:!1,children:(0,o.jsx)(n.Skeleton,{width:192,height:18})}),_=({isClipPage:e})=>{const t=(0,m.partConfigEnabled)("search_all_clip_card_redesign_web_enabled")||e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.AspectRatio,{ratio:9/16,children:(0,o.jsx)("div",{children:(0,o.jsx)(n.Skeleton,{borderRadius:8,width:"100%",height:"100%"})})}),t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:10}),(0,o.jsx)(n.Skeleton,{width:140,height:12,borderRadius:8}),(0,o.jsx)(a.Spacing,{size:10}),(0,o.jsx)(n.Skeleton,{width:110,height:12,borderRadius:8})]})]})},C=({itemsCount:e=3,isClipPage:t=!1})=>(0,o.jsx)(l.Div,{children:(0,o.jsx)(c.Grid,{columns:3,spacing:10,children:(0,p.createArray)(e).map(((e,i)=>(0,o.jsx)(c.Grid.Item,{children:(0,o.jsx)(_,{isClipPage:t},i)},i)))})}),y=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.AspectRatio,{ratio:.9,children:(0,o.jsx)("div",{children:(0,o.jsx)(n.Skeleton,{borderRadius:8,width:"100%",height:"100%"})})}),(0,o.jsx)(a.Spacing,{size:8}),(0,o.jsx)(n.Skeleton,{width:96,height:12}),(0,o.jsx)(a.Spacing,{size:2}),(0,o.jsx)(n.Skeleton,{width:140,height:12}),(0,o.jsx)(a.Spacing,{size:2}),(0,o.jsx)(n.Skeleton,{width:140,height:12})]}),b=()=>(0,o.jsx)(l.Div,{children:(0,o.jsx)(c.Grid,{columns:3,spacing:10,children:(0,p.createArray)(3).map(((e,t)=>(0,o.jsx)(c.Grid.Item,{children:(0,o.jsx)(y,{},t)},t)))})}),I=()=>(0,o.jsx)(r.RichCell,{before:(0,o.jsx)(s.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:80,height:80,borderRadius:8})}),caption:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:2}),(0,o.jsx)(n.Skeleton,{width:96,height:12})]}),after:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:12}),(0,o.jsx)(n.Skeleton,{width:134,height:28,borderRadius:8})]}),hasHover:!1,hasActive:!1,children:(0,o.jsx)(n.Skeleton,{width:192,height:18})}),S=()=>(0,o.jsx)(l.Div,{children:(0,o.jsx)(c.Grid,{columns:7,spacing:14,children:(0,p.createArray)(7).map(((e,t)=>(0,o.jsxs)(c.Grid.Item,{children:[(0,o.jsx)(s.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{width:64,height:64})}),(0,o.jsx)(a.Spacing,{size:12}),(0,o.jsx)(n.Skeleton,{width:134,height:14,borderRadius:8})]},t)))})}),f=({aside:e=!0})=>(0,o.jsx)(u.HeaderLayout,{aside:e&&(0,o.jsx)(n.Skeleton,{width:100}),children:(0,o.jsx)(h.Header,{size:"large",children:(0,o.jsx)(n.Skeleton,{width:120})})})},794970:(e,t,i)=>{i.d(t,{AppItemSkeleton:()=>o.AppItemSkeleton,AuthorItemSkeleton:()=>o.AuthorItemSkeleton,HeaderSkeleton:()=>o.HeaderSkeleton,OwnerItemSkeleton:()=>o.OwnerItemSkeleton,ProductGridSkeleton:()=>o.ProductGridSkeleton,ShortVideoGridSkeleton:()=>o.ShortVideoGridSkeleton});var o=i(520266)},68572:(e,t,i)=>{i.d(t,{ActionButton:()=>u});var o=i(474848),r=i(454154),s=i(864175),n=i(456921),a=i(132028),d=i(599520),l=i(164250);const c=(0,n.observer)((function(){const{url:e,title:t,logClickOnActionButton:i}=(0,l.useActionButtonModel)(),{navigate:n}=(0,s.useNavigate)();return(0,d.checkIfInternal)(e)?(0,o.jsx)(r.Button,{mode:"secondary",size:"m","data-testid":"clips-action-button",onClick:()=>{i(),n(e)},stretched:!0,children:t}):(0,o.jsx)(r.Button,{mode:"secondary",size:"m","data-testid":"clips-action-button",target:"_blank",rel:"noopener",href:(0,d.wrapAway)(e,!0),onClick:i,stretched:!0,children:t})})),u=(0,a.createWidget)(l.ActionButtonProvider,c)},94400:(e,t,i)=>{i.d(t,{ActionButton:()=>o.ActionButton});var o=i(68572)},181637:(e,t,i)=>{i.d(t,{ActionButtonModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(782413);class a{get title(){return this.props.current.actionButton?.snippet?.open_title||""}get url(){return this.props.current.actionButton.url}constructor(e,t){this.props=e,this.shortVideoVideoAnalytics=t,this.logClickOnActionButton=()=>{this.props.current.activeClipId&&this.shortVideoVideoAnalytics.logClickOnActionButton({clipRawId:this.props.current.activeClipId,objectRawId:this.props.current.actionButton.id,url:this.props.current.actionButton.url,type:this.props.current.actionButton.type})},(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoVideoAnalytics?Object:n.ShortVideoVideoAnalytics])],a)},164250:(e,t,i)=>{i.d(t,{ActionButtonProvider:()=>s,useActionButtonModel:()=>n});var o=i(132028),r=i(181637);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ActionButtonModel)},417050:(e,t,i)=>{i.d(t,{CarouselItem:()=>P});var o=i(474848),r=i(425072),s=i(454154),n=i(783856),a=i(93016),d=i(700272),l=i(303800),c=i(107996),u=i(192678),h=i(296540),p=i(456921),m=i(132028),v=i(289475),g=i(348882),_=i(222790),C=i(178907),y=i(244850),b=i(110812),I=i(909617),S=i(897681),f=i(401896),w=i(78368),E=i(50322);const k=(0,p.observer)((function(){const{video:e,badges:t,props:i,playingFullScreenStats:p,playerStatus:m,statsLegacy:k,stats:P,videoStalled:A,setVideoStalled:L,restriction:x,descriptionExpanded:M,toggleDescription:O,isStatsServiceEnabled:T,isSplitCarouselItem:V,userEnv:F,videoActionUrl:j,sendVideoActionStat:R}=(0,E.useCarouselItemModel)(),{duration:D,setDuration:B,currentTime:N,setCurrentTime:U,setNewCurrentTime:G,newCurrentTime:H,seekHandler:W,seekEndHandler:z,clickHandler:$,previewStyle:Y}=(0,w.usePlayerSeekControl)(e?.data),[q,K]=(0,h.useState)(!1),X=(0,h.useCallback)((e=>k.trackEvents(e)),[k]),Q=m.isMuted||Boolean(e?.data.need_mute),J=m.isPlaying,Z=i.current.isActive,ee=Z&&J,te=ee?m.volume:0,{onStalledChanged:ie,onVideoCurQualityChanged:oe,onVideoDurationChanged:re,onVideoPositionChanged:se,onEnded:ne,onVideoFormatChanged:ae,onVideoBitrateChanged:de,onFirstBytes:le,onFirstFrame:ce}=(0,_.usePlayerStats)({isPlaying:J,isMuted:Q,video:e,statsRef:i.current.statsRef},X),{onStalledChanged:ue,onVideoCurQualityChanged:he,onDurationChanged:pe,onPositionChanged:me,onEnded:ve,onVideoFormatChanged:ge,onVideoBitrateChanged:_e,onFirstBytes:Ce,onFirstFrame:ye,onStarted:be,onPlaying:Ie,onPaused:Se,onMutedChanged:fe,onError:we}=(0,g.usePlayingStats)({stats:P,statsRef:i.current.statsRef,video:e}),Ee=(0,h.useCallback)((e=>{Z&&m.setPlaying(e)}),[Z]);(0,h.useEffect)((()=>{if(!Z)return;const e=C.AdvancedPIP.isAvailable()&&C.AdvancedPIP.isPlaying();m.setPlaying(!e)}),[Z]);const ke=(0,h.useCallback)((e=>{T?pe(e):re(e),B(e)}),[re,pe,B]),Pe=(0,h.useCallback)((t=>{T?me(t):se(t),i.current.onCurrentTimeChanged?.(t),(0,v.partConfigEnabled)("short_video_button_to_video")&&e?.data?.duration&&.7*e?.data.duration<=t&&K(!0),U(t),F.partConfigEnabled("clips_fix_timeline")&&G(null)}),[se,me,U]),Ae=(0,h.useCallback)((e=>{L(e),T?ue(e):ie(e)}),[ie,ue]),Le=()=>{T?ve():ne(),i.current?.onEnded&&i.current.onEnded()};if((0,h.useEffect)((()=>(T||(J?p.startTimespent():p.endTimespent()),()=>{!T&&p.endTimespent()})),[J]),!e?.owner)return null;const xe=(0,g.getClipCover)(e.data,i.current.itemSize),Me=Boolean(e.data.content_restricted)||e.data.restriction?.title,Oe=Boolean(e.data.restriction?.blur);if(F.partConfigEnabled("clips_add_seized_restrictions_web")&&(Me&&!Oe||Oe&&!x.isRestrictionDisabled(i.current.videoFullId)))return(0,o.jsx)(r.ClipRestricted,{...i.current.itemSize,cover:xe,title:e.data.restriction?.title,text:e.data.restriction?.text,icon:(0,g.getClipIcon)(e.data.restriction?.icon_name),"data-testid":`clips-restricted-${i.current.videoFullId}`,blurred:Oe,size:"l",action:Oe?(0,o.jsx)(s.Button,{size:"m",onClick:()=>x.disableRestriction(i.current.videoFullId),mode:"outline",appearance:"overlay","data-testid":"clips-carousel-placeholder-blur-button",children:e.data.restriction?.button?.title}):void 0});if(Boolean(e.data.content_restricted)&&e.data.restriction?.title)return V?(0,o.jsx)(u.ClipContainer,{...i.current.itemSize,"data-testid":"clips-feed-item",size:"large",after:(0,o.jsx)(n.Overlay,{centered:!0,children:(0,o.jsx)(b.ClipRestrictionPlaceholder,{title:e.data.restriction.title,text:e.data.restriction.text})})}):(0,o.jsx)(a.ClipContainer,{...i.current.itemSize,"data-testid":"clips-feed-item",size:"large",centerComponent:(0,o.jsx)(b.ClipRestrictionPlaceholder,{title:e.data.restriction.title,text:e.data.restriction.text})});const Te=(e.data.width&&e.data.height?e.data.width/e.data.height:9/16)>i.current.itemSize.ratio?"contain":i.current.itemSize.mode,Ve="clips"!==i.current.appearance,Fe=(0,v.partConfigEnabled)("short_video_button_to_video")&&"video"===i.current.appearance;return V?(0,o.jsx)(u.ClipContainer,{...i.current.itemSize,mode:Te,cover:xe,size:"large","data-testid":"clips-feed-item",video:T?(0,o.jsx)(g.ClipsPlayer,{loop:!0,muted:Q,volume:te,newCurrentTime:H,onStalledChanged:Ae,onVideoCurQualityChanged:he,onPlayingChanged:Ee,onPlaying:Ie,onPaused:Se,onMutedChanged:fe,onDurationChanged:ke,onCurrentTimeChanged:Pe,onEnded:Le,onFirstBytes:Ce,onFirstFrame:ye,onStarted:be,onVideoFormatChanged:ge,onVideoBitrateChanged:_e,onError:we,playing:ee,video:e.data,mode:Te,platform:"web"}):(0,o.jsx)(g.ClipsPlayer,{loop:!0,muted:Q,volume:te,newCurrentTime:H,onStalledChanged:Ae,onVideoCurQualityChanged:oe,onPlayingChanged:Ee,onDurationChanged:ke,onCurrentTimeChanged:Pe,onEnded:Le,onFirstBytes:le,onFirstFrame:ce,onVideoFormatChanged:ae,onVideoBitrateChanged:de,playing:ee,video:e.data,mode:Te,platform:"web"}),noHover:i.current.noHover,center:Z&&A&&(0,o.jsx)(d.Spinner,{size:"large"})||(0,o.jsx)(b.PlayButton,{focused:!A&&i.current.focused,onPlayChange:Ee,playing:ee}),onClick:()=>Ee(!ee),timeline:(0,o.jsx)(l.Div,{children:(0,o.jsx)(c.ClipTimeline,{size:"l",currentTime:N,duration:D,onSeek:W,onEndTouch:z,onClick:F.partConfigEnabled("clips_fix_timeline")?$:void 0,previewStyle:Y,"aria-label":""})}),gradient:i.current.gradient,after:i.current.afterComponent,children:i.current.contentComponent}):(0,o.jsx)(a.ClipContainer,{...i.current.itemSize,mode:Te,cover:xe,size:"large","data-testid":"clips-feed-item",videoComponent:T?(0,o.jsx)(g.ClipsPlayer,{loop:!0,muted:Q,volume:te,newCurrentTime:H,onStalledChanged:Ae,onVideoCurQualityChanged:he,onPlayingChanged:Ee,onPlaying:Ie,onPaused:Se,onMutedChanged:fe,onDurationChanged:ke,onCurrentTimeChanged:Pe,onEnded:Le,onFirstBytes:Ce,onFirstFrame:ye,onStarted:be,onVideoFormatChanged:ge,onVideoBitrateChanged:_e,onError:we,playing:ee,video:e.data,mode:Te,platform:"web"}):(0,o.jsx)(g.ClipsPlayer,{loop:!0,muted:Q,volume:te,newCurrentTime:H,onStalledChanged:Ae,onVideoCurQualityChanged:oe,onPlayingChanged:Ee,onDurationChanged:ke,onCurrentTimeChanged:Pe,onEnded:Le,onFirstBytes:le,onFirstFrame:ce,onVideoFormatChanged:ae,onVideoBitrateChanged:de,playing:ee,video:e.data,mode:Te,platform:"web"}),centerComponent:Z&&A&&(0,o.jsx)(d.Spinner,{size:"large"})||(0,o.jsx)(b.PlayButton,{focused:!A&&i.current.focused,onPlayChange:Ee,playing:ee}),onClick:()=>Ee(!ee),timeline:(0,o.jsx)(l.Div,{children:(0,o.jsx)(c.ClipTimeline,{size:"l",currentTime:N,duration:D,onSeek:W,onEndTouch:z,onClick:F.partConfigEnabled("clips_fix_timeline")?$:void 0,previewStyle:Y,"aria-label":""})}),badges:(0,o.jsx)(b.ClipBadges,{badges:t,video:e,disableUrl:Ve,afterComponent:(0,o.jsxs)(o.Fragment,{children:[Fe&&j&&(0,o.jsx)(b.ClipToVideoButton,{videoActionUrl:j,sendVideoActionStat:R,isActive:q}),!Fe&&(0,o.jsx)(b.ClipAudio,{collectSearchClick:i.current.collectSearchClick,video:e,disableUrl:Ve})]})}),authorElement:"clips"!==i.current.appearance&&(0,o.jsx)(I.ClipAuthor,{collectSearchClick:i.current.collectSearchClick,video:e,getOwnerProfileUrl:y.getOwnerProfileUrl}),description:"clips"!==i.current.appearance&&Boolean(e.data.description)?(0,o.jsx)(b.ClipDescription,{video:e,descriptionText:e.data.description,descriptionExpanded:M,formatDescription:"video"===i.current.appearance?f.replaceMentionsLinks:S.replaceMentionsLinks,onToggle:O}):void 0,expandOverlay:"clips"!==i.current.appearance&&M})})),P=(0,m.createWidget)(E.CarouselItemProvider,k)},980111:(e,t,i)=>{var o=i(474848),r=i(456921),s=i(478091),n=i(361121),a=i(839812),d=i(149333),l=i(599520),c=i(317216),u=i(314309),h=i(289475);(0,r.observer)((function({actionButton:e,appearance:t,currentVideoId:i,currentOwnerId:r}){const{getLang:p}=(0,d.useLangs)(),m="video"===t&&"video"===e?.type&&(0,h.partConfigEnabled)("short_video_attached_video");if(!m)return;const v=m?`/video${e?.id}`:e.url,g=m?p("video_standalone_clip_attached_video_title"):e?.snippet?.open_title,_=(0,l.checkIfInternal)(v);if(!v||!g)return;const C=_?{onClick:()=>{if((0,h.partConfigEnabled)("short_video_attached_video")&&"video"===e?.type){const{ownerId:t,itemId:o}=(0,n.splitRawId)(e?.id);t&&o&&i&&r&&u.videoActionButtonStatsCollector.logEvent({event_type:c.VideoActionButtonEventTypes.CLICK_TO_ACTION_BUTTON,object_owner_id:t,object_id:o,video_owner_id:r,video_id:i,object_url:v,screen:"clips"})}},href:v}:{target:"_blank",rel:"noopener",href:(0,l.wrapAway)(v,!0)};return(0,o.jsx)(a.ClipBadge,{before:m?(0,o.jsx)(s.Icon12Play,{}):void 0,"data-testid":"clips-action-button",...C,children:g})}))},937207:(e,t,i)=>{i(980111)},403793:(e,t,i)=>{i.d(t,{ClipAudio:()=>p});var o=i(474848),r=i(456921),s=i(538522),n=i(27745),a=i(839812),d=i(293116),l=i(724244),c=i(149333),u=i(89972),h=i(70515);const p=(0,r.observer)((function({video:e,disableUrl:t=!1,collectSearchClick:i}){const r=(0,c.useLangs)(),p=e.data.short_video_info?.audio,m=p?(0,s.joinRawId)({ownerId:p.owner_id,itemId:p.id}):void 0,v=!m||e.data.owner_id===p?.owner_id,g=p?.content_restricted,_=t||g||!m?void 0:(0,u.getClipsGridSoundUrl)(m),C=!m&&r.getLang("video_unmoderated_original_sound_tooltip")||(g||e.data.need_mute)&&r.getLang("video_clip_restriction_claim_short"),y=C?{text:C,hideDelay:0}:void 0,b=p?.artist||e.owner?.name,I=p?.title||r.getLang("video_original_sound"),S=p?.album?.thumb?.photo_34||e.owner?.data.photo_50;return(0,o.jsx)(a.ClipBadge,{before:v||g?(0,o.jsx)(n.Icon12MusicNote,{}):(0,o.jsx)(d.Image,{size:18,src:S}),href:_,onClick:_?()=>i?.(h.SearchClickActionMap.OPEN_ATTACHED_MUSIC_OUT):void 0,disabled:Boolean(g)||!m,tooltip:y,"data-testid":"clips-controls-audio-info",children:v?r.getLang("video_original_sound"):(0,o.jsxs)(o.Fragment,{children:[!g&&(0,o.jsxs)(o.Fragment,{children:[b,(0,o.jsx)(l.InterpunctSeparator,{spacing:4})]}),I]})})}))},509411:(e,t,i)=>{i.d(t,{ClipAudio:()=>o.ClipAudio});var o=i(403793)},331747:(e,t,i)=>{i.d(t,{ClipBadges:()=>b});var o=i(474848),r=i(456921),s=i(228002),n=i(839812),a=i(149333),d=i(725772),l=i(28201),c=i(157307),u=i(487376),h=i(760793),p=i(156006),m=i(478091),v=i(873900),g=i(805102),_=i(89972),C=i(289475),y=i(690993);const b=(0,r.observer)((function({badges:e,video:t,afterComponent:i,disableUrl:r=!1}){const b=(0,a.useLangs)(),{availableOnlyForOwner:I,marketItem:S,placeInfo:f,duet:w,playlists:E,compilations:k,masks:P,effects:A}=e;return(0,o.jsxs)(s.ClipBadgesLayout,{after:i,children:[I?(0,o.jsx)(s.ClipBadgesLayout.Item,{type:"privacy",children:(0,o.jsx)(n.ClipBadge,{before:(0,o.jsx)(d.Icon12Lock,{}),"data-testid":"clips-controls-privacy-badge",children:(0,C.partConfigEnabled)("clips_syncing_clips_with_posts_web")?b.getLang("video_clips_badge_privacy_archive"):b.getLang("video_clips_badge_privacy_only_me")})}):void 0,S&&(0,o.jsx)(s.ClipBadgesLayout.Item,{type:"market",children:(0,o.jsx)(n.ClipBadge,{before:(0,o.jsx)(l.Icon12Market,{}),href:r?void 0:(0,g.constructProductLink)({baseUrl:"market",ownerId:S.owner_id,itemId:S.id,seoSlug:S.seo_slug??"",ref:"clips",refScreen:"clips",adsLabel:S.ads_label}),"data-testid":"clips-controls-market-badge",children:b.getLang("video_clips_badge_market")})}),E.length?(0,o.jsx)(s.ClipBadgesLayout.Item,{label:b.getLang("video_clips_badge_playlists"),type:"playlists",icon:(0,o.jsx)(c.Icon12ListPlayOutline,{}),children:E.map((({id:e,owner_id:t,title:i})=>(0,o.jsx)(n.ClipBadge,{before:(0,o.jsx)(c.Icon12ListPlayOutline,{}),href:r?void 0:(0,y.createLink)("clips.clipsPlaylist",{playlistId:e,ownerId:t}),"data-testid":"clips-controls-playlist-badge",children:i},e)))}):void 0,k.length?(0,o.jsx)(s.ClipBadgesLayout.Item,{label:b.getLang("video_clips_badge_compilations"),type:"compilations",children:k.map((({id:e,name:t})=>(0,o.jsx)(n.ClipBadge,{href:e&&!r?(0,_.getCompilationUrl)(e):void 0,"data-testid":"clips-controls-compilation-badge",children:t},e)))}):void 0,f&&(0,o.jsx)(s.ClipBadgesLayout.Item,{type:"place",children:(0,o.jsx)(n.ClipBadge,{before:(0,o.jsx)(u.Icon12Place,{}),href:r?void 0:(0,_.getPlaceUrl)(f.id),"data-testid":"clips-controls-place-badge",children:f.title})}),P.length?(0,o.jsx)(s.ClipBadgesLayout.Item,{label:b.getLang("video_clips_badge_masks"),type:"masks",icon:(0,o.jsx)(h.Icon12Mask,{}),children:P.map((({owner_id:e,id:t,name:i})=>(0,o.jsx)(n.ClipBadge,{before:(0,o.jsx)(h.Icon12Mask,{}),href:t&&!r?(0,_.getEffectUrl)((0,v.getIdentityRawId)({ownerId:e,id:t})):void 0,"data-testid":"clips-controls-mask-badge",children:i},t)))}):void 0,A.length?(0,o.jsx)(s.ClipBadgesLayout.Item,{label:b.getLang("video_clips_badge_effects"),type:"effects",icon:(0,o.jsx)(p.Icon12Stars,{}),children:A.map((({owner_id:e,id:t,name:i})=>(0,o.jsx)(n.ClipBadge,{before:(0,o.jsx)(p.Icon12Stars,{}),href:t&&!r?(0,_.getEffectUrl)((0,v.getIdentityRawId)({ownerId:e,id:t})):void 0,"data-testid":"clips-controls-effect-badge",children:i},t)))}):void 0,w&&(0,o.jsx)(s.ClipBadgesLayout.Item,{type:"duet",children:(0,o.jsxs)(n.ClipBadge,{before:(0,o.jsx)(m.Icon12Play,{}),href:w.clip_id&&!r?(0,_.getPopupClipUrl)(w.clip_id):void 0,"data-testid":"clips-controls-duet-badge",children:[b.getLang("video_clips_duet")," ",w.owner_name_case_ins]})})]},t.rawId)}))},72211:(e,t,i)=>{i.d(t,{ClipBadges:()=>o.ClipBadges});var o=i(331747)},274209:(e,t,i)=>{i.d(t,{ClipDescription:()=>c});var o=i(474848),r=i(456921),s=i(220208),n=i(194528),a=i(93016),d=i(149333),l=i(621036);const c=(0,r.observer)((function({video:e,descriptionExpanded:t,formatDescription:i,onToggle:r,spacingTop:c}){const u=(0,d.useLangs)();return e.data.description||e?.data?.ord_info?(0,o.jsxs)(s.ColorSchemeProvider,{value:s.ColorScheme.DARK,children:[c&&(0,o.jsx)(n.Spacing,{size:c}),e?.data?.ord_info&&(0,o.jsx)(l.ClipOrdTitle,{video:e}),(0,o.jsx)(a.ClipContainer.Description,{expanded:t,onToggle:r,lines:2,expandLabel:u.getLang("video_clips_author_description_more"),collapseLabel:u.getLang("global_min"),children:i(e.data.description||"")})]}):null}))},877859:(e,t,i)=>{i.d(t,{ClipDescription:()=>o.ClipDescription,replaceMentionsLinks:()=>r.replaceMentionsLinks});var o=i(274209),r=i(897681)},897681:(e,t,i)=>{i.d(t,{replaceMentionsLinks:()=>o.replaceMentionsLinks});var o=i(625659)},625659:(e,t,i)=>{i.d(t,{replaceMentionsLinks:()=>h});var o=i(474848),r=i(279734),s=i(192678),n=i(768355),a=i(70515),d=i(942981),l=i(627445),c=i(186093),u=i(83940);const h=(e,t)=>{const i=new n.ReactReplacer(e);return i.call(u.replaceFreeMention,(0,u.freeMentionReplacerReact)((({key:e,text:i,href:n})=>(0,o.jsx)(s.ClipContainer.UnderlinedText,{children:(0,o.jsx)(r.Link,{href:n,mode:"contrast",onClick:()=>{t?.({type:a.ClipDescriptionLinkTypes.LINK,value:n})},"data-testid":"link",children:i},e)})))),i.call(d.replaceHyperLinks,(0,d.linksReplacerReact)((({key:e,text:i,...r})=>(0,o.jsx)(s.ClipContainer.UnderlinedText,{children:(0,o.jsx)(l.MemOrExternalLink,{mode:"contrast",onClick:()=>t?.({type:r.mentionId?a.ClipDescriptionLinkTypes.MENTION:a.ClipDescriptionLinkTypes.LINK,value:r.mentionId||r.href}),"data-testid":"link",...r,children:i},e)})))),i.call(c.replaceMentions,(0,c.mentionReplaceReact)((({key:e,text:i,href:r,...n})=>(0,o.jsx)(s.ClipContainer.UnderlinedText,{children:(0,o.jsx)(l.MemLink,{mode:"contrast",onClick:()=>t?.({type:a.ClipDescriptionLinkTypes.MENTION,value:n.mentionId}),href:r,"data-testid":"mention",...n,children:i},e)})))),i.getComponent()}},295153:(e,t,i)=>{i.d(t,{ClipOrdTitle:()=>d});var o=i(474848),r=i(285056),s=i(578392),n=i(149333),a=i(289475);const d=({video:e})=>{const{getLang:t}=(0,n.useLangs)();return e.data.ord_info?.moderated&&(0,a.partConfigEnabled)("clips_hide_ord_tooltip")?(0,o.jsx)(r.Headline,{weight:"2",inline:!0,children:e.data.ord_info.title}):(0,o.jsx)(s.TextTooltip,{appearance:"neutral",maxWidth:190,placement:"bottom",text:t("video_clip_ord_tooltip_text"),children:(0,o.jsx)(r.Headline,{weight:"2",inline:!0,children:e.data.ord_info?.title})})}},621036:(e,t,i)=>{i.d(t,{ClipOrdTitle:()=>o.ClipOrdTitle});var o=i(295153)},683993:(e,t,i)=>{i.d(t,{ClipRestrictionPlaceholder:()=>n});var o=i(474848),r=i(720836),s=i(98967);const n=({title:e,text:t})=>(0,o.jsx)(r.Placeholder,{icon:(0,o.jsx)(s.Icon56LockOutline,{}),header:e,children:e!==t&&t})},123795:(e,t,i)=>{i.d(t,{ClipRestrictionPlaceholder:()=>o.ClipRestrictionPlaceholder});var o=i(683993)},404785:(e,t,i)=>{i.d(t,{ClipToVideoButton:()=>l});var o=i(474848),r=i(456921),s=i(149333),n=i(15978),a=i(688830);const d={transitionDuration:"0.4s"},l=(0,r.observer)((function({videoActionUrl:e,sendVideoActionStat:t,isActive:i}){const{getLang:r}=(0,s.useLangs)(),l=i?{mode:"primary",appearance:"neutral"}:{mode:"secondary",appearance:"accent"};return(0,o.jsx)(n.AppearanceProvider,{value:"dark",children:(0,o.jsx)(a.ClipButton,{size:"l",...l,baseStyle:{...d},onClick:t,href:e,stretched:!0,"data-testid":"clips-action-button",children:r("video_standalone_clip_attached_video_title_button")})})}))},787913:(e,t,i)=>{i.d(t,{ClipToVideoButton:()=>o.ClipToVideoButton});var o=i(404785)},873331:(e,t,i)=>{i.d(t,{PlayButton:()=>c});var o=i(474848),r=i(202350),s=i(271036),n=i(357331),a=i(499979),d=i(296540),l=i(149333);const c=({onPlayChange:e,playing:t,focused:i})=>{const c=(0,l.useLangs)(),u=(0,d.useRef)(null);return(0,d.useEffect)((()=>{i&&u.current?.focus()}),[i]),(0,o.jsx)(r.RoundedGroup.Item,{mode:"overlay",children:(0,o.jsx)(s.IconButton,{getRootRef:u,size:48,label:t?c.getLang("me_convo_player_pause"):c.getLang("me_convo_player_play"),onClick:()=>e(!t),children:t?(0,o.jsx)(n.Icon36Pause,{}):(0,o.jsx)(a.Icon36Play,{})})})}},708719:(e,t,i)=>{i.d(t,{PlayButton:()=>o.PlayButton});var o=i(873331)},110812:(e,t,i)=>{i.d(t,{ClipAudio:()=>o.ClipAudio,ClipBadges:()=>r.ClipBadges,ClipDescription:()=>a.ClipDescription,ClipRestrictionPlaceholder:()=>s.ClipRestrictionPlaceholder,ClipToVideoButton:()=>d.ClipToVideoButton,PlayButton:()=>n.PlayButton,replaceMentionsLinks:()=>a.replaceMentionsLinks});var o=i(509411),r=i(72211),s=i(123795),n=i(708719),a=i(877859),d=(i(937207),i(787913))},78368:(e,t,i)=>{i.d(t,{usePlayerSeekControl:()=>o.usePlayerSeekControl});var o=i(436105)},436105:(e,t,i)=>{i.d(t,{usePlayerSeekControl:()=>s});var o=i(296540),r=i(595389);const s=e=>{const[t,i]=(0,o.useState)(0),[s,n]=(0,o.useState)(0),[a,d]=(0,o.useState)(0),[l,c]=(0,o.useState)(),u=(0,o.useRef)(null),h=(0,o.useCallback)((i=>{c(e?.timeline_thumbs&&t?(0,r.getTimelinePreview)(e.timeline_thumbs,i,t):void 0)}),[t]),p=(0,o.useCallback)((e=>{u.current=e,h(e)}),[t]),m=(0,o.useCallback)((e=>{d(e),h(e)}),[t]),v=(0,o.useCallback)((()=>{null!==u.current&&(d(u.current),u.current=null)}),[]);return{duration:t,setDuration:i,currentTime:s,setCurrentTime:n,newCurrentTime:a,setNewCurrentTime:d,seekHandler:p,clickHandler:m,seekEndHandler:v,previewStyle:l}}},595389:(e,t,i)=>{i.d(t,{getTimelinePreview:()=>r});const o=90;function r(e,t,i){const{count_total:r,count_per_image:s,count_per_row:n,frame_width:a,frame_height:d,links:l}=e;if(!(r&&s&&n&&a&&d&&l))return;const c=Math.floor(t/i*r),u=n,h=s/n,p=Math.floor(c/s),m=Math.floor(c%s/u),v=o/a,g=c%s%u*v*-a,_=m*v*-d,C=l[p];return{width:`${o}px`,height:o*d/a+"px",backgroundImage:`url(${C})`,backgroundPosition:`${g}px ${_}px`,backgroundSize:`${u*a*v}px ${h*d*v}px`}}},87963:(e,t,i)=>{i.d(t,{CarouselItem:()=>o.CarouselItem,ClipAudio:()=>r.ClipAudio,ClipAuthor:()=>s.ClipAuthor,ClipBadges:()=>r.ClipBadges,ClipDescription:()=>r.ClipDescription,replaceMentionsLinks:()=>r.replaceMentionsLinks});var o=i(417050),r=i(110812),s=i(909617)},681688:(e,t,i)=>{i.d(t,{CarouselItemModel:()=>C});var o=i(331635),r=i(327813),s=i(361121),n=i(132028),a=i(24516),d=i(292202),l=i(632520),c=i(914492),u=i(964867),h=i(509739),p=i(681280),m=i(348882),v=i(222790),g=i(314309),_=i(317216);class C{get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get badges(){return this.shortVideoBadgesProvider.get(this.props.current.videoFullId)}get isStatsServiceEnabled(){return this.userEnv.partConfigEnabled("clips_stats_service")}get isSplitCarouselItem(){return this.userEnv.partConfigEnabled("clips_web_split_carousel_item")||Boolean(this.props.current.useNewCarouselItem)}get videoActionUrl(){const e=this.video?.data?.action_button?.id;return e?`/video${e}`:null}constructor(e,t,i,o,n,a,d,l,c,u,h){this.props=e,this.statsLegacy=t,this.stats=i,this.playerStatus=o,this.shortVideoVideosProvider=n,this.shortVideoOwnersProvider=a,this.shortVideoBadgesProvider=d,this.shortVideoDeleteService=l,this.playingFullScreenStats=c,this.restriction=u,this.userEnv=h,this.videoStalled=!0,this.setVideoStalled=e=>{this.videoStalled=e},this.descriptionExpanded=!1,this.toggleDescription=()=>{this.descriptionExpanded=!this.descriptionExpanded},this.sendVideoActionStat=()=>{const{ownerId:e,itemId:t}=(0,s.splitRawId)(this.video?.data?.action_button?.id||"");this.videoActionUrl&&this.video?.data.id&&this.video?.data.owner_id&&g.videoActionButtonStatsCollector.logEvent({event_type:_.VideoActionButtonEventTypes.CLICK_TO_ACTION_BUTTON,object_owner_id:e,object_id:t,video_owner_id:this.video?.data.owner_id,video_id:this.video?.data.id,object_url:this.videoActionUrl||"",screen:"clips"})},(0,r.makeAutoObservable)(this)}}C=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===v.ClipsStatsService?Object:v.ClipsStatsService,void 0===d.ShortVideoStatsService?Object:d.ShortVideoStatsService,void 0===m.ClipsPlayerStatusModel?Object:m.ClipsPlayerStatusModel,void 0===l.ShortVideoVideosProvider?Object:l.ShortVideoVideosProvider,void 0===c.ShortVideoOwnersProvider?Object:c.ShortVideoOwnersProvider,void 0===u.ShortVideoBadgesProvider?Object:u.ShortVideoBadgesProvider,void 0===h.ShortVideoDeleteService?Object:h.ShortVideoDeleteService,void 0===v.ClipsPlayingFullScreenStatsModel?Object:v.ClipsPlayingFullScreenStatsModel,void 0===p.ShortVideoRestrictions?Object:p.ShortVideoRestrictions,void 0===a.UserEnv?Object:a.UserEnv])],C)},50322:(e,t,i)=>{i.d(t,{CarouselItemProvider:()=>s,useCarouselItemModel:()=>n});var o=i(132028),r=i(681688);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CarouselItemModel)},119790:(e,t,i)=>{i.d(t,{ClipAuthor:()=>I});var o=i(474848),r=i(456921),s=i(15978),n=i(279734),a=i(724648),d=i(612196),l=i(285056),c=i(546642),u=i(723723),h=i(454154),p=i(132028),m=i(363046),v=i(149333),g=i(949634),_=i(239226),C=i(70515),y=i(31580);const b=(0,r.observer)((function(){const e=(0,v.useLangs)(),{props:t,isSubscribed:i,isPending:r,toggleSubscribeOwner:p}=(0,g.useClipAuthorModel)(),{video:b,getOwnerProfileUrl:I,collectSearchClick:S}=t.current,{owner:f}=b;return f?Boolean(b.data?.short_video_info?.co_owners)?(0,o.jsx)(_.ClipCoOwners,{video:b,isSubscribed:i,isPending:r,toggleSubscribeOwner:p,getOwnerProfileUrl:I,handleAuthorClick:()=>S?.(C.SearchClickActionMap.OPEN_OWNER_OUT)}):(0,o.jsx)(s.AppearanceProvider,{value:"dark",children:(0,o.jsx)(n.Link,{onClick:()=>S?.(C.SearchClickActionMap.OPEN_OWNER_OUT),href:I(f.screenName??""),...y.allowLinkOnclickWebAttrs,mode:"primary",noUnderline:!0,children:(0,o.jsxs)(a.Flex,{gap:"m",align:"center",children:[(0,o.jsx)(d.Avatar,{src:f.data?.photo_50??"",size:40,alt:f.name??""}),(0,o.jsx)(l.Headline,{level:"1",children:(0,o.jsx)(c.EllipsisText,{maxWidth:150,className:(0,u.getColorClass)("color_text_contrast"),children:f.name})}),(0,o.jsx)(h.Button,{mode:"primary",appearance:"accent",disabled:r,loading:r,onClick:e=>{(0,m.cancelEvent)(e),p(f?.ownerId)},size:"s",children:i?e.getLang("video_view_subscribed_msg"):e.getLang("global_public_join")})]})})}):null})),I=(0,p.createWidget)(g.ClipAuthorProvider,b)},988939:(e,t,i)=>{i.d(t,{ClipAuthor:()=>o.ClipAuthor});var o=i(119790)},372984:(e,t,i)=>{i.d(t,{ClipAuthorModel:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(914492),a=i(961189),d=i(70515);class l{get isSubscribed(){return this.props.current.video?.owner?.isSubscribed||!1}get isPending(){return this.props.current.video?.owner?.isPendingSubscription||!1}constructor(e,t,i){this.props=e,this.shortVideoOwnersProvider=t,this.shortVideoAuthorAnalytics=i,this.toggleSubscribeOwner=e=>{if(!e)return;const t=this.shortVideoOwnersProvider.get(e);if(!t)return;const i=this.props.current.video.data.track_code,o=this.props.current.video.data.id??0,{collectSearchClick:r}=this.props.current;r?.(t.isSubscribed?d.SearchClickActionMap.UNSUBSCRIBE_OUT:d.SearchClickActionMap.SUBSCRIBE_OUT),t.isSubscribed?(t.unsubscribe(),this.shortVideoAuthorAnalytics.logClickToSubscriptionButton({ownerId:e,videoId:o,subtype:"unsubscribe",place:"viewer",trackCode:i})):(t.subscribe(),this.shortVideoAuthorAnalytics.logClickToSubscriptionButton({ownerId:e,videoId:o,subtype:"subscribe",place:"viewer",trackCode:i}))},(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoOwnersProvider?Object:n.ShortVideoOwnersProvider,void 0===a.ShortVideoAuthorAnalytics?Object:a.ShortVideoAuthorAnalytics])],l)},949634:(e,t,i)=>{i.d(t,{ClipAuthorProvider:()=>s,useClipAuthorModel:()=>n});var o=i(132028),r=i(372984);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipAuthorModel)},371092:(e,t,i)=>{i.d(t,{ClipCoOwners:()=>_});var o=i(474848),r=i(456921),s=i(149333),n=i(132028),a=i(15978),d=i(507852),l=i(724648),c=i(655676),u=i(285056),h=i(546642),p=i(723723),m=i(340385),v=i(858375);const g=(0,r.observer)((function(){const{props:e,ownerFirst:t,ownerSecond:i}=(0,m.useClipCoOwnersModel)(),r=(0,s.useLangs)();return t&&i?(0,o.jsx)(a.AppearanceProvider,{value:"dark",children:(0,o.jsx)(d.DropdownActionSheet,{placement:"top",trigger:"hover",content:(0,o.jsx)(v.ClipCoOwnersDropdownContent,{ownerFirst:t,ownerSecond:i,getOwnerProfileUrl:e.current.getOwnerProfileUrl,toggleSubscribeOwner:e.current.toggleSubscribeOwner,handleAuthorClick:e.current.handleAuthorClick}),children:(0,o.jsxs)(l.Flex,{gap:"m",align:"center",children:[(0,o.jsxs)(c.AvatarStack,{size:32,direction:"bottom",hasHover:!1,hasActive:!1,stroke:!0,children:[(0,o.jsx)(c.AvatarStack.Item,{src:t.data.photo_50,alt:t.name}),(0,o.jsx)(c.AvatarStack.Item,{src:i.data.photo_50,alt:i.name})]}),(0,o.jsx)(u.Headline,{level:"1",children:(0,o.jsxs)(h.EllipsisText,{width:150,className:(0,p.getColorClass)("color_text_contrast"),children:[t.name,r.langReplace(r.getLang("video_clip_co_owners_and"),{name:i.name})]})})]})})}):null})),_=(0,n.createWidget)(m.ClipCoOwnersProvider,g)},650420:(e,t,i)=>{i.d(t,{ClipCoOwnersDropdownContent:()=>_});var o=i(474848),r=i(456921),s=i(507852),n=i(271036),a=i(723723),d=i(279734),l=i(724648),c=i(612196),u=i(546642),h=i(303913),p=i(44291),m=i(149333),v=i(363046),g=i(31580);const _=(0,r.observer)((function({ownerFirst:e,ownerSecond:t,getOwnerProfileUrl:i,toggleSubscribeOwner:r,handleAuthorClick:_}){const C=(0,m.useLangs)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.DropdownActionSheet.Item,{after:(0,o.jsx)(n.IconButton,{label:C.getLang("video_view_subscribed_msg"),size:24,disabled:e.isPendingSubscription,onClick:t=>{(0,v.cancelEvent)(t),r(e.ownerId)},children:e.isSubscribed?(0,o.jsx)(h.Icon24Done,{className:(0,a.getColorClass)("color_icon_contrast")}):(0,o.jsx)(p.Icon28AddSquareOutline,{className:(0,a.getColorClass)("color_icon_contrast")})}),children:(0,o.jsx)(d.Link,{onClick:_,...g.allowLinkOnclickWebAttrs,href:i(e.screenName),mode:"primary",noUnderline:!0,children:(0,o.jsxs)(l.Flex,{gap:"m",align:"center",children:[(0,o.jsx)(c.Avatar,{src:e.data.photo_50??"",size:20,alt:e.name}),(0,o.jsx)(u.EllipsisText,{maxWidth:250,children:e.name})]})})}),(0,o.jsx)(s.DropdownActionSheet.Item,{after:(0,o.jsx)(n.IconButton,{label:C.getLang("video_view_subscribed_msg"),size:24,disabled:t.isPendingSubscription,onClick:e=>{(0,v.cancelEvent)(e),r(t.ownerId)},children:t.isSubscribed?(0,o.jsx)(h.Icon24Done,{className:(0,a.getColorClass)("color_icon_contrast")}):(0,o.jsx)(p.Icon28AddSquareOutline,{className:(0,a.getColorClass)("color_icon_contrast")})}),children:(0,o.jsx)(d.Link,{onClick:_,...g.allowLinkOnclickWebAttrs,href:i(t.screenName),mode:"primary",noUnderline:!0,children:(0,o.jsxs)(l.Flex,{gap:"m",align:"center",children:[(0,o.jsx)(c.Avatar,{src:t.data.photo_50??"",size:20,alt:t.name}),(0,o.jsx)(u.EllipsisText,{maxWidth:250,children:t.name})]})})})]})}))},417250:(e,t,i)=>{i.d(t,{ClipCoOwnersDropdownContent:()=>o.ClipCoOwnersDropdownContent});var o=i(650420)},858375:(e,t,i)=>{i.d(t,{ClipCoOwnersDropdownContent:()=>o.ClipCoOwnersDropdownContent});var o=i(417250)},239226:(e,t,i)=>{i.d(t,{ClipCoOwners:()=>o.ClipCoOwners});var o=i(371092)},88628:(e,t,i)=>{i.d(t,{ClipCoOwnersModel:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(24516),a=i(914492),d=i(715799);class l{get ownerFirst(){return this.props.current.video.owner}get ownerSecond(){return this.coOwners.getCoOwners(this.props.current.video.rawId)[0]}async[s.init]({video:e}){return this.coOwners.fetchCoOwnersInfo(e.rawId)}constructor(e,t,i,o){this.props=e,this.shortVideoOwnersProvider=t,this.userEnv=i,this.coOwners=o,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===a.ShortVideoOwnersProvider?Object:a.ShortVideoOwnersProvider,void 0===n.UserEnv?Object:n.UserEnv,void 0===d.ShortVideoCoOwnerService?Object:d.ShortVideoCoOwnerService])],l)},340385:(e,t,i)=>{i.d(t,{ClipCoOwnersProvider:()=>s,useClipCoOwnersModel:()=>n});var o=i(132028),r=i(88628);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipCoOwnersModel)},909617:(e,t,i)=>{i.d(t,{ClipAuthor:()=>o.ClipAuthor});var o=i(988939);i(239226)},210622:(e,t,i)=>{i.d(t,{ClipsClipActionButtonWidget:()=>l});var o=i(474848),r=i(132028),s=i(456921),n=i(303800),a=i(547817),d=i(39051);const l=(0,r.createWidget)(d.ClipsClipActionButtonProvider,(0,s.observer)((function(){const{clipId:e,props:t,video:i}=(0,d.useClipsClipActionButtonModel)(),{paddingTop:r,paddingBottom:s}=t.current;return i&&i.data.action_button?(0,o.jsx)(n.Div,{paddingTop:r,paddingBottom:s,children:(0,o.jsx)(a.ActionButton,{actionButton:i.data.action_button,activeClipId:e})}):null})))},766485:(e,t,i)=>{i.d(t,{ClipsClipActionButtonWidget:()=>o.ClipsClipActionButtonWidget});var o=i(210622)},89983:(e,t,i)=>{i.d(t,{ClipsClipActionButtonModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(632520);class a{get clipId(){return this.props.current.clipId}get video(){return this.videosProvider.get(this.clipId)}constructor(e,t){this.props=e,this.videosProvider=t,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider])],a)},39051:(e,t,i)=>{i.d(t,{ClipsClipActionButtonProvider:()=>s,useClipsClipActionButtonModel:()=>n});var o=i(132028),r=i(89983);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsClipActionButtonModel)},728378:(e,t,i)=>{i.d(t,{ClipsClipAuthorWidget:()=>m});var o=i(474848),r=i(260546),s=i(612196),n=i(454154),a=i(456921),d=i(132028),l=i(896412),c=i(142648),u=i(690993),h=i(456773),p=i(11146);const m=(0,d.createWidget)(p.ClipsClipAuthorProvider,(0,a.observer)((function(){const{props:e,coOwners:t,isCoOwnersPending:i,isCoOwnersTitleKitEnabled:a,lang:d,video:m,handleCoOwnersAvatarClick:v,handleCoOwnersMoreClick:g,handleAuthorClick:_,handleSubscribe:C,handleUnsubscribe:y}=(0,p.useClipsClipAuthorModel)(),{avatarSize:b}=e.current,I=m?.owner;return m&&I&&!i?t.length&&I?(0,o.jsx)(h.CoOwners,{coOwners:t,mainAuthor:I,onAvatarClick:v,onMoreClick:g,handleAuthorClick:_,isCoOwnersTitleKitEnabled:a}):(0,o.jsx)(r.SimpleCell,{before:(0,o.jsx)(s.Avatar,{size:b,src:I.data.photo_100??"","data-testid":"clips-author-avatar"}),subtitle:(0,o.jsx)(c.SubscribersCount,{count:I.followersCount}),after:I.canSubscribe&&!I.isAdmin&&(I.isSubscribed?(0,o.jsx)(n.Button,{mode:"tertiary",appearance:"neutral",disabled:I.isPendingSubscription,loading:I.isPendingSubscription,"data-testid":"clips-author-unsubscribe-button",onClick:e=>{(0,l.cancelEvent)(e),C()},children:d.getLang("video_view_subscribed_msg")}):(0,o.jsx)(n.Button,{mode:"tertiary",appearance:"accent",disabled:I.isPendingSubscription,loading:I.isPendingSubscription,"data-testid":"clips-author-subscribe-button",onClick:e=>{(0,l.cancelEvent)(e),y()},children:d.getLang("global_public_join")})),"data-testid":"clips-author-cell-block",href:(0,u.createLink)("clips.clipsOwnerScreenName",{screenName:I.screenName}),onClick:_,children:(0,o.jsx)(c.AuthorName,{name:I.name,isVerified:Boolean(I.data.verified)})}):(0,o.jsx)(c.ClipsAuthorSkeleton,{})})))},539288:(e,t,i)=>{i.d(t,{CoOwners:()=>_});var o=i(474848),r=i(303800),s=i(260546),n=i(655676),a=i(563504),d=i(285056),l=i(279734),c=i(412888),u=i(344356),h=i(296540),p=i(149333),m=i(31580),v=i(104259),g=i(762216);const _=({coOwners:e,mainAuthor:t,onAvatarClick:i,onMoreClick:_,handleAuthorClick:C,isCoOwnersTitleKitEnabled:y})=>{const b=t,I=e[0],[S,f]=(0,h.useState)("full"),w=(0,h.useRef)(null),E=(0,p.useLangs)();return(0,h.useEffect)((()=>{if(!b||!I)return;const{current:t}=w;t&&(t.scrollWidth>t.offsetWidth||e.length>1?f("compact"):t.scrollWidth<t.offsetWidth&&f("full"))}),[w.current,e.length]),b&&I?(0,o.jsx)(r.Div,{mode:"vertical",paddingTop:4,paddingBottom:4,children:(0,o.jsx)(s.SimpleCell,{before:(0,o.jsxs)(n.AvatarStack,{onClick:i,size:32,direction:"bottom",hasHover:!1,hasActive:!1,stroke:!0,children:[(0,o.jsx)(n.AvatarStack.Item,{src:b.data.photo_50,alt:b.name}),(0,o.jsx)(n.AvatarStack.Item,{src:I.data.photo_50,alt:I.name})]}),"data-testid":"clips-co-author-cell-block",children:y?(0,o.jsx)(a.ClipCoOwnerTitle,{mainCoOwner:{name:b.name,href:(0,v.getOwnerProfileUrl)(b.screenName??""),onClick:C},secondCoOwner:{name:I.name,href:(0,v.getOwnerProfileUrl)(I.screenName??""),onClick:C},coOwnersCount:e.length+1,onClickMore:_,textMore:E.numeric(e.length,E.getLang("video_clip_co_owners_more_count_new",!0)),textAndOwner:E.langReplace(E.getLang("video_clip_co_owners_and_name"),{name:I.name})}):(0,o.jsxs)(d.Headline,{level:"2",weight:"2",getRootRef:w,className:g.default.wrapper,children:[(0,o.jsx)(l.Link,{href:(0,v.getOwnerProfileUrl)(b.screenName??""),onClick:C,...m.allowLinkOnclickWebAttrs,mode:"primary",children:(0,o.jsx)(c.TextClamp,{lines:1,className:g.default.authorLink,children:b.name})}),"full"===S?(0,o.jsx)(l.Link,{href:(0,v.getOwnerProfileUrl)(I.screenName??""),mode:"primary",onClick:C,...m.allowLinkOnclickWebAttrs,className:g.default.coAuthorLink,children:E.langReplace(E.getLang("video_clip_co_owners_and"),{name:I.name})}):(0,o.jsx)(u.Interpolate,{values:{link:(0,o.jsx)(l.Link,{onClick:_,mode:"primary",className:g.default.coAuthorLink})},children:E.numeric(e.length,E.getLang("video_clip_co_owners_more_count_new",!0))})]})})}):null}},401252:(e,t,i)=>{i.d(t,{CoOwners:()=>o.CoOwners});var o=i(539288)},456773:(e,t,i)=>{i.d(t,{CoOwners:()=>o.CoOwners});var o=i(401252)},582640:(e,t,i)=>{i.d(t,{ClipsClipAuthorWidget:()=>o.ClipsClipAuthorWidget});var o=i(728378)},905663:(e,t,i)=>{i.d(t,{ClipsClipAuthorModel:()=>C});var o=i(331635),r=i(327813),s=i(132028),n=i(468073),a=i(603025),d=i(695368),l=i(715799),c=i(961189),u=i(632520),h=i(24516),p=i(712600),m=i(670252),v=i(955060),g=i(70515),_=i(348882);class C{[s.init](){this.coOwnersService.fetchCoOwnersInfo(this.activeClipId)}[s.update](){this.coOwnersService.fetchCoOwnersInfo(this.activeClipId)}get isCoOwnersTitleKitEnabled(){return this.userEnv.partConfigEnabled("clips_replace_co_owner_title")}get activeClipId(){return this.props.current.activeClipId}get video(){return this.videosProvider.get(this.activeClipId)}get owner(){return this.video?.owner}get coOwners(){return this.coOwnersService.getCoOwners(this.activeClipId)}get isCoOwnersPending(){return this.coOwnersService.isPending(this.activeClipId)}constructor(e,t,i,o,s,l,c,u,h){this.props=e,this.coOwnersService=t,this.userEnv=i,this.lang=o,this.shortVideoAuthorAnalytics=s,this.videosProvider=l,this.snackbar=c,this.errorLogger=u,this.statsService=h,this.handleAuthorClick=()=>{this.statsService.collectSearchClick(g.SearchClickActionMap.OPEN_OWNER_OUT)},this.handleSubscribe=()=>{this.owner?.unsubscribe(),this.statsService.collectSearchClick(g.SearchClickActionMap.UNSUBSCRIBE_OUT),this.logClickToSubscriptionButton(g.EventClipSubscribeItemSubType.UNSUBSCRIBE)},this.handleUnsubscribe=()=>{this.ownerSubscribe(this.props.current.onUserBlackListError),this.statsService.collectSearchClick(g.SearchClickActionMap.SUBSCRIBE_OUT),this.logClickToSubscriptionButton(g.EventClipSubscribeItemSubType.SUBSCRIBE)},this.handleCoOwnersAvatarClick=()=>{this.logClickOnCoOwners(),this.props.current.onCoOwnersAvatarClick()},this.handleCoOwnersMoreClick=()=>{this.props.current.onCoOwnersMoreClick()},this.logClickToSubscriptionButton=e=>{const t=this.video?.data.id,i=this.video?.owner?.ownerId,o=this.video?.data.track_code;i&&t&&this.shortVideoAuthorAnalytics.logClickToSubscriptionButton({ownerId:i,videoId:t,subtype:e,place:g.ClipSubscribeLinkTypes.VIEWER,trackCode:o})},this.logClickOnCoOwners=()=>{const e=this.video?.data.id,t=this.video?.owner?.ownerId;t&&e&&this.shortVideoAuthorAnalytics.logClickToCoowners({ownerId:t,videoId:e})},this.ownerSubscribe=async e=>{if(this.owner)try{await this.owner.subscribe()}catch(t){if(n.Ranges.isUserId(this.owner.ownerId)&&(0,a.isApiError)(t)&&t.error.error_code===d.API_ERROR_FRIENDS_ADD_ENEMY)return void e();const i=this.userEnv.partConfigEnabled("video_channel_rename")?this.lang.getLang("video_clips_channel_subscribe_error_snackbar"):this.lang.getLang("video_clips_owner_subscribe_error_snackbar");this.snackbar.show({type:"error",text:i}),this.errorLogger.log(t)}},(0,r.makeAutoObservable)(this)}}C=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===l.ShortVideoCoOwnerService?Object:l.ShortVideoCoOwnerService,void 0===h.UserEnv?Object:h.UserEnv,void 0===p.Langs?Object:p.Langs,void 0===c.ShortVideoAuthorAnalytics?Object:c.ShortVideoAuthorAnalytics,void 0===u.ShortVideoVideosProvider?Object:u.ShortVideoVideosProvider,void 0===m.Snackbar?Object:m.Snackbar,void 0===v.ErrorLogger?Object:v.ErrorLogger,void 0===_.ClipsPlayerSearchStatsService?Object:_.ClipsPlayerSearchStatsService])],C)},11146:(e,t,i)=>{i.d(t,{ClipsClipAuthorProvider:()=>s,useClipsClipAuthorModel:()=>n});var o=i(132028),r=i(905663);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsClipAuthorModel)},523618:(e,t,i)=>{i.d(t,{ClipsClipDescriptionWidget:()=>l});var o=i(474848),r=i(132028),s=i(456921),n=i(303800),a=i(142648),d=i(220213);const l=(0,r.createWidget)(d.ClipsClipDescriptionProvider,(0,s.observer)((function(){const{props:e,video:t,clipId:i,isDescriptionExpanded:r,setExpandDescription:s,isMoveOrdLabel:l,logClickOnLink:c}=(0,d.useClipsClipDescriptionModel)(),{paddingTop:u,paddingBottom:h,maxHeight:p,maskHeight:m,maxOrdTitleWidth:v}=e.current;return t&&t.data?(0,o.jsx)(n.Div,{mode:"vertical",spacing:0,paddingTop:u,paddingBottom:h,"data-testid":"clips-author-description-block",children:(0,o.jsx)(a.ClipsShowMoreDescription,{ordTitleNode:t.data.ord_info&&!l?(0,o.jsx)(a.ClipsOrdTitle,{ordInfo:t.data.ord_info,maxWidth:v}):void 0,text:t.data.description||"",onLinkClick:c,isExpanded:r,expand:s,maxHeight:p,maskHeight:m},i)}):null})))},205031:(e,t,i)=>{i.d(t,{ClipsClipDescriptionWidget:()=>o.ClipsClipDescriptionWidget});var o=i(523618)},363779:(e,t,i)=>{i.d(t,{ClipsClipDescriptionModel:()=>u});var o=i(331635),r=i(327813),s=i(132028),n=i(632520),a=i(961189),d=i(24516),l=i(70515),c=i(348882);class u{[s.update](){this.setExpandDescription(!1)}get clipId(){return this.props.current.clipId}get video(){return this.videosProvider.get(this.clipId)}get isMoveOrdLabel(){const e=this.video;return!!e&&((0,c.isOzonProgram)(e)&&this.userEnv.partConfigEnabled("clips_move_ord_info_web"))}constructor(e,t,i,o,s){this.props=e,this.videosProvider=t,this.shortVideoAuthorAnalytics=i,this.statsService=o,this.userEnv=s,this.isDescriptionExpanded=!1,this.logClickOnLink=e=>{const t=this.video?.data.id,i=this.video?.owner?.ownerId,o=this.video?.data.track_code;i&&t&&(this.shortVideoAuthorAnalytics.logClickToDescription({ownerId:i,videoId:t,objectType:e.type,objectValue:e.value,trackCode:o}),this.statsService.collectSearchClick(l.SearchClickActionMap.OPEN_HASHTAG_OUT))},this.setExpandDescription=e=>{this.isDescriptionExpanded=e,e&&this.logClickOnDescriptionExpand()},this.logClickOnDescriptionExpand=()=>{const e=this.video?.data.id,t=this.video?.owner?.ownerId,i=this.video?.data.track_code;t&&e&&this.shortVideoAuthorAnalytics.logClickToExpandDescription({ownerId:t,videoId:e,trackCode:i})},(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider,void 0===a.ShortVideoAuthorAnalytics?Object:a.ShortVideoAuthorAnalytics,void 0===c.ClipsPlayerSearchStatsService?Object:c.ClipsPlayerSearchStatsService,void 0===d.UserEnv?Object:d.UserEnv])],u)},220213:(e,t,i)=>{i.d(t,{ClipsClipDescriptionProvider:()=>s,useClipsClipDescriptionModel:()=>n});var o=i(132028),r=i(363779);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsClipDescriptionModel)},965662:(e,t,i)=>{i.d(t,{ClipsClipMetaWidget:()=>c});var o=i(474848),r=i(132028),s=i(456921),n=i(303800),a=i(578392),d=i(142648),l=i(588804);const c=(0,r.createWidget)(l.ClipsClipMetaProvider,(0,s.observer)((function(){const{props:e,video:t}=(0,l.useClipsClipMetaModel)(),{paddingTop:i,paddingBottom:r,tooltipMaxWidth:s}=e.current;return t&&t.data.views&&t.data.date?(0,o.jsx)(n.Div,{paddingTop:i,paddingBottom:r,children:(0,o.jsx)(a.TextTooltip,{"data-testid":"clips-views-date-tooltip",appearance:"neutral",placement:"top",maxWidth:s,description:(0,o.jsxs)(d.PublishMeta,{type:"tooltip",children:[(0,o.jsx)(d.ViewsCount,{count:t.data.views,mode:"full"}),(0,o.jsx)(d.PublishDate,{date:t.data.date,mode:"full"})]}),children:(0,o.jsxs)(d.PublishMeta,{type:"description",children:[(0,o.jsx)(d.ViewsCount,{count:t.data.views,mode:"compact"}),(0,o.jsx)(d.PublishDate,{date:t.data.date,mode:"compact"})]})})}):null})))},152186:(e,t,i)=>{i.d(t,{ClipsClipMetaWidget:()=>o.ClipsClipMetaWidget});var o=i(965662)},990243:(e,t,i)=>{i.d(t,{ClipsClipMetaModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(632520);class a{get clipId(){return this.props.current.clipId}get video(){return this.videosProvider.get(this.clipId)}constructor(e,t){this.props=e,this.videosProvider=t,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider])],a)},588804:(e,t,i)=>{i.d(t,{ClipsClipMetaProvider:()=>s,useClipsClipMetaModel:()=>n});var o=i(132028),r=i(990243);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsClipMetaModel)},521568:(e,t,i)=>{i.d(t,{ClipsFeedCommentWidget:()=>h});var o=i(474848),r=i(456921),s=i(132028),n=i(578392),a=i(202350),d=i(723723),l=i(271036),c=i(383267),u=i(24100);const h=(0,s.createWidget)(u.ClipsFeedCommentModelProvider,(0,r.observer)((function(){const{commentsCountText:e,onClick:t,hintText:i}=(0,u.useClipsFeedCommentModel)();return(0,o.jsx)(n.TextTooltip,{description:i,placement:"right-start",offsetByCrossAxis:8,arrowPadding:12,children:(0,o.jsx)(a.RoundedGroup.Item,{mode:"border",appearance:"default",bottom:(0,o.jsx)("div",{"data-testid":"clips-controls-comments-count",className:(0,d.getColorClass)("color_icon_secondary"),children:e}),children:(0,o.jsx)(l.IconButton,{size:52,className:(0,d.getColorClass)("color_icon_secondary"),label:i,onClick:t,"data-testid":"clips-controls-comments-button",children:(0,o.jsx)(c.Icon28CommentOutline,{})})})})})))},430298:(e,t,i)=>{i.d(t,{ClipsFeedCommentWidget:()=>o.ClipsFeedCommentWidget});var o=i(521568)},677233:(e,t,i)=>{i.d(t,{ClipsFeedCommentModel:()=>u});var o=i(331635),r=i(327813),s=i(712600),n=i(632520),a=i(132028),d=i(908671),l=i(348882),c=i(70515);class u{get video(){return this.shortVideoVideosProvider.get(this.props.current.clipId)}get commentsCount(){return this.video?.data.comments||0}get commentsCountText(){return(0,d.formatCount)(this.commentsCount)}get hintText(){return this.langs.getLang("video_clips_comment")}constructor(e,t,i,o){this.props=e,this.shortVideoVideosProvider=t,this.statsService=i,this.langs=o,this.onClick=()=>{this.statsService.collectSearchClick(c.SearchClickActionMap.OPEN_COMMENTS_OUT),this.props.current.onClick()},(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([a.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.Props?Object:a.Props,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider,void 0===l.ClipsPlayerSearchStatsService?Object:l.ClipsPlayerSearchStatsService,void 0===s.Langs?Object:s.Langs])],u)},24100:(e,t,i)=>{i.d(t,{ClipsFeedCommentModelProvider:()=>s,useClipsFeedCommentModel:()=>n});var o=i(132028),r=i(677233);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedCommentModel)},370824:(e,t,i)=>{i.d(t,{ClipsFeedDislikeWidget:()=>m});var o=i(474848),r=i(456921),s=i(132028),n=i(544129),a=i(222870),d=i(149333),l=i(578392),c=i(202350),u=i(271036),h=i(723723),p=i(414438);const m=(0,s.createWidget)(p.ClipsFeedDislikeModelProvider,(0,r.observer)((function(){const{isDislikeAvailable:e,toggleDislike:t,isNotInterested:i,pending:r}=(0,p.useClipsFeedDislikeModel)(),s=(0,d.useLangs)();return e?(0,o.jsx)(l.TextTooltip,{description:s.getLang("video_clips_dislike"),placement:"right",children:(0,o.jsx)(c.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(u.IconButton,{size:52,className:(0,h.getColorClass)("color_icon_secondary"),label:s.getLang("video_clips_not_interested"),onClick:t,"data-testid":"clips-controls-dislike-button",disabled:r,children:i?(0,o.jsx)(n.Icon28ThumbsDown,{}):(0,o.jsx)(a.Icon28ThumbsDownOutline,{})})})}):null})))},870236:(e,t,i)=>{i.d(t,{ClipsFeedDislikeWidget:()=>o.ClipsFeedDislikeWidget});var o=i(370824)},651213:(e,t,i)=>{i.d(t,{ClipsFeedDislikeModel:()=>p});var o=i(331635),r=i(327813),s=i(132028),n=i(905683),a=i(632520),d=i(955060),l=i(670252),c=i(712600),u=i(70515),h=i(348882);class p{get clipId(){return this.props.current.clipId}get isNotInterested(){return this.shortVideoLikeService.isNotInterested(this.clipId)}get isDislikeAvailable(){return!this.currentUserIsVideoOwner&&this.clipCanBeDisliked}get pending(){return this.shortVideoLikeService.isPending(this.clipId)}get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipCanBeDisliked(){return Boolean(this.video?.data.can_dislike)}get currentUserIsVideoOwner(){return Boolean(this.video?.owner?.isAdmin)}constructor(e,t,i,o,s,n,a){this.props=e,this.shortVideoLikeService=t,this.statsService=i,this.shortVideoVideosProvider=o,this.errorLogger=s,this.snackbar=n,this.langs=a,this.toggleDislike=async()=>{try{await this.shortVideoLikeService.toggleNotInterested(this.clipId)&&this.isNotInterested&&(this.statsService.collectSearchClick(u.SearchClickActionMap.DISLIKE_OUT),this.props.current.onChange?.(this.isNotInterested),this.snackbar.show({type:"ok",text:this.langs.getLang("video_clips_after_dislike_snackbar"),duration:3e3}))}catch(e){this.errorLogger.log(e)}},(0,r.makeAutoObservable)(this)}}p=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoLikeService?Object:n.ShortVideoLikeService,void 0===h.ClipsPlayerSearchStatsService?Object:h.ClipsPlayerSearchStatsService,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===d.ErrorLogger?Object:d.ErrorLogger,void 0===l.Snackbar?Object:l.Snackbar,void 0===c.Langs?Object:c.Langs])],p)},414438:(e,t,i)=>{i.d(t,{ClipsFeedDislikeModelProvider:()=>s,useClipsFeedDislikeModel:()=>n});var o=i(132028),r=i(651213);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedDislikeModel)},437382:(e,t,i)=>{i.d(t,{ClipsFeedLikeWidget:()=>v});var o=i(474848),r=i(456921),s=i(132028),n=i(509548),a=i(840303),d=i(149333),l=i(578392),c=i(202350),u=i(723723),h=i(271036),p=i(908671),m=i(667400);const v=(0,s.createWidget)(m.ClipsFeedLikeModelProvider,(0,r.observer)((function(){const{likesCount:e,toggleLike:t,userLikes:i,pending:r}=(0,m.useClipsFeedLikeModel)(),s=(0,d.useLangs)();return(0,o.jsx)(l.TextTooltip,{description:s.getLang("video_clips_like"),placement:"right-start",offsetByCrossAxis:8,arrowPadding:12,children:(0,o.jsx)(c.RoundedGroup.Item,{mode:"border",appearance:i?"negative":"default",bottom:(0,o.jsx)("div",{"data-testid":"clips-controls-like-count",className:i?void 0:(0,u.getColorClass)("color_icon_secondary"),children:(0,p.formatCount)(e)}),children:(0,o.jsx)(h.IconButton,{size:52,className:(0,u.getColorClass)("color_icon_secondary"),disabled:r,label:s.getLang("video_clips_like"),onClick:t,"data-testid":"clips-controls-like-button",children:i?(0,o.jsx)(n.Icon28LikeFillRed,{}):(0,o.jsx)(a.Icon28LikeOutline,{})})})})})))},410494:(e,t,i)=>{i.d(t,{ClipsFeedLikeWidget:()=>o.ClipsFeedLikeWidget});var o=i(437382)},495847:(e,t,i)=>{i.d(t,{ClipsFeedLikeModel:()=>c});var o=i(331635),r=i(327813),s=i(132028),n=i(905683),a=i(632520),d=i(70515),l=i(348882);class c{get clipId(){return this.props.current.clipId}get likes(){return this.shortVideoLikeService.getLikes(this.clipId)}get userLikes(){return this.likes?.userLikes??!1}get likesCount(){return this.likes?.count||0}get pending(){return this.shortVideoLikeService.isPending(this.clipId)}get video(){return this.shortVideoVideosProvider.get(this.clipId)}constructor(e,t,i,o){this.props=e,this.shortVideoLikeService=t,this.statsService=i,this.shortVideoVideosProvider=o,this.toggleLike=async()=>{const e=this.userLikes;this.statsService.collectSearchClick(e?d.SearchClickActionMap.UNLIKE_OUT:d.SearchClickActionMap.LIKE_OUT,this.video?.data.track_code),await this.shortVideoLikeService.toggleLike(this.clipId),this.props.current.onChange?.(!e)},(0,r.makeAutoObservable)(this)}}c=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoLikeService?Object:n.ShortVideoLikeService,void 0===l.ClipsPlayerSearchStatsService?Object:l.ClipsPlayerSearchStatsService,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider])],c)},667400:(e,t,i)=>{i.d(t,{ClipsFeedLikeModelProvider:()=>s,useClipsFeedLikeModel:()=>n});var o=i(132028),r=i(495847);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedLikeModel)},519333:(e,t,i)=>{i.d(t,{ClipsFeedMoreCopyLinkWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(485749),d=i(548930);const l=(0,s.createWidget)(d.ClipsFeedMoreCopyLinkProvider,(0,r.observer)((function(){const{handleCopyClipUrl:e,copyLinkText:t}=(0,d.useClipsFeedMoreCopyLink)();return(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:e,before:(0,o.jsx)(a.Icon20CopyOutline,{}),"data-testid":"clips-controls-more-actions-copy-link-item",children:t})})))},641960:(e,t,i)=>{i.d(t,{ClipsFeedMoreCopyLinkWidget:()=>o.ClipsFeedMoreCopyLinkWidget});var o=i(519333)},487280:(e,t,i)=>{i.d(t,{ClipsFeedMoreCopyLinkModel:()=>p});var o=i(331635),r=i(327813),s=i(132028),n=i(670252),a=i(712600),d=i(888584),l=i(8520),c=i(632520),u=i(70515),h=i(348882);class p{get copyLinkText(){return this.langs.getLang("video_copy_video_link")}getSharedClipFullUrl(e){return`https://${this.vkHost.getHostName()}/clip${e}`}get clipId(){return this.props.current.clipId}get video(){return this.shortVideoVideosProvider.get(this.clipId)}constructor(e,t,i,o,s,n){this.props=e,this.snackbar=t,this.statsService=i,this.langs=o,this.vkHost=s,this.shortVideoVideosProvider=n,this.handleCopyClipUrl=async()=>{this.statsService.collectSearchClick(u.SearchClickActionMap.COPY_LINK_OUT,this.video?.data.track_code),await(0,l.copyTextToClipboard)(this.getSharedClipFullUrl(this.clipId)),this.snackbar.show({type:"ok",text:this.langs.getLang("video_clip_copied_to_clipboard")})},(0,r.makeAutoObservable)(this)}}p=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.Snackbar?Object:n.Snackbar,void 0===h.ClipsPlayerSearchStatsService?Object:h.ClipsPlayerSearchStatsService,void 0===a.Langs?Object:a.Langs,void 0===d.VkHost?Object:d.VkHost,void 0===c.ShortVideoVideosProvider?Object:c.ShortVideoVideosProvider])],p)},548930:(e,t,i)=>{i.d(t,{ClipsFeedMoreCopyLinkProvider:()=>s,useClipsFeedMoreCopyLink:()=>n});var o=i(132028),r=i(487280);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreCopyLinkModel)},944345:(e,t,i)=>{i.d(t,{ClipsFeedMoreDeleteWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(490639),d=i(37744);const l=(0,s.createWidget)(d.ClipsFeedMoreDeleteProvider,(0,r.observer)((function(){const{handleDeleteClip:e,deleteText:t,isVideoOwner:i}=(0,d.useClipsFeedMoreDelete)();return i?(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:e,before:(0,o.jsx)(a.Icon20DeleteOutline,{}),"data-testid":"clips-controls-more-actions-delete-link-item",children:t}):null})))},227782:(e,t,i)=>{i.d(t,{ClipsFeedMoreDeleteWidget:()=>o.ClipsFeedMoreDeleteWidget});var o=i(944345)},200855:(e,t,i)=>{i.d(t,{ClipsFeedMoreDeleteModel:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(712600),a=i(632520);class d{get isVideoOwner(){return Boolean(this.video?.owner?.isAdmin)}get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipId(){return this.props.current.clipId}get deleteText(){return this.langs.getLang("global_delete")}constructor(e,t,i){this.props=e,this.langs=t,this.shortVideoVideosProvider=i,this.handleDeleteClip=()=>{this.props.current.onClick?.(this.clipId)},(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.Langs?Object:n.Langs,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider])],d)},37744:(e,t,i)=>{i.d(t,{ClipsFeedMoreDeleteProvider:()=>s,useClipsFeedMoreDelete:()=>n});var o=i(132028),r=i(200855);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreDeleteModel)},991741:(e,t,i)=>{i.d(t,{ClipsFeedMoreDownloadWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(289150),d=i(567343);const l=(0,s.createWidget)(d.ClipsFeedMoreDownloadProvider,(0,r.observer)((function(){const{handleDownloadClip:e,downloadText:t,canDownload:i}=(0,d.useClipsFeedMoreDownload)();return i?(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:e,before:(0,o.jsx)(a.Icon20DownloadOutline,{}),"data-testid":"clips-controls-more-actions-download-item",children:t}):null})))},425753:(e,t,i)=>{i.d(t,{ClipsFeedMoreDownloadWidget:()=>o.ClipsFeedMoreDownloadWidget});var o=i(991741)},135652:(e,t,i)=>{i.d(t,{ClipsFeedMoreDownloadModel:()=>v});var o=i(331635),r=i(327813),s=i(768035),n=i(132028),a=i(632520),d=i(961189),l=i(712600),c=i(413206),u=i(955060),h=i(670252),p=i(70515),m=i(348882);class v{get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipId(){return this.props.current.clipId}get canDownload(){return Boolean(this.video?.data.can_download)}get downloadText(){return this.langs.getLang("video_download_video_from_modal")}constructor(e,t,i,o,n,a,d,l){this.props=e,this.langs=t,this.shortVideoVideosProvider=i,this.statsService=o,this.shortVideoApi=n,this.errorLogger=a,this.snackbar=d,this.shortVideoAuthorAnalytics=l,this.handleDownloadClip=async()=>{const{ownerId:e,id:t}=(0,s.parseRawId)(this.clipId),i=this.video?.data.track_code;this.statsService.collectSearchClick(p.SearchClickActionMap.DOWNLOAD_OUT,i),this.shortVideoAuthorAnalytics.logClickToDownloadButton({ownerId:e,videoId:t,downloadQuality:m.Q_1080P,downloadState:"started",trackCode:i}),this.props.current.onDownload?.(this.clipId);try{const{download_url:i}=await this.shortVideoApi.getDownloadUrl({owner_id:e,video_id:t,quality:m.Q_1080P});window.open(i)}catch(e){this.errorLogger.log(e),this.snackbar.show({type:"error",text:this.langs.getLang("video_clip_download_failed"),duration:3e3})}},(0,r.makeAutoObservable)(this)}}v=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===l.Langs?Object:l.Langs,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===m.ClipsPlayerSearchStatsService?Object:m.ClipsPlayerSearchStatsService,void 0===c.ShortVideoApi?Object:c.ShortVideoApi,void 0===u.ErrorLogger?Object:u.ErrorLogger,void 0===h.Snackbar?Object:h.Snackbar,void 0===d.ShortVideoAuthorAnalytics?Object:d.ShortVideoAuthorAnalytics])],v)},567343:(e,t,i)=>{i.d(t,{ClipsFeedMoreDownloadProvider:()=>s,useClipsFeedMoreDownload:()=>n});var o=i(132028),r=i(135652);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreDownloadModel)},484129:(e,t,i)=>{i.d(t,{ClipsFeedMoreEditWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(829713),d=i(807431);const l=(0,s.createWidget)(d.ClipsFeedMoreEditProvider,(0,r.observer)((function(){const{userCanEditClip:e,handleEditClip:t,editText:i}=(0,d.useClipsFeedMoreEdit)();return e?(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:t,before:(0,o.jsx)(a.Icon20WriteOutline,{}),"data-testid":"clips-controls-more-actions-edit-link-item",children:i}):null})))},784145:(e,t,i)=>{i.d(t,{ClipsFeedMoreEditWidget:()=>o.ClipsFeedMoreEditWidget});var o=i(484129)},650064:(e,t,i)=>{i.d(t,{ClipsFeedMoreEditModel:()=>p});var o=i(331635),r=i(327813),s=i(768035),n=i(132028),a=i(110343),d=i(632520),l=i(712600),c=i(24516),u=i(631112),h=i(547817);class p{get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipId(){return this.props.current.clipId}get isVideoOwner(){return Boolean(this.video?.owner?.isAdmin)}get userCanEditClip(){return Boolean(this.video?.data.can_edit)&&this.isVideoOwner}get editText(){return this.langs.getLang("global_edit")}async reloadClip(){const e=this.clipId,t=this.shortVideoVideosProvider.get(e);await this.shortVideoVideosProvider.fetch({videos:`${e}`,fields:a.SHORT_VIDEO_FETCH_OWNER_FIELDS.join(","),extended:1});const i=this.shortVideoVideosProvider.get(e);i&&t&&this.props.current.onDone&&this.props.current.onDone(i,t)}constructor(e,t,i,o){this.props=e,this.langs=t,this.shortVideoVideosProvider=i,this.userEnv=o,this.handleEditClip=()=>{const{ownerId:e,id:t}=(0,s.parseRawId)(this.clipId);this.userEnv.partConfigEnabled("clips_syncing_clips_with_posts_web")?(0,h.initEditClipModal)(this.clipId,(()=>{this.reloadClip()})):(0,u.showBox)("al_video.php?act=edit_box",{vid:t,oid:e,is_short_video:1},{params:{onHide:()=>{this.reloadClip()}},containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css",window.jsc("web/video.js"),"video.css",window.jsc("web/video_upload.js"),"video_edit.css",window.jsc("web/upload.js"),"video_showcase.css"]})},(0,r.makeAutoObservable)(this)}}p=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===l.Langs?Object:l.Langs,void 0===d.ShortVideoVideosProvider?Object:d.ShortVideoVideosProvider,void 0===c.UserEnv?Object:c.UserEnv])],p)},807431:(e,t,i)=>{i.d(t,{ClipsFeedMoreEditProvider:()=>s,useClipsFeedMoreEdit:()=>n});var o=i(132028),r=i(650064);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreEditModel)},282485:(e,t,i)=>{i.d(t,{ClipsFeedMoreEridWidget:()=>c});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(739483),d=i(485749),l=i(827197);const c=(0,s.createWidget)(l.ClipsFeedMoreEridProvider,(0,r.observer)((function(){const{adsUrl:e,adsErId:t,handleCopyErId:i,eridText:r}=(0,l.useClipsFeedMoreErid)();return Boolean(t)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.DropdownActionSheet.Item,{href:e,target:"_blank",before:(0,o.jsx)(a.Icon20LinkCircleOutline,{}),"data-testid":"clips-controls-more-actions-ord-item",children:r}),(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:i,before:(0,o.jsx)(d.Icon20CopyOutline,{}),"data-testid":"clips-controls-more-actions-erid-item",children:`ERID: ${t}`})]}):null})))},954383:(e,t,i)=>{i.d(t,{ClipsFeedMoreEridWidget:()=>o.ClipsFeedMoreEridWidget});var o=i(282485)},492144:(e,t,i)=>{i.d(t,{ClipsFeedMoreEridModel:()=>c});var o=i(331635),r=i(327813),s=i(132028),n=i(632520),a=i(8520),d=i(712600),l=i(670252);class c{get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipId(){return this.props.current.clipId}get eridText(){return this.langs.getLang("video_clip_ord_advertiser_info")}get adsUrl(){return this.video?.data.ord_info?.advertisers[0]?.url||this.video?.data.ads_info?.advertiser_info_url}get adsErId(){return this.video?.data.ord_info?.advertisers[0]?.er_id||this.video?.data.ads_info?.ad_marker}constructor(e,t,i,o){this.props=e,this.langs=t,this.shortVideoVideosProvider=i,this.snackbar=o,this.handleCopyErId=async()=>{this.adsErId&&(await(0,a.copyTextToClipboard)(this.adsErId),this.snackbar.show({type:"ok",text:this.langs.getLang("video_clip_ord_copied_to_clipboard")}))},(0,r.makeAutoObservable)(this)}}c=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===d.Langs?Object:d.Langs,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider,void 0===l.Snackbar?Object:l.Snackbar])],c)},827197:(e,t,i)=>{i.d(t,{ClipsFeedMoreEridProvider:()=>s,useClipsFeedMoreErid:()=>n});var o=i(132028),r=i(492144);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreEridModel)},61045:(e,t,i)=>{i.d(t,{ClipsFeedMoreOrdLabelWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(285056),d=i(644128);const l=(0,s.createWidget)(d.ClipsFeedMoreOrdLabelProvider,(0,r.observer)((function(){const{ordText:e,isOrdLabel:t}=(0,d.useClipsFeedMoreOrdLabel)();return t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.DropdownActionSheet.Item,{disabled:!0,"data-testid":"clips-controls-more-actions-ord-label",children:(0,o.jsx)(a.Subhead,{children:e})}),(0,o.jsx)(n.DropdownActionSheet.Separator,{})]}):null})))},355766:(e,t,i)=>{i.d(t,{ClipsFeedMoreOrdLabelWidget:()=>o.ClipsFeedMoreOrdLabelWidget});var o=i(61045)},923564:(e,t,i)=>{i.d(t,{ClipsFeedMoreOrdLabelModel:()=>c});var o=i(331635),r=i(327813),s=i(132028),n=i(632520),a=i(712600),d=i(24516),l=i(667984);class c{get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipId(){return this.props.current.clipId}get ordText(){return this.langs.getLang("video_clips_more_ord_title")}get isOrdLabel(){const e=this.video;return!!e&&((0,l.isOzonProgram)(e)&&this.userEnv.partConfigEnabled("clips_move_ord_info_web"))}constructor(e,t,i,o){this.props=e,this.langs=t,this.shortVideoVideosProvider=i,this.userEnv=o,(0,r.makeAutoObservable)(this)}}c=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===a.Langs?Object:a.Langs,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider,void 0===d.UserEnv?Object:d.UserEnv])],c)},644128:(e,t,i)=>{i.d(t,{ClipsFeedMoreOrdLabelProvider:()=>s,useClipsFeedMoreOrdLabel:()=>n});var o=i(132028),r=i(923564);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreOrdLabelModel)},438173:(e,t,i)=>{i.d(t,{ClipsFeedMoreReportWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(405816),d=i(498453);const l=(0,s.createWidget)(d.ClipsFeedMoreReportProvider,(0,r.observer)((function(){const{handleReportClip:e,reportText:t,isVideoOwner:i}=(0,d.useClipsFeedMoreReport)();return i?null:(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:e,before:(0,o.jsx)(a.Icon20ReportOutline,{}),"data-testid":"clips-controls-more-actions-report-item",children:t})})))},196423:(e,t,i)=>{i.d(t,{ClipsFeedMoreReportWidget:()=>o.ClipsFeedMoreReportWidget});var o=i(438173)},308443:(e,t,i)=>{i.d(t,{ClipsFeedMoreReportModel:()=>c});var o=i(331635),r=i(327813),s=i(768035),n=i(132028),a=i(712600),d=i(632520),l=i(450846);class c{get isVideoOwner(){return Boolean(this.video?.owner?.isAdmin)}get video(){return this.shortVideoVideosProvider.get(this.clipId)}get clipId(){return this.props.current.clipId}get reportText(){return this.langs.getLang("global_report_spam")}constructor(e,t,i){this.props=e,this.langs=t,this.shortVideoVideosProvider=i,this.handleReportClip=()=>{const{ownerId:e,id:t}=(0,s.parseRawId)(this.clipId);(0,l.showReportForm)("video",e,t),this.props.current.onClick?.(this.clipId)},(0,r.makeAutoObservable)(this)}}c=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===a.Langs?Object:a.Langs,void 0===d.ShortVideoVideosProvider?Object:d.ShortVideoVideosProvider])],c)},498453:(e,t,i)=>{i.d(t,{ClipsFeedMoreReportProvider:()=>s,useClipsFeedMoreReport:()=>n});var o=i(132028),r=i(308443);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreReportModel)},482061:(e,t,i)=>{i.d(t,{ClipsFeedMoreShareWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(507852),a=i(223173),d=i(936370);const l=(0,s.createWidget)(d.ClipsFeedMoreShareProvider,(0,r.observer)((function(){const{handleShareClip:e,shareText:t}=(0,d.useClipsFeedMoreShare)();return(0,o.jsx)(n.DropdownActionSheet.Item,{onClick:e,before:(0,o.jsx)(a.Icon20ShareOutline,{}),"data-testid":"clips-controls-more-actions-share-item",children:t})})))},389080:(e,t,i)=>{i.d(t,{ClipsFeedMoreShareWidget:()=>o.ClipsFeedMoreShareWidget});var o=i(482061)},392052:(e,t,i)=>{i.d(t,{ClipsFeedMoreShareModel:()=>c});var o=i(331635),r=i(327813),s=i(132028),n=i(712600),a=i(632520),d=i(348882),l=i(70515);class c{get clipId(){return this.props.current.clipId}get video(){return this.shortVideoVideosProvider.get(this.clipId)}get shareText(){return this.langs.getLang("global_share")}constructor(e,t,i,o){this.props=e,this.langs=t,this.statsService=i,this.shortVideoVideosProvider=o,this.handleShareClip=()=>{this.statsService.collectSearchClick(l.SearchClickActionMap.SHARE_OUT,this.video?.data.track_code),this.props.current.onShare?.(this.clipId)},(0,r.makeAutoObservable)(this)}}c=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.Langs?Object:n.Langs,void 0===d.ClipsPlayerSearchStatsService?Object:d.ClipsPlayerSearchStatsService,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider])],c)},936370:(e,t,i)=>{i.d(t,{ClipsFeedMoreShareProvider:()=>s,useClipsFeedMoreShare:()=>n});var o=i(132028),r=i(392052);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedMoreShareModel)},13768:(e,t,i)=>{i.d(t,{ClipsFeedShareWidget:()=>p});var o=i(474848),r=i(456921),s=i(132028),n=i(709781),a=i(149333),d=i(578392),l=i(202350),c=i(723723),u=i(271036),h=i(116314);const p=(0,s.createWidget)(h.ClipsFeedShareModelProvider,(0,r.observer)((function(){const{shareCountText:e,onClick:t}=(0,h.useClipsFeedShareModel)(),i=(0,a.useLangs)();return(0,o.jsx)(d.TextTooltip,{description:i.getLang("global_share"),placement:"right-start",offsetByCrossAxis:8,arrowPadding:12,children:(0,o.jsx)(l.RoundedGroup.Item,{mode:"border",appearance:"default",bottom:(0,o.jsx)("div",{"data-testid":"clips-controls-share-count",className:(0,c.getColorClass)("color_icon_secondary"),children:e}),children:(0,o.jsx)(u.IconButton,{size:52,className:(0,c.getColorClass)("color_icon_secondary"),label:i.getLang("global_share"),onClick:t,"data-testid":"clips-controls-share-button",children:(0,o.jsx)(n.Icon28ShareOutline,{})})})})})))},347072:(e,t,i)=>{i.d(t,{ClipsFeedShareWidget:()=>o.ClipsFeedShareWidget});var o=i(13768)},866789:(e,t,i)=>{i.d(t,{ClipsFeedShareModel:()=>u});var o=i(331635),r=i(327813),s=i(132028),n=i(908671),a=i(712600),d=i(632520),l=i(348882),c=i(70515);class u{get clipId(){return this.props.current.clipId}get video(){return this.shortVideoVideosProvider.get(this.props.current.clipId)}get shareCount(){return this.video?.data.reposts?.count||0}get hintText(){return this.langs.getLang("video_clips_comment")}get shareCountText(){return(0,n.formatCount)(this.shareCount)}constructor(e,t,i,o){this.props=e,this.shortVideoVideosProvider=t,this.statsService=i,this.langs=o,this.onClick=()=>{this.statsService.collectSearchClick(c.SearchClickActionMap.SHARE_OUT,this.video?.data.track_code),this.props.current.onClick?.(this.clipId)},(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===d.ShortVideoVideosProvider?Object:d.ShortVideoVideosProvider,void 0===l.ClipsPlayerSearchStatsService?Object:l.ClipsPlayerSearchStatsService,void 0===a.Langs?Object:a.Langs])],u)},116314:(e,t,i)=>{i.d(t,{ClipsFeedShareModelProvider:()=>s,useClipsFeedShareModel:()=>n});var o=i(132028),r=i(866789);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsFeedShareModel)},464884:(e,t,i)=>{i.d(t,{ClipsModal:()=>C});var o=i(474848),r=i(132028),s=i(456921),n=i(220208),a=i(694244),d=i(724648),l=i(303800),c=i(486114),u=i(865708),h=i(222790),p=i(547817),m=i(20267),v=i(218240),g=i(550628);const _=(0,r.createWidget)(v.ClipsModalProvider,(0,s.observer)((function(){const{clipId:e,closeText:t,handleCloseModal:i,isOwnerSubscriptionErrorModalShown:r,handleOwnerSubscriptionErrorClose:s,isDeleteClipModalShown:u,handleCloseDeleteClip:_,isCoOwnersModalShown:C,handleCoOwnersModalClose:y}=(0,v.useClipsModalModel)();return(0,n.useScrollLock)(),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.PopoutWrapper,{onClick:i,zIndex:999,children:(0,o.jsxs)(a.ModalBox,{maxWidth:859,width:"100%","aria-label":"Modal",height:"calc(100vh - 48px)",maxHeight:748,children:[(0,o.jsx)(n.ModalDismissButton,{onClick:i,children:t}),(0,o.jsx)(h.PlayingContextProvider,{children:(0,o.jsxs)(d.Flex,{direction:"row",noWrap:!0,className:g.default.clipsModal,children:[(0,o.jsx)(d.Flex.Item,{className:g.default.clipsFeedWrapper,flex:"fixed",flexBasis:"calc(100% - 356px)",children:(0,o.jsx)(l.Div,{mode:"vertical",spacing:8,paddingTop:0,paddingBottom:0,children:(0,o.jsx)(m.ClipsFeed,{})})}),(0,o.jsx)(c.SeparatorSpacing,{size:0,mode:"vertical",direction:"vertical"}),(0,o.jsx)(d.Flex.Item,{className:g.default.clipsFeedSidebar,flex:"fixed",flexBasis:356,children:(0,o.jsx)(m.ClipSidebar,{})})]})})]})}),C&&(0,o.jsx)(p.CoOwnersModal,{activeClipId:e,onClose:y}),r&&(0,o.jsx)(p.OwnerSubscriptionErrorModal,{activeClipId:e,onClose:s}),u&&(0,o.jsx)(p.DeleteClipModal,{onClose:_,videoFullId:e})]})}))),C=({layerParams:e})=>(0,o.jsx)(u.AppRootProvider,{children:(0,o.jsx)(_,{layerParams:e,name:"clipsModal"})})},957988:(e,t,i)=>{i.d(t,{ClipAuthor:()=>l});var o=i(474848),r=i(456921),s=i(303800),n=i(547817),a=i(142648),d=i(218240);const l=(0,r.observer)((function(){const{clipId:e,handleCoOwnersModalOpen:t,handleOwnerSubscriptionErrorOpen:i}=(0,d.useClipsModalModel)();return(0,o.jsx)(s.Div,{mode:"vertical",spacing:8,paddingTop:16,paddingBottom:16,children:(0,o.jsxs)(a.ClipsFadeWrapper,{id:e,children:[(0,o.jsx)(s.Div,{mode:"vertical",spacing:0,paddingTop:0,paddingBottom:0,children:(0,o.jsx)(n.ClipsClipAuthorWidget,{onCoOwnersAvatarClick:t,onCoOwnersMoreClick:t,onUserBlackListError:i,activeClipId:e,avatarSize:48})}),(0,o.jsx)(n.ClipsClipDescriptionWidget,{clipId:e,maxHeight:244,maskHeight:32,paddingTop:12,paddingBottom:0,maxOrdTitleWidth:190}),(0,o.jsx)(n.ClipsClipMetaWidget,{clipId:e,paddingTop:6,paddingBottom:0,tooltipMaxWidth:270}),(0,o.jsx)(n.ClipsClipActionButtonWidget,{clipId:e,paddingTop:12,paddingBottom:0})]})})}))},390345:(e,t,i)=>{i.d(t,{ClipAuthor:()=>o.ClipAuthor});var o=i(957988)},401550:(e,t,i)=>{i.d(t,{ClipComments:()=>_});var o=i(474848),r=i(456921),s=i(808586),n=i(609969),a=i(768035),d=i(557992),l=i(744440),c=i(547817),u=i(142648),h=i(93120),p=i(104259),m=i(218240),v=i(604818);const g=(0,r.observer)((function(){const{clipId:e,commentsTitleText:t}=(0,m.useClipsModalModel)(),{popupStore:i}=(0,s.usePopupStickerWithError)(),{onCommentsScroll:r,commentsRootRef:n,commentsBlockRef:g,setCommentsBlockRef:_,onReverse:C}=(0,p.useCommentsScroll)(e),{ownerId:y,id:b}=(0,a.parseRawId)(e);return(0,o.jsx)(c.CommentsWidget,{headerWrapper:e=>(0,o.jsx)(d.Header,{indicator:e,"data-testid":"clips-comment-header",children:t}),ownerId:y,videoId:b,commentsBlockElement:g,onReverse:C,scrollWrapper:e=>(0,o.jsx)(h.PopupStickerRoot,{id:"popup-sticker-clips-modal",className:v.default.clipCommentsWidgetList,setElementRef:n,popUpStore:i,children:(0,o.jsx)(u.ClipsCommentsScrollWrapper,{children:(0,o.jsx)(l.CustomScrollView,{onScroll:r,getRootRef:_,children:e})})})},e)})),_=(0,r.observer)((function(){return(0,o.jsx)(n.PopupProvider,{children:(0,o.jsx)(g,{})})}))},815932:(e,t,i)=>{i.d(t,{ClipComments:()=>o.ClipComments});var o=i(401550)},554120:(e,t,i)=>{i.d(t,{ClipSidebar:()=>u});var o=i(474848),r=i(456921),s=i(724648),n=i(194528),a=i(582192),d=i(390345),l=i(815932),c=i(463968);const u=(0,r.observer)((function(){return(0,o.jsxs)(s.Flex,{noWrap:!0,direction:"column",className:c.default.clipSidebar,children:[(0,o.jsx)(s.Flex.Item,{flex:"fixed",children:(0,o.jsx)(d.ClipAuthor,{})}),(0,o.jsx)(n.Spacing,{size:1,children:(0,o.jsx)(a.Separator,{padding:!1})}),(0,o.jsxs)(s.Flex.Item,{flex:"content",className:c.default.clipComments,children:[(0,o.jsx)(l.ClipComments,{}),(0,o.jsx)(n.Spacing,{size:4})]})]})}))},133590:(e,t,i)=>{i.d(t,{ClipSidebar:()=>o.ClipSidebar});var o=i(554120)},879540:(e,t,i)=>{i.d(t,{ClipsFeed:()=>h});var o=i(474848),r=i(456921),s=i(296540),n=i(724648),a=i(202350),d=i(965632),l=i(142648),c=i(547817),u=i(218240);const h=(0,r.observer)((function(){const{handleActiveClipIdChanged:e,clipId:t,handleShareClick:i,handleLoadMore:r,feedType:h,isLoadingNext:p,emptyPlaceholder:m,clipItemsIds:v,hasMultipleClipItems:g,isFirstClipActive:_,isLastClipActive:C,handleDeleteClipClicked:y}=(0,u.useClipsModalModel)(),b={height:692,mode:"contain",ratio:.5625,width:390},I=(0,s.useRef)(null),S=(0,s.useCallback)((e=>{I.current?.controlsHandler(e)}),[]);return(0,o.jsx)(n.Flex,{noWrap:!0,children:(0,o.jsx)(l.ClipsFeedComponent,{activeItemId:t,feed:h,listIds:v,isLoadingNext:p,emptyPlaceholder:m,loadNext:r,itemSize:b,onActiveItemChanged:e,itemRender:(e,t,i,r)=>(0,o.jsx)(c.ClipsModalCarouselItem,{videoFullId:e,itemSize:b,isActive:r,statsRef:d.ShortVideoPlayerStatsRef.TOP}),scrollRef:I,itemsGap:8,after:(0,o.jsx)(l.ClipsFeedControlsLayout,{itemSize:b,itemsOffset:-20,itemsGapSize:16,topControlsDirection:"column",bottomControlsDirection:"column",topControls:[(0,o.jsxs)(l.ClipsFeedMoreMenu,{children:[(0,o.jsx)(c.ClipsFeedMoreOrdLabelWidget,{clipId:t}),(0,o.jsx)(c.ClipsFeedMoreEditWidget,{clipId:t}),(0,o.jsx)(c.ClipsFeedMoreCopyLinkWidget,{clipId:t}),(0,o.jsx)(c.ClipsFeedMoreShareWidget,{clipId:t,onShare:i}),(0,o.jsx)(c.ClipsFeedMoreDeleteWidget,{clipId:t,onClick:y}),(0,o.jsx)(c.ClipsFeedMoreReportWidget,{clipId:t}),(0,o.jsx)(c.ClipsFeedMoreDownloadWidget,{clipId:t}),(0,o.jsx)(c.ClipsFeedMoreEridWidget,{clipId:t})]},"clips-feed-more-menu"),(0,o.jsx)(c.ClipsPlayerSoundToggle,{videoFullId:t},"clips-player-sound-toggle")],bottomControls:[(0,o.jsxs)(a.RoundedGroup,{direction:"vertical",gap:16,children:[(0,o.jsx)(c.ClipsFeedLikeWidget,{clipId:t}),(0,o.jsx)(c.ClipsFeedShareWidget,{clipId:t,onClick:i}),(0,o.jsx)(c.ClipsFeedDislikeWidget,{clipId:t})]},"clip_actions"),g?(0,o.jsx)(l.ClipsFeedCarouselControls,{isFirstActive:_,isLastActive:C,handler:S},"clip_controls"):null]})})})}))},542375:(e,t,i)=>{i.d(t,{ClipsFeed:()=>o.ClipsFeed});var o=i(879540)},20267:(e,t,i)=>{i.d(t,{ClipSidebar:()=>r.ClipSidebar,ClipsFeed:()=>o.ClipsFeed});var o=i(542375),r=i(133590)},260182:(e,t,i)=>{i.d(t,{ClipsModal:()=>o.ClipsModal});var o=i(464884)},63065:(e,t,i)=>{i.d(t,{ClipsModalModel:()=>h});var o=i(331635),r=i(327813),s=i(132028),n=i(873900),a=i(768035),d=i(712600),l=i(348882),c=i(6286),u=i(608814);class h{async[s.init](){await this.feed.init(this.clipId)}get clipId(){return(0,n.getIdentityRawId)({ownerId:Number(this.props.current.layerParams.ownerId),id:Number(this.props.current.layerParams.clipId)})}get clipItemsIds(){return this.feed.ids}get feedType(){return this.feed.feedType}get isLoadingNext(){return this.feed.isLoadingNext}get emptyPlaceholder(){return this.feed.emptyPlaceholder}get hasMultipleClipItems(){return this.clipItemsIds.length>1}get isFirstClipActive(){return 0===this.clipItemsIds.indexOf(this.clipId)}get isLastClipActive(){return this.clipItemsIds.indexOf(this.clipId)===this.clipItemsIds.length-1}get closeText(){return this.langs.getLang("global_close")}get commentsTitleText(){return this.langs.getLang("video_clips_comments")}constructor(e,t,i,o){this.feed=e,this.props=t,this.langs=i,this.webLayers=o,this.isCoOwnersModalShown=!1,this.isOwnerSubscriptionErrorModalShown=!1,this.isDeleteClipModalShown=!1,this.handleCloseModal=()=>{this.webLayers.close()},this.handleActiveClipIdChanged=e=>{const{id:t,ownerId:i}=(0,a.parseRawId)(e);this.webLayers.open("clipsModal",{layerParams:{ownerId:i.toString(),clipId:t.toString()}})},this.handleShareClick=e=>{c.Likes.share(`clip${e}`,{})},this.handleLoadMore=async()=>{await this.feed.fetchNext()},this.handleCoOwnersModalOpen=()=>{this.isCoOwnersModalShown=!0},this.handleCoOwnersModalClose=()=>{this.isCoOwnersModalShown=!1},this.handleOwnerSubscriptionErrorOpen=()=>{this.isOwnerSubscriptionErrorModalShown=!0},this.handleOwnerSubscriptionErrorClose=()=>{this.isOwnerSubscriptionErrorModalShown=!1},this.handleDeleteClipClicked=()=>{this.isDeleteClipModalShown=!0},this.handleCloseDeleteClip=()=>{this.isDeleteClipModalShown=!1},(0,r.makeAutoObservable)(this)}}h=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===l.ClipsTopFeed?Object:l.ClipsTopFeed,void 0===s.Props?Object:s.Props,void 0===d.Langs?Object:d.Langs,void 0===u.WebLayers?Object:u.WebLayers])],h)},218240:(e,t,i)=>{i.d(t,{ClipsModalProvider:()=>n,useClipsModalModel:()=>s});var o=i(132028),r=i(63065);const{useModel:s,Provider:n}=(0,o.createPageProvider)(r.ClipsModalModel)},318958:(e,t,i)=>{i.d(t,{ClipsModalCarouselItem:()=>d});var o=i(474848),r=i(456921),s=i(132028),n=i(87963),a=i(297049);const d=(0,s.createWidget)(a.ClipsModalCarouselItemProvider,(0,r.observer)((function(){const{badges:e,props:t,video:i}=(0,a.useClipsModalCarouselItemModel)();if(i)return(0,o.jsx)(n.CarouselItem,{...t.current,useNewCarouselItem:!0,gradient:"bottom",contentComponent:(0,o.jsx)(n.ClipBadges,{badges:e,video:i,afterComponent:(0,o.jsx)(n.ClipAudio,{video:i})})})})))},659467:(e,t,i)=>{i.d(t,{ClipsModalCarouselItem:()=>o.ClipsModalCarouselItem});var o=i(318958)},860579:(e,t,i)=>{i.d(t,{ClipsModalCarouselItemModel:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(632520),a=i(964867);class d{get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get badges(){return this.shortVideoBadgesProvider.get(this.props.current.videoFullId)}constructor(e,t,i){this.props=e,this.shortVideoVideosProvider=t,this.shortVideoBadgesProvider=i,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider,void 0===a.ShortVideoBadgesProvider?Object:a.ShortVideoBadgesProvider])],d)},297049:(e,t,i)=>{i.d(t,{ClipsModalCarouselItemProvider:()=>s,useClipsModalCarouselItemModel:()=>n});var o=i(132028),r=i(860579);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsModalCarouselItemModel)},68366:(e,t,i)=>{i.d(t,{ClipsPlayerSoundToggle:()=>C});var o=i(474848),r=i(456921),s=i(202350),n=i(578392),a=i(271036),d=i(723723),l=i(625528),c=i(303800),u=i(707864),h=i(217157),p=i(54472),m=i(149333),v=i(132028),g=i(243158);const _=(0,r.observer)((function(){const{isMuted:e,isForceMuted:t,toggleMute:i,setVolume:r,volume:v,isVolumeControlEnaled:_}=(0,g.useClipsPlayerSoundToggleModel)(),C=(0,m.useLangs)(),y=e?C.getLang("video_volume_on"):C.getLang("video_volume_off");return _?t?(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(n.TextTooltip,{text:C.getLang("video_clip_sound_restriction_default2"),placement:"right",children:(0,o.jsx)(a.IconButton,{size:52,className:(0,d.getColorClass)("color_icon_secondary"),label:C.getLang("video_clip_sound_restriction_default2"),"data-testid":"clips-controls-mute-button",disabled:!0,children:(0,o.jsx)(h.Icon28MuteOutline,{})})})}):(0,o.jsx)(l.Popover,{noStyling:!0,trigger:"hover",placement:"bottom",role:"slider","aria-describedby":"volume_control",content:(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(c.Div,{mode:"vertical",spacing:16,paddingTop:16,paddingBottom:16,children:(0,o.jsx)(u.Slider,{fillMode:"accent",handleAlwaysActive:!0,size:"xl",hasHandle:!0,vertical:!0,minHeight:85,value:v,min:0,max:1,formatHint:e=>`${Math.floor(100*e)}%`,onChange:r,"data-testid":"clips-controls-volume-slider"})})}),children:(0,o.jsx)("div",{children:(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(a.IconButton,{size:52,className:(0,d.getColorClass)("color_icon_secondary"),label:y,onClick:i,"data-testid":"clips-controls-mute-button",children:e?(0,o.jsx)(h.Icon28MuteOutline,{}):(0,o.jsx)(p.Icon28VolumeOutline,{})})})})}):(0,o.jsx)(s.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(n.TextTooltip,{text:t?C.getLang("video_clip_sound_restriction_default2"):y,placement:"right",children:(0,o.jsx)(a.IconButton,{size:52,className:(0,d.getColorClass)("color_icon_secondary"),label:t?C.getLang("video_clip_sound_restriction_default2"):y,onClick:i,"data-testid":"clips-controls-mute-button",disabled:t,children:e||t?(0,o.jsx)(h.Icon28MuteOutline,{}):(0,o.jsx)(p.Icon28VolumeOutline,{})})})})})),C=(0,v.createWidget)(g.ClipsPlayerSoundToggleProvider,_)},282359:(e,t,i)=>{i.d(t,{ClipsPlayerSoundToggle:()=>o.ClipsPlayerSoundToggle});var o=i(68366)},898840:(e,t,i)=>{i.d(t,{ClipsPlayerSoundToggleModel:()=>d});var o=i(331635),r=i(327813),s=i(632520),n=i(132028),a=i(348882);class d{get isForceMuted(){const e=this.props.current.videoFullId;return Boolean(!!e&&this.shortVideoVideosProvider.get(e)?.data.need_mute)}get isMuted(){return this.playerStatus.isMuted}get volume(){return this.playerStatus.volume}get isVolumeControlEnaled(){return this.playerStatus.isVolumeControlEnaled}constructor(e,t,i){this.props=e,this.shortVideoVideosProvider=t,this.playerStatus=i,this.toggleMute=()=>{this.playerStatus.toggleMute()},this.setVolume=e=>{this.playerStatus.setVolume(e)},(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===s.ShortVideoVideosProvider?Object:s.ShortVideoVideosProvider,void 0===a.ClipsPlayerStatusModel?Object:a.ClipsPlayerStatusModel])],d)},243158:(e,t,i)=>{i.d(t,{ClipsPlayerSoundToggleProvider:()=>s,useClipsPlayerSoundToggleModel:()=>n});var o=i(132028),r=i(898840);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ClipsPlayerSoundToggleModel)},810898:(e,t,i)=>{i.d(t,{CoOwnersBox:()=>g});var o=i(474848),r=i(296540),s=i(456921),n=i(700272),a=i(694244),d=i(782174),l=i(63614),c=i(172656),u=i(194528),h=i(132028),p=i(122083),m=i(975341);const v=(0,s.observer)((function(){const{props:e,lang:t,coOwners:i,owner:s,coOwnersService:h,logOwnerClick:v,isPending:g,userEnv:_,canShowSubscribeButton:C,updateOwnersData:y}=(0,p.useCoOwnersModel)();return(0,r.useEffect)((()=>{h.fetchCoOwnersInfo(e.current.activeClipId)}),[e.current.activeClipId]),(0,r.useEffect)((()=>()=>{y()}),[]),g?(0,o.jsx)(n.Spinner,{size:"large"}):i&&s?(0,o.jsxs)(a.ModalBox,{"data-testid":"clips-co-author-modal","aria-label":t.getLang("video_clips_co_owners_author_modal_title"),children:[(0,o.jsx)(d.ModalHeader,{onClose:e.current.onClose,closeAriaLabel:t.getLang("global_close"),children:t.getLang("video_clips_co_owners_author_modal_title")}),(0,o.jsx)(l.ModalBody,{insetLevel:1,children:(0,o.jsxs)(c.Group,{mode:"plain",children:[(0,o.jsx)(u.Spacing,{size:8}),(0,o.jsx)(m.CoOwnerCells,{owners:[s],logOwnerClick:v,isMainAuthor:!0,subscriptionEnabled:_.partConfigEnabled("clips_subscribe_btns_for_coowners"),canShowSubscribeButton:C}),(0,o.jsx)(m.CoOwnerCells,{owners:i,logOwnerClick:v,subscriptionEnabled:_.partConfigEnabled("clips_subscribe_btns_for_coowners"),canShowSubscribeButton:C}),(0,o.jsx)(u.Spacing,{size:8})]})})]}):void 0})),g=(0,h.createWidget)(p.CoOwnersProvider,v)},886278:(e,t,i)=>{i.d(t,{CoOwnersModal:()=>n});var o=i(474848),r=i(604743),s=i(810898);const n=({onClose:e,activeClipId:t})=>(0,o.jsx)(r.MessageBoxModal,{onDestroy:e,width:420,children:({onClose:e})=>(0,o.jsx)(s.CoOwnersBox,{onClose:e,activeClipId:t})})},332609:(e,t,i)=>{i.d(t,{CoOwnerCells:()=>m});var o=i(474848),r=i(456921),s=i(260546),n=i(612196),a=i(454154),d=i(285056),l=i(723723),c=i(896412),u=i(149333),h=i(976811),p=i(104259);const m=(0,r.observer)((function({owners:e,logOwnerClick:t,isMainAuthor:i,subscriptionEnabled:r,canShowSubscribeButton:m}){const v=(0,u.useLangs)();return(0,o.jsx)(o.Fragment,{children:e.map((u=>(0,o.jsx)(s.SimpleCell,{before:(0,o.jsx)(n.Avatar,{src:u.data.photo_50,size:40,alt:u.name,children:i&&1===e.length&&(0,o.jsx)(n.Avatar.Badge,{children:(0,o.jsx)(h.Icon20StarCircleFillBlue,{})})}),onClick:t,href:(0,p.getOwnerProfileUrl)(u.screenName),after:u.canSubscribe&&!u.isAdmin&&m(u.ownerId)&&r&&(u.isSubscribed?(0,o.jsx)(a.Button,{mode:"secondary",size:"s",appearance:"neutral",disabled:u.isPendingSubscription,loading:u.isPendingSubscription,"data-testid":"clips-coauthor-unsubscribe-button",onClick:e=>{(0,c.cancelEvent)(e),u.unsubscribe()},children:(0,o.jsx)(d.Subhead,{weight:"2",className:(0,l.getColorClass)("color_text_subhead"),children:v.getLang("video_view_subscribed_msg")})}):(0,o.jsx)(a.Button,{mode:"secondary",size:"s",appearance:"neutral",disabled:u.isPendingSubscription,loading:u.isPendingSubscription,"data-testid":"clips-coauthor-subscribe-button",onClick:e=>{(0,c.cancelEvent)(e),u.subscribe()},children:v.getLang("global_public_join")})),children:u.name},u.ownerId.toString())))})}))},975341:(e,t,i)=>{i.d(t,{CoOwnerCells:()=>o.CoOwnerCells});var o=i(332609)},204141:(e,t,i)=>{i.d(t,{CoOwnersBox:()=>r.CoOwnersBox,CoOwnersModal:()=>o.CoOwnersModal});var o=i(886278),r=i(810898)},886896:(e,t,i)=>{i.d(t,{CoOwnersModel:()=>m});var o=i(331635),r=i(327813),s=i(132028),n=i(715799),a=i(961189),d=i(632520),l=i(914492),c=i(712600),u=i(24516),h=i(780345),p=i(891281);class m{get video(){return this.videosProvider.get(this.props.current.activeClipId)}get owner(){return this.video?.owner}get coOwners(){return this.coOwnersService.getCoOwners(this.props.current.activeClipId)}get isPending(){return this.coOwnersService.isPending(this.props.current.activeClipId)}constructor(e,t,i,o,s,n,a){this.coOwnersService=e,this.props=t,this.lang=i,this.userEnv=o,this.authorAnalytics=s,this.videosProvider=n,this.shortVideoOwnersProvider=a,this.canShowSubscribeButton=e=>{const t=this.shortVideoOwnersProvider.get(e);return!!t&&("member_status"in t?.data?t?.data?.member_status!==h.GroupsGroupFullMemberStatusEnumNames.MEMBER&&t?.data?.member_status!==h.GroupsGroupFullMemberStatusEnumNames.HAS_SENT_A_REQUEST:!("friend_status"in t?.data)||t?.data?.friend_status!==p.FriendsFriendStatusStatusEnumNames.IS_FRIEND&&t?.data?.friend_status!==p.FriendsFriendStatusStatusEnumNames.OUTCOMING_REQUEST)},this.logOwnerClick=()=>{const e=this.video?.data.id,t=this.owner?.ownerId;e&&t&&this.authorAnalytics.logClickLinkClickPostOwner({ownerId:t,videoId:e,navScreen:"coowner_modal_card"})},this.updateOwnersData=async()=>{if(!this.userEnv.partConfigEnabled("clips_subscribe_btns_for_coowners")||!this.owner)return;const e=[this.owner.ownerId,...this.coOwnersService.getCoOwnerIds(this.props.current.activeClipId)];e.length&&await Promise.all([...e.map((e=>this.shortVideoOwnersProvider.fetch(e)))])},(0,r.makeAutoObservable)(this)}}m=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.ShortVideoCoOwnerService?Object:n.ShortVideoCoOwnerService,void 0===s.Props?Object:s.Props,void 0===c.Langs?Object:c.Langs,void 0===u.UserEnv?Object:u.UserEnv,void 0===a.ShortVideoAuthorAnalytics?Object:a.ShortVideoAuthorAnalytics,void 0===d.ShortVideoVideosProvider?Object:d.ShortVideoVideosProvider,void 0===l.ShortVideoOwnersProvider?Object:l.ShortVideoOwnersProvider])],m)},122083:(e,t,i)=>{i.d(t,{CoOwnersProvider:()=>s,useCoOwnersModel:()=>n});var o=i(132028),r=i(886896);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CoOwnersModel)},596054:(e,t,i)=>{i.d(t,{AttachmentStub:()=>d});var o=i(474848),r=i(412888),s=i(723723),n=i(285056),a=i(42802);const d=({text:e})=>(0,o.jsx)("div",{className:a.default.wrap,children:(0,o.jsx)(r.TextClamp,{className:(0,s.getColorClass)("color_text_secondary"),lines:1,TypographyComponent:n.Caption,children:e})})},843739:(e,t,i)=>{i.d(t,{AttachmentStub:()=>o.AttachmentStub});var o=i(596054)},936985:(e,t,i)=>{i.d(t,{Attachments:()=>I});var o=i(474848),r=i(296540),s=i(293116),n=i(48158),a=i(873900),d=i(136306),l=i(666e3),c=i(808586),u=i(344527),h=i(902506),p=i(183628),m=i(46611),v=i(183720),g=i(742554),_=i(272231),C=i(772445),y=i(698391),b=i(944127);const I=({commentId:e,attachments:t,inModal:i,lastAddedComment:I})=>{const{userEnv:S}=(0,b.useCommentsViewModel)(),f=(0,r.useRef)(null),{popupStore:w}=(0,c.usePopupSticker)(),E=(0,_.useModuleReady)("audio-player"),k=t[0];(0,r.useEffect)((()=>{if(!S.partConfigEnabled("stickers.popup.vkcom"))return;if(!(0,u.isBaseSticker)(k?.sticker)||!I||!(0,m.isPopupStickerAttachment)(k)||(0,h.isPopupAutoplayOnSendOff)())return;const t=k?.sticker?.sticker_id;t&&((0,y.isStopAutoplayStickerComment)({stickerId:t,commentId:e,inModal:i})||f.current?.click())}),[I,w,k,e,i]);return(0,o.jsx)(n.CommentAttachments,{commentId:e,attachments:t,formatDateTime:d.formatDateTime,formatSize:l.formatFileSize,onStickerClick:e=>{(0,u.isBaseSticker)(e)&&(0,p.openStickersLayerView)({sticker_id:e?.sticker_id})},onPhotoClick:(e,t)=>{t.preventDefault(),(0,v.showPhoto)(e.photo_id,e.access_key)},onVideoClick:(e,t)=>{t.preventDefault(),e.owner_id&&(0,g.showVideo)((0,a.getIdentityRawId)({ownerId:e.owner_id,id:e.id}),null,{forceLoc:!0,openInPopup:!0})},onCustomAttachmentRender:e=>"custom"!==e.type?null:"audio"===e.original_type&&E?(0,o.jsx)(C.AudioAttachment,{audio:e.custom},`attachment-audio-${e.custom.id}`):"graffiti"===e.original_type?(0,o.jsx)(s.Image,{widthSize:"100%",heightSize:"100%",src:e.custom.url},`attachment-graffiti-${e.custom.id}`):null,stickerAttachmentProps:(0,m.getStickerRichProps)({attachment:k,popupStore:w,wrapperProps:{iconWrapperRef:f}})})}},534834:(e,t,i)=>{i.d(t,{AudioAttachment:()=>v});var o=i(474848),r=i(456921),s=i(132028),n=i(149333),a=i(724648),d=i(145512),l=i(271036),c=i(723723),u=i(539267),h=i(181084),p=i(738262);const m=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,h.useAudioAttachmentModel)(),{audio:i,progress:r,volume:s,duration:m,playStatus:v,artistLink:g,trackLink:_,togglePlay:C,onProgressChange:y,onVolumeChange:b}=t,{onDeleteClick:I}=t.props.current;return(0,o.jsxs)(a.Flex,{noWrap:!0,className:p.default.root,children:[(0,o.jsx)(d.AudioAttachment,{progress:r,duration:m,volume:s,status:v,artist:i.artist,title:i.title,artistLink:g,trackLink:_,onTogglePlay:C,onProgressChange:y,onVolumeChange:b}),I&&(0,o.jsx)(l.IconButton,{noPadding:!0,hoverMode:"opacity",label:e.getLang("global_delete"),activeMode:"opacity",onClick:I,children:(0,o.jsx)(u.Icon12Cancel,{className:(0,c.getColorClass)("color_icon_secondary")})})]})})),v=(0,s.createWidget)(h.AudioAttachmentProvider,m)},772445:(e,t,i)=>{i.d(t,{AudioAttachment:()=>o.AudioAttachment});var o=i(534834)},344079:(e,t,i)=>{i.d(t,{AudioAttachment:()=>u});var o=i(331635),r=i(327813),s=i(132028),n=i(873900),a=i(983567),d=i(671731),l=i(673569),c=i(799540);class u{[s.init](){this.volume=this.player.getVolume(),this.player.subscribe(c.AudioPlayerEventType.PROGRESS,(e=>{this.isCurrentAudioPlaying&&this.setProgress(e)})),this.player.subscribe(c.AudioPlayerEventType.PLAY,(()=>this.isCurrentAudioPlaying&&this.setPlayStatus("playing"))),this.player.subscribe(c.AudioPlayerEventType.PAUSE,(()=>this.isCurrentAudioPlaying&&this.setPlayStatus("paused"))),this.player.subscribe(c.AudioPlayerEventType.STOP,(()=>this.isCurrentAudioPlaying&&this.setPlayStatus("stopped"))),this.player.subscribe(c.AudioPlayerEventType.VOLUME,(e=>this.setVolume(e))),this.player.subscribe(c.AudioPlayerEventType.CURRENT_CHANGED,(()=>!this.isCurrentAudioPlaying&&this.setPlayStatus("stopped")))}setPlayStatus(e){this.playStatus=e}setProgress(e){this.progress=e}setVolume(e){this.volume=e}get isCurrentAudioPlaying(){return(0,l.audioTupleToApiAudio)(this.player.getCurrentAudio())?.id===this.audio.id}get audio(){return this.props.current.audio}get duration(){return this.audio.duration}get artistLink(){return`/audio?performer=1&q=${encodeURIComponent(this.audio.artist)}`}get trackLink(){return`/audio${(0,n.getIdentityRawId)({ownerId:this.audio.owner_id,id:this.audio.id})}`}constructor(e){this.props=e,this.player=(0,a.getAudioPlayer)(),this.playStatus="stopped",this.progress=0,this.volume=0,this.play=()=>{const e=(0,l.audioTupleToApiAudio)(this.player.getCurrentAudio());e&&e.id===this.audio.id?this.player.play():this.player.playAudio((0,d.apiAudioToAudioTuple)(this.audio))},this.togglePlay=()=>{"playing"===this.playStatus?this.player.pause():this.play()},this.onProgressChange=e=>{this.player.seek(e)},this.onVolumeChange=e=>{this.player.setVolume(e)},(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props])],u)},181084:(e,t,i)=>{i.d(t,{AudioAttachmentProvider:()=>s,useAudioAttachmentModel:()=>n});var o=i(132028),r=i(344079);const{Provider:s,useModel:n}=(0,o.createProvider)(r.AudioAttachment,{isolatedContext:!1,onlyTransient:!1})},497109:(e,t,i)=>{i.d(t,{AttachmentStub:()=>o.AttachmentStub,Attachments:()=>r.Attachments});var o=i(843739),r=i(936985)},192205:(e,t,i)=>{i.d(t,{CommentItemWrapper:()=>a});var o=i(474848),r=i(456921),s=i(944127),n=i(548506);const a=(0,r.observer)((({id:e})=>{const t=(0,s.useCommentsViewModel)(),{getComment:i,videoOwnerId:r,onParentOwnerClick:a,selectedCommentId:d,lastAddedCommentId:l,onReplyClick:c,inModal:u}=t,{isAttachmentsNotSupported:h}=t.props.current,p=i(e);return p?(0,o.jsx)(n.CommentItem,{comment:p,videoOwnerId:r,onParentOwnerClick:a,onReplyClick:c,selected:d===e,lastAddedComment:l===e,inModal:u,isAttachmentsNotSupported:h}):null}))},223884:(e,t,i)=>{i.d(t,{CommentItemWrapper:()=>o.CommentItemWrapper});var o=i(192205)},354460:(e,t,i)=>{i.d(t,{CommentsWidget:()=>a});var o=i(474848),r=i(132028),s=i(944127),n=i(802516);const a=(0,r.createWidget)(s.CommentsViewModelProvider,(()=>(0,o.jsx)(n.CommentsBlock,{})))},704602:(e,t,i)=>{i.d(t,{CommentsBlock:()=>p});var o=i(474848),r=i(456921),s=i(724648),n=i(172656),a=i(944127),d=i(777047),l=i(548506),c=i(325254),u=i(106551),h=i(351655);const p=(0,r.observer)((function(){const e=(0,a.useCommentsViewModel)(),{isLoading:t,videoOwnerId:i,videoId:r,count:p,isLoadedFully:m,canPost:v,addComment:g,isAuthorized:_,replyObject:C,resetReplyObject:y,reverseComments:b,reversed:I,inModal:S}=e,{headerWrapper:f,scrollWrapper:w,commentsBlockElement:E,isAttachmentsNotSupported:k}=e.props.current;return!i||!r||t&&!p?(0,o.jsx)(c.CommentsSkeleton,{inModal:S}):(0,o.jsxs)(s.Flex,{direction:"column",noWrap:!0,className:h.default.root,children:[!!f&&f(p||""),(0,o.jsx)(s.Flex.Item,{flex:"grow",children:w?w((0,o.jsx)(d.CommentsList,{})):(0,o.jsx)(d.CommentsList,{})}),(0,o.jsxs)(n.Group.ExpandedContent,{className:h.default.inputWrapper,children:[p>0&&(0,o.jsx)(u.ScrollBackButton,{fullyLoaded:m,scrollElement:E,listReversed:I,reverseList:b}),_&&(0,o.jsx)(l.CommentsInput,{onCreateComment:g,videoOwnerId:i,videoId:r,canPost:v,replyObject:C,resetReplyObject:y,inModal:S,isAttachmentsNotSupported:k})]})]})}))},316851:(e,t,i)=>{i.d(t,{ScrollBackButton:()=>u});var o=i(474848),r=i(202350),s=i(271036),n=i(723723),a=i(366186),d=i(149333),l=i(460565),c=i(342009);const u=({fullyLoaded:e,scrollElement:t,listReversed:i,reverseList:u})=>{const h=(0,d.useLangs)(),{scrollToTop:p,isScrollButtonHidden:m}=(0,l.useScrollToTop)({scrollElement:t,fullyLoaded:e,listReversed:i,reverseList:u});return m?null:(0,o.jsx)("div",{className:c.default.button,children:(0,o.jsx)(r.RoundedGroup.Item,{mode:"border",children:(0,o.jsx)(s.IconButton,{onClick:p,className:(0,n.getColorClass)("color_icon_secondary"),"data-testid":"clips-comment-scroll-back-button",label:h.getLang("video_clips_comments_hop_last"),children:(0,o.jsx)(a.Icon20Dropdown,{width:44})})})})}},106551:(e,t,i)=>{i.d(t,{ScrollBackButton:()=>o.ScrollBackButton});var o=i(316851)},460565:(e,t,i)=>{i.d(t,{useScrollToTop:()=>n});var o=i(296540),r=i(8520);const s=e=>e.scrollTop>e.scrollHeight-e.clientHeight-50,n=({scrollElement:e,fullyLoaded:t,listReversed:i,reverseList:n})=>{const[a,d]=(0,o.useState)(!0),l=(0,o.useCallback)((()=>{i?e&&(e.dataset.bypassScrollHandler="1",e.scrollTop=e.scrollHeight):n()}),[e,i,t]);return(0,o.useEffect)((()=>{e&&d(s(e))}),[e]),(0,o.useEffect)((()=>{const o=(0,r.throttle)((({target:e})=>{const o=s(e);d((i||t)&&o)}),100);return e?.addEventListener("scroll",o),()=>{e?.removeEventListener("scroll",o)}}),[e,i,t]),{scrollToTop:l,isScrollButtonHidden:a}}},802516:(e,t,i)=>{i.d(t,{CommentsBlock:()=>o.CommentsBlock});var o=i(704602)},331575:(e,t,i)=>{i.d(t,{CommentsList:()=>c});var o=i(474848),r=i(456921),s=i(151972),n=i(944127),a=i(223884),d=i(417695),l=i(927810);const c=(0,r.observer)((function(){const e=(0,n.useCommentsViewModel)(),{ids:t,error:i,isLoading:r,fetchMore:c,isLoadedFully:u,reversed:h,inModal:p,restrictedComments:m,epmtyComments:v}=e,{commentsBlockElement:g}=e.props.current;return m?(0,o.jsx)(d.RestrictedCommentsPlaceholder,{stretched:!p}):i?(0,o.jsx)(d.GlobalErrorPlaceholder,{stretched:!p}):v?(0,o.jsx)(d.EmptyCommentsPlaceholder,{stretched:!p}):(0,o.jsxs)(l.ReversedList,{parentElement:g,isActive:h,spinnerOffset:42,listIds:t,children:[t.map((e=>(0,o.jsx)(a.CommentItemWrapper,{id:e},e))),!u&&(0,o.jsx)(s.DynamicPagination,{isLoading:r,fetchData:c,nextFrom:t.length})]})}))},65486:(e,t,i)=>{i.d(t,{ReversedList:()=>n});var o=i(474848),r=i(724648),s=i(757074);const n=({parentElement:e,spinnerOffset:t,listIds:i,isActive:n,children:a})=>((0,s.useCommentsListScroll)({parentElement:e,spinnerOffset:t,listIds:i,isActive:n}),(0,o.jsx)(r.Flex,{noWrap:!0,direction:"column",justify:n?"end":"start",reverse:n,children:a}))},927810:(e,t,i)=>{i.d(t,{ReversedList:()=>o.ReversedList});var o=i(65486)},757074:(e,t,i)=>{i.d(t,{useCommentsListScroll:()=>r});var o=i(296540);const r=({parentElement:e,spinnerOffset:t,listIds:i,isActive:r})=>{const s=(0,o.useRef)(0);(0,o.useLayoutEffect)((()=>{r&&e&&(0===e.scrollTop&&(e.scrollTop=e.scrollHeight-s.current-t),s.current=e.scrollHeight)}),[i,e])}},777047:(e,t,i)=>{i.d(t,{CommentsList:()=>o.CommentsList});var o=i(331575)},330589:(e,t,i)=>{i.d(t,{CommentsModal:()=>a});var o=i(474848),r=i(456921),s=i(211413),n=i(668382);const a=(0,r.observer)((function({activeClipId:e,isAttachmentsNotSupported:t,onClose:i}){return(0,o.jsx)(s.MessageBoxModal,{onDestroy:i,width:550,children:({onClose:i,refreshCoordinates:r})=>(0,o.jsx)(n.CommentsModalBox,{activeClipId:e,isAttachmentsNotSupported:t,onClose:i,refreshCoordinates:r})})}))},668382:(e,t,i)=>{i.d(t,{CommentsModalBox:()=>v});var o=i(474848),r=i(456921),s=i(296540),n=i(694244),a=i(782174),d=i(285056),l=i(299494),c=i(149333),u=i(808586),h=i(768035),p=i(547817),m=i(93120);const v=(0,r.observer)((function({activeClipId:e,isAttachmentsNotSupported:t,onClose:i,refreshCoordinates:r}){const v=(0,c.useLangs)(),{popupStore:g}=(0,u.usePopupStickerWithError)(),[_,C]=(0,s.useState)(null),{ownerId:y,id:b}=(0,h.parseRawId)(e);return(0,s.useLayoutEffect)((()=>{r()}),[]),(0,o.jsx)(n.ModalBox,{maxHeight:"90vh","aria-label":v.getLang("video_clips_comments"),children:(0,o.jsx)(p.CommentsWidget,{headerWrapper:e=>(0,o.jsx)(a.ModalHeader,{onClose:i,indicator:e,closeAriaLabel:v.getLang("global_close"),children:(0,o.jsx)(d.Paragraph,{weight:"2",children:v.getLang("video_clips_comments")})}),ownerId:y,videoId:b,placement:"modal",commentsBlockElement:_,scrollWrapper:e=>(0,o.jsx)(l.ModalScrollView,{maxHeight:.7*window.innerHeight,getRef:C,children:(0,o.jsx)(m.PopupStickerRoot,{id:"popup-sticker-clips-comment-modal-container",popUpStore:g,children:e})}),isAttachmentsNotSupported:t})})}))},185005:(e,t,i)=>{i.d(t,{EmojiWrapper:()=>r});var o=i(474848);const r=({children:e})=>(0,o.jsxs)("div",{className:"_emoji_field_wrap",children:[(0,o.jsx)("div",{className:"_emoji_wrap"}),e]})},81952:(e,t,i)=>{i.d(t,{EmojiWrapper:()=>o.EmojiWrapper});var o=i(185005)},293463:(e,t,i)=>{i.d(t,{InputAttachments:()=>c});var o=i(474848),r=i(889977),s=i(724648),n=i(181944),a=i(149333),d=i(272231),l=i(772445);const c=({attachments:e,removeAttachment:t})=>{const i=(0,a.useLangs)(),c=(0,d.useModuleReady)("audio-player");return Boolean(e?.length)?(0,o.jsx)(s.Flex,{gap:8,children:e.map((e=>{if("audio"===e.type&&e.data)return c?(0,o.jsx)(l.AudioAttachment,{audio:e.data,onDeleteClick:()=>t(e)},e.fullId):null;let a={};return"photo"===e.type||"video"===e.type?a.src=e.thumb:"doc"===e.type&&(a.caption=e.data.title,a.icon=(0,o.jsx)(r.Icon24DocumentOutline,{})),(0,o.jsx)(s.Flex.Item,{children:(0,o.jsx)(n.MediaAttach,{"aria-label":i.getLang("global_upload"),...a,children:(0,o.jsx)(n.MediaAttach.RemoveButton,{label:i.getLang("me_attachment_dont_attach"),onClick:()=>t(e)})})},`${e.type}${e.fullId}`)}))}):null}},742699:(e,t,i)=>{i.d(t,{InputAttachments:()=>o.InputAttachments});var o=i(293463)},832798:(e,t,i)=>{i.d(t,{MAX_COMMENT_LENGTH:()=>o,SNACKBAR_DURATION:()=>r});const o=250,r=4e3},642e3:(e,t,i)=>{i.d(t,{CommentsModal:()=>r.CommentsModal,CommentsWidget:()=>o.CommentsWidget});var o=i(354460),r=i(330589)},299819:(e,t,i)=>{i.d(t,{CommentsViewModel:()=>h});var o=i(331635),r=i(327813),s=i(132028),n=i(951652),a=i(24516),d=i(903653),l=i(607417),c=i(603025),u=i(873900);class h{[s.init](){this.count>0||this.isLoadedFully||this.isLoading?this.sortOrder=this.commentsList.order:this.fetch()}[s.destroy](){clearTimeout(this.selectTimer)}async fetch(){try{await this.commentsList.fetch({videoId:this.videoId,ownerId:this.videoOwnerId,count:this.chunkSize,fields:h.getExtendedFields(),sort:this.sortOrder})}catch(e){(0,r.runInAction)((()=>{this.error=e}))}}get ids(){return this.commentsList.ids}get count(){return this.commentsList.countAll}get videoOwnerId(){return this.props.current.ownerId}get videoId(){return this.props.current.videoId}get isAuthorized(){return this.authService.isAuthorized}get isLoading(){return this.commentsList.isLoading}get isLoadedFully(){return this.commentsList.isLoadedFully}get canPost(){return this.commentsList.canPost}get restrictedComments(){return 0===this.count&&!this.canPost||(0,c.isApiError)(this.error)&&801===this.error.error.error_code}get epmtyComments(){return 0===this.count&&this.isLoadedFully}get reversed(){return"desc"===this.commentsList.order}get inModal(){return"modal"===this.props.current.placement}static getExtendedFields(){return["photo_100","first_name_dat"]}selectComment(e){this.selectedCommentId=e,clearTimeout(this.selectTimer),this.selectTimer=setTimeout((()=>{this.selectedCommentId=null}),2e3)}constructor(e,t,i,o,s){this.props=e,this.commentsListProvider=t,this.commentsProvider=i,this.authService=o,this.userEnv=s,this.selectedCommentId=null,this.lastAddedCommentId=null,this.error=null,this.replyObject=null,this.getComment=e=>this.commentsProvider.getItem(e),this.addComment=async e=>{this.authService.userId&&(this.resetReplyObject(),this.reversed?this.commentsList.addComment(e):await this.reverseComments(),(0,r.runInAction)((()=>{this.selectComment(e),this.lastAddedCommentId=e})))},this.fetchMore=async()=>{this.error=null;try{return this.commentsList.fetchMore()}catch(e){(0,r.runInAction)((()=>{this.error=e}))}},this.onReplyClick=(e,t)=>{if(!t)return;this.replyObject={owner:t,commentId:e};const i=(0,u.getIdentityRawId)({ownerId:t.id,id:e});this.selectComment(i)},this.resetReplyObject=()=>{this.replyObject=null},this.reverseComments=async()=>{this.sortOrder="desc",await this.fetch(),this.props.current.onReverse?.()},this.onParentOwnerClick=({reply_to_user:e,reply_to_comment:t})=>{if(e&&t){const i=(0,u.getIdentityRawId)({ownerId:e,id:t});this.selectComment(i)}},this.chunkSize=20,this.sortOrder="asc",this.selectTimer=void 0,this.commentsList=this.commentsListProvider.getList(this.props.current.videoId),(0,r.makeAutoObservable)(this)}}h=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===d.VideoCommentsListProvider?Object:d.VideoCommentsListProvider,void 0===l.VideoCommentsProvider?Object:l.VideoCommentsProvider,void 0===n.AuthService?Object:n.AuthService,void 0===a.UserEnv?Object:a.UserEnv])],h)},944127:(e,t,i)=>{i.d(t,{CommentsViewModelProvider:()=>s,useCommentsViewModel:()=>n});var o=i(132028),r=i(299819);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CommentsViewModel,{isolatedContext:!1,onlyTransient:!1})},679445:(e,t,i)=>{i.d(t,{EmptyCommentsPlaceholder:()=>a});var o=i(474848),r=i(149333),s=i(720836),n=i(313393);const a=({stretched:e})=>{const t=(0,r.useLangs)();return(0,o.jsx)(s.Placeholder,{stretched:e,icon:(0,o.jsx)(n.Icon56CommentOutline,{}),header:t.getLang("video_clips_no_comments_title"),"data-testid":"clips-comment-placeholder-empty",children:t.getLang("video_clips_no_comments_text")})}},573109:(e,t,i)=>{i.d(t,{GlobalErrorPlaceholder:()=>a});var o=i(474848),r=i(720836),s=i(525652),n=i(149333);const a=({stretched:e})=>{const t=(0,n.useLangs)();return(0,o.jsx)(r.Placeholder,{stretched:e,icon:(0,o.jsx)(s.Icon56ErrorOutline,{}),header:t.getLang("vkconnect_auth_security_error_title"),"data-testid":"clips-comment-placeholder-error",children:t.getLang("vkconnect_auth_security_error_text")})}},926025:(e,t,i)=>{i.d(t,{RestrictedCommentsPlaceholder:()=>a});var o=i(474848),r=i(149333),s=i(720836),n=i(98967);const a=({stretched:e})=>{const t=(0,r.useLangs)();return(0,o.jsx)(s.Placeholder,{stretched:e,icon:(0,o.jsx)(n.Icon56LockOutline,{}),header:t.getLang("video_clips_comments_restricted"),"data-testid":"clips-comment-placeholder-restricted"})}},417695:(e,t,i)=>{i.d(t,{EmptyCommentsPlaceholder:()=>o.EmptyCommentsPlaceholder,GlobalErrorPlaceholder:()=>s.GlobalErrorPlaceholder,RestrictedCommentsPlaceholder:()=>r.RestrictedCommentsPlaceholder});var o=i(679445),r=i(926025),s=i(573109)},432247:(e,t,i)=>{i.d(t,{CommentsSkeleton:()=>u});var o=i(474848),r=i(172656),s=i(303800),n=i(157643),a=i(724648),d=i(55366),l=i(8520),c=i(963293);const u=({inModal:e})=>(0,o.jsxs)(r.Group,{separator:"hide",mode:e?"card":"plain",className:c.default.root,children:[(0,o.jsx)(s.Div,{spacing:16,children:(0,o.jsx)(n.Skeleton,{noAnimation:!0,width:220})}),(0,l.createArray)(12).map((e=>(0,o.jsx)(s.Div,{spacing:8,children:(0,o.jsxs)(a.Flex,{children:[(0,o.jsx)(d.FakeAvatar,{children:(0,o.jsx)(n.Skeleton,{noAnimation:!0,width:36,height:36,circle:!0})}),(0,o.jsx)(a.Flex.Item,{flex:"grow",children:(0,o.jsxs)(s.Div,{paddingBottom:0,paddingTop:0,children:[(0,o.jsx)(n.Skeleton,{noAnimation:!0,width:"50%"}),(0,o.jsx)(n.Skeleton,{noAnimation:!0,width:"80%"}),(0,o.jsx)(n.Skeleton,{noAnimation:!0,width:"60%"})]})})]})},e)))]})},325254:(e,t,i)=>{i.d(t,{CommentsSkeleton:()=>o.CommentsSkeleton});var o=i(432247)},890118:(e,t,i)=>{i.d(t,{mapUserOrGroupToCommentOwner:()=>o.mapUserOrGroupToCommentOwner,parseAttachment:()=>r.parseAttachment,parseAttachmentFromBox:()=>s.parseAttachmentFromBox,parseClipboard:()=>n.parseClipboard});var o=i(592706),r=i(915204),s=i(267235),n=i(654919)},592706:(e,t,i)=>{i.d(t,{mapUserOrGroupToCommentOwner:()=>n});var o=i(222062),r=i(172479),s=i(406751);const n=e=>{if(e)return{kind:"type"in e&&["group","page","event"].includes(e.type??"")?"group":"user",is_nft:(0,o.checkOwnerIsNFT)(e),href:(0,r.getOwnerUrl)(e,(0,s.isVideoStandalone)()?"/@":"/"),...e}}},915204:(e,t,i)=>{i.d(t,{parseAttachment:()=>r});var o=i(873900);const r=e=>{switch(e.type){case"audio":return e.audio?{type:"audio",fullId:(0,o.getIdentityRawId)({ownerId:e.audio.owner_id,id:e.audio.id}),data:e.audio}:null;case"video":return e.video?.id&&e.video?.owner_id?{type:"video",fullId:(0,o.getIdentityRawId)({ownerId:e.video.owner_id,id:e.video.id}),thumb:e.video.image?.[0]?.url}:null;case"photo":return e.photo?{type:"photo",fullId:(0,o.getIdentityRawId)({ownerId:e.photo.owner_id,id:e.photo.id}),thumb:e.photo.sizes?.find((e=>"m"===e.type))?.url}:null;case"doc":return e.doc?{type:"doc",fullId:(0,o.getIdentityRawId)({ownerId:e.doc.owner_id,id:e.doc.id}),data:{title:e.doc?.title}}:null;default:return null}}},267235:(e,t,i)=>{i.d(t,{parseAttachmentFromBox:()=>r});var o=i(673569);const r=(e,t,i)=>{switch(e){case"photo":return{type:"photo",fullId:t,thumb:i.thumb_m};case"video":return{type:"video",fullId:t,thumb:i.thumb};case"audio":return{type:"audio",fullId:t,data:(0,o.audioTupleToApiAudio)(i)??void 0};case"doc":return{type:"doc",fullId:t,data:i};default:return null}}},654919:(e,t,i)=>{i.d(t,{parseClipboard:()=>r});var o=i(225741);const r=async e=>{if(!e.clipboardData||!window.cur.urlAttachmentTimeHash)return;const t=new RegExp(String.raw`^(?:(?:(?:https?:\/\/)?(?:${o.VK_HOST_REGEX_GROUP_UNSAFE.source})\/)|@)(?:(?:id(\d+))|(\w|.+))$`),i=e.clipboardData.getData("text/plain");if(t.test(i)){const e=new URLSearchParams({url:i,hash:window.cur.urlAttachmentTimeHash,response_as_json:"1"}),t=await fetch("/share.php?act=url_attachment",{method:"POST",body:e}),[o,r,s]=await t.json();return{attachment:{type:o,fullId:r,thumb:s?.thumb||s?.thumb_m},link:i}}}},893584:(e,t,i)=>{i.d(t,{createStickerIdCommentId:()=>o});const o=(e,t)=>`${String(e)}_${String(t)}`},290960:(e,t,i)=>{i.d(t,{StickerPopupCommentSendedInClipsCacheKeys:()=>s.StickerPopupCommentSendedInClipsCacheKeys,addPopupStickerIdHasBeenSentInClips:()=>s.addPopupStickerIdHasBeenSentInClips,createStickerIdCommentId:()=>o.createStickerIdCommentId,isPopupStickerHasBeenSentInClips:()=>s.isPopupStickerHasBeenSentInClips,isStickerPopupAutoplayedInClips:()=>r.isStickerPopupAutoplayedInClips,updatePopupStickerIdHasBeenSentInClipsWithCommentId:()=>s.updatePopupStickerIdHasBeenSentInClipsWithCommentId});var o=i(893584),r=i(965701),s=i(756930)},965701:(e,t,i)=>{i.d(t,{isStickerPopupAutoplayedInClips:()=>r});const o=(0,i(558137).makeSharedState)("stickers-popup-autoplayed-in-clips",(()=>new Set),{version:1}),r=e=>{const t=o();return!!t.has(e)||(t.add(e),!1)}},756930:(e,t,i)=>{i.d(t,{StickerPopupCommentSendedInClipsCacheKeys:()=>s,addPopupStickerIdHasBeenSentInClips:()=>a,isPopupStickerHasBeenSentInClips:()=>l,updatePopupStickerIdHasBeenSentInClipsWithCommentId:()=>d});var o=i(558137),r=i(893584),s=function(e){return e.IN_MODAL="inModal",e.IN_PAGE="inPage",e}({});const n=(0,o.makeSharedState)("stickers-comments-has-been-sent-clips",(()=>({inModal:new Set,inPage:new Set})),{version:1}),a=(e,t)=>{e=String(e);n()[t].add(e)},d=(e,t,i)=>{e=String(e),t=String(t);const o=n();o[i].has(e)&&(o[i].delete(e),o[i].add((0,r.createStickerIdCommentId)(e,t)))},l=(e,t)=>{e=String(e);return!!n()[t].has(e)}},698391:(e,t,i)=>{i.d(t,{StickerPopupCommentSendedInClipsCacheKeys:()=>r.StickerPopupCommentSendedInClipsCacheKeys,addPopupStickerIdHasBeenSentInClips:()=>r.addPopupStickerIdHasBeenSentInClips,isStopAutoplayStickerComment:()=>o.isStopAutoplayStickerComment,updatePopupStickerIdHasBeenSentInClipsWithCommentId:()=>r.updatePopupStickerIdHasBeenSentInClipsWithCommentId});var o=i(910374),r=i(290960)},910374:(e,t,i)=>{i.d(t,{isStopAutoplayStickerComment:()=>r});var o=i(290960);const r=({stickerId:e,commentId:t,inModal:i})=>!((0,o.isPopupStickerHasBeenSentInClips)((0,o.createStickerIdCommentId)(e,t),i?o.StickerPopupCommentSendedInClipsCacheKeys.IN_MODAL:o.StickerPopupCommentSendedInClipsCacheKeys.IN_PAGE)&&!(0,o.isStickerPopupAutoplayedInClips)((0,o.createStickerIdCommentId)(e,t)))},596343:(e,t,i)=>{i.d(t,{CommentItem:()=>b});var o=i(474848),r=i(456921),s=i(327813),n=i(132028),a=i(296540),d=i(149333),l=i(424714),c=i(360020),u=i(865757),h=i(662213),p=i(23513),m=i(136306),v=i(441746),g=i(890118),_=i(398940),C=i(497109);const y=(0,r.observer)((function(){const e=(0,d.useLangs)(),t=(0,v.useCommentItemModel)(),{comment:i,owner:r,parentOwner:n,toggleLike:y,commentEdit:b,commentDelete:I,isCurrentUserCommentOwner:S,isCommentOwnerVideoOwner:f,commentReport:w,rawId:E}=t,{selected:k,onReplyClick:P,onParentOwnerClick:A,inModal:L,lastAddedComment:x,isAttachmentsNotSupported:M}=t.props.current,O=L?`modal${E}`:E;if((0,a.useEffect)((()=>{k&&document.getElementById(O)?.scrollIntoView({block:"center",behavior:"smooth"})}),[k]),b.isEditing)return(0,o.jsx)(_.CommentEdit,{});if(I.isDeleted)return(0,o.jsx)(l.CommentDeleted,{onRestoreClick:I.restore,restoreActionLabel:e.getLang("video_restorecomm"),children:e.getLang("video_comm_deleted")});if(w.reported)return(0,o.jsx)(l.CommentDeleted,{children:e.getLang("global_report_sent")});const T=(0,h.parseCommentProps)((0,s.toJS)(i));return(0,o.jsx)(c.Comment,{id:O,comment:T,replyActionLabel:e.getLang("me_message_action_reply"),onReplyClick:()=>P(i.id,r),onLikeClick:y,likeAriaLabel:e.getLang("global_comment_like_aria_label"),dislikeAriaLabel:e.getLang("global_comment_dislike_aria_label"),formatText:e=>(0,p.formatCommentText)(e,!0),actions:(0,o.jsx)(_.CommentActionMenu,{userRole:S?"owner":"reader"}),formatDateTime:m.formatDateTime,owner:(0,g.mapUserOrGroupToCommentOwner)(r),parentOwner:(0,g.mapUserOrGroupToCommentOwner)(n),onParentOwnerClick:A,renderAttachments:()=>{if(T.attachments)return M?(0,o.jsx)(C.AttachmentStub,{text:e.getLang("video_attach_not_supported")}):(0,o.jsx)(C.Attachments,{commentId:i.id,attachments:T.attachments,lastAddedComment:x,inModal:L})},selected:k,authorizedByUser:S,expandActionLabel:e.getLang("me_fc_expand_panel"),avatarBadge:f?(0,o.jsx)(u.Icon16StarCircleFillBlue,{}):void 0})})),b=(0,n.createWidget)(v.CommentItemProvider,y)},205253:(e,t,i)=>{i.d(t,{CommentActionMenu:()=>d});var o=i(474848),r=i(456921),s=i(149333),n=i(360020),a=i(441746);const d=(0,r.observer)((function({userRole:e}){const t=(0,a.useCommentItemModel)(),{commentEdit:i,commentDelete:r,reportComment:d}=t,l=(0,s.useLangs)(),c="owner"===e;return(0,o.jsxs)(o.Fragment,{children:[i.canEdit&&(0,o.jsx)(n.Comment.Action,{icon:"edit",ariaLabel:l.getLang("global_edit"),onClick:i.setIsEditing,"data-testid":"clips-comment-item-edit"},"edit"),r.canDelete&&(0,o.jsx)(n.Comment.Action,{icon:"delete",ariaLabel:l.getLang("global_delete"),onClick:r.delete,"data-testid":"clips-comment-item-delete"},"delete"),!c&&(0,o.jsx)(n.Comment.Action,{icon:"report",ariaLabel:l.getLang("global_report_spam"),onClick:d,"data-testid":"clips-comment-item-report"},"report")]})}))},80827:(e,t,i)=>{i.d(t,{CommentActionMenu:()=>o.CommentActionMenu});var o=i(205253)},768949:(e,t,i)=>{i.d(t,{CommentEdit:()=>g});var o=i(474848),r=i(456921),s=i(296540),n=i(360020),a=i(285056),d=i(550304),l=i(303800),c=i(149333),u=i(890118),h=i(441746),p=i(611444),m=i(742699),v=i(81952);const g=(0,r.observer)((function(){const e=(0,c.useLangs)(),{props:t,owner:i,commentEdit:r,commentDelete:g}=(0,h.useCommentItemModel)(),{isAttachmentsNotSupported:_}=t.current;return(0,s.useEffect)((()=>{r.setDefaultData()}),[]),(0,o.jsx)(n.Comment.Edit,{owner:(0,u.mapUserOrGroupToCommentOwner)(i),afterOwnerName:e.getLang("video_comment_edit_label"),sendActionLabel:e.getLang("global_save"),cancelActionLabel:e.getLang("global_cancel"),deleteActionLabel:e.getLang("global_delete"),onSendClick:r.save,sendDisabled:r.isSendDisabled,onDeleteClick:g.delete,onCancelClick:r.cancelEditing,bottom:r.contentLengthNotification&&(0,o.jsx)(a.Text,{children:r.contentLengthNotification}),field:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.EmojiWrapper,{children:(0,o.jsx)(d.CommentInput.ContentEditable,{getRef:r.inputRef,onInput:r.changeInput,onPasteCapture:r.pasteHandler,inlineAfter:(0,o.jsx)(p.InputActionButtons,{commentText:r.content,attachmentsCount:r.attachments?.length||0,addAttachment:r.addAttachment,setTextComment:r.handleChange,isAttachmentsNotSupported:_})})}),Boolean(r.attachments?.length)&&(0,o.jsx)(l.Div,{mode:"vertical",spacing:0,children:(0,o.jsx)(m.InputAttachments,{attachments:r.attachments,removeAttachment:r.removeAttachment})})]})})}))},726566:(e,t,i)=>{i.d(t,{CommentEdit:()=>o.CommentEdit});var o=i(768949)},398940:(e,t,i)=>{i.d(t,{CommentActionMenu:()=>r.CommentActionMenu,CommentEdit:()=>o.CommentEdit});var o=i(726566),r=i(80827)},17115:(e,t,i)=>{i.d(t,{CommentItem:()=>o.CommentItem});var o=i(596343)},576119:(e,t,i)=>{i.d(t,{CommentDeleteModel:()=>n});var o=i(327813),r=i(98710),s=i(832798);class n{get canDelete(){return Boolean(this.commentData.can_delete)}get isDeleted(){return this.props.current.comment.isDeleted}get commentData(){return this.props.current.comment.data}get commentRawId(){return this.props.current.comment.rawId}get videoOwnerId(){return this.props.current.videoOwnerId}dispose(){this.abortController?.abort(),this.abortController=null}constructor(e,t,i,n,a){this.props=e,this.commentEdit=t,this.commentsDeletingService=i,this.langs=n,this.snackbar=a,this.delete=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={commentId:this.commentRawId,ownerId:this.videoOwnerId};this.commentEdit.cancelEditing();try{await this.commentsDeletingService.delete(e,{signal:this.abortController.signal}),(0,o.runInAction)((()=>{this.abortController=null}))}catch(e){(0,r.isAbortError)(e)||this.snackbar.show({type:"error",text:this.langs.getLang("video_comment_delete_fail_message"),duration:s.SNACKBAR_DURATION})}},this.restore=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={commentId:this.commentRawId,ownerId:this.videoOwnerId};try{await this.commentsDeletingService.restore(e,{signal:this.abortController.signal}),(0,o.runInAction)((()=>{this.abortController=null}))}catch(e){(0,r.isAbortError)(e)||this.snackbar.show({type:"error",text:this.langs.getLang("video_comment_restore_fail_message"),duration:s.SNACKBAR_DURATION})}},this.abortController=null,(0,o.makeAutoObservable)(this)}}},252854:(e,t,i)=>{i.d(t,{CommentEditModel:()=>l});var o=i(327813),r=i(296540),s=i(514683),n=i(104386),a=i(890118),d=i(832798);class l{get canEdit(){return Boolean(this.commentData.can_edit)}get isSendDisabled(){return this.pending||this.isNoChanges||this.content.length>d.MAX_COMMENT_LENGTH}get contentLengthNotification(){return(0,n.getValidateLengthMessage)({value:this.content.trim(),maxLength:d.MAX_COMMENT_LENGTH,getExceededLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_exceeded",!0)),getRemainingLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_remained",!0))})}setDefaultData(){this.inputRef?.current&&(this.inputRef.current.innerText=this.commentData.text,(0,s.setEndOfContentEditable)(this.inputRef.current)),this.attachments=this.commentData.attachments?.map(a.parseAttachment).filter((e=>null!==e))??[],this.currentAttachmentsSerialized=this.serializeAttachments([...this.attachments])}get isNoChanges(){return this.content.trim()===this.commentData.text&&this.serializeAttachments(this.attachments)===this.currentAttachmentsSerialized}get commentData(){return this.props.current.comment.data}serializeAttachments(e){return e.length?e.map((e=>`${e.type}${e.fullId}`)).join(","):void 0}constructor(e,t,i){this.props=e,this.langs=t,this.snackbar=i,this.isEditing=!1,this.content="",this.attachments=[],this.inputRef=(0,r.createRef)(),this.handleChange=e=>{this.content=e,this.inputRef?.current&&e!==this.inputRef.current.innerText&&(this.inputRef.current.innerText=e,(0,s.setEndOfContentEditable)(this.inputRef.current))},this.changeInput=({target:e})=>{e instanceof HTMLElement&&null!==e.innerText&&this.handleChange(e.innerText)},this.addAttachment=e=>{this.attachments.push(e)},this.removeAttachment=e=>{this.attachments=this.attachments.filter((({type:t,fullId:i})=>t!==e.type||i!==e.fullId))},this.setIsEditing=()=>{this.isEditing=!0,this.handleChange(this.commentData.text)},this.save=async()=>{try{this.pending=!0,await this.props.current.comment.edit({ownerId:this.props.current.videoOwnerId,message:this.content.trim(),attachments:this.serializeAttachments(this.attachments)}),(0,o.runInAction)((()=>{this.isEditing=!1}))}catch(e){this.snackbar.show({type:"error",text:this.langs.getLang("video_comment_edit_fail_message"),duration:d.SNACKBAR_DURATION})}finally{(0,o.runInAction)((()=>{this.pending=!1}))}},this.cancelEditing=()=>{this.isEditing=!1,this.handleChange(this.commentData.text)},this.pasteHandler=async e=>{const t=await(0,a.parseClipboard)(e);if(!t)return;const{attachment:i,link:o}=t;this.addAttachment(i),this.handleChange(this.content.replace(o,""))},this.pending=!1,this.currentAttachmentsSerialized=void 0,(0,o.makeAutoObservable)(this)}}},342788:(e,t,i)=>{i.d(t,{CommentItemViewModel:()=>g});var o=i(331635),r=i(327813),s=i(132028),n=i(473905),a=i(172539),d=i(951652),l=i(712600),c=i(670252),u=i(955060),h=i(252854),p=i(576119),m=i(689440),v=i(450846);class g{[s.destroy](){this.commentDelete.dispose()}get comment(){return this.props.current.comment.data}get owner(){return this.props.current.comment.owner?.data}get parentOwner(){return this.props.current.comment.parentOwner?.data}get videoOwnerId(){return this.props.current.videoOwnerId}get isCurrentUserCommentOwner(){return this.currentUserId===this.owner?.id}get isCommentOwnerVideoOwner(){return this.videoOwnerId===this.owner?.id}get rawId(){return this.props.current.comment.rawId}get currentUserId(){return this.authService.userId??0}constructor(e,t,i,o,s,n,a){this.props=e,this.authService=t,this.commentsDeletingService=i,this.commentsReportService=o,this.langs=s,this.snackbar=n,this.errorLogger=a,this.toggleLike=()=>{this.props.current.comment.likes.toggleLike({ownerId:this.videoOwnerId,optimistic:!0})},this.reportComment=()=>{(0,v.showReportForm)("video_comment",this.videoOwnerId,this.comment.id,this.commentReport.report)},this.commentEdit=new h.CommentEditModel(this.props,this.langs,this.snackbar),this.commentDelete=new p.CommentDeleteModel(this.props,this.commentEdit,this.commentsDeletingService,this.langs,this.snackbar),this.commentReport=new m.CommentReportModel(this.props,this.commentsReportService,this.errorLogger),(0,r.makeAutoObservable)(this)}}g=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===d.AuthService?Object:d.AuthService,void 0===n.VideoCommentsDeletingService?Object:n.VideoCommentsDeletingService,void 0===a.VideoCommentsReportService?Object:a.VideoCommentsReportService,void 0===l.Langs?Object:l.Langs,void 0===c.Snackbar?Object:c.Snackbar,void 0===u.ErrorLogger?Object:u.ErrorLogger])],g)},689440:(e,t,i)=>{i.d(t,{CommentReportModel:()=>r});var o=i(327813);class r{constructor(e,t,i){this.props=e,this.commentsReportProvider=t,this.errorLogger=i,this.reported=!1,this.report=async e=>{const t={commentId:this.props.current.comment.rawId,ownerId:this.props.current.videoOwnerId,reason:e};try{await this.commentsReportProvider.report(t),this.reported=!0}catch(e){this.errorLogger.log(new Error("Can't create a complain for the clip",{cause:e}))}},(0,o.makeAutoObservable)(this)}}},441746:(e,t,i)=>{i.d(t,{CommentItemProvider:()=>s,useCommentItemModel:()=>n});var o=i(132028),r=i(342788);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CommentItemViewModel,{isolatedContext:!1,onlyTransient:!1})},988927:(e,t,i)=>{i.d(t,{CommentsInput:()=>_});var o=i(474848),r=i(456921),s=i(132028),n=i(866042),a=i(550304),d=i(285056),l=i(149333),c=i(751423),u=i(8520),h=i(742699),p=i(611444),m=i(873130),v=i(81952);const g=(0,r.observer)((function(){const e=(0,l.useLangs)(),t=(0,m.useCommentInputModel)(),{inputRef:i,content:r,handleChange:s,createComment:g,attachments:_,addAttachment:C,removeAttachment:y,pending:b,contentLengthNotification:I,user:S,keyDownHandler:f,pasteHandler:w,sendDisabled:E,disabled:k,sendSticker:P}=t,{replyObject:A,resetReplyObject:L,isAttachmentsNotSupported:x}=t.props.current,{handleInput:M}=(0,c.useEmoji)({inputValue:r,inputRef:i,onChangeInput:s,emojiOpts:{onUGCStickerSend:u.noop,emojiLoadMore:u.noop,ref:"clip_comment",global:!1,pickerBottomMargin:12,onStickerSend:x?u.noop:P,noStickers:x}});return(0,o.jsxs)(o.Fragment,{children:[A&&(0,o.jsx)(n.CommentReplyTarget,{before:e.getLang("mobile_market_item_all_comments_reply_to"),onClick:L,children:A.owner.first_name_dat}),(0,o.jsx)(v.EmojiWrapper,{children:(0,o.jsx)(a.CommentInput,{getRef:i,onInput:M,onKeyDownCapture:f,onSendClick:()=>g(),onPasteCapture:w,before:(0,o.jsx)(a.CommentInput.Avatar,{href:"#",src:S?.data?.photo_100,"data-testId":"clips-comment-input-avatar"}),disabled:k||b,placeholder:e.getLang("me_comments_composer_input_placeholder"),sendActionLabel:e.getLang("wall_send"),sendDisabled:E,bottom:(I||_.length>0)&&(0,o.jsxs)(o.Fragment,{children:[I&&(0,o.jsx)(d.Text,{children:I}),(0,o.jsx)(h.InputAttachments,{attachments:_,removeAttachment:y})]}),inlineAfter:!k&&(0,o.jsx)(p.InputActionButtons,{commentText:r,attachmentsCount:_.length,isAttachmentsNotSupported:x,sendSticker:e=>e.id&&P(e.id),addAttachment:C,setTextComment:s})})})]})})),_=(0,s.createWidget)(m.CommentInputProvider,g)},903971:(e,t,i)=>{i.d(t,{CommentsInput:()=>o.CommentsInput});var o=i(988927)},458638:(e,t,i)=>{i.d(t,{CommentInputModel:()=>b});var o=i(331635),r=i(327813),s=i(132028),n=i(951652),a=i(955060),d=i(712600),l=i(670252),c=i(24516),u=i(343825),h=i(349773),p=i(639147),m=i(296540),v=i(104386),g=i(890118),_=i(646296),C=i(832798);const y=["photo_100"];class b{[s.init](){this.authService.userId&&this.usersFetchProvider.fetch({fields:y,userIds:[this.authService.userId]})}[s.update](){null!==this.props.current.replyObject?this.handleChange(`${this.props.current.replyObject.owner.first_name},`):this.handleChange("")}get user(){if(this.authService.userId)return this.videoUsersStore?.getById(this.authService.userId)}get contentLengthNotification(){return(0,v.getValidateLengthMessage)({value:this.content.trim(),maxLength:C.MAX_COMMENT_LENGTH,getExceededLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_exceeded",!0)),getRemainingLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_remained",!0))})}get sendDisabled(){return this.pending||0===this.content.trim().length&&!this.attachments.length||this.content.trim().length>C.MAX_COMMENT_LENGTH}get disabled(){return!this.props.current.canPost}reset(){this.content="",this.attachments=[]}static getExtendedFields(){return["photo_100","first_name_dat"]}constructor(e,t,i,o,s,n,a,d,l){this.props=e,this.authService=t,this.errorLogger=i,this.videoCommentCreationService=o,this.usersStoreFactory=s,this.usersFetchProvider=n,this.langs=a,this.snackbar=d,this.userEnv=l,this.pending=!1,this.content="",this.attachments=[],this.inputRef=(0,m.createRef)(),this.handleChange=e=>{this.content=e},this.addAttachment=e=>{this.attachments.push(e)},this.removeAttachment=e=>{this.attachments=this.attachments.filter((({type:t,fullId:i})=>t!==e.type||i!==e.fullId))},this.createComment=async e=>{this.pending=!0;const t={videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,replyToCommentId:this.props.current.replyObject?.commentId,fields:b.getExtendedFields()};e?t.stickerId=e:(t.message=this.content.trim(),t.attachments=this.attachments.length?this.attachments.map((e=>`${e.type}${e.fullId}`)).join(","):void 0);try{const e=await this.videoCommentCreationService.createComment(t);return e&&(this.props.current.onCreateComment(e),this.stickerModel.onCreateComment(e),this.reset()),!0}catch(e){this.errorLogger.log(new Error("Can't create a comment for the clip",{cause:e})),this.snackbar.show({type:"error",text:this.langs.getLang("video_comment_publishing_fail_message"),duration:C.SNACKBAR_DURATION})}finally{(0,r.runInAction)((()=>{this.pending=!1}))}},this.keyDownHandler=e=>{e.shiftKey||e.ctrlKey||e.metaKey||e.altKey||"Enter"!==e.key||this.createComment()},this.pasteHandler=async e=>{const t=await(0,g.parseClipboard)(e);if(!t)return;const{attachment:i,link:o}=t;this.addAttachment(i),this.handleChange(this.content.replace(o,""))},this.sendSticker=e=>{this.stickerModel.getStickerData(e,this.props.current.inModal)&&this.createComment(e)},this.videoUsersStore=void 0,this.videoUsersStore=this.usersStoreFactory.ensureByFields(y),this.stickerModel=new _.StickerModel(this.userEnv),(0,r.makeAutoObservable)(this)}}b=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.AuthService?Object:n.AuthService,void 0===a.ErrorLogger?Object:a.ErrorLogger,void 0===u.VideoCommentCreationService?Object:u.VideoCommentCreationService,void 0===h.VideoUsersStoreFactory?Object:h.VideoUsersStoreFactory,void 0===p.VideoUsersFetchService?Object:p.VideoUsersFetchService,void 0===d.Langs?Object:d.Langs,void 0===l.Snackbar?Object:l.Snackbar,void 0===c.UserEnv?Object:c.UserEnv])],b)},646296:(e,t,i)=>{i.d(t,{StickerModel:()=>s});var o=i(327813),r=i(698391);class s{constructor(e){this.userEnv=e,this.stickerData={},this.onCreateComment=async e=>{this.stickerData.stickerId&&(this.userEnv.partConfigEnabled("stickers.popup.vkcom")&&this.stickerData.stickerId&&(0,r.updatePopupStickerIdHasBeenSentInClipsWithCommentId)(String(this.stickerData.stickerId),e,this.stickerData.inModal?r.StickerPopupCommentSendedInClipsCacheKeys.IN_MODAL:r.StickerPopupCommentSendedInClipsCacheKeys.IN_PAGE),this.stickerData={})},this.getStickerData=(e,t)=>{if(e)return this.userEnv.partConfigEnabled("stickers.popup.vkcom")&&(0,r.addPopupStickerIdHasBeenSentInClips)(e,t?r.StickerPopupCommentSendedInClipsCacheKeys.IN_MODAL:r.StickerPopupCommentSendedInClipsCacheKeys.IN_PAGE),this.stickerData={stickerId:e,inModal:Boolean(t)},this.stickerData},(0,o.makeAutoObservable)(this)}}},873130:(e,t,i)=>{i.d(t,{CommentInputProvider:()=>s,useCommentInputModel:()=>n});var o=i(132028),r=i(458638);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CommentInputModel,{isolatedContext:!1,onlyTransient:!1})},908039:(e,t,i)=>{i.d(t,{InputActionButtons:()=>y});var o=i(474848),r=i(456921),s=i(132028),n=i(957994),a=i(550304),d=i(625528),l=i(666112),c=i(695498),u=i(229653),h=i(516413),p=i(298590),m=i(93120),v=i(685637),g=i(327515),_=i(13261);const C=(0,r.observer)((function(){const e=(0,g.useInputActionButtonsModel)(),{isStickerPickerShown:t,setShowStickerPicker:i,destroyPopupSticker:r,userId:s,popupStickerService:C,handleStickerSend:y,handlePopUpPlay:b,logError:I}=e,{commentText:S,attachmentsCount:f,addAttachment:w,setTextComment:E,isAttachmentsNotSupported:k}=e.props.current;return(0,o.jsxs)(o.Fragment,{children:[!k&&f<2&&(0,o.jsx)(a.CommentInput.IconButton,{"data-testid":"clips-comment-attachment-button",children:(0,o.jsx)(v.AttachmentsDropdown,{maxCount:2-f,addAttachment:w})}),(0,o.jsx)(d.Popover,{trigger:"hover",placement:"top",onShownChange:i,content:t&&(0,o.jsx)(m.PopupStickerRoot,{onClick:r,className:_.default.emojiKeyboardWrapper,id:c.POPUP_STICKER_CONTAINER_ID,popUpStore:C,isUseAsFullscreen:!0,position:"absolute",children:(0,o.jsx)(u.StickersEmojiKeyboard,{onAPIRequest:n.api,visibleTab:k?h.Tab.EMOJI:void 0,userId:s,lang:window.vk.lang,onPopUpPlay:b,onEmojiInsert:e=>{E(S+e)},onCatchError:I,onStickerSend:y,onShopClick:()=>p.Emoji.showStickersStore()})}),children:(0,o.jsx)(a.CommentInput.IconButton,{"data-testid":"clips-comment-sticker-button",children:(0,o.jsx)(l.Icon20SmileOutline,{})})})]})})),y=(0,s.createWidget)(g.InputActionButtonsProvider,C)},5110:(e,t,i)=>{i.d(t,{AttachmentsDropdown:()=>m});var o=i(474848),r=i(631112),s=i(507852),n=i(723723),a=i(149333),d=i(461571),l=i(768098),c=i(885609),u=i(398001),h=i(394062),p=i(890118);const m=({addAttachment:e,maxCount:t})=>{const i=(0,a.useLangs)(),m=(t,i)=>{(0,r.showBox)(t,i,{onDone:t=>{window.cur.chooseMedia=(i,o,r)=>{const s=(0,p.parseAttachmentFromBox)(i,o,r);s&&e(s),setTimeout((()=>t.hide())),"audio"===i&&window.cur.audioChooseBox?.hide()}}})};return(0,o.jsx)(s.DropdownActionSheet,{content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.DropdownActionSheet.Item,{before:(0,o.jsx)(d.Icon20CameraOutline,{className:(0,n.getColorClass)("color_icon_secondary")}),onClick:()=>m("al_photos.php?act=choose_photo",{max_files:t}),"data-testid":"clips-comment-attach-photo",children:i.getLang("me_attachment_add_photo")}),(0,o.jsx)(s.DropdownActionSheet.Item,{before:(0,o.jsx)(l.Icon20VideoCircleOutline,{className:(0,n.getColorClass)("color_icon_secondary")}),onClick:()=>m("al_video.php?act=a_choose_video_box",{to_id:window.vk.id,owner_id:window.vk.id,from:"comment",max_files:t}),"data-testid":"clips-comment-attach-video",children:i.getLang("me_attachment_add_video")}),(0,o.jsx)(s.DropdownActionSheet.Item,{before:(0,o.jsx)(c.Icon20MusicOutline,{className:(0,n.getColorClass)("color_icon_secondary")}),onClick:()=>m("al_audio.php?act=choose_box",{owner_id:window.vk.id}),"data-testid":"clips-comment-attach-audio",children:i.getLang("me_attachment_add_audio")}),(0,o.jsx)(s.DropdownActionSheet.Item,{before:(0,o.jsx)(u.Icon20DocumentOutline,{className:(0,n.getColorClass)("color_icon_secondary")}),onClick:()=>m("docs.php?act=a_choose_doc_box",{}),"data-testid":"clips-comment-attach-file",children:i.getLang("me_attachment_add_file")})]}),children:(0,o.jsx)(h.Icon20Attach,{})})}},685637:(e,t,i)=>{i.d(t,{AttachmentsDropdown:()=>o.AttachmentsDropdown});var o=i(5110)},611444:(e,t,i)=>{i.d(t,{InputActionButtons:()=>o.InputActionButtons});var o=i(908039)},835260:(e,t,i)=>{i.d(t,{InputActionButtons:()=>u});var o=i(331635),r=i(327813),s=i(8520),n=i(132028),a=i(312459),d=i(951652),l=i(955060),c=i(597521);class u{[n.init](){(0,c.isPopUpStickersEnabled)()&&(this.popupStickerService=new a.PopupStickerService)}get userId(){return this.authService.userId||0}constructor(e,t,i){this.props=e,this.authService=t,this.errorLogger=i,this.isStickerPickerShown=!1,this.logError=this.errorLogger.log.bind(this.errorLogger),this.destroyPopupSticker=()=>{this.popupStickerService?.destroyByRemove()},this.setShowStickerPicker=(0,s.debounce)((e=>{this.setShowStickerPickerForce(e)}),300),this.setShowStickerPickerForce=e=>{this.isStickerPickerShown=e},this.handleStickerSend=e=>{e.id&&this.props.current.sendSticker&&(this.props.current.sendSticker(e),this.setShowStickerPickerForce(!1))},this.handlePopUpPlay=(e,t)=>{this.isStickerPickerShown&&this.popupStickerService?.preparePreview({stickerElement:e.target,layers:t})},(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===d.AuthService?Object:d.AuthService,void 0===l.ErrorLogger?Object:l.ErrorLogger])],u)},327515:(e,t,i)=>{i.d(t,{InputActionButtonsProvider:()=>s,useInputActionButtonsModel:()=>n});var o=i(132028),r=i(835260);const{Provider:s,useModel:n}=(0,o.createProvider)(r.InputActionButtons,{isolatedContext:!1,onlyTransient:!1})},548506:(e,t,i)=>{i.d(t,{CommentItem:()=>r.CommentItem,CommentsInput:()=>o.CommentsInput});var o=i(903971),r=i(17115);i(611444)},699297:(e,t,i)=>{i.d(t,{DeleteClipModal:()=>g});var o=i(474848),r=i(456921),s=i(694244),n=i(782174),a=i(285056),d=i(63614),l=i(908242),c=i(454154),u=i(149333),h=i(132028),p=i(604743),m=i(395278);const v=(0,r.observer)((function(){const e=(0,m.useDeleteClipModalModel)(),t=(0,u.useLangs)();return(0,o.jsx)(p.MessageBoxModal,{onDestroy:e.props.current.onClose,width:550,children:({onClose:i})=>(0,o.jsxs)(s.ModalBox,{children:[(0,o.jsx)(n.ModalHeader,{onClose:i,closeAriaLabel:t.getLang("global_close"),children:(0,o.jsx)(a.Paragraph,{weight:"2",children:t.getLang("video_clips_remove_own_video_alert_title")})}),(0,o.jsx)(d.ModalBody,{insetLevel:2,children:t.getLang("video_clips_remove_own_video_alert_desc")}),(0,o.jsx)(l.ModalFooter,{before:(0,o.jsx)(c.Button,{size:"m",mode:"tertiary",onClick:()=>{e.deleteClip(),i()},children:t.getLang("global_delete")}),actions:(0,o.jsx)(c.Button,{size:"m",mode:"secondary",onClick:i,children:t.getLang("global_close")})})]})})})),g=(0,h.createWidget)(m.DeleteClipModalProvider,v)},290660:(e,t,i)=>{i.d(t,{DeleteClipModal:()=>o.DeleteClipModal});var o=i(699297)},852839:(e,t,i)=>{i.d(t,{DeleteClipModalModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(509739);class a{deleteClip(){return this.shortVideoDeleteService.delete(this.props.current.videoFullId)}constructor(e,t){this.shortVideoDeleteService=e,this.props=t,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.ShortVideoDeleteService?Object:n.ShortVideoDeleteService,void 0===s.Props?Object:s.Props])],a)},395278:(e,t,i)=>{i.d(t,{DeleteClipModalProvider:()=>s,useDeleteClipModalModel:()=>n});var o=i(132028),r=i(852839);const{Provider:s,useModel:n}=(0,o.createProvider)(r.DeleteClipModalModel,{isolatedContext:!1,onlyTransient:!1})},705182:(e,t,i)=>{i.d(t,{EditClipModal:()=>C});var o=i(474848),r=i(456921),s=i(132028),n=i(149333),a=i(28928),d=i(694244),l=i(782174),c=i(63614),u=i(524378),h=i(44544),p=i(908242),m=i(454154),v=i(282963),g=i(183774);const _=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,v.useEditClipModalModel)(),{isInitialized:i,pending:r,description:s,isOrdEditable:_,ordInfo:C,isPostponed:y,publishDate:b,disabledSave:I,save:S,setDescription:f,setOrdInfo:w,setPublishDate:E}=t,{onClose:k}=t.props.current;return i?(0,o.jsxs)(d.ModalBox,{children:[(0,o.jsx)(l.ModalHeader,{onClose:k,closeAriaLabel:e.getLang("global_close"),children:e.getLang("video_clip_edit_title")}),(0,o.jsx)(c.ModalBody,{insetLevel:1,children:(0,o.jsxs)(u.FormLayout,{disabled:r,children:[(0,o.jsx)(g.DescriptionBlock,{onChange:f,text:s,disabled:r,placeholder:e.getLang("video_clip_upload_description_placeholder")}),y&&(0,o.jsx)(g.PublishDateInput,{publishDate:b,setPublishDate:E}),_&&(0,o.jsx)(h.FormItem,{children:(0,o.jsx)(g.OrdInfoSection,{ordData:C,isSaving:r,onChange:w})})]})}),(0,o.jsx)(p.ModalFooter,{actions:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(m.Button,{mode:"tertiary",size:"m",onClick:k,children:e.getLang("global_cancel")}),(0,o.jsx)(m.Button,{size:"m",loading:r,onClick:S,disabled:I,children:e.getLang("global_save")})]})})]}):(0,o.jsx)(a.ScreenSpinner,{size:"medium"})})),C=(0,s.createWidget)(v.EditClipModalProvider,_)},53271:(e,t,i)=>{i.d(t,{DescriptionBlock:()=>c});var o=i(474848),r=i(296540),s=i(149333),n=i(289475),a=i(44544),d=i(945206);const l=(0,n.getConfigValue)("clips_description_max_length")??4e3,c=({text:e,onChange:t,disabled:i,placeholder:n})=>{const c=(0,s.useLangs)(),u=(0,r.useRef)(null);return(0,r.useEffect)((()=>{u.current&&(u.current.focus(),u.current.setSelectionRange(u.current.value.length,u.current.value.length))}),[u]),(0,o.jsx)(a.FormItem,{top:c.getLang("video_descr"),htmlFor:"clipDescription",bottom:l&&e.length>l-100?c.numeric(l-e.length,c.getLang("text_N_symbols_remain",!0)):"",children:(0,o.jsx)(d.Textarea,{id:"clipDescription",placeholder:n,value:e,onChange:e=>t(e.target.value),maxLength:l,"data-testid":"clips-upload-description",disabled:i,getRef:u})})}},816372:(e,t,i)=>{i.d(t,{DescriptionBlock:()=>o.DescriptionBlock});var o=i(53271)},218225:(e,t,i)=>{i.d(t,{OrdInfoSection:()=>u});var o=i(474848),r=i(149333),s=i(140083),n=i(260546),a=i(723723),d=i(330320),l=i(431399);const c=(e=!0)=>{const t=e?"visible":"hidden",i=e?"1":"0",o=e?"500":"1000",r=window.videoview?.isLayerShown();window.boxLayerWrap&&(window.boxLayerWrap.style.visibility=t,window.boxLayerWrap.style.opacity=i),window.boxLayerBG&&(r?window.wkLayerWrap&&(window.wkLayerWrap.style.zIndex=o):window.boxLayerBG.style.visibility=t),e&&r&&window.layerBG&&(window.layerBG.style.display="block")},u=({ordData:e,onChange:t,isSaving:i})=>{const u=(0,r.useLangs)();return(0,o.jsx)(n.SimpleCell,{Component:"label",multiline:!0,subtitle:e?.is_ads?u.getLang("mobile_video_clips_upload_ord_subtitle_added"):u.getLang("mobile_video_clips_upload_ord_subtitle_empty"),after:(0,o.jsx)(s.Icon24ChevronCompactRight,{className:(0,a.getColorClass)("color_icon_tertiary")}),onClick:()=>{let i=null;window.videoview?.isLayerShown()&&window.layers&&(i=window.layers.fullhide,window.layers.fullhide=!1),(0,d.handleOrdMiniappOpen)((0,l.videoOrdInfoParamsToOrdData)(e),(e=>t((0,l.ordDataToVideoOrdInfoParams)(e))),{isSnackbar:!1,edit:!1,options:{noLocChange:1,skipBoxesHide:1,noClickHide:1,onLoaded:()=>c(!1),onHide:()=>{c(),i&&(window.layers.fullhide=i)},onFail:()=>c()}})},"data-testid":"clips-edit-ord",disabled:i,children:u.getLang("video_upload_ord_label")})}},954333:(e,t,i)=>{i.d(t,{OrdInfoSection:()=>o.OrdInfoSection});var o=i(218225)},431399:(e,t,i)=>{function o(e){return e?.is_ad?{is_ads:e.is_ad,advertisers:[{ord_pred_id:e.ord_pred_id,er_id:e.erid}]}:null}function r(e){return e?.is_ads?{is_ad:!0,ord_pred_id:e.advertisers[0].ord_pred_id,erid:e.advertisers[0].er_id}:null}i.d(t,{ordDataToVideoOrdInfoParams:()=>o,videoOrdInfoParamsToOrdData:()=>r})},765975:(e,t,i)=>{i.d(t,{PublishDateInput:()=>p});var o=i(474848),r=i(272880),s=i(149333),n=i(394005),a=i(296540),d=i(44544),l=i(220208),c=i(271036),u=i(723723),h=i(679804);const p=({publishDate:e,setPublishDate:t,disabled:i})=>{const{getLang:p}=(0,s.useLangs)(),m=(0,a.useRef)(null),[v,g]=(0,a.useState)(!1),_=e&&(0,r.isBefore)(e,new Date)?p("video_postpone_date_error"):"",C=(0,a.useCallback)((()=>{const e=new Date;e.setHours(e.getHours()+1),t(e),g(!0)}),[]);return(0,a.useEffect)((()=>{e&&m.current&&v&&(m.current.click(),g(!1))}),[v]),(0,o.jsx)(d.FormItem,{htmlFor:"postponeDate",top:p("video_publication_time_label"),status:_?"error":"default",bottom:_,"data-testid":"clips-edit-publish-date",children:e?(0,o.jsx)(l.DateInput,{id:"postponeDate",value:e,onChange:t,closeOnChange:!1,enableTime:!0,disablePast:!0,showNeighboringMonth:!0,shouldDisableDate:n.shouldDisableDate,disabled:i,getRootRef:m}):(0,o.jsx)(l.Input,{readOnly:!0,value:p("video_upload_now"),onClick:C,after:(0,o.jsx)(c.IconButton,{hasHover:!1,onClick:C,label:p("mobile_video_clips_upload_publish_time_reset"),children:(0,o.jsx)(h.Icon20CalendarOutline,{className:(0,u.getColorClass)("color_icon_secondary")})}),disabled:i})})}},635254:(e,t,i)=>{i.d(t,{PublishDateInput:()=>o.PublishDateInput});var o=i(765975)},183774:(e,t,i)=>{i.d(t,{DescriptionBlock:()=>o.DescriptionBlock,OrdInfoSection:()=>r.OrdInfoSection,PublishDateInput:()=>s.PublishDateInput});var o=i(816372),r=i(954333),s=i(635254)},954653:(e,t,i)=>{i.r(t),i.d(t,{EditClipModal:()=>r.EditClipModal,initEditClipModal:()=>o.initEditClipModal});var o=i(685648),r=i(705182)},685648:(e,t,i)=>{i.d(t,{initEditClipModal:()=>a});var o=i(474848),r=i(576950),s=i(604743),n=i(705182);const a=(e,t)=>{(0,s.showMessageBoxModal)((i=>(0,o.jsx)(r.DIRootWebProvider,{children:(0,o.jsx)(n.EditClipModal,{...i,videoFullId:e,callback:t})})),{width:495})}},525675:(e,t,i)=>{i.d(t,{EditClipModalModel:()=>d});var o=i(331635),r=i(132028),s=i(327813),n=i(632520),a=i(272880);class d{async[r.init](){await this.fetchVideo(),this.newDescription=this.video?.data.description??"",this.video?.data.published_at&&(this.newPublishDate=new Date(1e3*this.video?.data.published_at)),this.isInitialized=!0}async fetchVideo(){await this.shortVideoVideosProvider.fetch({videos:this.props.current.videoFullId},{})}get pending(){return this.shortVideoVideosProvider.isPending(this.props.current.videoFullId)||this.callbackPending}get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get description(){return this.newDescription}get isOrdEditable(){return!this.video?.data.ord_info}get ordInfo(){return this.newOrdInfo}get isPostponed(){return Boolean(this.video?.data.published_at)}get publishDate(){return this.newPublishDate}get disabledSave(){return!!this.publishDate&&(0,a.isBefore)(this.publishDate,new Date)}constructor(e,t){this.props=e,this.shortVideoVideosProvider=t,this.isInitialized=!1,this.newDescription="",this.newOrdInfo=null,this.newPublishDate=void 0,this.callbackPending=!1,this.setDescription=e=>{this.newDescription=e},this.setOrdInfo=e=>{this.newOrdInfo=e},this.setPublishDate=e=>{this.newPublishDate=e},this.save=async()=>{if(!this.video||!this.video.data.id||!this.video.data.owner_id)return;this.callbackPending=Boolean(this.props.current.callback);const e={video_id:this.video.data.id,owner_id:this.video.data.owner_id,description:this.description,publish_date:this.publishDate?Math.trunc(this.publishDate.getTime()/1e3):0};null!==this.ordInfo&&(e.ord_info=JSON.stringify(this.ordInfo)),await this.shortVideoVideosProvider.update(e,{}),await(this.props.current.callback?.({wallPostId:this.video.data.wall_post_id,ownerId:this.video.data.owner_id,description:this.description})),this.props.current.onClose()},(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Props?Object:r.Props,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider])],d)},282963:(e,t,i)=>{i.d(t,{EditClipModalProvider:()=>s,useEditClipModalModel:()=>n});var o=i(132028),r=i(525675);const{Provider:s,useModel:n}=(0,o.createProvider)(r.EditClipModalModel,{isolatedContext:!1,onlyTransient:!1})},743006:(e,t,i)=>{i.d(t,{OwnerSubscriptionErrorModal:()=>m});var o=i(474848),r=i(694244),s=i(782174),n=i(63614),a=i(908242),d=i(454154),l=i(456921),c=i(132028),u=i(604743),h=i(368821);const p=(0,l.observer)((function(){const{langs:e,owner:t,pending:i,unblacklistAndSubscribeUser:l,errorText:c,onClose:p}=(0,h.useOwnerSubscriptionErrorModel)();if(t)return(0,o.jsx)(u.MessageBoxModal,{onDestroy:p,width:560,children:({onClose:t})=>(0,o.jsxs)(r.ModalBox,{"data-testid":"clips-subscription-blacklist-error-modal",children:[(0,o.jsx)(s.ModalHeader,{onClose:t,closeAriaLabel:e.getLang("global_close"),children:e.getLang("global_warning")}),(0,o.jsx)(n.ModalBody,{insetLevel:2,children:c}),(0,o.jsx)(a.ModalFooter,{actions:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.Button,{mode:"tertiary",size:"m",onClick:t,children:e.getLang("global_cancel")}),(0,o.jsx)(d.Button,{size:"m",onClick:l,loading:i,children:e.getLang("profile_do_unban")})]})})]})})})),m=(0,c.createWidget)(h.OwnerSubscriptionErrorProvider,p)},440679:(e,t,i)=>{i.d(t,{OwnerSubscriptionErrorModal:()=>o.OwnerSubscriptionErrorModal});var o=i(743006)},5832:(e,t,i)=>{i.d(t,{OwnerSubscriptionErrorModel:()=>p});var o=i(331635),r=i(327813),s=i(132028),n=i(74605),a=i(632520),d=i(324742),l=i(712600),c=i(670252),u=i(955060),h=i(24516);class p{get video(){return this.props.current.activeClipId?this.videosProvider.get(this.props.current.activeClipId):void 0}get owner(){if(this.video&&((e=this.video.owner)&&void 0!==e.data?.sex))return this.video.owner;var e}get errorText(){return this.owner?this.langs.langReplace(this.langs.sex(this.owner.data.sex??n.BaseSexEnumNames.UNKNOWN,this.langs.getLang("profile_unban_on_action",!0)),{user:this.owner.data.first_name_acc??this.owner.name??this.owner.screenName}):""}constructor(e,t,i,o,s,n,a){this.props=e,this.langs=t,this.videosProvider=i,this.blacklist=o,this.snackbar=s,this.errorLogger=n,this.userEnv=a,this.pending=!1,this.unblacklistAndSubscribeUser=async()=>{if(this.owner){this.pending=!0;try{await this.blacklist.remove(this.owner.ownerId),await this.owner.subscribe()}catch(e){const t=this.userEnv.partConfigEnabled("video_channel_rename")?this.langs.getLang("video_clips_channel_subscribe_error_snackbar"):this.langs.getLang("video_clips_owner_subscribe_error_snackbar");this.snackbar.show({type:"error",text:t}),this.errorLogger.log(e)}finally{(0,r.runInAction)((()=>{this.pending=!1})),this.onClose()}}},this.onClose=()=>{this.props.current.onClose()},(0,r.makeAutoObservable)(this)}}p=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===l.Langs?Object:l.Langs,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===d.BlackListService?Object:d.BlackListService,void 0===c.Snackbar?Object:c.Snackbar,void 0===u.ErrorLogger?Object:u.ErrorLogger,void 0===h.UserEnv?Object:h.UserEnv])],p)},368821:(e,t,i)=>{i.d(t,{OwnerSubscriptionErrorProvider:()=>s,useOwnerSubscriptionErrorModel:()=>n});var o=i(132028),r=i(5832);const{Provider:s,useModel:n}=(0,o.createProvider)(r.OwnerSubscriptionErrorModel)},547817:(e,t,i)=>{i.d(t,{ActionButton:()=>I.ActionButton,ClipsClipActionButtonWidget:()=>P.ClipsClipActionButtonWidget,ClipsClipAuthorWidget:()=>w.ClipsClipAuthorWidget,ClipsClipDescriptionWidget:()=>E.ClipsClipDescriptionWidget,ClipsClipMetaWidget:()=>k.ClipsClipMetaWidget,ClipsFeedCommentWidget:()=>l.ClipsFeedCommentWidget,ClipsFeedDislikeWidget:()=>u.ClipsFeedDislikeWidget,ClipsFeedLikeWidget:()=>d.ClipsFeedLikeWidget,ClipsFeedMoreCopyLinkWidget:()=>p.ClipsFeedMoreCopyLinkWidget,ClipsFeedMoreDeleteWidget:()=>v.ClipsFeedMoreDeleteWidget,ClipsFeedMoreDownloadWidget:()=>_.ClipsFeedMoreDownloadWidget,ClipsFeedMoreEditWidget:()=>h.ClipsFeedMoreEditWidget,ClipsFeedMoreEridWidget:()=>C.ClipsFeedMoreEridWidget,ClipsFeedMoreOrdLabelWidget:()=>y.ClipsFeedMoreOrdLabelWidget,ClipsFeedMoreReportWidget:()=>g.ClipsFeedMoreReportWidget,ClipsFeedMoreShareWidget:()=>m.ClipsFeedMoreShareWidget,ClipsFeedShareWidget:()=>c.ClipsFeedShareWidget,ClipsModal:()=>a.ClipsModal,ClipsModalCarouselItem:()=>b.ClipsModalCarouselItem,ClipsPlayerSoundToggle:()=>s.ClipsPlayerSoundToggle,CoOwnersBox:()=>f.CoOwnersBox,CoOwnersModal:()=>f.CoOwnersModal,CommentsModal:()=>n.CommentsModal,CommentsWidget:()=>n.CommentsWidget,DeleteClipModal:()=>r.DeleteClipModal,OwnerSubscriptionErrorModal:()=>S.OwnerSubscriptionErrorModal,initEditClipModal:()=>o.initEditClipModal});var o=i(954653),r=i(290660),s=i(282359),n=i(642e3),a=i(260182),d=i(410494),l=i(430298),c=i(347072),u=i(870236),h=i(784145),p=i(641960),m=i(389080),v=i(227782),g=i(196423),_=i(425753),C=i(954383),y=i(355766),b=i(659467),I=i(94400),S=i(440679),f=i(204141),w=i(582640),E=i(205031),k=i(152186),P=i(766485)},890110:(e,t,i)=>{i.d(t,{AddToGroupAlbumModal:()=>b});var o=i(474848),r=i(296540),s=i(456921),n=i(132028),a=i(694244),d=i(782174),l=i(299494),c=i(63614),u=i(44544),h=i(604743),p=i(149333),m=i(425918),v=i(569449),g=i(215281),_=i(98114);const C=.7*window.innerHeight,y=(0,s.observer)((()=>{const{groupAlbumGroupsModel:{selectedGroupId:e},messageBoxProps:t,isInitialLoading:i,userEnv:s}=(0,m.useGroupAlbumModel)();(0,r.useEffect)((()=>{t?.refreshCoordinates()}),[i]);const{getLang:n}=(0,p.useLangs)();if(i)return(0,o.jsx)(h.MessageBoxModalLoader,{refreshCoordinates:t?.refreshCoordinates});const y=s.partConfigEnabled("video_channel_rename")?n("video_add_video_in_channel_album_modal_header"):n("video_add_video_in_group_album_modal_header"),b=s.partConfigEnabled("video_channel_rename")?n("video_add_video_in_channel_album_label_channel"):n("video_add_video_in_group_album_label_group");return(0,o.jsxs)(a.ModalBox,{width:420,"aria-label":y,children:[(0,o.jsx)(d.ModalHeader,{onClose:t.onClose,closeAriaLabel:n("global_close"),children:y}),(0,o.jsx)(l.ModalScrollView,{autoHideScrollbar:!0,maxHeight:C,children:(0,o.jsxs)(c.ModalBody,{insetLevel:1,"data-testid":"video_group_album_modal",children:[(0,o.jsx)(u.FormItem,{top:b,children:(0,o.jsx)(g.GroupSelect,{})}),e&&(0,o.jsx)(u.FormItem,{top:n("video_add_video_in_group_album_label_album"),children:(0,o.jsx)(v.PlaylistsSelect,{})})]})}),(0,o.jsx)(_.ModalActions,{})]})})),b=(0,n.createWidget)(m.GroupAlbumModelProvider,y)},215281:(e,t,i)=>{i.d(t,{GroupSelect:()=>c});var o=i(474848),r=i(296540),s=i(456921),n=i(220208),a=i(612196),d=i(149333),l=i(425918);const c=(0,s.observer)((()=>{const{groupAlbumGroupsModel:{groupsOptions:e,selectedGroupId:t,selectedGroupAvatar:i},isFormLoading:s,handleChangeSelectedGroup:c,userEnv:u}=(0,l.useGroupAlbumModel)(),{getLang:h}=(0,d.useLangs)(),p=u.partConfigEnabled("video_channel_rename")?h("video_add_video_in_channel_album_placeholder_channel"):h("video_add_video_in_group_album_placeholder_group");return(0,o.jsx)(n.Select,{"data-testid":"video_group_album_modal_group_selector",placeholder:p,options:e,value:String(t),renderOption:({option:e,...t})=>(0,r.createElement)(n.CustomSelectOption,{...t,key:String(e.value),before:(0,o.jsx)(a.Avatar,{size:20,src:e.avatar,alt:"avatar"})}),onChange:c,before:Boolean(i)&&(0,o.jsx)(a.Avatar,{size:20,src:i,alt:"selected avatar"}),disabled:s})}))},98114:(e,t,i)=>{i.d(t,{ModalActions:()=>l});var o=i(474848),r=i(456921),s=i(908242),n=i(454154),a=i(149333),d=i(425918);const l=(0,r.observer)((()=>{const{disableSaveButton:e,messageBoxProps:t,handleSubmit:i,isFormLoading:r}=(0,d.useGroupAlbumModel)(),{getLang:l}=(0,a.useLangs)();return(0,o.jsx)(s.ModalFooter,{actions:[(0,o.jsx)(n.Button,{mode:"secondary",size:"m",onClick:t.onClose,children:l("box_cancel")},1),(0,o.jsx)(n.Button,{"data-testid":"video_group_album_modal_save_button",mode:"primary",size:"m",disabled:e,onClick:i,loading:r,children:l("Save")},2)]})}))},769239:(e,t,i)=>{i.d(t,{PlaylistsSelectOption:()=>p});var o=i(474848),r=i(296540),s=i(723723),n=i(293116),a=i(220208),d=i(175278),l=i(778071),c=i(562791),u=i(425918);const h=({option:e})=>{const{userEnv:t}=(0,u.useGroupAlbumModel)();return e.isCreateOption?(0,o.jsx)(d.Icon24ListAddOutline,{className:(0,s.getColorClass)("color_icon_accent")}):t.partConfigEnabled("video_preselect_add_in_group_modal")?(0,o.jsx)(n.Image,{size:24,src:e.preview,alt:"playlist",children:e.preview?null:(0,o.jsx)(l.Icon16MenuOutline,{})}):(0,o.jsx)(n.Image,{size:24,src:e.preview,alt:"playlist",children:(0,o.jsx)(l.Icon16MenuOutline,{})})},p=({props:e,option:t})=>(0,r.createElement)(a.CustomSelectOption,{...e,key:t.value,before:(0,o.jsx)(h,{option:t}),children:[t.label,t.havePrivacy&&(0,o.jsx)(c.Icon16LockOutline,{className:(0,s.getColorClass)("color_text_secondary")})]})},569449:(e,t,i)=>{i.d(t,{PlaylistsSelect:()=>h});var o=i(474848),r=i(456921),s=i(296540),n=i(220208),a=i(149333),d=i(769239),l=i(425918),c=i(879754);const u=(e,t)=>(0,o.jsx)(d.PlaylistsSelectOption,{props:e,option:t}),h=(0,r.observer)((()=>{const{groupAlbumPlaylistsModel:{isPlaylistLoading:e,createNewPlaylist:t,selectedPlaylistChipOption:i,onChangeSelectedPlaylists:r,playlistChipOptions:d,ownerId:h},isFormLoading:p}=(0,l.useGroupAlbumModel)(),{getLang:m}=(0,a.useLangs)(),v=(0,s.useId)(),g=(0,s.useRef)(null),_=(0,s.useCallback)(((e,i)=>{h&&v&&i.value===c.CREATE_PLAYLIST_VALUE&&(e.preventDefault(),t(e),g.current?.click())}),[h,v,t]);return(0,o.jsx)(n.ChipsSelect,{"data-testid":"video_group_album_modal_album_selector",value:i,placeholder:m("video_add_video_in_group_album_placeholder_album"),options:d,onChangeStart:_,onChange:r,closeAfterSelect:!1,renderOption:u,disabled:p,fetching:e})}))},879754:(e,t,i)=>{i.d(t,{CREATE_PLAYLIST_VALUE:()=>o,GROUP_ALBUMS_LIMIT:()=>r});const o=-1,r=100},828463:(e,t,i)=>{i.d(t,{showAddToGroupAlbumModal:()=>o.showAddToGroupAlbumModal});var o=i(918389)},5669:(e,t,i)=>{i.d(t,{GroupAlbumGroupsModel:()=>s});var o=i(327813),r=i(437822);class s{get selectedGroupId(){return this._selectedGroupId}get groupsOptions(){return this.groupsItems.map((e=>({label:e.name||"",value:e.id,avatar:(0,r.getOwnerAvatar)(e)})))}get selectedGroupAvatar(){const e=this.groupsOptions.find((e=>e.value===this.selectedGroupId));return e?.avatar}getGroupByGroupId(e){return this.groupsItems.find((({id:t})=>t===e))}setSelectedGroupId(e){this._selectedGroupId=e}get groupsItems(){return this.groupsModel.groupsItems||[]}constructor(e,t){this.groupsModel=e,this.userModel=t,this.changeSelectedGroup=e=>{this.setSelectedGroupId(e);const t=this.getGroupByGroupId(e);t&&this.userModel.setCurrentUser(t)},this._selectedGroupId=null,(0,o.makeAutoObservable)(this)}}},720261:(e,t,i)=>{i.d(t,{GroupAlbumModelProvider:()=>S,useGroupAlbumModel:()=>f});var o=i(331635),r=i(327813),s=i(132028),n=i(627016),a=i(866763),d=i(476205),l=i(491318),c=i(968192),u=i(639147),h=i(349773),p=i(712600),m=i(670252),v=i(951652),g=i(24516),_=i(990305),C=i(570085),y=i(5669),b=i(505786);class I{async[s.init](){this.setInitialLoading(!0),this._abortController=new AbortController,await this.groupsModel.fetchGroups(),this.userEnv.partConfigEnabled("video_preselect_add_in_group_modal")?await this.initGroupSelect():this.initGroupSelect(),window.addEventListener(C.PlaylistFormEvents.CREATE,this.newPlaylistCreatedEventListener,{signal:this._abortController.signal}),this.setInitialLoading(!1)}[s.destroy](){this._abortController?.abort()}get isInitialLoading(){return this._isInitialLoading}get messageBoxProps(){return{onClose:this.props.current.onClose,refreshCoordinates:this.props.current.refreshCoordinates}}get isFormLoading(){return this._isFormLoading}get disableSaveButton(){return!this.groupAlbumPlaylistsModel.selectedPlaylistIds.length&&!this.groupAlbumPlaylistsModel.playlistsForRemove.length}async initGroupSelect(){this.props.current.isGroupOwner&&(await this.changeSelectedGroup(this.props.current.ownerId),this.userEnv.partConfigEnabled("video_preselect_add_in_group_modal")&&await this.groupAlbumPlaylistsModel.preselectContainingVideoPlaylists())}async changeSelectedGroup(e){this.groupAlbumGroupsModel.changeSelectedGroup(e);const{selectedGroupId:t}=this.groupAlbumGroupsModel;t&&(this.groupAlbumPlaylistsModel.onChangeSelectedPlaylists([]),await this.groupAlbumPlaylistsModel.fetchPlaylistsList(t),this.userEnv.partConfigEnabled("video_add_group_album_preselect_playlists")&&await this.groupAlbumPlaylistsModel.preselectContainingVideoPlaylists())}setFormLoading(e){this._isFormLoading=e}setInitialLoading(e){this._isInitialLoading=e}constructor(e,t,i,o,s,n,a,d,l,c,u,h){this.props=e,this.langs=t,this.snackbar=i,this.playlistsProvider=o,this.groupsService=s,this.authService=n,this.groupsStoreFactory=a,this.playlistsListService=d,this.videoPlaylistListProvider=l,this.userService=c,this.usersStoreFactory=u,this.userEnv=h,this.handleSubmit=async()=>{this.setFormLoading(!0),await this.groupAlbumPlaylistsModel.addVideoToAlbum(),this.setFormLoading(!1),this.messageBoxProps.onClose()},this.handleChangeSelectedGroup=e=>{const t=Number(e.target.value);Number.isNaN(t)||this.changeSelectedGroup(t)},this.newPlaylistCreatedEventListener=e=>{this.groupAlbumPlaylistsModel.newPlaylistCreatedEventListener(e,this.groupAlbumGroupsModel.selectedGroupId??void 0,this._abortController)},this._isInitialLoading=!1,this._isFormLoading=!1,this._abortController=void 0,this.groupsModel=new _.VideoGroupsFetchModel(this.authService,this.groupsService),this.videoGroupsStore=a.ensureByFields([]),this.userModel=new _.VideoUserFetchModel(this.props,this.userService,this.authService,this.usersStoreFactory,this.groupsModel),this.createNewPlaylistModel=new _.VideoCreateNewPlaylistModel(this.props,this.langs,this.videoPlaylistListProvider,this.playlistsListService,l.createList(),this.userModel,this.snackbar),this.groupAlbumGroupsModel=new y.GroupAlbumGroupsModel(this.groupsModel,this.userModel),this.groupAlbumPlaylistsModel=new b.GroupAlbumPlaylistsModel(this.props,this.langs,this.userModel,this.playlistsListService,this.videoPlaylistListProvider,this.createNewPlaylistModel,this.snackbar,this.userEnv),(0,r.makeAutoObservable)(this)}}I=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===p.Langs?Object:p.Langs,void 0===m.Snackbar?Object:m.Snackbar,void 0===n.VideoPlaylistsProvider?Object:n.VideoPlaylistsProvider,void 0===a.VideoGroupsFetchService?Object:a.VideoGroupsFetchService,void 0===v.AuthService?Object:v.AuthService,void 0===d.VideoGroupsStoreFactory?Object:d.VideoGroupsStoreFactory,void 0===l.VideoPlaylistsListService?Object:l.VideoPlaylistsListService,void 0===c.VideoPlaylistsListProvider?Object:c.VideoPlaylistsListProvider,void 0===u.VideoUsersFetchService?Object:u.VideoUsersFetchService,void 0===h.VideoUsersStoreFactory?Object:h.VideoUsersStoreFactory,void 0===g.UserEnv?Object:g.UserEnv])],I);const{Provider:S,useModel:f}=(0,s.createProvider)(I)},505786:(e,t,i)=>{i.d(t,{GroupAlbumPlaylistsModel:()=>c});var o=i(327813),r=i(217239),s=i(144757),n=i(857456),a=i(468073),d=i(680635),l=i(879754);class c{get ownerId(){return this.props.current.ownerId}get playlists(){return this._playlistsList?.playlists.map((e=>e.data))}get isPlaylistLoading(){return this.userEnv.partConfigEnabled("video_add_group_album_preselect_playlists")?this._playlistsList?.isLoading||this._preselectPlaylistLoading:this._playlistsList?.isLoading}get selectedPlaylistChipOption(){return this._playlistsList?this._playlistsList.playlists.filter((({data:{id:e}})=>this.selectedPlaylistIds.includes(e))).map((({data:{title:e,id:t}})=>({label:e,value:t}))):[]}get selectedPlaylistIds(){return this._selectedPlaylistIds}get playlistChipOptions(){return this.playlists?[{label:this.langs.getLang("video_create_new_playlist_btn"),value:l.CREATE_PLAYLIST_VALUE,isCreateOption:!0},...this.playlistsOptions]:[]}get playlistsForRemove(){const e=(0,r.default)(this._playlistsContainingVideo,this.playlists?.map((({id:e})=>e))||[]).filter((e=>e>0));return(0,s.default)(e,this.selectedPlaylistIds)}fetchPlaylistsList(e,t){try{const i=this.userEnv.partConfigEnabled("video_community_fix_playlist_limit")?l.GROUP_ALBUMS_LIMIT:void 0;return this._playlistsList?.fetch({groupId:e,count:i},t)}catch{(0,d.showFailSnackbar)(this.snackbar,this.langs.getLang("video_add_video_in_group_album_snackbar_fetch_playlists_fail"))}}async newPlaylistCreatedEventListener({detail:e},t,i){if(t&&await this.fetchPlaylistsList(t,i),e.id){const t={label:e.title,value:e.id};this._selectedPlaylistIds.push(t.value)}}getPlaylistPreview(e){if(!e.image?.length)return;const[t]=e.image;return t?.url}get playlistsOptions(){return this.playlists?this.playlists.map((e=>({value:e.id,label:e.title,preview:this.getPlaylistPreview(e),havePrivacy:Boolean(e.privacy)}))):[]}get currentUserId(){return this.userModel.currentUser?.id||0}get isGroup(){return this.currentUserId!==this.userModel.user?.id}get targetId(){const e=this.props.current.isGroupOwner&&this.props.current.ownerId||this.isGroup?a.Ranges.convertGroupIdToOwnerId(this.currentUserId):this.currentUserId;return this.currentUserId===this.userModel.user?.id?this.currentUserId:e}constructor(e,t,i,r,s,a,l,c){this.props=e,this.langs=t,this.userModel=i,this.playlistsListService=r,this.videoPlaylistListProvider=s,this.createNewPlaylistModel=a,this.snackbar=l,this.userEnv=c,this.preselectContainingVideoPlaylists=async()=>{try{this.userEnv.partConfigEnabled("video_add_group_album_preselect_playlists")&&(this._preselectPlaylistLoading=!0),await this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,targetId:this.targetId,extended:!0});const e=this.playlistsListService.getContainingVideoPlaylistIds(this.props.current.videoId);if(!e)return;const t=[...e].filter((e=>e>0));(0,o.runInAction)((()=>{this._playlistsContainingVideo=t}));const i=this.playlistChipOptions.filter((({value:e})=>t.includes(e)));this.onChangeSelectedPlaylists(i)}catch(e){(0,d.showFailSnackbar)(this.snackbar,this.langs.getLang("video_add_video_in_group_album_snackbar_preselect_playlists_fail"))}finally{this.userEnv.partConfigEnabled("video_add_group_album_preselect_playlists")&&(0,o.runInAction)((()=>{this._preselectPlaylistLoading=!1}))}},this.createNewPlaylist=e=>this.createNewPlaylistModel.handleCreateNewPlaylist(e,!1,!1),this.onChangeSelectedPlaylists=e=>{this._selectedPlaylistIds=e.map((({value:e})=>Number(e))).filter((e=>!Number.isNaN(e)))},this.addVideoToAlbum=async()=>{try{this.userEnv.partConfigEnabled("video_preselect_add_in_group_modal")&&await this.removeFromNotContainsAnymoreAlbums();const e=(0,n.default)(this.selectedPlaylistIds,...this._playlistsContainingVideo);if(this.userEnv.partConfigEnabled("video_preselect_add_in_group_modal")&&!e.length)return void(this.playlistsForRemove.length>0&&(0,d.showSuccessSnackbar)(this.snackbar,this.playlistsForRemove.length>1?this.langs.getLang("video_add_video_in_group_album_snackbar_remove_success_few"):this.langs.getLang("video_add_video_in_group_album_snackbar_remove_success_one")));const t=await this.playlistsListService.addToAlbum({targetId:this.targetId,videoId:this.props.current.videoId,albumIds:this.selectedPlaylistIds,ownerId:this.props.current.videoOwnerId});return(0,d.showSuccessSnackbar)(this.snackbar,this.selectedPlaylistIds.length>1?this.langs.getLang("video_add_video_in_group_album_snackbar_create_success_few"):this.langs.getLang("video_add_video_in_group_album_snackbar_create_success_one")),t}catch{(0,d.showFailSnackbar)(this.snackbar,this.langs.getLang("video_add_video_in_group_album_snackbar_create_fail"))}},this.removeFromNotContainsAnymoreAlbums=async()=>{if(this.playlistsForRemove.length)try{return this.playlistsListService.removeFromAlbum({targetId:this.targetId,videoId:this.props.current.videoId,albumIds:this.playlistsForRemove,ownerId:this.props.current.videoOwnerId})}catch(e){(0,d.showFailSnackbar)(this.snackbar,this.langs.getLang("video_add_video_in_group_album_snackbar_remove_fail"))}},this._selectedPlaylistIds=[],this._playlistsContainingVideo=[],this._preselectPlaylistLoading=!1,this._playlistsList=void 0,this._playlistsList=s.createList(),(0,o.makeAutoObservable)(this)}}},425918:(e,t,i)=>{i.d(t,{GroupAlbumModelProvider:()=>o.GroupAlbumModelProvider,useGroupAlbumModel:()=>o.useGroupAlbumModel});var o=i(720261)},918389:(e,t,i)=>{i.d(t,{showAddToGroupAlbumModal:()=>d});var o=i(474848),r=i(865708),s=i(576950),n=i(604743),a=i(890110);const d=e=>{(0,n.showMessageBoxModal)((t=>(0,o.jsx)(s.DIRootWebProvider,{children:(0,o.jsx)(r.AppRootProvider,{children:(0,o.jsx)(a.AddToGroupAlbumModal,{...e,...t})})})),{width:420})}},116064:(e,t,i)=>{i.d(t,{CommentsWidget:()=>m});var o=i(474848),r=i(456921),s=i(132028),n=i(149333),a=i(609969),d=i(815138),l=i(724244),c=i(560633),u=i(764211),h=i(195798);const p=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,u.useCommentsViewModel)();if(t.commentsBlocked&&!t.canComment)return(0,o.jsx)(c.CaptionWrapper,{children:e.getLang("video_comments_blocked_by_author")});if(t.isLoading)return(0,o.jsx)(c.CommentsSkeleton,{});if(!t.canComment&&t.isEmptyComments)return null;const i=e.numeric(t.commentsCount,e.getLang("video_view_comments_summary",!0));return(0,o.jsxs)(a.PopupProvider,{children:[(0,o.jsx)(c.CaptionWrapper,{children:(0,o.jsxs)(d.Join,{separator:(0,o.jsx)(l.InterpunctSeparator,{}),children:[i,(0,o.jsx)(c.CommentsSorting,{})]})}),t.canComment&&(0,o.jsx)(h.CommentInput,{onCreateComment:t.addComment,videoOwnerId:t.videoOwnerId,videoId:t.videoId,accessKey:t.accessKey}),(0,o.jsx)(c.CommentsList,{})]})})),m=(0,s.createWidget)(u.CommentsViewModelProvider,p)},991450:(e,t,i)=>{i.d(t,{CaptionWrapper:()=>n});var o=i(474848),r=i(303800),s=i(285056);const n=({children:e})=>(0,o.jsx)(r.Div,{paddingBottom:8,children:(0,o.jsx)(s.Caption,{level:"1",weight:"3",children:e})})},828367:(e,t,i)=>{i.d(t,{CaptionWrapper:()=>o.CaptionWrapper});var o=i(991450)},916274:(e,t,i)=>{i.d(t,{CommentItemWrapper:()=>a});var o=i(474848),r=i(456921),s=i(764211),n=i(195798);const a=(0,r.observer)((({id:e})=>{const t=(0,s.useCommentsViewModel)(),i=t.getComment(e);if(!i)return null;const r=t.pageThreadId===i.data.id,a=r&&!t.pageReplyId;return(0,o.jsx)(n.CommentItem,{comment:i,videoOwnerId:t.videoOwnerId,canComment:t.canComment,isHighlightedTemporarily:t.lastAddedItemId===e,selectedId:t.selectedCommentId,selected:t.selectedCommentId===e,videoId:t.videoId,accessKey:t.accessKey,selectedReply:e===t.repliedComment,onReplyClick:t.onReplyClick,repliedComment:t.repliedComment,moderationRights:t.moderationRights,replyId:r?t.pageReplyId:void 0,needScrollToViewport:a,onParentOwnerClick:t.onParentOwnerClick})}))},685083:(e,t,i)=>{i.d(t,{CommentItemWrapper:()=>o.CommentItemWrapper});var o=i(916274)},504562:(e,t,i)=>{i.d(t,{CommentsError:()=>d});var o=i(474848),r=i(720836),s=i(96635),n=i(454154),a=i(149333);const d=({onReload:e})=>{const t=(0,a.useLangs)();return(0,o.jsx)(r.Placeholder,{icon:(0,o.jsx)(s.Icon56IllustrationAntenna,{}),action:(0,o.jsx)(n.Button,{onClick:e,align:"center",appearance:"accent",mode:"secondary",children:t.getLang("video_goods_recognition_try_again")}),children:t.getLang("video_comments_fetch_error")})}},712210:(e,t,i)=>{i.d(t,{CommentsError:()=>o.CommentsError});var o=i(504562)},471316:(e,t,i)=>{i.d(t,{CommentsList:()=>u});var o=i(474848),r=i(456921),s=i(187460),n=i(151972),a=i(764211),d=i(712210),l=i(626579),c=i(552335);const u=(0,r.observer)((function(){const e=(0,a.useCommentsViewModel)();return e.hasError?(0,o.jsx)(d.CommentsError,{onReload:e.reFetch}):e.hasComments?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.CommentLayout,{children:[(0,o.jsx)(l.PrevCommentsLoading,{}),(0,o.jsx)(c.CommentsListOutput,{})]}),!e.isCommentsLoadedFully&&(0,o.jsx)(n.DynamicPagination,{isLoading:e.isCommentsLoading,fetchData:e.fetchMore,nextFrom:e.lastLoadedIndex})]}):null}))},552335:(e,t,i)=>{i.d(t,{CommentsListOutput:()=>a});var o=i(474848),r=i(456921),s=i(764211),n=i(685083);const a=(0,r.observer)((function(){const{ids:e}=(0,s.useCommentsViewModel)();return(0,o.jsx)(o.Fragment,{children:e.map((e=>(0,o.jsx)(n.CommentItemWrapper,{id:e},e)))})}))},626444:(e,t,i)=>{i.d(t,{CommentsList:()=>o.CommentsList});var o=i(471316)},320281:(e,t,i)=>{i.d(t,{CommentInputSkeleton:()=>d});var o=i(474848),r=i(303800),s=i(724648),n=i(157643),a=i(194528);const d=()=>(0,o.jsx)(r.Div,{spacing:12,children:(0,o.jsxs)(s.Flex,{align:"center",noWrap:!0,children:[(0,o.jsx)(n.Skeleton,{width:36,height:36,borderRadius:"50%"}),(0,o.jsx)(a.Spacing,{mode:"vertical",size:8}),(0,o.jsx)(n.Skeleton,{width:"calc(100% - 36px - 8px - 8px - 30px)",height:30,borderRadius:6}),(0,o.jsx)(a.Spacing,{mode:"vertical",size:8}),(0,o.jsx)(n.Skeleton,{width:30,height:30,borderRadius:6})]})})},235703:(e,t,i)=>{i.d(t,{CommentSkeleton:()=>d});var o=i(474848),r=i(303800),s=i(724648),n=i(157643),a=i(194528);const d=()=>(0,o.jsx)(r.Div,{spacing:12,children:(0,o.jsxs)(s.Flex,{direction:"row",children:[(0,o.jsx)(n.Skeleton,{width:32,height:32,borderRadius:"50%"}),(0,o.jsx)(a.Spacing,{mode:"vertical",size:8}),(0,o.jsxs)(s.Flex,{direction:"column",children:[(0,o.jsx)(n.Skeleton,{width:119,height:8,borderRadius:3}),(0,o.jsx)(a.Spacing,{size:3}),(0,o.jsx)(n.Skeleton,{width:218,height:12,borderRadius:4}),(0,o.jsx)(a.Spacing,{size:8}),(0,o.jsx)(n.Skeleton,{width:76,height:8,borderRadius:3})]})]})})},805898:(e,t,i)=>{i.d(t,{CommentsSkeleton:()=>u});var o=i(474848),r=i(296540),s=i(303800),n=i(724648),a=i(157643),d=i(235703),l=i(8520),c=i(320281);const u=(0,r.memo)((({amount:e=4})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Div,{mode:"vertical",spacing:12,paddingTop:8,paddingBottom:0,children:(0,o.jsx)(n.Flex,{children:(0,o.jsx)(a.Skeleton,{width:209,height:12,borderRadius:4})})}),(0,o.jsx)(c.CommentInputSkeleton,{}),(0,l.createArray)(e).map((e=>(0,o.jsx)(d.CommentSkeleton,{},e)))]})));u.displayName="CommentsSkeleton"},678883:(e,t,i)=>{i.d(t,{CommentsSkeleton:()=>o.CommentsSkeleton});var o=i(805898)},478318:(e,t,i)=>{i.d(t,{CommentsSorting:()=>u});var o=i(474848),r=i(456921),s=i(106962),n=i(8520),a=i(507852),d=i(279734),l=i(764211),c=i(251871);const u=(0,r.observer)((function(){const{sorting:e,isEmptyComments:t}=(0,l.useCommentsViewModel)(),{currentLabel:i,isEmpty:r,orders:u}=e;return r||t?null:(0,o.jsx)(a.DropdownActionSheet,{trigger:"click",content:u.map((e=>(0,o.jsx)(c.CommentsSortingItem,{order:e},e))),children:(0,o.jsxs)(d.Link,{noUnderline:!0,onClick:n.noop,children:[i,(0,o.jsx)(s.Icon12Dropdown,{})]})})}))},251871:(e,t,i)=>{i.d(t,{CommentsSortingItem:()=>d});var o=i(474848),r=i(456921),s=i(629775),n=i(507852),a=i(764211);const d=(0,r.observer)((function({order:e}){const{sorting:t,changeCommentsSorting:i}=(0,a.useCommentsViewModel)(),r=t.checkIsActive(e)?(0,o.jsx)(s.Icon20CheckAlt,{}):null;return(0,o.jsx)(n.DropdownActionSheet.Item,{after:r,onClick:()=>i(e),children:t.getLabel(e)})}))},288692:(e,t,i)=>{i.d(t,{CommentsSorting:()=>o.CommentsSorting});var o=i(478318)},723088:(e,t,i)=>{i.d(t,{EmojiInputButton:()=>v});var o=i(474848),r=i(695498),s=i(229653),n=i(516413),a=i(625528),d=i(550304),l=i(666112),c=i(364796),u=i(93120),h=i(957994),p=i(8520),m=i(675736);const v=({onEmojiInsert:e,userId:t})=>(0,o.jsx)(a.Popover,{trigger:"hover",placement:"top-end",content:(0,o.jsx)(u.PopupStickerRoot,{className:m.default.emojiKeyboardWrapper,id:r.POPUP_STICKER_CONTAINER_ID,isUseAsFullscreen:!0,position:"absolute",children:(0,o.jsx)(s.StickersEmojiKeyboard,{onEmojiInsert:e,visibleTab:n.Tab.EMOJI,onAPIRequest:h.api,userId:t,onStickerSend:p.noop})}),...c.fixVideoPlayerScrollPopover,children:(0,o.jsx)(d.CommentInput.IconButton,{children:(0,o.jsx)(l.Icon20SmileOutline,{})})},"smile")},45536:(e,t,i)=>{i.d(t,{EmojiInputButton:()=>o.EmojiInputButton});var o=i(723088)},469482:(e,t,i)=>{i.d(t,{PrevCommentsLoading:()=>d});var o=i(474848),r=i(456921),s=i(187460),n=i(149333),a=i(764211);const d=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,a.useCommentsViewModel)();return t.isCommentsPrevLoadedFully?null:(0,o.jsxs)(s.CommentLayout.Action,{onClick:t.fetchPrev,children:[e.getLang("video_page_show_previous_comments",!0)," (",t.prevCommentsCount,")"]})}))},626579:(e,t,i)=>{i.d(t,{PrevCommentsLoading:()=>o.PrevCommentsLoading});var o=i(469482)},560633:(e,t,i)=>{i.d(t,{CaptionWrapper:()=>a.CaptionWrapper,CommentsError:()=>n.CommentsError,CommentsList:()=>o.CommentsList,CommentsSkeleton:()=>s.CommentsSkeleton,CommentsSorting:()=>r.CommentsSorting,EmojiInputButton:()=>d.EmojiInputButton});i(685083);var o=i(626444),r=i(288692),s=i(678883),n=i(712210),a=i(828367),d=i(45536)},622108:(e,t,i)=>{i.d(t,{CommentsWidget:()=>o.CommentsWidget});var o=i(116064)},323312:(e,t,i)=>{i.d(t,{CommentModerationRightsModel:()=>n});var o=i(327813),r=i(695368),s=i(603025);class n{get data(){return this._data}setData(e){this._data=this.prepareData(e)}prepareData(e){return{...e,can_delete_comment_with_reason:Boolean(e.can_delete_comment_with_reason)}}async getModerationRights(){if(this.authService.userId)try{this.setData(await this.moderationProvider.getModerationRights(this.authService.userId))}catch(e){if(!(0,s.isApiError)(e)||e.error.error_code!==r.API_ERROR_METHOD)throw e}}constructor(e,t){this.authService=e,this.moderationProvider=t,this._data={can_delete_comment_with_reason:!1},(0,o.makeAutoObservable)(this),this.getModerationRights()}}},762691:(e,t,i)=>{i.d(t,{CommentSortingModel:()=>r});var o=i(327813);class r{get currentOrder(){return this._currentOrder}get currentLabel(){return this._currentOrder?this.getLabel(this._currentOrder):""}get isEmpty(){return!this._orders.length}get orders(){return this._orders}constructor(){this.changeCurrentOrder=e=>{this._currentOrder=e},this.checkIsActive=e=>e===this._currentOrder,this.getLabel=e=>this.labelsMap.get(e)??"",this.init=(e,t)=>{this._currentOrder=e,this._orders=t.map((({id:e,name:t})=>(this.labelsMap.set(e,t),e)),[])},this._currentOrder=null,this._orders=[],this.labelsMap=new Map,(0,o.makeAutoObservable)(this)}}},855735:(e,t,i)=>{i.d(t,{CommentsViewModel:()=>C});var o=i(331635),r=i(327813),s=i(132028),n=i(903653),a=i(607417),d=i(190105),l=i(866763),c=i(951652),u=i(468073),h=i(873900),p=i(323312),m=i(762691);let v=s.init,g=s.update,_=s.destroy;class C{[v](){this.fetch()}[g](){this.fetch()}[_](){clearTimeout(this.selectTimer)}get error(){return this._error}get hasError(){return Boolean(this._error)}get canComment(){return Boolean(this.props.current.canComment)}get isEmptyComments(){return!this.ids.length}get ids(){return this.commentsList.ids}get hasComments(){return this.ids.length>0}get commentsBlocked(){return Boolean(this.props.current.commentsBlocked)}get accessKey(){return this.props.current.accessKey}get commentsCount(){return this.commentsList.countAllWithAdded}get lastAddedItemId(){return this.commentsList.lastAddedItemId}get lastLoadedIndex(){return this.commentsList.offset+this.commentsList.loadedCount}get videoOwnerId(){return this.props.current.ownerId}get videoId(){return this.props.current.videoId}get isAnonymousUser(){return 0===this.authService.userId}get isLoading(){return this._isLoading}get isCommentsLoading(){return this.commentsList.isLoading}get isCommentsLoadedFully(){return this.commentsList.isLoadedFully}get isCommentsPrevLoadedFully(){return this.commentsList.isPrevLoadedFully}get moderationRights(){return this._moderationRights.data}get pageReplyId(){return this.props.current.replyId}get pageThreadId(){return this.props.current.threadId}get prevCommentsCount(){return this.commentsList.offset}async fetch(){this._isLoading=!0;try{const e={videoId:this.videoId,ownerId:this.videoOwnerId,count:C.CHUNK_SIZE,fields:C.getExtendedFields(),accessKey:this.accessKey};this.sorting.currentOrder&&(e.sort=this.sorting.currentOrder),this.props.current.threadId&&(e.startCommentId=this.props.current.threadId),await Promise.allSettled([this.commentsList.fetch(e),this.groupsService.fetch({userId:this.authService?.userId||void 0,extended:!0,filter:["admin","has_video"]})]),this.sorting.init(this.commentsList.order,this.commentsList.orderItems)}catch(e){(0,r.runInAction)((()=>{this._error=e}))}finally{(0,r.runInAction)((()=>{this._isLoading=!1}))}}selectComment(e){this.selectedCommentId=e,clearTimeout(this.selectTimer),this.selectTimer=setTimeout((()=>{this.selectedCommentId=void 0}),2e3)}static getExtendedFields(){return["photo_100","first_name_dat"]}constructor(e,t,i,o,s,n){this.props=e,this.commentsListProvider=t,this.commentsProvider=i,this.authService=o,this.moderationProvider=s,this.groupsService=n,this.sorting=new m.CommentSortingModel,this.selectedCommentId=void 0,this.repliedComment=void 0,this.addComment=e=>{this.authService.userId&&this.commentsList.addComment(e)},this.onParentOwnerClick=({reply_to_comment:e,reply_to_user:t})=>{if(t&&e){const i=(0,h.getIdentityRawId)({ownerId:t,id:e});this.selectComment(i)}},this.onReplyClick=(e,t)=>{if(!t)return;const i="is_admin"in t&&1===t.is_admin?u.Ranges.convertGroupIdToOwnerId(t.id):t.id;this.repliedComment=(0,h.getIdentityRawId)({ownerId:i,id:e})},this.changeCommentsSorting=e=>{this.sorting.changeCurrentOrder(e),this.fetch()},this.fetchPrev=async()=>{this._prevError=null;try{return this.commentsList.fetchPrev(C.CHUNK_SIZE)}catch(e){(0,r.runInAction)((()=>{this._prevError=e}))}},this.fetchMore=async()=>{this._error=null;try{return this.commentsList.fetchMore()}catch(e){(0,r.runInAction)((()=>{this._error=e}))}},this.getComment=e=>this.commentsProvider.getItem(e),this.reFetch=()=>{this._error&&this.fetch()},this._moderationRights=new p.CommentModerationRightsModel(this.authService,this.moderationProvider),this._isLoading=!1,this._error=null,this._prevError=null,this.selectTimer=void 0,this.commentsList=this.commentsListProvider.getList(this.videoId),(0,r.makeAutoObservable)(this)}}C.CHUNK_SIZE=20,C=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.VideoCommentsListProvider?Object:n.VideoCommentsListProvider,void 0===a.VideoCommentsProvider?Object:a.VideoCommentsProvider,void 0===c.AuthService?Object:c.AuthService,void 0===d.VideoModerationProvider?Object:d.VideoModerationProvider,void 0===l.VideoGroupsFetchService?Object:l.VideoGroupsFetchService])],C)},764211:(e,t,i)=>{i.d(t,{CommentsViewModelProvider:()=>s,useCommentsViewModel:()=>n});var o=i(132028),r=i(855735);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CommentsViewModel,{isolatedContext:!1,onlyTransient:!1})},927830:(e,t,i)=>{i.d(t,{mapUserOrGroupToCommentOwner:()=>n});var o=i(33305),r=i(222062),s=i(172479);const n=e=>{if(e)return{kind:(0,o.isOwnerGroup)(e)?"group":"user",is_nft:(0,r.checkOwnerIsNFT)(e),href:(0,s.getOwnerUrl)(e,"/video/@"),...e}}},233139:(e,t,i)=>{i.d(t,{CommentInput:()=>v});var o=i(474848),r=i(296540),s=i(456921),n=i(132028),a=i(8520),d=i(550304),l=i(149333),c=i(751423),u=i(200767),h=i(560633),p=i(496037);const m=(0,s.observer)((function(){const e=(0,u.useCommentInputModel)(),t=(0,l.useLangs)(),i=(0,r.useRef)(null);(0,r.useEffect)((()=>{e.inFocus&&i.current?.focus()}),[]);const s=async()=>{if(e.isSendingNotAllowed)return;await e.createComment()&&i.current&&(i.current.innerHTML="")},{handleInput:n}=(0,c.useEmoji)({inputValue:e.content,inputRef:i,onChangeInput:e.handleChange,emojiOpts:{onSend:s,onUGCStickerSend:a.noop,emojiLoadMore:a.noop,ref:"video_comment",global:!1,pickerBottomMargin:12,noStickers:!0}});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(d.CommentInput,{getRef:i,before:(0,o.jsx)(p.AvatarSelector,{}),inlineAfter:(0,o.jsx)(h.EmojiInputButton,{onEmojiInsert:e.insertEmoji,userId:e.userId}),placeholder:t.getLang("video_comment_input_placeholder"),sendDisabled:e.isSendingNotAllowed,onInput:n,onSendClick:s})})})),v=(0,n.createWidget)(u.CommentInputProvider,m)},143602:(e,t,i)=>{i.d(t,{Author:()=>a});var o=i(474848),r=i(507852),s=i(612196),n=i(511617);const a=({author:e,onSelectAuthorId:t,id:i})=>(0,o.jsx)(r.DropdownActionSheet.Item,{keepOpen:!0,onClick:()=>t(e.id),before:(0,o.jsx)(s.Avatar,{size:28,src:e?.avatar,alt:e.name}),after:i===e.id?(0,o.jsx)(n.Icon16Done,{}):null,children:e.name},e.id)},765033:(e,t,i)=>{i.d(t,{Author:()=>o.Author});var o=i(143602)},208506:(e,t,i)=>{i.d(t,{AuthorsDropdown:()=>u});var o=i(474848),r=i(456921),s=i(507852),n=i(612196),a=i(200767),d=i(366186),l=i(149333),c=i(995818);const u=(0,r.observer)((function(){const e=(0,a.useCommentInputModel)(),t=(0,l.useLangs)();return(0,o.jsx)(s.DropdownActionSheet,{width:250,trigger:"click",size:"s",onShownChange:e.onDropdownClick,content:(0,o.jsx)(c.AuthorsList,{}),children:(0,o.jsx)(n.Avatar.Overlay,{visibility:e.isListShown?"always":"on-hover",theme:"dark","aria-label":t.getLang("video_tree_comment_input_select_author"),children:(0,o.jsx)(d.Icon20Dropdown,{})})})}))},661067:(e,t,i)=>{i.d(t,{AuthorsDropdown:()=>o.AuthorsDropdown});var o=i(208506)},491002:(e,t,i)=>{i.d(t,{AuthorsList:()=>a});var o=i(474848),r=i(456921),s=i(765033),n=i(200767);const a=(0,r.observer)((function(){const e=(0,n.useCommentInputModel)();return(0,o.jsx)(o.Fragment,{children:e.listOfAuthors.map(((t,i)=>(0,o.jsx)(s.Author,{author:t,id:e.selectedAuthor?.id,onSelectAuthorId:e.onSelectAuthorId},i)))})}))},995818:(e,t,i)=>{i.d(t,{AuthorsList:()=>o.AuthorsList});var o=i(491002)},474264:(e,t,i)=>{i.d(t,{AvatarSelector:()=>c});var o=i(474848),r=i(456921),s=i(578392),n=i(550304),a=i(661067),d=i(200767),l=i(149333);const c=(0,r.observer)((function(){const e=(0,d.useCommentInputModel)(),t=(0,l.useLangs)();return e.isUserAdmin?(0,o.jsx)(s.TextTooltip,{text:e.isUserSelected?t.getLang("video_tree_comments_tooltip_from_user"):t.getLang("video_tree_comments_input_tooltip"),placement:"top",children:(0,o.jsx)(n.CommentInput.Avatar,{src:e.selectedAuthor?.avatar,children:(0,o.jsx)(a.AuthorsDropdown,{})})}):(0,o.jsx)(n.CommentInput.Avatar,{src:e?.user?.data?.photo_100})}))},99226:(e,t,i)=>{i.d(t,{AvatarSelector:()=>o.AvatarSelector});var o=i(474264)},496037:(e,t,i)=>{i.d(t,{AvatarSelector:()=>o.AvatarSelector});var o=i(99226)},348240:(e,t,i)=>{i.d(t,{CommentInput:()=>o.CommentInput});var o=i(233139)},392635:(e,t,i)=>{i.d(t,{CommentInputModel:()=>y});var o=i(331635),r=i(327813),s=i(132028),n=i(951652),a=i(712600),d=i(670252),l=i(24516),c=i(343825),u=i(349773),h=i(639147),p=i(476205),m=i(468073),v=i(820361),g=i(104386),_=i(680635);const C=["photo_100"];class y{[s.init](){this.authService.userId&&(this.usersFetchProvider.fetch({fields:C,userIds:[this.authService.userId]}),this._selectedId=this.isUserAdmin?this.groupDataById?.id:this.user?.data.id);const{replyToOwner:e}=this.props.current;e&&("first_name"in e?this.handleChange(`${e.first_name}, `):"name"in e&&this.handleChange(`${e.name}, `))}get groupId(){return m.Ranges.convertOwnerIdToGroupId(this.props.current.videoOwnerId)}get groupDataById(){return this.videoGroupsStore.getById(this.groupId)?.data}get isUserAdmin(){return 1===this.groupDataById?.is_admin}get user(){if(this.authService.userId)return this.videoUsersStore?.getById(this.authService.userId)}get groupData(){return{id:this.groupId,name:this.groupDataById?.name??"",avatar:this.groupDataById?.photo_100??""}}get userData(){return{id:this.user?.data.id??0,name:(0,v.getUserFullName)({first_name:this.user?.data.first_name,last_name:this.user?.data.last_name}),avatar:this.user?.data.photo_100??""}}get isListShown(){return this._isListShown}get selectedAuthor(){return this.listOfAuthors.find((e=>e.id===this._selectedId))}get isUserSelected(){return this.selectedAuthor?.id===this.userData.id}get listOfAuthors(){return[this.userData,this.groupData]}get contentLengthNotification(){return(0,g.getValidateLengthMessage)({value:this._content.trim(),maxLength:this.MAX_COMMENT_LENGTH,getExceededLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_exceeded",!0)),getRemainingLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_remained",!0))})}get inFocus(){return Boolean(this.props.current.inFocus)}get isPending(){return this._isPending}get isSendingNotAllowed(){return this._isPending||0===this._content.trim().length||this._content.trim().length>this.MAX_COMMENT_LENGTH}get content(){return this._content}get userId(){return this.authService.userId??0}static getExtendedFields(){return["photo_100","first_name_dat"]}constructor(e,t,i,o,s,n,a,d,l){this.props=e,this.authService=t,this.videoCommentCreationService=i,this.usersStoreFactory=o,this.usersFetchProvider=s,this.groupsStoreFactory=n,this.langs=a,this.snackbar=d,this.userEnv=l,this.handleChange=e=>{this._content=e},this.onDropdownClick=()=>{this._isListShown=!this._isListShown},this.onSelectAuthorId=e=>{this._selectedId=e},this.insertEmoji=e=>{this.handleChange(this._content+e)},this.createComment=async()=>{this._isPending=!0;try{const e=await this.videoCommentCreationService.createComment({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,message:this.content.trim(),replyToCommentId:this.props.current.replyToCommentId,fields:y.getExtendedFields(),accessKey:this.props.current.accessKey,isCommentFromGroup:this._selectedId===this.groupData.id});return e&&(this._content="",this.props.current.onCreateComment(e,this.content)),!0}catch(e){console.error(e),(0,r.runInAction)((()=>{(0,_.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_publishing_fail_message"))}))}finally{(0,r.runInAction)((()=>{this._isPending=!1}))}},this._content="",this._isPending=!1,this._selectedId=void 0,this._isListShown=!1,this.MAX_COMMENT_LENGTH=1e4,this.videoUsersStore=void 0,this.videoUsersStore=o.ensureByFields(C),this.videoGroupsStore=n.ensureByFields([]),(0,r.makeAutoObservable)(this)}}y=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.AuthService?Object:n.AuthService,void 0===c.VideoCommentCreationService?Object:c.VideoCommentCreationService,void 0===u.VideoUsersStoreFactory?Object:u.VideoUsersStoreFactory,void 0===h.VideoUsersFetchService?Object:h.VideoUsersFetchService,void 0===p.VideoGroupsStoreFactory?Object:p.VideoGroupsStoreFactory,void 0===a.Langs?Object:a.Langs,void 0===d.Snackbar?Object:d.Snackbar,void 0===l.UserEnv?Object:l.UserEnv])],y)},200767:(e,t,i)=>{i.d(t,{CommentInputProvider:()=>s,useCommentInputModel:()=>n});var o=i(132028),r=i(392635);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CommentInputModel,{isolatedContext:!1,onlyTransient:!1})},635499:(e,t,i)=>{i.d(t,{CommentItem:()=>u});var o=i(474848),r=i(456921),s=i(296540),n=i(132028),a=i(977731),d=i(506822),l=i(483232);const c=(0,r.observer)((function(){const e=(0,d.useCommentItemModel)(),t=(0,s.useRef)(null);return(0,s.useEffect)((()=>{(e.needScrollToViewport||e.selected)&&t.current?.scrollIntoView({block:"center",behavior:"smooth"})}),[e.needScrollToViewport,e.selected]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{ref:t,children:(0,o.jsx)(l.MainComment,{})}),(0,o.jsx)(l.CommentReply,{}),e.isCommentWithThread&&!e.commentDelete.isThreadDeleted&&(0,o.jsx)(a.Thread,{videoId:e.videoId,ownerId:e.videoOwnerId,canComment:e.canComment,parentComment:e.comment,accessKey:e.accessKey,moderationRights:e.moderationRights,replyId:e.replyId,isThreadShown:e.isThreadShown,onHideThread:e.hideThread,isCommentDeleted:e.commentDelete.isDeleted,isAlreadyDeleted:e.commentDelete.isAlreadyDeleted,onParentOwnerClick:e.onParentOwnerClick,selectedId:e.selectedId,selected:e.selected,selectedReply:e.selectedReply,repliedComment:e.repliedComment,onReplyClick:e.onReplyClick})]})})),u=(0,n.createWidget)(d.CommentItemProvider,c)},454222:(e,t,i)=>{i.d(t,{formatDateTime:()=>r});var o=i(406751);const r=e=>(0,o.getFormattedUpdatedTime)(e,!0)},636805:(e,t,i)=>{i.d(t,{AttachStub:()=>d});var o=i(474848),r=i(412888),s=i(723723),n=i(285056),a=i(784623);const d=({text:e})=>(0,o.jsx)("div",{className:a.default.wrap,children:(0,o.jsx)(r.TextClamp,{className:(0,s.getColorClass)("color_text_secondary"),lines:1,TypographyComponent:n.Caption,children:e})})},749972:(e,t,i)=>{i.d(t,{AttachStub:()=>o.AttachStub});var o=i(636805)},723537:(e,t,i)=>{i.d(t,{CommentActionMenu:()=>g});var o=i(474848),r=i(456921),s=i(829713),n=i(490639),a=i(485749),d=i(405816),l=i(79479),c=i(8520),u=i(149333),h=i(507852),p=i(271036),m=i(506822),v=i(364796);const g=(0,r.observer)((function(){const e=(0,m.useCommentItemModel)(),t=(0,u.useLangs)();return(0,o.jsx)(h.DropdownActionSheet,{trigger:"hover",content:(0,o.jsxs)(o.Fragment,{children:[e.commentEdit.canEdit&&(0,o.jsx)(h.DropdownActionSheet.Item,{before:(0,o.jsx)(s.Icon20WriteOutline,{}),onClick:e.commentEdit.setIsEditing,children:t.getLang("video_comment_edit")}),e.commentDelete.canDelete&&(0,o.jsx)(h.DropdownActionSheet.Item,{before:(0,o.jsx)(n.Icon20DeleteOutline,{}),onClick:e.commentDelete.delete,children:t.getLang("video_comment_delete")}),e.moderationRights.can_delete_comment_with_reason&&(0,o.jsx)(h.DropdownActionSheet.Item,{before:(0,o.jsx)(n.Icon20DeleteOutline,{}),onClick:e.commentDelete.deleteWithReason,children:t.getLang("video_comments_action_delete_with_reason")}),(0,o.jsx)(h.DropdownActionSheet.Item,{before:(0,o.jsx)(a.Icon20CopyOutline,{}),onClick:e.copyLink,children:t.getLang("video_copy_link")}),!e.isCommentOwnerVideoOwner&&(0,o.jsx)(h.DropdownActionSheet.Item,{before:(0,o.jsx)(d.Icon20ReportOutline,{}),onClick:e.reportComment,children:t.getLang("video_comment_complain")})]}),...v.fixVideoPlayerScrollPopover,children:(0,o.jsx)(p.IconButton,{label:t.getLang("video_context_menu_aria_label"),hoverMode:"opacity",activeMode:"opacity",noPadding:!0,onMouseEnter:c.noop,onMouseOut:c.noop,children:(0,o.jsx)(l.Icon16MoreHorizontal,{})})})}))},191967:(e,t,i)=>{i.d(t,{CommentActionMenu:()=>o.CommentActionMenu});var o=i(723537)},757905:(e,t,i)=>{i.d(t,{CommentEdit:()=>v});var o=i(474848),r=i(456921),s=i(296540),n=i(360020),a=i(285056),d=i(550304),l=i(149333),c=i(8520),u=i(751423),h=i(927830),p=i(506822),m=i(560633);const v=(0,r.observer)((function(){const e=(0,p.useCommentItemModel)(),t=(0,l.useLangs)();(0,s.useEffect)((()=>{e.commentEdit.setDefaultText()}),[]);const{handleInput:i}=(0,u.useEmoji)({inputValue:e.commentEdit.inputValue,inputRef:e.commentEdit.inputRef,onChangeInput:e.commentEdit.setInputValue,emojiOpts:{onSend:e.commentEdit.save,onUGCStickerSend:c.noop,emojiLoadMore:c.noop,ref:"video_comment",global:!1,pickerBottomMargin:12,noStickers:!0}});return(0,o.jsx)(n.Comment.Edit,{owner:(0,h.mapUserOrGroupToCommentOwner)(e.owner),afterOwnerName:t.getLang("video_comment_edit_label"),sendActionLabel:t.getLang("global_save"),cancelActionLabel:t.getLang("global_cancel"),deleteActionLabel:t.getLang("global_delete"),onSendClick:e.commentEdit.save,sendDisabled:e.commentEdit.isSendDisabled,onDeleteClick:e.commentDelete.delete,onCancelClick:e.commentEdit.cancelEdit,bottom:e.commentEdit.lengthWarning&&(0,o.jsx)(a.Text,{children:e.commentEdit.lengthWarning}),field:(0,o.jsx)(d.CommentInput.ContentEditable,{getRef:e.commentEdit.inputRef,onInput:i,inlineAfter:(0,o.jsx)(m.EmojiInputButton,{onEmojiInsert:e.commentEdit.insertEmoji,userId:e.currentUserId})})})}))},729498:(e,t,i)=>{i.d(t,{CommentEdit:()=>o.CommentEdit});var o=i(757905)},72305:(e,t,i)=>{i.d(t,{CommentReply:()=>d});var o=i(474848),r=i(456921),s=i(187460),n=i(506822),a=i(151278);const d=(0,r.observer)((function(){const e=(0,n.useCommentItemModel)();return e.commentReply.replyFormShown?e.isCommentWithThread?(0,o.jsx)(s.CommentLayout,{children:(0,o.jsx)(a.CommentReplyInput,{})}):(0,o.jsx)(a.CommentReplyInput,{}):null}))},491514:(e,t,i)=>{i.d(t,{CommentReply:()=>o.CommentReply});var o=i(72305)},556825:(e,t,i)=>{i.d(t,{CommentReplyInput:()=>a});var o=i(474848),r=i(456921),s=i(506822),n=i(348240);const a=(0,r.observer)((function(){const e=(0,s.useCommentItemModel)();return(0,o.jsx)(n.CommentInput,{videoOwnerId:e.videoOwnerId,videoId:e.videoId,onCreateComment:e.addCommentToThread,accessKey:e.accessKey,replyToOwner:e.commentReply.replyOwner,replyToCommentId:e.comment.id,inFocus:!0})}))},151278:(e,t,i)=>{i.d(t,{CommentReplyInput:()=>o.CommentReplyInput});var o=i(556825)},664709:(e,t,i)=>{i.d(t,{DeleteButton:()=>d});var o=i(474848),r=i(578392),s=i(271036),n=i(917919),a=i(149333);const d=({onClick:e})=>{const t=(0,a.useLangs)();return(0,o.jsx)(r.TextTooltip,{minWidth:115,placement:"top",text:t.getLang("video__tree_comments_delete_thread"),children:(0,o.jsx)(s.IconButton,{label:t.getLang("video_context_menu_aria_label"),hoverMode:"opacity",activeMode:"opacity",noPadding:!0,onClick:e,children:(0,o.jsx)(n.Icon20Cancel,{})})})}},192894:(e,t,i)=>{i.d(t,{DeleteButton:()=>o.DeleteButton});var o=i(664709)},431013:(e,t,i)=>{i.d(t,{MainComment:()=>b});var o=i(474848),r=i(456921),s=i(327813),n=i(8520),a=i(149333),d=i(424714),l=i(360020),c=i(662213),u=i(23513),h=i(506822),p=i(927830),m=i(191967),v=i(729498),g=i(454222),_=i(749972),C=i(192894),y=i(685081);const b=(0,r.observer)((function(){const e=(0,h.useCommentItemModel)(),t=(0,a.useLangs)();if(e.isCommentHidden)return null;if(e.commentEdit.isEditing)return(0,o.jsx)(v.CommentEdit,{});if(e.commentDelete.isThreadDeleted)return(0,o.jsx)(y.RestoreButton,{isParentCommentDeleted:e.commentDelete.isAlreadyDeleted,onClick:e.commentDelete.restoreThread});if(e.commentDelete.isDeleted){const i=e.commentDelete.isAlreadyDeleted?{actions:(0,o.jsx)(C.DeleteButton,{onClick:e.commentDelete.deleteThread})}:{onRestoreClick:e.commentDelete.restore,restoreActionLabel:t.getLang("video_restorecomm")};return(0,o.jsx)(d.CommentDeleted,{...i,children:t.getLang("video_comm_deleted")})}const i=e.isAttachInComment?()=>(0,o.jsx)(_.AttachStub,{text:t.getLang("video_attach_not_supported")}):()=>{};return(0,o.jsx)(l.Comment,{id:e.rawId,comment:(0,c.parseCommentProps)((0,s.toJS)(e.comment)),replyActionLabel:t.getLang("me_message_action_reply"),onReplyClick:e.canComment?e.commentReply.toggle:void 0,afterOwnerName:e.commentEdit.isCommentSaved?t.getLang("video_comment_edit_save_label"):void 0,onMoreClick:n.noop,onLikeClick:e.isAnonymousUser?void 0:e.toggleLike,likeAriaLabel:t.getLang("global_comment_like_aria_label"),dislikeAriaLabel:t.getLang("global_comment_dislike_aria_label"),formatText:u.formatCommentText,actions:e.isAnonymousUser?void 0:(0,o.jsx)(m.CommentActionMenu,{}),highlightOwnerName:e.isCommentOwnerVideoOwner,formatDateTime:g.formatDateTime,owner:(0,p.mapUserOrGroupToCommentOwner)(e.owner),parentOwner:e.parentOwnerName,renderAttachments:i,selected:e.isHighlighted,authorizedByUser:e.isCurrentUserCommentOwner,expandActionLabel:t.getLang("me_fc_expand_panel"),onParentOwnerClick:e.onParentOwnerClick,children:e.isAuthorLikeVisible?(0,o.jsx)(l.Comment.LikedByOwner,{src:e.avatar,onClick:e.comment.likes?.can_like_by_group?e.toggleAdminLike:void 0,liked:e.liked,tooltipProps:e.liked?{text:t.getLang("intro_hint_description_feed_author_liked"),placement:"top"}:void 0}):null})}))},861757:(e,t,i)=>{i.d(t,{MainComment:()=>o.MainComment});var o=i(431013)},220117:(e,t,i)=>{i.d(t,{RestoreButton:()=>u});var o=i(474848),r=i(149333),s=i(187460),n=i(724648),a=i(194528),d=i(285056),l=i(723723),c=i(454154);const u=({onClick:e,isParentCommentDeleted:t})=>{const i=(0,r.useLangs)();return(0,o.jsx)(s.CommentLayout,{children:(0,o.jsxs)(n.Flex,{noWrap:!0,align:"center",gap:"s",children:[(0,o.jsx)(a.Spacing,{size:t?54:6,mode:"vertical"}),(0,o.jsx)(d.Footnote,{className:(0,l.getColorClass)("color_text_secondary"),children:i.getLang("video_tree_comments_was_delete_thread")}),(0,o.jsx)(c.Button,{mode:"link",size:"s",onClick:e,children:i.getLang("video_restorecomm")})]})})}},685081:(e,t,i)=>{i.d(t,{RestoreButton:()=>o.RestoreButton});var o=i(220117)},483232:(e,t,i)=>{i.d(t,{CommentReply:()=>r.CommentReply,MainComment:()=>o.MainComment,RestoreButton:()=>s.RestoreButton});i(191967),i(729498);var o=i(861757),r=i(491514),s=(i(151278),i(685081))},231729:(e,t,i)=>{i.d(t,{showDeleteWithReasonForm:()=>o.showDeleteWithReasonForm});var o=i(513599)},513599:(e,t,i)=>{i.d(t,{showDeleteWithReasonForm:()=>n});var o=i(474848),r=i(604743),s=i(732340);const n=(e,t,i)=>{(0,r.showMessageBoxModal)((r=>(0,o.jsx)(s.StrikeForbidObjectForm,{...r,objectOwnerId:e,objectId:t,objectType:7,onSubmit:i})))}},931111:(e,t,i)=>{i.d(t,{CommentItem:()=>o.CommentItem});var o=i(635499)},754259:(e,t,i)=>{i.d(t,{CommentDeleteModel:()=>d});var o=i(327813),r=i(98710),s=i(680635),n=i(231729),a=i(361121);class d{get canDelete(){return Boolean(this.commentData.can_delete)}get isDeleted(){return this.props.current.comment.isDeleted}get isAlreadyDeleted(){return Boolean(this.props.current.comment.data.deleted)}get isThreadDeleted(){return this._isThreadDeleted}get commentData(){return this.props.current.comment.data}get commentRawId(){return this.props.current.comment.rawId}get videoOwnerId(){return this.props.current.videoOwnerId}constructor(e,t,i,d,l,c){this.props=e,this.commentEdit=t,this.commentsDeletingService=i,this.threadDeletingService=d,this.langs=l,this.snackbar=c,this.delete=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={commentId:this.commentRawId,ownerId:this.videoOwnerId};this.commentEdit.cancelEdit();try{await this.commentsDeletingService.delete(e,{signal:this.abortController.signal}),(0,o.runInAction)((()=>{this.abortController=null}))}catch(e){(0,o.runInAction)((()=>{(0,r.isAbortError)(e)||(0,s.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_delete_fail_message"))}))}},this.restore=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={commentId:this.commentRawId,ownerId:this.videoOwnerId};try{await this.commentsDeletingService.restore(e,{signal:this.abortController.signal}),(0,o.runInAction)((()=>{this.abortController=null}))}catch(e){(0,o.runInAction)((()=>{(0,r.isAbortError)(e)||(0,s.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_restore_fail_message"))}))}},this.deleteThread=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={threadId:(0,a.splitRawId)(this.commentRawId).itemId,ownerId:this.videoOwnerId};try{await this.threadDeletingService.delete(e,{signal:this.abortController.signal}),(0,o.runInAction)((()=>{this.abortController=null,this._isThreadDeleted=!0}))}catch(e){(0,r.isAbortError)(e)||(0,s.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_thread_delete_fail_message"))}},this.restoreThread=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={threadId:(0,a.splitRawId)(this.commentRawId).itemId,ownerId:this.videoOwnerId};try{await this.threadDeletingService.restore(e,{signal:this.abortController.signal}),(0,o.runInAction)((()=>{this.abortController=null,this._isThreadDeleted=!1}))}catch(e){(0,r.isAbortError)(e)||(0,s.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_thread_restore_fail_message"))}},this.deleteWithReason=()=>{(0,n.showDeleteWithReasonForm)(this.videoOwnerId,this.commentData.id,this.delete)},this.abortController=null,this._isThreadDeleted=!1,(0,o.makeAutoObservable)(this)}}},841738:(e,t,i)=>{i.d(t,{CommentEditModel:()=>d});var o=i(327813),r=i(296540),s=i(132028),n=i(104386),a=i(680635);class d{[s.destroy](){clearTimeout(this._timer)}get inputRef(){return this._inputRef}get canEdit(){return Boolean(this.commentData.can_edit)}get inputValue(){return this._inputValue}get isEditing(){return this._isEditing}get isCommentSaved(){return this._isCommentSaved}get isSendDisabled(){return this.isLoading||this.isEmptyValue||this.isNoChanges||this.isLimitExceeded}get lengthWarning(){return(0,n.getValidateLengthMessage)({value:this._inputValue,maxLength:this.MAX_INPUT_LENGTH,getExceededLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_exceeded",!0)),getRemainingLengthLabel:e=>this.langs.numeric(e,this.langs.getLang("video_comment_recommended_remained",!0))})}resetSavingAfter(e){this._timer=setTimeout((0,o.action)((()=>{this._isCommentSaved=!1})),e)}setDefaultText(){this.setInputValue(this.commentData.text)}get isEmptyValue(){return 0===this._inputValue.trim().length}get isNoChanges(){return this._inputValue===this.commentData.text}get isLimitExceeded(){return this._inputValue.length>this.MAX_INPUT_LENGTH}get commentData(){return this.props.current.comment.data}constructor(e,t,i){this.props=e,this.langs=t,this.snackbar=i,this.setIsEditing=()=>{this._isEditing=!0,this.setInputValue(this.commentData.text)},this.save=async()=>{const e={ownerId:this.props.current.videoOwnerId,message:this._inputValue};try{this.isLoading=!0,await this.props.current.comment.edit(e),(0,o.runInAction)((()=>{this._isCommentSaved=!0,this._isEditing=!1,this.resetSavingAfter(2e3)}))}catch(e){(0,o.runInAction)((()=>{(0,a.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_edit_fail_message"))}))}finally{(0,o.runInAction)((()=>{this.isLoading=!1}))}},this.cancelEdit=()=>{this._isEditing=!1,this.setInputValue(this.commentData.text)},this.setInputValue=e=>{this._inputValue=e},this.insertEmoji=e=>{this.setInputValue(this._inputValue+e)},this._isCommentSaved=!1,this.isLoading=!1,this._inputValue="",this._timer=void 0,this._isEditing=!1,this.MAX_INPUT_LENGTH=1e4,this._inputRef=(0,r.createRef)(),(0,o.makeAutoObservable)(this)}}},401680:(e,t,i)=>{i.d(t,{CommentItemViewModel:()=>E});var o=i(331635),r=i(327813),s=i(8520),n=i(132028),a=i(473905),d=i(172539),l=i(307951),c=i(903653),u=i(476205),h=i(951652),p=i(712600),m=i(670252),v=i(24516),g=i(110518),_=i(450846),C=i(873900),y=i(680635),b=i(841738),I=i(754259),S=i(750036),f=i(257594),w=i(927830);class E{[n.init](){this.props.current.isHighlightedTemporarily&&(this._isHighlighted=!0,this.resetSelectionAfter(2e3))}[n.destroy](){clearTimeout(this._timer)}get replyName(){return this.props.current.comment.data?.reply_to_comment!==this.props.current.comment.data?.parents_stack?.[0]?(0,w.mapUserOrGroupToCommentOwner)(this.parentOwner):void 0}get comment(){return this.props.current.comment.data}get threadIds(){return this.comment.parents_stack?.[0]?this.commentsListProvider.getList(this.comment.parents_stack[0]).ids:[]}get selected(){return this.props.current.selected}get selectedId(){return this.props.current.selectedId}get onReplyClick(){return this.props.current.onReplyClick}get selectedReply(){return this.props.current.selectedReply}get repliedComment(){return this.props.current.repliedComment}get onParentOwnerClick(){return this.props.current.onParentOwnerClick}get rawId(){return this.props.current.comment.rawId}get showRepliedCommentAuthor(){if(this.comment.reply_to_comment&&this.comment.reply_to_user&&this.threadIds.length)return this.threadIds.includes((0,C.getIdentityRawId)({id:this.comment.reply_to_comment,ownerId:this.comment.reply_to_user}))}get parentOwnerName(){const e=this.showRepliedCommentAuthor?this.replyName:void 0;return this.userEnv.partConfigEnabled("video_tree_comments_hide_author")?e:this.replyName}get owner(){return this.props.current.comment.owner?.data}get groupAvatar(){const e=Math.abs(this.props.current.videoOwnerId),t=this.videoGroupsStore.getById(e)?.data.photo_50;return t??this.videoGroupsStore.getById(e)?.data.photo_100??""}get avatar(){return this.comment.likes?.can_like_by_group?this.groupAvatar:this.owner?.photo_100??""}get currentUserId(){return this.authService.userId??0}get isHighlighted(){return this._isHighlighted||Boolean(this.selected)}get parentOwner(){return this.props.current.comment.parentOwner?.data}get videoId(){return this.props.current.videoId}get accessKey(){return this.props.current.accessKey}get canComment(){return Boolean(this.props.current.canComment)}get isCommentWithThread(){return Boolean(this.comment.thread)}get needScrollToViewport(){return Boolean(this.props.current.needScrollToViewport)}get isCommentHidden(){return this.commentDelete.isDeleted&&this.commentDelete.isAlreadyDeleted&&(!this.comment.thread||0===this.comment.thread?.count)}get isAttachInComment(){return Boolean(this.comment.attachments?.length)}get videoOwnerId(){return this.props.current.videoOwnerId}get moderationRights(){return this.props.current.moderationRights}get isCurrentUserCommentOwner(){return this.currentUserId===this.owner?.id}get isCommentOwnerVideoOwner(){return!!this.owner&&Math.abs(this.videoOwnerId)===Math.abs(this.owner.id)}get isAnonymousUser(){return!this.authService.isAuthorized}get groupLike(){return Boolean(this._groupLike)}get authorLike(){return Boolean(this._authorLike)}get liked(){return Boolean(this._groupLike||this._authorLike)}get isAuthorLikeVisible(){return Boolean(this._groupLike||this._authorLike||this._canLikeByGroup)}get replyId(){return this.props.current.replyId}get isThreadShown(){return this._isThreadShown}resetSelectionAfter(e){this._timer=setTimeout((0,r.action)((()=>{this._isHighlighted=!1})),e)}constructor(e,t,i,o,n,a,d,l,c,u){this.props=e,this.authService=t,this.commentsDeletingService=i,this.commentsReportService=o,this.threadDeletingService=n,this.langs=a,this.snackbar=d,this.commentsListProvider=l,this.groupsStoreFactory=c,this.userEnv=u,this.addCommentToThread=e=>{if(this.props.current.onAddCommentToThread)this.props.current.onAddCommentToThread(e);else{this.commentsListProvider.getList(this.comment.id).addCommentToEnd(e)}this.commentsListProvider.getList(this.videoId).incrementCommentsCount(),this._isThreadShown=!0,this.commentReply.hideField()},this.copyLink=()=>{const{videoId:e,videoOwnerId:t,accessKey:i}=this.props.current,o={id:e,owner_id:t,access_key:i},r=new URL((0,g.getVideoCopyLink)(o)),n=this.props.current.parentCommentId;n?(r.searchParams.set("thread",String(n)),r.searchParams.set("reply",String(this.comment.id))):r.searchParams.set("thread",String(this.comment.id)),(0,s.copyTextToClipboard)(r.href),(0,y.showSuccessSnackbar)(this.snackbar,this.langs.getLang("video_link_copied"))},this.toggleLike=()=>{this.props.current.comment.likes.toggleLike({ownerId:this.videoOwnerId,optimistic:!0})},this.toggleAdminLike=()=>{this._groupLike=!this._groupLike,this.props.current.comment.likes.toggleAdminLike({ownerId:this.videoOwnerId,optimistic:!0,fromGroup:1})},this.hideThread=()=>{this._isThreadShown=!1},this.reportComment=()=>{(0,_.showReportForm)("video_comment",this.videoOwnerId,this.comment.id,this.commentReport.report)},this._isHighlighted=!1,this._timer=void 0,this._groupLike=this.props.current.comment.data.likes?.group_liked,this._authorLike=this.props.current.comment.data.likes?.author_liked,this._canLikeByGroup=this.props.current.comment.data.likes?.can_like_by_group,this._isThreadShown=!1,this.commentEdit=new b.CommentEditModel(this.props,this.langs,this.snackbar),this.commentDelete=new I.CommentDeleteModel(this.props,this.commentEdit,this.commentsDeletingService,this.threadDeletingService,this.langs,this.snackbar),this.commentReport=new S.CommentReportModel(this.props,this.commentsReportService),this.commentReply=new f.CommentReplyModel(this.props.current.onReplyClick,this.comment.id,this.owner),this.videoGroupsStore=c.ensureByFields([]),(0,r.makeAutoObservable)(this),(0,r.reaction)((()=>this.selectedReply),(()=>{this.selectedReply||this.commentReply.hideField()}))}}E=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===h.AuthService?Object:h.AuthService,void 0===a.VideoCommentsDeletingService?Object:a.VideoCommentsDeletingService,void 0===d.VideoCommentsReportService?Object:d.VideoCommentsReportService,void 0===l.VideoCommentsDeletingTreadService?Object:l.VideoCommentsDeletingTreadService,void 0===p.Langs?Object:p.Langs,void 0===m.Snackbar?Object:m.Snackbar,void 0===c.VideoCommentsListProvider?Object:c.VideoCommentsListProvider,void 0===u.VideoGroupsStoreFactory?Object:u.VideoGroupsStoreFactory,void 0===v.UserEnv?Object:v.UserEnv])],E)},257594:(e,t,i)=>{i.d(t,{CommentReplyModel:()=>r});var o=i(327813);class r{get replyFormShown(){return this._replyFormShown}get replyOwner(){return this._replyOwner}setReplyOwner(e){this._replyOwner=e}constructor(e,t,i){this.onReplyClick=e,this.commentId=t,this.owner=i,this.toggle=()=>{this.onReplyClick(this.commentId,this.owner),this._replyFormShown?this.hideField():(this._replyFormShown=!0,this.owner&&this.setReplyOwner(this.owner))},this.resetReply=()=>{this.setReplyOwner(null)},this.hideField=()=>{this.resetReply(),this._replyFormShown=!1},this._replyFormShown=!1,this._replyOwner=null,(0,o.makeAutoObservable)(this)}}},750036:(e,t,i)=>{i.d(t,{CommentReportModel:()=>r});var o=i(327813);class r{constructor(e,t){this.props=e,this.commentsReportProvider=t,this.report=async e=>{const t={commentId:this.props.current.comment.rawId,ownerId:this.props.current.videoOwnerId,reason:e};try{await this.commentsReportProvider.report(t)}catch(e){throw e}},(0,o.makeAutoObservable)(this)}}},506822:(e,t,i)=>{i.d(t,{CommentItemProvider:()=>s,useCommentItemModel:()=>n});var o=i(132028),r=i(401680);const{Provider:s,useModel:n}=(0,o.createProvider)(r.CommentItemViewModel,{isolatedContext:!1,onlyTransient:!1})},393465:(e,t,i)=>{i.d(t,{Thread:()=>p});var o=i(474848),r=i(456921),s=i(187460),n=i(209808),a=i(132028),d=i(32906),l=i(125108),c=i(560633),u=i(483232);const h=(0,r.observer)((function(){const e=(0,d.useThreadViewModel)();return e.isThreadDeleted?(0,o.jsx)(u.RestoreButton,{onClick:e.restore}):(0,o.jsxs)(s.CommentLayout,{children:[e.isDeleteButtonShown&&(0,o.jsx)(l.ThreadDeleteButton,{onClick:e.delete}),(0,o.jsx)(l.ThreadCommentCount,{}),e.isThreadShown&&(0,o.jsxs)(o.Fragment,{children:[e.isPrevLoading?(0,o.jsx)(n.PanelSpinner,{}):(0,o.jsx)(l.PrevCommentsLoading,{}),(0,o.jsx)(l.ThreadList,{})]}),e.isLoading?(0,o.jsx)(n.PanelSpinner,{}):(0,o.jsxs)(o.Fragment,{children:[e.hasError&&(0,o.jsx)(c.CommentsError,{onReload:e.showThread}),e.isThreadShown&&e.isThreadLoaded&&(0,o.jsx)(l.ThreadActions,{})]})]})})),p=(0,a.createWidget)(d.ThreadViewModelProvider,h)},467117:(e,t,i)=>{i.d(t,{PrevCommentsLoading:()=>d});var o=i(474848),r=i(456921),s=i(187460),n=i(149333),a=i(32906);const d=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,a.useThreadViewModel)();return t.canShowPrevComments?(0,o.jsxs)(s.CommentLayout.Action,{onClick:t.fetchPrev,children:[e.getLang("video_page_show_previous_comments",!0)," (",t.prevCommentsCount,")"]}):null}))},642858:(e,t,i)=>{i.d(t,{PrevCommentsLoading:()=>o.PrevCommentsLoading});var o=i(467117)},517961:(e,t,i)=>{i.d(t,{ThreadActions:()=>d});var o=i(474848),r=i(456921),s=i(187460),n=i(149333),a=i(32906);const d=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,a.useThreadViewModel)();return(0,o.jsxs)(o.Fragment,{children:[t.canShowMoreComments&&(0,o.jsxs)(s.CommentLayout.Action,{onClick:t.fetchMoreComments,children:[e.getLang("me_comments_load_more")," (",t.threadRemainingCount,")"]}),(0,o.jsx)(s.CommentLayout.Hide,{onClick:t.hideThread})]})}))},934300:(e,t,i)=>{i.d(t,{ThreadActions:()=>o.ThreadActions});var o=i(517961)},480929:(e,t,i)=>{i.d(t,{ThreadCommentCount:()=>d});var o=i(474848),r=i(456921),s=i(187460),n=i(149333),a=i(32906);const d=(0,r.observer)((function(){const e=(0,n.useLangs)(),t=(0,a.useThreadViewModel)();return t.threadCommentsCount?(0,o.jsx)(s.CommentLayout.Action,{expandable:!0,expanded:t.isThreadShown,onClick:t.toggleThread,children:e.numeric(t.threadCommentsCount,e.getLang("video_replies_amount",!0))}):null}))},182938:(e,t,i)=>{i.d(t,{ThreadCommentCount:()=>o.ThreadCommentCount});var o=i(480929)},494813:(e,t,i)=>{i.d(t,{ThreadDeleteButton:()=>d});var o=i(474848),r=i(724648),s=i(194528),n=i(454154),a=i(149333);const d=({onClick:e})=>{const t=(0,a.useLangs)();return(0,o.jsxs)(r.Flex,{gap:"s",noWrap:!0,align:"center",children:[(0,o.jsx)(s.Spacing,{size:6,mode:"vertical"}),(0,o.jsx)(n.Button,{mode:"link",size:"s",onClick:e,"data-testid":"commentdeleted-restore",children:t.getLang("video_tree_comments_delete_thread")})]})}},565914:(e,t,i)=>{i.d(t,{ThreadDeleteButton:()=>o.ThreadDeleteButton});var o=i(494813)},812673:(e,t,i)=>{i.d(t,{ThreadItemWrapper:()=>a});var o=i(474848),r=i(456921),s=i(32906),n=i(931111);const a=(0,r.observer)((({id:e})=>{const t=(0,s.useThreadViewModel)(),i=t.getComment(e);if(!i)return null;const r=i.data.id===t.replyId||e===t.lastAddedItemId;return(0,o.jsx)(n.CommentItem,{comment:i,videoOwnerId:t.videoOwnerId,isHighlightedTemporarily:r||t.lastAddedItemId===e,videoId:t.videoId,accessKey:t.accessKey,canComment:t.canComment,onAddCommentToThread:t.addComment,moderationRights:t.moderationRights,needScrollToViewport:r,parentCommentId:t.parentCommentId,onParentOwnerClick:t.onParentOwnerClick,selectedId:t.selectedId,selected:t.selectedId===e,selectedReply:e===t.repliedComment,onReplyClick:t.onReplyClick,repliedComment:t.repliedComment})}))},750089:(e,t,i)=>{i.d(t,{ThreadItemWrapper:()=>o.ThreadItemWrapper});var o=i(812673)},839299:(e,t,i)=>{i.d(t,{ThreadList:()=>a});var o=i(474848),r=i(456921),s=i(32906),n=i(750089);const a=(0,r.observer)((function(){const e=(0,s.useThreadViewModel)();return e.isEmptyThread?null:e.ids.map((e=>(0,o.jsx)(n.ThreadItemWrapper,{id:e},e)))}))},385357:(e,t,i)=>{i.d(t,{ThreadList:()=>o.ThreadList});var o=i(839299)},125108:(e,t,i)=>{i.d(t,{PrevCommentsLoading:()=>n.PrevCommentsLoading,ThreadActions:()=>r.ThreadActions,ThreadCommentCount:()=>o.ThreadCommentCount,ThreadDeleteButton:()=>a.ThreadDeleteButton,ThreadList:()=>s.ThreadList});var o=i(182938),r=i(934300),s=i(385357),n=i(642858),a=i(565914)},977731:(e,t,i)=>{i.d(t,{Thread:()=>o.Thread});var o=i(393465)},864568:(e,t,i)=>{i.d(t,{ThreadViewModel:()=>m});var o=i(331635),r=i(327813),s=i(132028),n=i(903653),a=i(607417),d=i(307951),l=i(712600),c=i(670252),u=i(680635);let h=s.init,p=s.update;class m{[h](){void 0!==this.props.current.replyId&&this.showThread()}[p](){this.props.current.isThreadShown&&(this._isThreadShown=!0)}get isLoading(){return this.commentsList.isLoading}get isPrevLoading(){return this.commentsList.isPrevLoading}get error(){return this._error}get isEmptyThread(){return!this.ids.length}get selected(){return this.props.current.selected}get onReplyClick(){return this.props.current.onReplyClick}get repliedComment(){return this.props.current.repliedComment}get selectedReply(){return this.props.current.selectedReply}get selectedId(){return this.props.current.selectedId}get onParentOwnerClick(){return this.props.current.onParentOwnerClick}get hasError(){return Boolean(this._error)}get ids(){return this.commentsList.ids}get videoOwnerId(){return this.props.current.ownerId}get accessKey(){return this.props.current.accessKey}get canComment(){return Boolean(this.props.current.canComment)}get lastAddedItemId(){return this.commentsList.lastAddedItemId}get isCommentDeleted(){return Boolean(this.props.current.isCommentDeleted)}get isAlreadyDeleted(){return Boolean(this.props.current.isAlreadyDeleted)}get isDeleteButtonShown(){return Boolean(this.isCommentDeleted&&!this.isAlreadyDeleted&&!this.isThreadDeleted&&this.threadCommentsCount>0)}get videoId(){return this.props.current.videoId}get parentCommentId(){return this.props.current.parentComment.id}get isThreadLoaded(){return!this.isFirstThreadLoading}get threadCommentsCount(){return Math.max(this.parentCommentThreadCount,this.commentsList.levelCountWithAdded,this.ids.length)}get prevCommentsCount(){return Math.min(this.chunkSize,this.commentsList.offset)}get isCommentsPrevLoadedFully(){return this.commentsList.isPrevLoadedFully}get canShowMoreComments(){return this.threadRemainingCount>0}get canShowPrevComments(){return this.prevCommentsCount>0}get threadRemainingCount(){return Math.min(this.chunkSize,this.remainingCount)}get moderationRights(){return this.props.current.moderationRights}get isThreadShown(){return this._isThreadShown}get replyId(){return this.props.current.replyId}async fetchThread(){try{await this.commentsList.fetch({videoId:this.videoId,ownerId:this.videoOwnerId,count:this.chunkSize,fields:m.getExtendedFields(),commentId:this.parentCommentId,accessKey:this.accessKey,startCommentId:this.props.current.replyId}),(0,r.runInAction)((()=>{this._isThreadShown||(this._isThreadShown=!0),this.isFirstThreadLoading&&(this.isFirstThreadLoading=!1)}))}catch(e){(0,r.runInAction)((()=>{this._error=e}))}}get isThreadDeleted(){return this._isThreadDeleted}get chunkSize(){return this.isFirstThreadLoading?m.FIRST_CHUNK_SIZE:m.NEXT_CHUNK_SIZE}get remainingCount(){const{levelCount:e=0,offset:t=0,loadedCount:i}=this.commentsList;return e-t-i}get parentCommentThreadCount(){return this.props.current.parentComment.thread?.count??0}get isNewThread(){return!this.parentCommentThreadCount&&this.commentsList.levelCountWithAdded>0}static getExtendedFields(){return["photo_100","first_name_dat"]}constructor(e,t,i,o,s,n){this.props=e,this.commentsListProvider=t,this.commentsProvider=i,this.threadDeletingService=o,this.langs=s,this.snackbar=n,this.getComment=e=>this.commentsProvider.getItem(e),this.showThread=()=>{this.ids.length&&!this.isFirstThreadLoading||this.isNewThread?this._isThreadShown=!0:this.fetchThread()},this.hideThread=()=>{this._isThreadShown=!1,this.props.current.onHideThread?.()},this.addComment=e=>{this.commentsList.addCommentToEnd(e)},this.delete=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={threadId:this.parentCommentId,ownerId:this.videoOwnerId};try{await this.threadDeletingService.delete(e,{signal:this.abortController.signal}),(0,r.runInAction)((()=>{this.abortController=null,this._isThreadDeleted=!0}))}catch(e){(0,r.runInAction)((()=>{this._error=e,(0,u.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_thread_delete_fail_message"))}))}},this.restore=async()=>{this.abortController?.abort(),this.abortController=new AbortController;const e={threadId:this.parentCommentId,ownerId:this.videoOwnerId};try{await this.threadDeletingService.restore(e,{signal:this.abortController.signal}),(0,r.runInAction)((()=>{this.abortController=null,this._isThreadDeleted=!1}))}catch(e){(0,r.runInAction)((()=>{this._error=e,(0,u.showFailSnackbar)(this.snackbar,this.langs.getLang("video_comment_thread_delete_fail_message"))}))}},this.fetchMoreComments=async()=>{this._error=null;try{return this.commentsList.fetchMore(this.chunkSize)}catch(e){(0,r.runInAction)((()=>{this._error=e}))}},this.fetchPrev=async()=>{this._prevError=null;try{return this.commentsList.fetchPrev(this.chunkSize)}catch(e){(0,r.runInAction)((()=>{this._prevError=e}))}},this.toggleThread=()=>{!this.isThreadShown||this.isFirstThreadLoading&&!this.isNewThread?this.showThread():this.hideThread()},this._error=null,this._prevError=null,this._isThreadShown=!1,this.isFirstThreadLoading=!0,this._isThreadDeleted=!1,this.abortController=null,this.commentsList=this.commentsListProvider.getList(e.current.parentComment.id),(0,r.makeAutoObservable)(this)}}m.FIRST_CHUNK_SIZE=10,m.NEXT_CHUNK_SIZE=30,m=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.VideoCommentsListProvider?Object:n.VideoCommentsListProvider,void 0===a.VideoCommentsProvider?Object:a.VideoCommentsProvider,void 0===d.VideoCommentsDeletingTreadService?Object:d.VideoCommentsDeletingTreadService,void 0===l.Langs?Object:l.Langs,void 0===c.Snackbar?Object:c.Snackbar])],m)},32906:(e,t,i)=>{i.d(t,{ThreadViewModelProvider:()=>s,useThreadViewModel:()=>n});var o=i(132028),r=i(864568);const{Provider:s,useModel:n}=(0,o.createProvider)(r.ThreadViewModel)},195798:(e,t,i)=>{i.d(t,{CommentInput:()=>o.CommentInput,CommentItem:()=>r.CommentItem});var o=i(348240),r=i(931111)},569330:(e,t,i)=>{i.d(t,{PlaylistDeleteModal:()=>h});var o=i(474848),r=i(456921),s=i(454154),n=i(694244),a=i(782174),d=i(63614),l=i(908242),c=i(149333),u=i(670107);const h=(0,r.observer)((function(){const e=(0,c.useLangs)(),t=(0,u.usePlaylistDeleteModel)(),{body:i,buttons:r,title:h}=t.error?{body:e.getLang("video_playlist_deleting_error_text"),buttons:(0,o.jsx)(s.Button,{mode:"primary",size:"m",onClick:t.onClose,children:e.getLang("global_close")}),title:e.getLang("global_error")}:{body:e.getLang("video_delete_playlist_are_you_sure"),buttons:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Button,{mode:"tertiary",size:"m",onClick:t.onClose,children:e.getLang("global_cancel")}),(0,o.jsx)(s.Button,{loading:t.isLoading,mode:"primary",size:"m",onClick:t.delete,children:e.getLang("global_delete")})]}),title:e.getLang("video_delete_playlist_title")};return(0,o.jsxs)(n.ModalBox,{children:[(0,o.jsx)(a.ModalHeader,{onClose:t.onClose,closeAriaLabel:e.getLang("global_close"),children:h}),(0,o.jsx)(d.ModalBody,{insetLevel:2,children:i}),(0,o.jsx)(l.ModalFooter,{actions:r})]})}))},857034:(e,t,i)=>{i.d(t,{PlaylistDeleteModalWidget:()=>n});var o=i(132028),r=i(569330),s=i(670107);const n=(0,o.createWidget)(s.PlaylistDeleteModelProvider,r.PlaylistDeleteModal)},731956:(e,t,i)=>{i.r(t),i.d(t,{showPlaylistDeleteModal:()=>o.showPlaylistDeleteModal});var o=i(647739)},978737:(e,t,i)=>{i.d(t,{PlaylistDeleteModel:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(627016);class a{get isLoading(){return this._isLoading}get error(){return this._error}get onClose(){return this.props.current.onClose}[s.destroy](){this._abortController?.abort()}constructor(e,t){this.props=e,this.playlistsProvider=t,this.delete=async()=>{this._isLoading=!0,this._abortController?.abort(),this._abortController=new AbortController;try{await this.playlistsProvider.delete({id:this.props.current.id,ownerId:this.props.current.ownerId},{signal:this._abortController.signal}),this.props.current.onClose(),this.props.current.onDelete?.()}catch(e){(0,r.runInAction)((()=>{this._error=e}))}finally{(0,r.runInAction)((()=>{this._isLoading=!1}))}},this._abortController=null,this._isLoading=!1,this._error=null,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===n.VideoPlaylistsProvider?Object:n.VideoPlaylistsProvider])],a)},670107:(e,t,i)=>{i.d(t,{PlaylistDeleteModelProvider:()=>s,usePlaylistDeleteModel:()=>n});var o=i(132028),r=i(978737);const{Provider:s,useModel:n}=(0,o.createProvider)(r.PlaylistDeleteModel,{isolatedContext:!1,onlyTransient:!1})},647739:(e,t,i)=>{i.d(t,{showPlaylistDeleteModal:()=>a});var o=i(474848),r=i(604743),s=i(576950),n=i(857034);const a=e=>{(0,r.showMessageBoxModal)((t=>(0,o.jsx)(s.DIRootWebProvider,{children:(0,o.jsx)(n.PlaylistDeleteModalWidget,{...e,...t})})),{width:420})}},338638:(e,t,i)=>{i.d(t,{PlaylistErrorModal:()=>a});var o=i(474848),r=i(915424),s=i(454154),n=i(149333);const a=({onClose:e,error:t})=>{const i=(0,n.useLangs)(),a="type"in t&&"network_error"===t.type,d=a?i.getLang("video_playlist_popup_connection_error_header"):i.getLang("video_playlist_popup_loading_error_header"),l=a?i.getLang("video_playlist_popup_connection_error_subheader"):i.getLang("video_playlist_popup_loading_error_subheader");return(0,o.jsx)(r.ModalCardBase,{onClose:e,header:d,subheader:l,actions:(0,o.jsx)(s.Button,{size:"l",mode:"secondary",stretched:!0,onClick:()=>window.location.reload(),children:i.getLang("video_playlist_popup_error_reload_button")})})}},119823:(e,t,i)=>{i.d(t,{PlaylistErrorModal:()=>o.PlaylistErrorModal});var o=i(338638)},333106:(e,t,i)=>{i.d(t,{PlaylistModal:()=>m});var o=i(474848),r=i(456921),s=i(296540),n=i(694244),a=i(63614),d=i(132028),l=i(604743),c=i(119823),u=i(125110),h=i(260436);const p=(0,r.observer)((function(){const{error:e,resetError:t,isInfoLoading:i,props:r,privacyModel:{error:d,formModalVisibility:{isShown:p},friendsModalVisibility:{isShown:m}}}=(0,h.usePlaylistModel)();return(0,s.useEffect)((()=>{r.current.refreshCoordinates()}),[e,i,p,m]),e?(0,o.jsx)(c.PlaylistErrorModal,{error:e,onClose:d?r.current.onClose:t}):i?(0,o.jsx)(l.MessageBoxModalLoader,{refreshCoordinates:r.current.refreshCoordinates}):p?(0,o.jsx)(u.PlaylistModalPrivacyFormModal,{}):m?(0,o.jsx)(u.PlaylistModalPrivacyFriendsModal,{}):(0,o.jsxs)(n.ModalBox,{children:[(0,o.jsx)(u.PlaylistModalHeader,{}),(0,o.jsxs)(a.ModalBody,{insetLevel:1,children:[(0,o.jsx)(u.PlaylistModalTitle,{}),(0,o.jsx)(u.PlaylistModalThumbs,{}),(0,o.jsx)(u.PlaylistModalPrivacy,{})]}),(0,o.jsx)(u.PlaylistModalFooter,{})]})})),m=(0,d.createWidget)(h.PlaylistModelProvider,p)},831539:(e,t,i)=>{i.d(t,{PlaylistModalFooter:()=>l});var o=i(474848),r=i(456921),s=i(908242),n=i(454154),a=i(149333),d=i(260436);const l=(0,r.observer)((function(){const e=(0,a.useLangs)(),{handleSubmit:t,isLoading:i,props:r}=(0,d.usePlaylistModel)();return(0,o.jsx)(s.ModalFooter,{actions:[(0,o.jsx)(n.Button,{mode:"secondary",size:"m",onClick:r.current.onClose,children:e.getLang("box_cancel")},1),(0,o.jsx)(n.Button,{mode:"primary",size:"m",onClick:t,loading:i,children:e.getLang("Save")},2)]})}))},614049:(e,t,i)=>{i.d(t,{PlaylistModalFooter:()=>o.PlaylistModalFooter});var o=i(831539)},101367:(e,t,i)=>{i.d(t,{PlaylistModalHeader:()=>d});var o=i(474848),r=i(456921),s=i(782174),n=i(149333),a=i(260436);const d=(0,r.observer)((function(){const e=(0,n.useLangs)(),{props:t}=(0,a.usePlaylistModel)();return(0,o.jsx)(s.ModalHeader,{closeAriaLabel:e.getLang("box_cancel"),onClose:t.current.onClose,children:t.current.playlist?e.getLang("video_edit_playlist_title"):e.getLang("video_create_playlist_title")})}))},689451:(e,t,i)=>{i.d(t,{PlaylistModalHeader:()=>o.PlaylistModalHeader});var o=i(101367)},498615:(e,t,i)=>{i.d(t,{PlaylistModalPrivacy:()=>l});var o=i(474848),r=i(456921),s=i(149333),n=i(468073),a=i(509429),d=i(260436);const l=(0,r.observer)((function(){const e=(0,s.useLangs)(),{props:t,privacyModel:{privacy:i,setPrivacy:r,friendsModel:l,friendsListsModel:c,isProfileClosed:u,formModalVisibility:{toggleShown:h},friendsModalVisibility:{toggleShown:p}}}=(0,d.usePlaylistModel)();return n.Ranges.isGroupId(t.current.ownerId)?null:(0,o.jsx)(a.PrivacyDropdown,{placement:"right",title:e.getLang("video_playlist_settings_privacy_view"),privacy:i,setPrivacy:r,isProfileClosed:u,friends:l.friends,friendsLists:c.friendsLists,onClickExceptFriends:h,onClickSomeFriends:p,noPublicAdd:t.current.noPublicAdd})}))},378286:(e,t,i)=>{i.d(t,{PlaylistModalPrivacyFormModal:()=>a});var o=i(474848),r=i(456921),s=i(509429),n=i(260436);const a=(0,r.observer)((function(){const{privacyModel:{privacy:e,setPrivacy:t,friendsListsModel:i,friendsModel:r,isProfileClosed:a,formModalVisibility:{toggleShown:d}}}=(0,n.usePlaylistModel)();return(0,o.jsx)(s.PrivacyFormModal,{privacy:e,setPrivacy:t,friends:r.friends,friendsLists:i.friendsLists,setFriends:r.setFriends,isProfileClosed:a,onDestroy:d})}))},595509:(e,t,i)=>{i.d(t,{PlaylistModalPrivacyFriendsModal:()=>a});var o=i(474848),r=i(456921),s=i(509429),n=i(260436);const a=(0,r.observer)((function(){const{privacyModel:{privacy:e,friendsModel:t,setPrivacy:i,friendsModalVisibility:{toggleShown:r}}}=(0,n.usePlaylistModel)();return(0,o.jsx)(s.PrivacyFriendsModal,{privacy:e,setPrivacy:i,friends:t.friends,setFriends:t.setFriends,onDestroy:r})}))},92554:(e,t,i)=>{i.d(t,{PlaylistModalPrivacy:()=>o.PlaylistModalPrivacy,PlaylistModalPrivacyFormModal:()=>r.PlaylistModalPrivacyFormModal,PlaylistModalPrivacyFriendsModal:()=>s.PlaylistModalPrivacyFriendsModal});var o=i(498615),r=i(378286),s=i(595509)},616502:(e,t,i)=>{i.d(t,{PlaylistModalThumb:()=>d});var o=i(474848),r=i(456921),s=i(149333),n=i(260436),a=i(185837);const d=(0,r.observer)((function(){const e=(0,s.useLangs)(),{updateInfoModel:{canUploadThumb:t,thumbModel:{thumb:i,thumbFile:r,upload:d,resetData:l,isLoading:c,error:u}}}=(0,n.usePlaylistModel)();return t?(0,o.jsx)(a.PlaylistModalThumbBase,{top:e.getLang("video_playlist_thumb"),bottom:e.getLang("video_playlist_thumb_recomendation"),width:128,height:80,thumb:i,thumbFile:r,upload:d,resetData:l,isLoading:c,error:u}):null}))},185837:(e,t,i)=>{i.d(t,{PlaylistModalThumbBase:()=>u});var o=i(474848),r=i(296540),s=i(44544),n=i(181944),a=i(390147),d=i(149333),l=i(8520);const c=["image/jpeg","image/png","image/gif","image/heic","image/heif","image/webp"].join(","),u=({top:e,bottom:t,width:i,height:u,thumb:h,thumbFile:p,upload:m,resetData:v,isLoading:g,error:_})=>{const C=(0,d.useLangs)(),y=(0,r.useMemo)((()=>Array.isArray(h)?(0,l.getPhotoSize)(h,2*i)?.url:h),[h,i]);return(0,o.jsx)(s.FormItem,{top:e,bottom:t,children:y?(0,o.jsxs)(n.MediaAttach,{src:y,"aria-label":C.getLang("video_upload_select_thumb"),width:i,height:u,children:[(0,o.jsx)(n.MediaAttach.RemoveButton,{label:C.getLang("global_delete"),onClick:v}),_&&(0,o.jsx)(n.MediaAttach.ErrorOverlay,{"aria-label":C.getLang("global_retry_upload"),onClick:()=>{m(p)}}),g&&(0,o.jsx)(n.MediaAttach.LoadingOverlay,{})]}):(0,o.jsx)(n.MediaAttach,{"aria-label":C.getLang("video_upload_select_thumb"),inputIcon:(0,o.jsx)(a.Icon28CameraOutline,{}),accept:c,width:i,height:u,onChange:e=>{m(e[0])}})})}},780924:(e,t,i)=>{i.d(t,{PlaylistModalThumbVertical:()=>d});var o=i(474848),r=i(456921),s=i(149333),n=i(260436),a=i(185837);const d=(0,r.observer)((function(){const e=(0,s.useLangs)(),{updateInfoModel:{canUploadVerticalThumb:t,verticalThumbModel:{thumb:i,thumbFile:r,upload:d,resetData:l,isLoading:c,error:u}}}=(0,n.usePlaylistModel)();return t?(0,o.jsx)(a.PlaylistModalThumbBase,{top:e.getLang("video_playlist_vertical_thumb"),bottom:e.getLang("video_playlist_vertical_thumb_recomendation"),width:94,height:142,thumb:i,thumbFile:r,upload:d,resetData:l,isLoading:c,error:u}):null}))},240955:(e,t,i)=>{i.d(t,{PlaylistModalThumbs:()=>n});var o=i(474848),r=i(616502),s=i(780924);const n=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.PlaylistModalThumb,{}),(0,o.jsx)(s.PlaylistModalThumbVertical,{})]})},185823:(e,t,i)=>{i.d(t,{PlaylistModalThumbs:()=>o.PlaylistModalThumbs});var o=i(240955)},106123:(e,t,i)=>{i.d(t,{PlaylistModalTitle:()=>l});var o=i(474848),r=i(456921),s=i(44544),n=i(220208),a=i(149333),d=i(260436);const l=(0,r.observer)((function(){const e=(0,a.useLangs)(),{title:t,titleError:i,setTitle:r}=(0,d.usePlaylistModel)();return(0,o.jsx)(s.FormItem,{top:e.getLang("video_playlist_name_placeholder"),children:(0,o.jsx)(n.Input,{value:t,status:i?"error":"default",placeholder:e.getLang("video_create_playlist_placeholder"),onChange:e=>r(e.target.value)})})}))},442984:(e,t,i)=>{i.d(t,{PlaylistModalTitle:()=>o.PlaylistModalTitle});var o=i(106123)},125110:(e,t,i)=>{i.d(t,{PlaylistModalFooter:()=>o.PlaylistModalFooter,PlaylistModalHeader:()=>r.PlaylistModalHeader,PlaylistModalPrivacy:()=>s.PlaylistModalPrivacy,PlaylistModalPrivacyFormModal:()=>s.PlaylistModalPrivacyFormModal,PlaylistModalPrivacyFriendsModal:()=>s.PlaylistModalPrivacyFriendsModal,PlaylistModalThumbs:()=>n.PlaylistModalThumbs,PlaylistModalTitle:()=>a.PlaylistModalTitle});var o=i(614049),r=i(689451),s=i(92554),n=i(185823),a=i(442984)},570085:(e,t,i)=>{i.d(t,{PlaylistFormEvents:()=>o.PlaylistFormEvents,PlaylistModal:()=>r.PlaylistModal,showPlaylistModal:()=>s.showPlaylistModal});var o=i(260436),r=i(333106),s=i(236707)},505539:(e,t,i)=>{i.d(t,{PlaylistModalVisibility:()=>r});var o=i(327813);class r{get isShown(){return this.value}constructor(e=!1){this.value=e,this.toggleShown=()=>{this.value=!this.value},(0,o.makeAutoObservable)(this)}}},646879:(e,t,i)=>{i.d(t,{PlaylistModel:()=>S});var o=i(331635),r=i(327813),s=i(132028),n=i(639370),a=i(301250),d=i(3969),l=i(891999),c=i(479804),u=i(263349),h=i(712600),p=i(670252),m=i(882044),v=i(951652),g=i(873900),_=i(680635),C=i(285947),y=i(958865),b=i(176528),I=i(451857);class S{get title(){return this._title}get titleError(){return this._titleError}get error(){return this._error||this.privacyModel.error}get isLoading(){return Boolean(this._abortController)}get isInfoLoading(){return this.updateInfoModel.isLoading||this.privacyModel.isLoading}[s.init](){this.updateInfoModel.fetchInfo(),this.privacyModel.fetchPrivacy()}[s.destroy](){this._abortController?.abort(),this.privacyModel.dispose(),this.updateInfoModel.dispose()}validateTitle(){""===this._title.trim()&&(this._titleError=!0)}constructor(e,t,i,o,s,a,d,l,c,u){this.langs=e,this.snackbar=t,this.videoApi=i,this.authService=o,this.friendsService=s,this.friendsListsProvider=a,this.usersProvider=d,this.playlistCreationService=l,this.thumbService=c,this.props=u,this.updateInfoModel=new b.PlaylistUpdateInfoModel(this.videoApi,this.thumbService,this.props.current),this.privacyModel=new y.PlaylistPrivacyModel(this.authService,this.friendsService,this.friendsListsProvider,this.usersProvider,this.props.current),this.setTitle=e=>{this._titleError=!1,this._title=e},this.resetError=()=>{this._error=null},this.createPlaylist=async()=>{if(this.validateTitle(),this._titleError)return;this._abortController?.abort(),this._abortController=new AbortController;const e=(0,r.toJS)(this.updateInfoModel.thumbModel.uploadedThumb),t=(0,r.toJS)(this.updateInfoModel.verticalThumbModel.uploadedThumb),i={ownerId:this._ownerId,title:this._title,privacy:(0,r.toJS)(this.privacyModel.privacy)??void 0};e&&(i.photoId=e.photo_id,i.photoHash=e.photo_hash),t&&(i.verticalPhotoTag=t.vertical_photo_tag,i.verticalPhotoHash=t.vertical_photo_hash);try{const{album_id:e}=await this.playlistCreationService.create(i,{signal:this._abortController.signal});return!1!==this.props.current.hasOnCreateSnackbar&&(0,C.showCreateSnackbar)(this.snackbar,{text:this.langs.getLang("video_playlist_created_notification"),action:{label:this.langs.getLang("video_open_new_playlist"),href:(0,_.getPlaylistUrl)((0,g.getIdentityRawId)({ownerId:this._ownerId,id:e}))}}),window.dispatchEvent(new CustomEvent(I.PlaylistFormEvents.CREATE,{detail:{id:e,ownerId:i.ownerId,title:i.title,privacy:i.privacy}})),e}catch(e){(0,r.runInAction)((()=>{this._error=e}))}finally{(0,r.runInAction)((()=>{this._abortController=null}))}},this.handleSubmitCreate=async()=>{const e=await this.createPlaylist();e&&(this.props.current.onClose(),this.props.current.onCreate?.({id:e,title:this.title}))},this.editPlaylist=async()=>{if(this.validateTitle(),!this._playlist||this._titleError)return;this._abortController?.abort(),this._abortController=new AbortController;const e=(0,r.toJS)(this.updateInfoModel.thumbModel.uploadedThumb),t=(0,r.toJS)(this.updateInfoModel.verticalThumbModel.uploadedThumb),i={ownerId:this._ownerId,itemId:this._playlist.data.id,title:this._title,privacy:(0,r.toJS)(this.privacyModel.privacy)??void 0};e?(i.photoId=e.photo_id,i.photoHash=e.photo_hash):null===e&&(i.photoId=0),t?(i.verticalPhotoTag=t.vertical_photo_tag,i.verticalPhotoHash=t.vertical_photo_hash):null===t&&(i.verticalPhotoTag="");try{await this._playlist.edit(i,{signal:this._abortController.signal}),window.dispatchEvent(new CustomEvent(I.PlaylistFormEvents.UPDATE,{detail:{id:i.itemId,ownerId:i.ownerId,title:i.title,privacy:i.privacy}}))}catch(e){return void(0,r.runInAction)((()=>{this._error=e}))}finally{(0,r.runInAction)((()=>{this._abortController=null}))}return!0},this.handleSubmitEdit=async()=>{if(await this.editPlaylist()){this.props.current.onClose();const e=this.updateInfoModel.thumbModel.uploadedThumb?.image;this.props.current.onEdit?.({title:this.title,image:e?(0,r.toJS)(e):void 0,privacy:this.privacyModel.privacy?(0,r.toJS)(this.privacyModel.privacy):void 0})}},this.handleSubmit=async()=>{await(this.props.current.playlist?this.handleSubmitEdit():this.handleSubmitCreate())},this._abortController=null,this._title="",this._titleError=!1,this._error=null,this._ownerId=u.current.ownerId,u.current.playlist&&(this._playlist=new n.VideoPlaylist(u.current.playlist,i),this._title=u.current.playlist.title),(0,r.makeAutoObservable)(this)}}S=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===h.Langs?Object:h.Langs,void 0===p.Snackbar?Object:p.Snackbar,void 0===m.VideoApi?Object:m.VideoApi,void 0===v.AuthService?Object:v.AuthService,void 0===a.FriendsService?Object:a.FriendsService,void 0===d.FriendsListsListsProvider?Object:d.FriendsListsListsProvider,void 0===l.UsersProvider?Object:l.UsersProvider,void 0===c.VideoPlaylistCreationService?Object:c.VideoPlaylistCreationService,void 0===u.VideoPlaylistThumbService?Object:u.VideoPlaylistThumbService,void 0===s.Props?Object:s.Props])],S)},958865:(e,t,i)=>{i.d(t,{PlaylistPrivacyModel:()=>a});var o=i(327813),r=i(468073),s=i(509429),n=i(505539);class a{get privacy(){return this._privacy}get isProfileClosed(){return this._isProfileClosed}get isLoading(){return Boolean(this._abortController)||this.friendsModel.isLoading||this.friendsListsModel.isLoading}get error(){return this._error}dispose(){this._abortController?.abort(),this.friendsModel.dispose(),this.friendsListsModel.dispose()}fetchPrivacy(){const{ownerId:e}=this.props;this.authService.userId&&!r.Ranges.isGroupId(e)&&(this.fetchUser(),this.fetchPrivacyFriends(),this.friendsListsModel.fetch())}setDefaultPrivacy(){this._privacy||(this._isProfileClosed?this._privacy={category:s.SETTINGS_PRIVACY_FRIENDS}:this.props?.noPublicAdd?this._privacy={category:s.SETTINGS_PRIVACY_ONLY_ME}:this._privacy={category:s.SETTINGS_PRIVACY_ALL})}async fetchUser(){const e=this.authService.userId;if(e){this._abortController?.abort(),this._abortController=new AbortController;try{const t=await this.usersProvider.fetchUsersByIds({userIds:[e]},{signal:this._abortController.signal});(0,o.runInAction)((()=>{t.length?(this._isProfileClosed=Boolean(t[0].is_closed),this.setDefaultPrivacy()):this._error=Error("Couldn't fetch current user")}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}}async fetchPrivacyFriends(){if(!this._privacy?.owners)return;const e=[...this._privacy.owners.excluded||[],...this._privacy.owners.allowed||[]];await this.friendsModel.fetch(e)}constructor(e,t,i,r,a){this.authService=e,this.friendsService=t,this.friendsListsProvider=i,this.usersProvider=r,this.props=a,this.friendsModel=new s.PrivacyFriendsModel(this.usersProvider),this.friendsListsModel=new s.PrivacyFriendsListsModel(this.authService,this.friendsService,this.friendsListsProvider),this.formModalVisibility=new n.PlaylistModalVisibility,this.friendsModalVisibility=new n.PlaylistModalVisibility,this.setPrivacy=e=>{this._privacy=e},this._abortController=null,this._isProfileClosed=!1,this._privacy=null,this._error=null,this.props.playlist?.privacy&&(this._privacy=this.props.playlist.privacy),(0,o.makeAutoObservable)(this)}}},77074:(e,t,i)=>{i.d(t,{PlaylistThumbAdditionalModel:()=>r});var o=i(327813);class r{get uploadedThumb(){return this._uploadedThumb}get thumbFile(){return this._thumbFile}get thumb(){return this._uploadedThumb?this._uploadedThumb.thumb_url:this._thumbFile?URL.createObjectURL(this._thumbFile):this._playlistThumb}get error(){return this._error}get isLoading(){return Boolean(this._abortController)}setPlaylistThumb(e){this._playlistThumb=e}dispose(){this._abortController?.abort()}constructor(e,t){this.thumbService=e,this.props=t,this.resetData=()=>{this.dispose(),this._abortController=null,this._error=null,this._playlistThumb=null,this._thumbFile=null,this._uploadedThumb=null},this.upload=async e=>{if(e&&e.type.match(/^image\//)){this._thumbFile=e,this._abortController?.abort(),this._abortController=new AbortController,this._error=null;try{const t=await this.thumbService.uploadAdditional(e,{ownerId:this.props.ownerId},{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._uploadedThumb=t,this._thumbFile=null}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}else this._thumbFile=null},this._abortController=null,this._error=null,this._thumbFile=null,this._playlistThumb=null,this._uploadedThumb=void 0,(0,o.makeAutoObservable)(this)}}},427901:(e,t,i)=>{i.d(t,{PlaylistThumbModel:()=>r});var o=i(327813);class r{get uploadedThumb(){return this._uploadedThumb}get thumbFile(){return this._thumbFile}get thumb(){return this._uploadedThumb?this._uploadedThumb.image:this._thumbFile?URL.createObjectURL(this._thumbFile):this._playlistThumbs}get error(){return this._error}get isLoading(){return Boolean(this._abortController)}setPlaylistThumbs(e){this._playlistThumbs=e}dispose(){this._abortController?.abort()}constructor(e,t){this.thumbService=e,this.props=t,this.resetData=()=>{this.dispose(),this._abortController=null,this._error=null,this._playlistThumbs=null,this._thumbFile=null,this._uploadedThumb=null},this.upload=async e=>{if(e&&e.type.match(/^image\//)){this._thumbFile=e,this._abortController?.abort(),this._abortController=new AbortController,this._error=null;try{const t=await this.thumbService.upload(e,{ownerId:this.props.ownerId},{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._uploadedThumb=t,this._thumbFile=null}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}else this._thumbFile=null},this._abortController=null,this._error=null,this._thumbFile=null,this._playlistThumbs=null,this._uploadedThumb=void 0,(0,o.makeAutoObservable)(this)}}},176528:(e,t,i)=>{i.d(t,{PlaylistUpdateInfoModel:()=>n});var o=i(327813),r=i(427901),s=i(77074);class n{get error(){return this._error}get isLoading(){return Boolean(this._abortController)}get canUploadThumb(){return this._canUploadThumb}get canUploadVerticalThumb(){return this._canUploadVerticalThumb}dispose(){this._abortController?.abort(),this.thumbModel.dispose(),this.verticalThumbModel.dispose()}async fetchInfo(){this._abortController?.abort(),this._abortController=new AbortController;const e={owner_id:this.props.ownerId};this.props.playlist&&(e.playlist_id=this.props.playlist.id);try{const t=await this.videoApi.getPlaylistUpdateInfo(e,{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._canUploadThumb=t.can_upload_thumb,this._canUploadVerticalThumb=t.can_upload_vertical_thumb,t.has_custom_thumb&&(this.thumbModel.setPlaylistThumbs(this.props.playlist?.image),this.verticalThumbModel.setPlaylistThumb(this.props.playlist?.vertical_image))}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}constructor(e,t,i){this.videoApi=e,this.thumbService=t,this.props=i,this.thumbModel=new r.PlaylistThumbModel(this.thumbService,this.props),this.verticalThumbModel=new s.PlaylistThumbAdditionalModel(this.thumbService,this.props),this._abortController=null,this._error=null,this._canUploadThumb=!1,this._canUploadVerticalThumb=!1,(0,o.makeAutoObservable)(this)}}},451857:(e,t,i)=>{i.d(t,{PlaylistFormEvents:()=>o});const o={CREATE:"PlaylistFormEvents/CREATE",UPDATE:"PlaylistFormEvents/UPDATE",DELETE:"PlaylistFormEvents/DELETE"}},260436:(e,t,i)=>{i.d(t,{PlaylistFormEvents:()=>s.PlaylistFormEvents,PlaylistModelProvider:()=>n,usePlaylistModel:()=>a});var o=i(132028),r=i(646879),s=i(451857);const{Provider:n,useModel:a}=(0,o.createProvider)(r.PlaylistModel)},236707:(e,t,i)=>{i.d(t,{showPlaylistModal:()=>a});var o=i(474848),r=i(604743),s=i(576950),n=i(333106);const a=e=>{(0,r.showMessageBoxModal)((t=>(0,o.jsx)(s.DIRootWebProvider,{children:(0,o.jsx)(n.PlaylistModal,{...e,...t})})),{width:420,onDestroy:e.onClose})}},285947:(e,t,i)=>{i.d(t,{showCreateSnackbar:()=>o.showCreateSnackbar});var o=i(574803)},574803:(e,t,i)=>{i.d(t,{showCreateSnackbar:()=>s});var o=i(474848),r=i(818515);const s=(e,t)=>{e.show({before:{content:(0,o.jsx)(r.Icon28ListCheckOutline,{})},...t})}},779060:(e,t,i)=>{i.d(t,{SubscriptionsActualizationModal:()=>_});var o=i(474848),r=i(296540),s=i(456921),n=i(132028),a=i(694244),d=i(299494),l=i(63614),c=i(303800),u=i(604743),h=i(667906),p=i(661602),m=i(835312);const v=.7*window.innerHeight,g=(0,s.observer)((()=>{const{props:e,isInitialLoading:t,shouldHideFooter:i}=(0,m.useSubscriptionsActualizationAuthorsModel)();return(0,r.useEffect)((()=>{e.current?.refreshCoordinates()}),[t]),(0,h.useModalStats)(),t?(0,o.jsx)(u.MessageBoxModalLoader,{refreshCoordinates:e.current?.refreshCoordinates}):(0,o.jsxs)(a.ModalBox,{width:640,children:[(0,o.jsx)(p.Header,{}),(0,o.jsx)(p.Errors,{}),(0,o.jsx)(d.ModalScrollView,{autoHideScrollbar:!0,maxHeight:v,children:(0,o.jsx)(l.ModalBody,{insetLevel:0,children:(0,o.jsx)(c.Div,{mode:"vertical",paddingTop:12,paddingBottom:12,spacing:4,children:(0,o.jsx)(p.ActualizationCatalog,{})})})}),!i&&(0,o.jsx)(p.Footer,{})]})})),_=(0,n.createWidget)(m.SubscriptionsActualizationAuthorsModelProvider,g)},236011:(e,t,i)=>{i.d(t,{ActualizationCatalog:()=>d});var o=i(474848),r=i(456921),s=i(839614),n=i(349371),a=i(835312);const d=(0,r.observer)((()=>{const{section:e}=(0,a.useSubscriptionsActualizationAuthorsModel)();return(0,o.jsx)(s.CatalogSearchWidget,{section:e,blockLayoutResolver:n.blockLayoutResolver})}))},309692:(e,t,i)=>{i.d(t,{AuthorItem:()=>C});var o=i(474848),r=i(456921),s=i(839614),n=i(363046),a=i(303800),d=i(260546),l=i(724648),c=i(330414),u=i(751268),h=i(412888),p=i(285056),m=i(446327),v=i(835312),g=i(392618);const _=(0,r.observer)((({item:e})=>{const{id:t,name:i,is_video_subscription_hidden:r,members_count:s}=e,{formState:_,isInitialActualization:C}=(0,v.useSubscriptionsActualizationAuthorsModel)(),y=((0,m.isRetina)()?e.photo_200:e.photo_100)||"",b=(0,g.useMembersCount)(s),I=C||r;return(0,o.jsx)(a.Div,{mode:"vertical",paddingTop:4,paddingBottom:4,spacing:8,children:(0,o.jsx)(d.SimpleCell,{before:(0,o.jsxs)(l.Flex,{align:"center",gap:16,noWrap:!0,children:[(0,o.jsx)(c.Cell.Checkbox,{type:"circle",checked:_.checkToggled(t,I),readOnly:!0}),(0,o.jsx)(u.RichAvatar,{src:y,size:48,alt:"Avatar"})]}),subtitle:b?(0,o.jsx)(h.TextClamp,{TypographyComponent:p.Footnote,lines:1,title:b,children:b}):void 0,onClick:e=>{(0,n.cancelEvent)(e),_.toggleId(t,I)},children:i},t)})})),C=(0,s.withCatalogStore)(_)},642213:(e,t,i)=>{i.d(t,{Errors:()=>l});var o=i(474848),r=i(456921),s=i(303800),n=i(836422),a=i(149333),d=i(835312);const l=(0,r.observer)((()=>{const e=(0,a.useLangs)(),{submitError:t}=(0,d.useSubscriptionsActualizationAuthorsModel)();return t?(0,o.jsx)(s.Div,{mode:"horizontal",spacing:12,children:(0,o.jsx)(n.FormStatus,{header:e.getLang("video_subscriptions_actualization_modal_save_error"),mode:"error"})}):null}))},506537:(e,t,i)=>{i.d(t,{Footer:()=>u});var o=i(474848),r=i(456921),s=i(908242),n=i(454154),a=i(149333),d=i(517401),l=i(70515),c=i(835312);const u=(0,r.observer)((()=>{const e=(0,a.useLangs)(),{close:t,save:i,formState:r,isLoading:u,selectedAuthorsCount:h,userEnv:p}=(0,c.useSubscriptionsActualizationAuthorsModel)(),m=p.partConfigEnabled("video_channel_rename")?e.getLang("video_channel_subscriptions_actualization_modal_save",!0):e.getLang("video_subscriptions_actualization_modal_save",!0);return(0,o.jsx)(s.ModalFooter,{actions:[(0,o.jsx)(n.Button,{onClick:t,mode:"secondary",children:e.getLang("video_subscriptions_actualization_modal_close")},"close"),(0,o.jsx)(n.Button,{onClick:()=>{const e=l.ClickProductionStatEventTypes.TYPE_VIDEO_SUBSCRIPTIONS_SELECT_CREATORS_CLICK,t={type:e,[e]:{event_type:d.VideoSubscriptionsClickEventTypes.EVENT_TYPE_CLICK_TO_SELECT_CREATORS_CONFIRM,selected_count:h}};d.videoSubscriptionsClickStatsCollector.logEvent(t),i()},disabled:!r.isDirty||u,loading:u,children:e.numeric(h,m)},"save")]})}))},247515:(e,t,i)=>{i.d(t,{Header:()=>d});var o=i(474848),r=i(456921),s=i(149333),n=i(784434),a=i(835312);const d=(0,r.observer)((()=>{const e=(0,s.useLangs)(),{title:t,close:i}=(0,a.useSubscriptionsActualizationAuthorsModel)();return(0,o.jsx)(n.ModalHeaderHero,{onClose:i,closeAriaLabel:e.getLang("video_subscriptions_actualization_modal_close"),children:t})}))},547969:(e,t,i)=>{i.d(t,{Placeholder:()=>h});var o=i(474848),r=i(296540),s=i(839614),n=i(8520),a=i(720836),d=i(293116),l=i(279734),c=i(454154),u=i(412888);const h=(0,s.withCatalogStore)((({item:e})=>{const{id:t,title:i,text:s,icons:h,buttons:p}=e,m=(0,r.useMemo)((()=>h&&(0,n.getPhotoSize)(h,100*window.devicePixelRatio)),[h]),v=p?.[0];return(0,o.jsx)(a.Placeholder,{header:i,icon:m&&(0,o.jsx)(d.Image,{alt:i,src:m.url,size:100,withTransparentBackground:!0,noBorder:!0}),action:v&&(0,o.jsx)(l.Link,{href:v.action?.url,children:(0,o.jsx)(c.Button,{size:"m",children:v.title})}),children:s&&(0,o.jsx)(u.TextClamp,{lines:0,preserveWhitespaces:!0,children:s})},t)}))},661602:(e,t,i)=>{i.d(t,{ActualizationCatalog:()=>o.ActualizationCatalog,AuthorItem:()=>n.AuthorItem,Errors:()=>a.Errors,Footer:()=>s.Footer,Header:()=>r.Header,Placeholder:()=>d.Placeholder});var o=i(236011),r=i(247515),s=i(506537),n=i(309692),a=i(642213),d=i(547969)},349371:(e,t,i)=>{i.d(t,{blockLayoutResolver:()=>o.blockLayoutResolver});var o=i(120007)},120007:(e,t,i)=>{i.d(t,{blockLayoutResolver:()=>u});var o=i(474848),r=i(456921),s=i(839614),n=i(506195),a=i(661602);const d=(0,s.withCatalogBlock)(n.StackedList,{horizontalPaddingByDataType:{search_authors:0},verticalPaddingByDataType:{search_authors:0},spacingByDataType:{search_authors:0},columnsByDataType:{search_authors:2}},(e=>"search_authors"===e.data.data_type?a.AuthorItem:null)),l=(0,r.observer)((function({block:e,items:t,ItemComponent:i}){return t?.map(((t,r)=>(0,o.jsx)(i,{...t,index:r,block:e},t.id)))})),c=(0,s.withCatalogBlock)(l,{},(e=>"placeholder"===e.data.data_type?a.Placeholder:null)),u=e=>{switch(e.data.layout.name){case"large_list":return d;case"placeholder":return c;default:return()=>null}}},392618:(e,t,i)=>{i.d(t,{useMembersCount:()=>r});var o=i(149333);function r(e){const t=(0,o.useLangs)();if(!e)return"";if(e<1e3)return t.numeric(e,t.getLang("video_author_subscribers_counter",!0));return`${new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).formatToParts(e).map((e=>e.value)).join("")} ${t.getLang("video_author_subscribers")}`}},667906:(e,t,i)=>{i.d(t,{useModalStats:()=>o.useModalStats});var o=i(85629)},85629:(e,t,i)=>{i.d(t,{useModalStats:()=>a});var o=i(296540),r=i(517401),s=i(220503),n=i(835312);function a(){const{props:e,formState:t}=(0,n.useSubscriptionsActualizationAuthorsModel)();(0,o.useEffect)((()=>{const i=e.current?.sectionId,o=e.current?.screen||(0,s.getCurrentScreen)()||"video_catalog";return r.videoSubscriptionsSelectCreatorsNavCollector.logOpenEvent(i,o),()=>{r.videoSubscriptionsSelectCreatorsNavCollector.logCloseEvent(i,o,t.isConfirmed)}}),[])}},766169:(e,t,i)=>{i.d(t,{showSubscriptionsActualizationModal:()=>o.showSubscriptionsActualizationModal});var o=i(525829)},76757:(e,t,i)=>{i.d(t,{SubscriptionsActualizationAuthorsModelProvider:()=>g,useSubscriptionsActualizationAuthorsModel:()=>_});var o=i(331635),r=i(327813),s=i(132028),n=i(712600),a=i(670252),d=i(24516),l=i(67552),c=i(298593),u=i(468073),h=i(708370),p=i(195604),m=i(651462);class v{get isInitialActualization(){return this._isInitialActualization}get isInitialLoading(){return this._isInitialLoading}get isLoading(){return this._isLoading}get section(){return this._section}get title(){return this._section?.title||""}get formState(){return this._formState}get submitError(){return this._errorsSet.has("submit")}get selectedAuthorsCount(){return this.alreadySelectedAuthors+this._formState.countToAdd}get shouldHideFooter(){return Boolean(this._section?.blocks.filter((e=>"placeholder"===e.data.data_type)).length)}async[s.init](){this._isInitialLoading=!0;try{const e=this._sectionId??await this.subscriptionsCatalogProvider.fetchSectionId({url:`${window.location.origin}/video/subscriptions_chooser`}),[t,{has_configured_list:i}]=await Promise.all([this.subscriptionsCatalogProvider.fetchSection({section_id:e}),this.subscriptionService.subscribeGetRelevantAuthors({count:0,start_from:"0"})]);(0,r.runInAction)((()=>{this._section=t?.activeSection||null,this._isInitialActualization=!i}))}catch(e){const t=this.userEnv.partConfigEnabled("video_channel_rename")?this.langs.getLang("video_channel_subscriptions_actualization_modal_init_error"):this.langs.getLang("video_subscriptions_actualization_modal_init_error");this.snackbar.show({type:"error",text:t}),this.close()}finally{(0,r.runInAction)((()=>{this._isInitialLoading=!1}))}}get alreadySelectedAuthors(){const e=this._section?.blocks[0]?.data?.badge?.text,t=Number(e);return Number.isNaN(t)?0:t}constructor(e,t,i,o,s,n){this.langs=e,this.snackbar=t,this.subscriptionsCatalogProvider=i,this.subscriptionService=o,this.props=s,this.userEnv=n,this.catalogService=new h.CatalogServiceAdapter((0,p.getSubscriptionsPageServices)().catalogService),this.close=()=>{this.props.current.onClose?.()},this.save=async()=>{this._formState.toggleIsConfirmed(!0),this._errorsSet.delete("submit"),this._isLoading=!0;try{if(!await this.subscriptionService.subscribeChooseRelevantAuthors({keep_author_ids:this._formState.state.show.map((e=>u.Ranges.convertGroupIdToOwnerId(e))).join(),hide_author_ids:this._formState.state.hide.map((e=>u.Ranges.convertGroupIdToOwnerId(e))).join()}))return void this._errorsSet.add("submit");this.close(),this.catalogService.refetchCurrentSection(),this.props.current.onActualizationSuccess?.();const e=this.userEnv.partConfigEnabled("video_channel_rename")?this.langs.getLang("video_channel_subscriptions_actualization_modal_save_success",!0):this.langs.getLang("video_subscriptions_actualization_modal_save_success",!0);this.snackbar.show({type:"ok",text:this.langs.numeric(this.selectedAuthorsCount,e)})}catch(e){this._errorsSet.add("submit")}finally{this._formState.toggleIsConfirmed(!1),(0,r.runInAction)((()=>{this._isLoading=!1}))}},this._errorsSet=new Set,this._sectionId=void 0,this._section=null,this._isInitialActualization=!1,this._isInitialLoading=!1,this._isLoading=!1,this._sectionId=s.current.sectionId,this._formState=new m.FormStateModel,(0,r.makeAutoObservable)(this)}}v=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Langs?Object:n.Langs,void 0===a.Snackbar?Object:a.Snackbar,void 0===l.VideoSubscriptionsCatalogProvider?Object:l.VideoSubscriptionsCatalogProvider,void 0===c.VideoSubscriptionsService?Object:c.VideoSubscriptionsService,void 0===s.Props?Object:s.Props,void 0===d.UserEnv?Object:d.UserEnv])],v);const{Provider:g,useModel:_}=(0,s.createProvider)(v,{isolatedContext:!1,onlyTransient:!0})},651462:(e,t,i)=>{i.d(t,{FormStateModel:()=>r});var o=i(327813);class r{get isDirty(){return Boolean(this.authorsIdsHideSet.size||this.authorsIdsShowSet.size)}get isConfirmed(){return this._isConfirmed}get countToAdd(){return this.authorsIdsShowSet.size-this.authorsIdsHideSet.size}get state(){return{hide:Array.from(this.authorsIdsHideSet),show:Array.from(this.authorsIdsShowSet)}}checkInSet(e,t){return(t?this.authorsIdsShowSet:this.authorsIdsHideSet).has(e)}constructor(){this.toggleId=(e,t)=>{const i=t?this.authorsIdsShowSet:this.authorsIdsHideSet;this.checkInSet(e,t)?i.delete(e):i.add(e)},this.checkToggled=(e,t)=>{const i=this.checkInSet(e,t);return t?i:!i},this.toggleIsConfirmed=e=>{this._isConfirmed=e??!this._isConfirmed},this.authorsIdsHideSet=new Set,this.authorsIdsShowSet=new Set,this._isConfirmed=!1,(0,o.makeAutoObservable)(this)}}},835312:(e,t,i)=>{i.d(t,{SubscriptionsActualizationAuthorsModelProvider:()=>o.SubscriptionsActualizationAuthorsModelProvider,useSubscriptionsActualizationAuthorsModel:()=>o.useSubscriptionsActualizationAuthorsModel});var o=i(76757)},525829:(e,t,i)=>{i.d(t,{showSubscriptionsActualizationModal:()=>d});var o=i(474848),r=i(865708),s=i(576950),n=i(604743),a=i(779060);const d=e=>(t,i)=>{(0,n.showMessageBoxModal)((n=>(0,o.jsx)(s.DIRootWebProvider,{children:(0,o.jsx)(r.AppRootProvider,{children:(0,o.jsx)(a.SubscriptionsActualizationModal,{...n,onActualizationSuccess:e,sectionId:t,screen:i})})})),{fullscreen:!0})}},206258:(e,t,i)=>{i.d(t,{VideoCardWidget:()=>_});var o=i(474848),r=i(296540),s=i(456921),n=i(618068),a=i(132028),d=i(196147),l=i(202799),c=i(70515),u=i(149333),h=i(370420),p=i(109889),m=i(950885),v=i(218426);const g=(0,s.observer)((function(){const e=(0,v.useVideoCardModel)(),{isEpisodesEnabled:t,videoData:i,videoForCard:s,removeFromHistory:a,videoCardOverlay:g}=e,{collectClick:_,direction:C,videoContainerWidth:y,noOwner:b,infoContainerWidth:I,hasEpisodes:S,isFromHistory:f,noPlayIcon:w,noAvatar:E}=e.props.current,k=(0,u.useLangs)(),P=k.numeric(s.episodes?.length??0,k.getLang("video_n_time_codes",!0),!0),A=function(e){const{videoData:t}=e,{collectClick:i}=e.props.current;return(0,r.useMemo)((()=>h.getMenuItems(h.watchLater(t,(()=>e.faveHandler(l.FAVORITE_SOURCES.VIDEO_CARD_MODAL))),h.share(t,(e=>{i?.({action:c.SearchClickActionMap.SHARE,track_code:t.track_code,type:c.EventItemType.VIDEO}),(0,m.shareVideo)(e,t,{trackCode:t.track_code})})),h.report(t,(()=>(0,p.reportHandler)(String(t.id),String(t.owner_id),t.track_code))))),[t])}(e),L=(0,p.useControls)({video:i,controls:[],onToggleFav:e.faveHandler}),x=(0,r.useRef)(null),M=(0,l.useRefLogView)({type:c.EventItemType.VIDEO,trackCode:i.track_code});return(0,o.jsx)(n.VideoCard,{getRef:e.isControlsFixEnabled?e=>{M?.(e),x.current=e}:M,controlItems:f?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.VideoCard.IconControl,{icon:d.Icon16Cancel,tooltipText:k.getLang("video_delete_from_history_button"),onClick:a},k.getLang("video_delete_from_history_button"))}):(0,o.jsx)(p.VideoCardControls,{video:i,cardRef:e.isControlsFixEnabled?x:void 0,collectClick:_||(()=>{}),controls:L??[]}),noAvatar:E,menuItems:A,video:s,onVideoOpen:e.onVideoOpen,onAuthorClick:()=>{_?.({action:c.SearchClickActionMap.OPEN_OWNER,track_code:i.track_code,type:c.EventItemType.VIDEO})},direction:C,noPlayIcon:w,videoContainerWidth:y,noOwner:b,infoContainerWidth:I,titleEpisodes:t&&S?P:void 0,thumbDataTitleEpisodes:t&&S?e.thumbDataTitleEpisodes:void 0,onClickEpisode:t&&S?e.handleClickEpisode:void 0,defaultSelectedEpisodeIndex:t&&S?e.activeEpisodeIndex:void 0,onClickAccordionEpisodes:t&&S?e.handleClickAccordionEpisodes:void 0,overlay:g})})),_=(0,a.createWidget)(v.VideoCardProvider,g)},692851:(e,t,i)=>{i.d(t,{VideoCardWidget:()=>o.VideoCardWidget});var o=i(206258)},76174:(e,t,i)=>{i.d(t,{VideoCardProvider:()=>f,useVideoCardModel:()=>w});var o=i(331635),r=i(327813),s=i(132028),n=i(24516),a=i(882044),d=i(712600),l=i(538522),c=i(22421),u=i(119629),h=i(202799),p=i(70515),m=i(969617),v=i(98354),g=i(916637),_=i(406751),C=i(29593),y=i(131256),b=i(680635),I=i(175380);class S{get videoData(){const e=this.props.current.video.data,t=this.props.current.trackCode||e.track_code;return{...e,track_code:t,is_favorite:this.videoFaveService.getIsFavorite(e.id)}}get isControlsFixEnabled(){return this.userEnv.partConfigEnabled("video_card_controls_focus_fix")}get isSearchHideVideoDescription(){return this.userEnv.partConfigEnabled("search_hide_video_description")}get isEpisodesEnabled(){return this.userEnv.partConfigEnabled("search_add_video_episodes_web")}get isActiveVkLive(){const{video:e}=this.props.current;return!!e.data.vk_live_channel_url&&(0,b.isLiveVideo)(e.data)}get videoForCard(){const{owner:e,video:t}=this.props.current,i=(0,_.mapVideoToVideoCardItem)(this.videoData),o={...i,description:this.isSearchHideVideoDescription?"":this.videoData.description,owner:{...(0,_.mapArtistToVideoCardOwner)(this.videoData)??(0,_.mapUserOrGroupToVideoCardOwner)(e,"/video/@"),badge:(0,C.getVerifiedBadge)(e)},href:this.isActiveVkLive?t.data.vk_live_channel_url:i.href};return this.isDeletedFromHistory&&(o.restriction={mode:"hidden",title:this.langs.getLang("video_success_removing_from_history").replace(/<[^>]+>/g," "),iconType:"delete"}),o}get videoCardOverlay(){if(this.isDeletedFromHistory)return{text:"",kind:"full"}}get thumbDataTitleEpisodes(){if(!this.videoData.episodes?.length||!this.videoData.timeline_thumbs||void 0===this.activeEpisodeIndex)return;const e=(0,_.mapThumbsDataEpisodes)(this.videoData);if(!e)return;const t=this.videoData.duration,i=this.videoData.episodes[this.activeEpisodeIndex].time;return void 0!==i&&void 0!==t?{...(0,v.getEpisodeThumb)(e,i/t,t,I.VIDEO_CARD_TITLE_EPISODE_THUMB_WIDTH),frameWidth:e.frameWidth,frameHeight:e.frameHeight}:void 0}get activeEpisodeIndex(){const e=this.videoData.episodes;if(!e?.length)return;const t=this.videoData.viewed_duration??0,i=e.at(-1)?.time??0;if(t>=i)return e.length-1;const o=e.findIndex((({time:e=0})=>e>t));return Math.max(o-1,0)}constructor(e,t,i,o,s){this.userEnv=e,this.props=t,this.videoFaveService=i,this.videoApi=o,this.langs=s,this.isDeletedFromHistory=!1,this.faveHandler=async e=>{const{collectClick:t,video:i}=this.props.current,o=this.videoData.owner_id,r=this.videoData.id;if(!o)return;const s=this.videoData.is_favorite;this.videoFaveService.toggle({ownerId:o,id:r,ref:this.videoData.track_code,source:e}),window.dispatchEvent(new CustomEvent(u.VideoShowcaseFaveEvents.TOGGLE,{detail:{id:i.rawId,isFave:s,rollbackCallback:()=>{this.videoFaveService.add({ownerId:o,id:r,ref:this.videoData.track_code,source:h.FAVORITE_SOURCES.SNACKBAR}),window.dispatchEvent(new CustomEvent(u.VideoShowcaseFaveEvents.TOGGLE,{detail:{id:i.rawId,isFave:!1}}))}}})),t?.({action:s?p.SearchClickActionMap.UNFAVE:p.SearchClickActionMap.FAVE,track_code:this.videoData.track_code,type:p.EventItemType.VIDEO})},this.onVideoOpen=e=>{if(window.cur.cancelClick)return e.preventDefault(),void(window.cur.cancelClick=!1);const{collectClick:t,video:i}=this.props.current;if(window.cur.chooseVideoMedia)return e.preventDefault(),window.cur.chooseVideoMedia(e.target,String(this.videoData.id));t?.({action:p.SearchClickActionMap.TAP,track_code:this.videoData.track_code,type:p.EventItemType.VIDEO}),this.isActiveVkLive&&i.data.vk_live_channel_url?window.location.href=i.data.vk_live_channel_url:(0,g.showVideo)({event:e,id:i.rawId,video:this.videoData})},this.handleClickAuthor=()=>{const{collectClick:e}=this.props.current;e?.({action:p.SearchClickActionMap.OPEN_OWNER,track_code:this.videoData.track_code,type:p.EventItemType.VIDEO})},this.removeFromHistory=async()=>{this.isDeletedFromHistory=!0;try{await this.videoApi.removeViewingHistoryRecords({video_ids:(0,l.joinRawId)({ownerId:this.videoData.owner_id,itemId:this.videoData.id})})}catch{this.isDeletedFromHistory=!1}},this.handleClickEpisode=(e,t)=>{const i=this.videoForCard.href;if(!i)return;const{collectClick:o,video:r}=this.props.current;o?.({action:p.SearchClickActionMap.OPEN_EPISODES,track_code:this.videoData.track_code,type:p.EventItemType.VIDEO}),(0,g.showVideo)({event:e,id:r.rawId,video:this.videoData,videoUrlWithParams:(0,y.getEpisodeLink)(t,this.videoData.track_code?(0,c.makeUrl)(i,{search_track_code:this.videoData.track_code}):i)})},this.handleClickAccordionEpisodes=(e,t)=>{const{collectClick:i}=this.props.current;t&&i?.({action:p.SearchClickActionMap.EXTEND_EPISODES,track_code:this.videoData.track_code,type:p.EventItemType.VIDEO})},(0,r.makeAutoObservable)(this)}}S=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.UserEnv?Object:n.UserEnv,void 0===s.Props?Object:s.Props,void 0===m.VideoFaveService?Object:m.VideoFaveService,void 0===a.VideoApi?Object:a.VideoApi,void 0===d.Langs?Object:d.Langs])],S);const{Provider:f,useModel:w}=(0,s.createProvider)(S,{isolatedContext:!1,onlyTransient:!0})},218426:(e,t,i)=>{i.d(t,{VideoCardProvider:()=>o.VideoCardProvider,useVideoCardModel:()=>o.useVideoCardModel});var o=i(76174)},296032:(e,t,i)=>{i.d(t,{VideoClipsWidget:()=>w});var o=i(474848),r=i(456921),s=i(296540),n=i(132028),a=i(724648),d=i(202350),l=i(609969),c=i(965632),u=i(142648),h=i(547817),p=i(87963),m=i(961306),v=i(350485),g=i(517401),_=i(70515),C=i(680635),y=i(830983),b=i(684594),I=i(495792);const S={feed:"top"},f=(0,r.observer)((function(){const{feed:e,props:t,statsInfo:i,isCommentsModal:r,showCommentsModal:n,hideCommentsModal:f,shareClip:w,hideShareClipModal:E,onEmbedClick:k,isShareClipModalActive:P,video:A,screen:L,isSplitCarouselItem:x,isDeleteClipModalActive:M,hideDeleteClipModal:O,deleteClip:T}=(0,y.useVideoClipsModel)(),V=t.current.activeItemId,F=t.current.feed||S,j=(0,v.usePageBlockOffset)(),{setRoot:R,itemSize:D,maxWidth:B}=(0,u.useClipSize)(),N=e.getFeedData(F),U=(0,C.getListIds)(N,V),G=N?.isLoading??!1,H=Boolean(N?.error),W=N?.fullyLoaded??!1,z=(0,s.useCallback)((()=>{e.fetchNext(F)}),[]),$=(0,s.useRef)(null),Y=(0,s.useCallback)((e=>{$.current?.controlsHandler(e)}),[]),q=(0,s.useCallback)((e=>{i.getBlockId()&&A?g.searchStatsCollector.logEvent({action:e,type:_.EventItemType.CLIP,track_code:A.data.track_code}):i.getFromType("search")&&g.searchStatsCollector.logOutOfSerpEvent({action:e,type:_.EventItemType.CLIP})}),[A]);(0,s.useEffect)((()=>{e.initFeed(F,V)}),[]),(0,s.useEffect)((()=>{!V&&U.length&&t.current.setActiveItemId(U[0])}),[V,U]);const K=(0,s.useMemo)((()=>Math.max((B-D.width)/2,j)),[D,B,j]);return(0,o.jsxs)(a.Flex,{getRootRef:R,className:I.default.container,justify:"center",children:[(0,o.jsx)(u.ClipsFeedComponent,{activeItemId:V,feed:F.feed,listIds:U,isLoadingNext:G,emptyPlaceholder:Boolean(H)?"error":W?"empty":"none",loadNext:z,itemSize:D,onActiveItemChanged:t.current.setActiveItemId,itemRender:(e,t,i,r)=>x?(0,o.jsx)(b.VideoClipsCarouselItem,{videoFullId:e,itemSize:D,isActive:r,statsRef:c.ShortVideoPlayerStatsRef.VIDEO,collectSearchClick:q}):(0,o.jsx)(p.CarouselItem,{appearance:"video",videoFullId:e,itemSize:D,isActive:r,statsRef:c.ShortVideoPlayerStatsRef.VIDEO,collectSearchClick:q}),scrollRef:$,itemsOffset:K,after:(0,o.jsx)(u.ClipsFeedControlsLayout,{itemSize:D,itemsOffset:K,itemsGapSize:16,topControlsDirection:D.height<750?"row":"column",bottomControlsDirection:D.height<600?"row":"column",topControls:(0,o.jsx)(h.ClipsPlayerSoundToggle,{videoFullId:V}),bottomControls:[V?(0,o.jsxs)(d.RoundedGroup,{direction:"vertical",gap:16,children:[(0,o.jsx)(h.ClipsFeedLikeWidget,{clipId:V}),(0,o.jsx)(h.ClipsFeedCommentWidget,{clipId:V,onClick:n}),(0,o.jsx)(h.ClipsFeedShareWidget,{clipId:V,onClick:w}),(0,o.jsx)(h.ClipsFeedDislikeWidget,{clipId:V}),(0,o.jsxs)(u.ClipsFeedMoreMenu,{children:[(0,o.jsx)(h.ClipsFeedMoreEditWidget,{clipId:V}),(0,o.jsx)(h.ClipsFeedMoreCopyLinkWidget,{clipId:V}),(0,o.jsx)(h.ClipsFeedMoreShareWidget,{clipId:V,onShare:w}),(0,o.jsx)(h.ClipsFeedMoreDeleteWidget,{clipId:V,onClick:T}),(0,o.jsx)(h.ClipsFeedMoreReportWidget,{clipId:V}),(0,o.jsx)(h.ClipsFeedMoreDownloadWidget,{clipId:V}),(0,o.jsx)(h.ClipsFeedMoreEridWidget,{clipId:V})]})]},"clips-feed-buttons"):null,U.length>1&&V?(0,o.jsx)(u.ClipsFeedCarouselControls,{isFirstActive:0===U.indexOf(V),isLastActive:U.indexOf(V)===U.length-1,handler:Y},"clips-feed-carousel-controls"):null]})}),r&&V&&(0,o.jsx)(l.PopupProvider,{children:(0,o.jsx)(h.CommentsModal,{activeClipId:V,onClose:f,isAttachmentsNotSupported:!0})}),M&&V&&(0,o.jsx)(h.DeleteClipModal,{videoFullId:V,onClose:O}),P&&V&&(0,o.jsx)(l.PopupProvider,{children:(0,o.jsx)(m.VideoShareModal,{videoId:A?.data.id||0,ownerId:A?.data.owner_id||0,trackCode:A?.data.track_code||"",screenFrom:L,onClose:E,onEmbedClick:k,urlPart:"/clip"})})]})})),w=(0,n.createWidget)(y.VideoClipsProvider,f)},779584:(e,t,i)=>{i.d(t,{VideoClipsWidget:()=>o.VideoClipsWidget});var o=i(296032)},776632:(e,t,i)=>{i.d(t,{VideoClipsModel:()=>p});var o=i(331635),r=i(327813),s=i(132028),n=i(6286),a=i(632520),d=i(348882),l=i(214079),c=i(809424),u=i(24516),h=i(777446);class p{get isSplitCarouselItem(){return this.userEnv.partConfigEnabled("clips_web_split_carousel_item")}get video(){return this.props.current.activeItemId&&this.shortVideoVideosProvider.get(this.props.current.activeItemId)||null}get screen(){const{screen:e}=this.metaData.get();return e}constructor(e,t,i,o,s,a){this.props=e,this.feed=t,this.statsInfo=i,this.metaData=o,this.shortVideoVideosProvider=s,this.userEnv=a,this.isShareClipModalActive=!1,this.isDeleteClipModalActive=!1,this.hideShareClipModal=()=>{this.isShareClipModalActive=!1},this.hideDeleteClipModal=()=>{this.isDeleteClipModalActive=!1},this.deleteClip=()=>{this.isDeleteClipModalActive=!0},this.shareClip=()=>{if(this.userEnv.partConfigEnabled("video_new_share_modal"))this.isShareClipModalActive=!0;else{const e=this.video?.data.track_code;n.Likes.share(`clip${this.props.current.activeItemId}`,{trackCode:e})}},this.onEmbedClick=()=>{if(this.userEnv.partConfigEnabled("video_new_share_modal")){(0,h.curBox)().hide();const e=this.video?.data.track_code;n.Likes.share(`clip${this.props.current.activeItemId}`,{trackCode:e})}},this.isCommentsModal=!1,this.showCommentsModal=()=>{this.isCommentsModal=!0},this.hideCommentsModal=()=>{this.isCommentsModal=!1},(0,r.makeAutoObservable)(this)}}p=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===d.ClipsFeedModel?Object:d.ClipsFeedModel,void 0===l.StatsInfo?Object:l.StatsInfo,void 0===c.MetaData?Object:c.MetaData,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===u.UserEnv?Object:u.UserEnv])],p)},830983:(e,t,i)=>{i.d(t,{VideoClipsProvider:()=>s,useVideoClipsModel:()=>n});var o=i(132028),r=i(776632);const{Provider:s,useModel:n}=(0,o.createPageProvider)(r.VideoClipsModel,{isolatedContext:!1,onlyTransient:!1})},390023:(e,t,i)=>{i.d(t,{VideoClipsCarouselItem:()=>p});var o=i(474848),r=i(456921),s=i(132028),n=i(192678),a=i(87963),d=i(110812),l=i(477492),c=i(233062),u=i(244850);const h=(0,r.observer)((function(){const{badges:e,props:t,video:i,toggleDescription:r,descriptionExpanded:s,sendVideoActionStat:h,videoActionUrl:p,isVideoStandaloneAttached:m,isPartViewed:v,onCurrentTimeChanged:g,isShowFullVideoContent:_,isClipWithVideoItem:C,continueWatching:y,stopWatching:b,isShowToVideoButton:I}=(0,c.useVideoClipsCarouselItemModel)();if(i)return(0,o.jsx)(a.CarouselItem,{...t.current,onCurrentTimeChanged:g,gradient:s?"expanded":"bottom",isActive:C?!_:t.current.isActive,onEnded:C?b:void 0,noHover:I,afterComponent:I&&p&&(0,o.jsx)(n.ClipContainer.OverlayBackground,{centered:!0,children:(0,o.jsx)(l.ClipToVideoPlayerButton,{videoActionUrl:p,sendVideoActionStat:h,continueWatching:y})}),contentComponent:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.ClipAuthor,{collectSearchClick:t.current.collectSearchClick,video:i,getOwnerProfileUrl:u.getOwnerProfileUrl}),(0,o.jsx)(a.ClipDescription,{video:i,descriptionExpanded:s,formatDescription:u.replaceMentionsLinks,onToggle:r,spacingTop:10}),(0,o.jsx)(a.ClipBadges,{badges:e,video:i,disableUrl:!0,afterComponent:(0,o.jsxs)(o.Fragment,{children:[m&&p&&(0,o.jsx)(d.ClipToVideoButton,{videoActionUrl:p,sendVideoActionStat:h,isActive:v}),!m&&(0,o.jsx)(a.ClipAudio,{collectSearchClick:t.current.collectSearchClick,video:i,disableUrl:!0})]})})]})})})),p=(0,s.createWidget)(c.VideoClipsCarouselItemProvider,h)},401601:(e,t,i)=>{i.d(t,{ClipToVideoPlayerButton:()=>c});var o=i(474848),r=i(456921),s=i(149333),n=i(15978),a=i(175400),d=i(454154),l=i(800483);const c=(0,r.observer)((function({videoActionUrl:e,sendVideoActionStat:t,continueWatching:i}){const{getLang:r}=(0,s.useLangs)();return(0,o.jsx)(n.AppearanceProvider,{value:"dark",children:(0,o.jsxs)(a.ButtonGroup,{gap:"m",mode:"vertical",align:"center",children:[(0,o.jsx)(d.Button,{size:"l",href:e,before:(0,o.jsx)(l.Icon24Play,{}),minWidth:246,onClick:t,"data-testid":"clips-action-button",children:r("video_standalone_clip_attached_video_title_button")}),(0,o.jsx)(d.Button,{size:"l",mode:"link",onClick:i,children:r("video_standalone_clip_attached_video_retry_button")})]})})}))},477492:(e,t,i)=>{i.d(t,{ClipToVideoPlayerButton:()=>o.ClipToVideoPlayerButton});var o=i(401601)},946908:(e,t,i)=>{i.d(t,{VideoClipsCarouselItem:()=>o.VideoClipsCarouselItem});var o=i(390023)},928418:(e,t,i)=>{i.d(t,{VideoClipsCarouselItemModel:()=>h});var o=i(331635),r=i(327813),s=i(132028),n=i(24516),a=i(632520),d=i(964867),l=i(361121),c=i(314309),u=i(317216);class h{get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get isVideoStandaloneAttached(){return this.userEnv.partConfigEnabled("short_video_button_to_video")}get badges(){return this.shortVideoBadgesProvider.get(this.props.current.videoFullId)}get isPartViewed(){return Boolean(this.isVideoStandaloneAttached&&this.video?.data.duration&&.7*this.video.data.duration<=this.currentTime)}get videoActionUrl(){const e=this.video?.data?.action_button?.id;return e?`/video${e}`:null}get isClipToVideoAvaible(){return this.userEnv.partConfigEnabled("short_video_button_to_video_player")}get isShowFullVideoContent(){return!this.isWatching}get isClipWithVideoItem(){return this.isClipToVideoAvaible&&this.videoActionUrl}get isShowToVideoButton(){return Boolean(this.isClipWithVideoItem&&this.isShowFullVideoContent)}constructor(e,t,i,o){this.props=e,this.shortVideoVideosProvider=t,this.shortVideoBadgesProvider=i,this.userEnv=o,this.descriptionExpanded=!1,this.toggleDescription=()=>{this.descriptionExpanded=!this.descriptionExpanded},this.onCurrentTimeChanged=e=>{this.currentTime=e},this.sendVideoActionStat=()=>{const{ownerId:e,itemId:t}=(0,l.splitRawId)(this.video?.data?.action_button?.id||"");this.videoActionUrl&&this.video?.data.id&&this.video?.data.owner_id&&c.videoActionButtonStatsCollector.logEvent({event_type:u.VideoActionButtonEventTypes.CLICK_TO_ACTION_BUTTON,object_owner_id:e,object_id:t,video_owner_id:this.video?.data.owner_id,video_id:this.video?.data.id,object_url:this.videoActionUrl||"",screen:"clips"})},this.continueWatching=()=>{this.isWatching=!0},this.stopWatching=()=>{this.isWatching=!1},this.currentTime=0,this.isWatching=!0,(0,r.makeAutoObservable)(this)}}h=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===d.ShortVideoBadgesProvider?Object:d.ShortVideoBadgesProvider,void 0===n.UserEnv?Object:n.UserEnv])],h)},233062:(e,t,i)=>{i.d(t,{VideoClipsCarouselItemProvider:()=>s,useVideoClipsCarouselItemModel:()=>n});var o=i(132028),r=i(928418);const{Provider:s,useModel:n}=(0,o.createProvider)(r.VideoClipsCarouselItemModel)},795561:(e,t,i)=>{i.d(t,{getOwnerProfileUrl:()=>r});var o=i(856289);const r=e=>`/${(0,o.getVideoPrefix)("at")}${e}`},244850:(e,t,i)=>{i.d(t,{getOwnerProfileUrl:()=>o.getOwnerProfileUrl,replaceMentionsLinks:()=>r.replaceMentionsLinks});var o=i(795561),r=i(401896)},987908:(e,t,i)=>{function o(e){return(t,i,o,r,s,n)=>e({key:t,mentionId:o+r,mention:s,href:`/@${o+r}`,text:n})}i.d(t,{mentionReplaceReactVideo:()=>o})},401896:(e,t,i)=>{i.d(t,{replaceMentionsLinks:()=>p});var o=i(474848),r=i(279734),s=i(192678),n=i(768355),a=i(70515),d=i(942981),l=i(627445),c=i(186093),u=i(83940),h=i(987908);const p=(e,t)=>{const i=new n.ReactReplacer(e);return i.call(u.replaceFreeMention,(0,u.freeMentionReplacerReact)((({key:e,text:i,href:n})=>(0,o.jsx)(s.ClipContainer.UnderlinedText,{children:(0,o.jsx)(r.Link,{href:n,onClick:()=>{t?.({type:a.ClipDescriptionLinkTypes.LINK,value:n})},"data-testid":"link",mode:"contrast",children:i},e)})))),i.call(d.replaceHyperLinks,(0,d.linksReplacerReact)((({key:e,text:i,...r})=>(0,o.jsx)(s.ClipContainer.UnderlinedText,{children:(0,o.jsx)(l.MemOrExternalLink,{mode:"contrast",onClick:()=>t?.({type:r.mentionId?a.ClipDescriptionLinkTypes.MENTION:a.ClipDescriptionLinkTypes.LINK,value:r.mentionId||r.href}),"data-testid":"link",disableMentionHover:!0,...r,children:i},e)})))),i.call(c.replaceMentions,(0,h.mentionReplaceReactVideo)((({key:e,text:i,href:r,...n})=>(0,o.jsx)(s.ClipContainer.UnderlinedText,{children:(0,o.jsx)(l.MemLink,{onClick:()=>t?.({type:a.ClipDescriptionLinkTypes.MENTION,value:n.mentionId}),href:r,mode:"contrast","data-testid":"mention",disableMentionHover:!0,...n,children:i},e)})))),i.getComponent()}},684594:(e,t,i)=>{i.d(t,{VideoClipsCarouselItem:()=>o.VideoClipsCarouselItem});var o=i(946908)},247418:(e,t,i)=>{i.d(t,{showNewOrReplacePopout:()=>s});var o=i(876229),r=i(777446);function s({onSubmitReplace:e,onSubmitNew:t,lang:i}){(0,o.showFastBoxModal)({title:i.getLang("video_editor_popout_new_or_replace_header"),text:i.getLang("video_editor_popout_new_or_replace_lock_text"),yesButtonLabel:i.getLang("global_save"),onYesButtonClick:()=>{(0,r.curBox)().hide(),e()},noButtonLabel:i.getLang("video_editor_popout_new_or_replace_save"),onNoButtonClick:()=>{(0,r.curBox)().hide(),t()}})}},762797:(e,t,i)=>{i.d(t,{showSaveFailedPopout:()=>n});var o=i(876229),r=i(289475),s=i(777446);function n(e){const{getLang:t}=e;(0,o.showFastBoxModal)({title:t("video_editor_popout_save_failed_header"),text:(0,r.partConfigEnabled)("video_new_editor_page")?t("video_new_editor_popout_save_failed_text"):t("video_editor_popout_save_failed_text"),yesButtonLabel:t("video_editor_popout_save_failed_got_it"),onYesButtonClick:()=>{(0,s.curBox)().hide()}})}},244632:(e,t,i)=>{i.d(t,{showNewOrReplacePopout:()=>o.showNewOrReplacePopout,showSaveFailedPopout:()=>r.showSaveFailedPopout});var o=i(247418),r=i(762797)},876229:(e,t,i)=>{i.d(t,{showFastBoxModal:()=>m});var o=i(474848),r=i(296540),s=i(454154),n=i(694244),a=i(782174),d=i(63614),l=i(908242),c=i(149333),u=i(604743);const h=450,p=({title:e,text:t,yesButtonLabel:i,onYesButtonClick:u,noButtonLabel:p,onNoButtonClick:m,refreshCoordinates:v,onClose:g})=>{const _=(0,c.useLangs)();(0,r.useEffect)((()=>{v()}),[]);const C=(0,r.useMemo)((()=>{const e=[];return p&&m&&e.push((0,o.jsx)(s.Button,{mode:"tertiary",size:"m",onClick:m,children:p},"button-cancel")),i&&u&&e.push((0,o.jsx)(s.Button,{mode:"primary",size:"m",onClick:u,children:i},"button-save")),e}),[i,u,p,m]);return(0,o.jsxs)(n.ModalBox,{maxWidth:h,children:[(0,o.jsx)(a.ModalHeader,{onClose:g,closeAriaLabel:_.getLang("global_close"),centered:!0,children:e}),(0,o.jsx)(d.ModalBody,{insetLevel:2,children:t}),(0,o.jsx)(l.ModalFooter,{actions:C})]})};function m(e){return(0,u.showMessageBoxModal)((t=>(0,o.jsx)(p,{...t,...e})),{width:h})}},998654:(e,t,i)=>{i.d(t,{CANVAS_THUMBNAILS_ID:()=>u,DEFAULT_PREVIEW_SELECTED_FRAGMENT:()=>w,EEntryPointName:()=>I,EditorMode:()=>k,FRAGMENT_BORDER_RADIUS:()=>_,FRAGMENT_BORDER_WIDTH:()=>g,FRAGMENT_DURATION_MIN:()=>b,FRAGMENT_EPSILON:()=>y,FRAGMENT_SPLIT_INC:()=>C,FRAGMENT_WIDTH_MIN:()=>v,FragmentDraggingType:()=>P,MAX_PREVIEW_SELECTED_FRAGMENT:()=>f,MIN_PREVIEW_SELECTED_FRAGMENT:()=>S,SCROLL_MINIMAL_WIDTH:()=>p,SEGMENTS_TIMELINE_COUNT:()=>m,SNACKBAR_TIMEOUT:()=>E,TIMELINE_CANVAS_PADDING:()=>a,TIMELINE_CANVAS_WIDTH_FULLSCREEN:()=>s,TIMELINE_CANVAS_WIDTH_WINDOWED:()=>n,TIMELINE_MAX_ZOOM_LEVEL:()=>l,TIMELINE_MIN_ZOOM_LEVEL:()=>d,TIMELINE_SCROLL_USER_INTERACTION_TIMEOUT:()=>c,TIME_MARKER_POINTS_COUNT:()=>h,VIDEO_EDITOR_MODAL_HEIGHT_WINDOWED:()=>r});var o=i(502940);const r=650,s=window.innerWidth,n=724,a=12,d=1,l=5,c=10*o.millisecondsInSecond,u="canvasThumbnails",h=4,p=50,m=5,v=40,g=2,_=8,C=1e-8,y=1e-4,b=.1-C;var I=function(e){return e.VideoUpload="video_upload",e.VideoEdit="video_edit",e.VideoToClip="video_to_clip",e.VideoAsClipVideoUpload="video_as_clip_video_upload",e}({});const S=1,f=179,w=60,E=1e4;var k=function(e){return e.Preview="preview",e.Edit="edit",e}({}),P=function(e){return e.Right="right",e.Left="left",e.Middle="middle",e}({})},191792:(e,t,i)=>{i.d(t,{EEntryPointName:()=>o.EEntryPointName,StatsService:()=>r.StatsService,getVideoEditorModalModule:()=>n,showNewOrReplacePopout:()=>s.showNewOrReplacePopout,showSaveFailedPopout:()=>s.showSaveFailedPopout});var o=i(998654),r=i(284177),s=i(244632);function n(){return Promise.all([i.e(91498),i.e(89631),i.e(718),i.e(23280),i.e(99370),i.e("langs/web/VideoEditorModal")]).then(i.bind(i,687301))}},284177:(e,t,i)=>{i.d(t,{StatsService:()=>s});var o=i(517401),r=i(70515);class s{init(e){this.video=e}sendOpenVideoEditorStats(){const e=r.VideoPublishActionEventTypes.EVENT_TYPE_OPEN_VIDEO_EDITOR;this.sendVideoPublishStats(e)}sendCutVideoStats(){const e=r.VideoPublishActionEventTypes.EVENT_TYPE_CUT_VIDEO;this.sendVideoPublishStats(e)}sendSaveEditedVideoStats(e){const t=e?r.VideoPublishActionEventTypes.EVENT_TYPE_SAVE_EDITED_VIDEO_AS_NEW:r.VideoPublishActionEventTypes.EVENT_TYPE_SAVE_EDITED_VIDEO;this.sendVideoPublishStats(t)}sendVideoPublishStats(e){!this.sendedEvents.has(e)&&this.video?.owner_id&&this.video?.id&&(o.videoPublishStatsCollector.logEvent({event_type:e,video_owner_id:this.video.owner_id,video_id:this.video.id}),this.sendedEvents.add(e))}sendCreateClipStats(){const e=r.VideoCreateClipActionEventTypes.EVENT_TYPE_CREATE_CLIP;this.sendVideoCreateClipStats(e)}sendCreateClipCutStats(e){const t=e?r.VideoCreateClipActionEventTypes.EVENT_TYPE_CREATE_CLIP_CUT_CROP:r.VideoCreateClipActionEventTypes.EVENT_TYPE_CREATE_CLIP_CUT;this.sendVideoCreateClipStats(t)}sendCreateClipCancelStats(){const e=r.VideoCreateClipActionEventTypes.EVENT_TYPE_CREATE_CLIP_CANCEL;this.sendVideoCreateClipStats(e)}sendCreateClipCancelSubmitStats(e){const t=e?r.VideoCreateClipActionEventTypes.EVENT_TYPE_CREATE_CLIP_CANCEL_YES:r.VideoCreateClipActionEventTypes.EVENT_TYPE_CREATE_CLIP_CANCEL_NO;this.sendVideoCreateClipStats(t)}sendVideoCreateClipStats(e){!this.sendedEvents.has(e)&&this.video?.owner_id&&this.video?.id&&(o.videoCreateClipStatsCollector.logEvent({event_type:e,video_owner_id:this.video.owner_id,video_id:this.video.id}),this.sendedEvents.add(e))}dispose(){this.video=null,this.sendedEvents=new Set}constructor(){this.sendedEvents=new Set,this.video=null}}},909880:(e,t,i)=>{i.d(t,{VideoGeoBlockButton:()=>n});var o=i(132028),r=i(642907),s=i(884278);const n=(0,o.createWidget)(r.GeoBlockButtonModelProvider,s.GeoBlockButton)},909182:(e,t,i)=>{i.d(t,{GeoBlockButton:()=>d});var o=i(474848),r=i(456921),s=i(642907),n=i(536901),a=i(692751);const d=(0,r.observer)((function(){const{visibilityToggle:e}=(0,s.useGeoBlockButtonModel)();return e.state?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.GeoBlockButtonComponent,{}),(0,o.jsx)(a.GeoBlockButtonModal,{})]}):null}))},536901:(e,t,i)=>{i.d(t,{GeoBlockButtonComponent:()=>c});var o=i(474848),r=i(578392),s=i(454154),n=i(622820),a=i(149333),d=i(456921),l=i(642907);const c=(0,d.observer)((function(){const e=(0,a.useLangs)(),{tooltipVisibilityToggle:t,modalVisibilityToggle:i}=(0,l.useGeoBlockButtonModel)();return(0,o.jsx)(r.TextTooltip,{appearance:"inversion",text:e.getLang("video_geo_block_block_button_text"),placement:"top-end",shown:t.state,offsetByCrossAxis:25,offsetByMainAxis:4,children:(0,o.jsx)(s.Button,{size:"m",mode:"secondary",before:(0,o.jsx)(n.Icon24HammerOutline,{}),onPointerLeave:t.disable,onPointerEnter:t.enable,onFocus:t.enable,onBlur:t.disable,onClick:i.enable,"data-testid":"geo_block_video_section_button","aria-label":e.getLang("video_geo_block_block_button_text")})})}))},692751:(e,t,i)=>{i.d(t,{GeoBlockButtonModal:()=>a});var o=i(474848),r=i(456921),s=i(532234),n=i(642907);const a=(0,r.observer)((function(){const{modalVisibilityToggle:e,ownerId:t}=(0,n.useGeoBlockButtonModel)();return e.state&&t?(0,o.jsx)(s.VideoGeoBlockModal,{ownerId:t,onClose:e.disable}):null}))},884278:(e,t,i)=>{i.d(t,{GeoBlockButton:()=>o.GeoBlockButton});var o=i(909182)},187941:(e,t,i)=>{i.d(t,{VideoGeoBlockButton:()=>o.VideoGeoBlockButton});var o=i(909880)},268120:(e,t,i)=>{i.d(t,{GeoBlockButtonModelProvider:()=>c,useGeoBlockButtonModel:()=>u});var o=i(331635),r=i(132028),s=i(644054),n=i(24516),a=i(327813),d=i(358639);class l{get ownerId(){return this.props.current.ownerId}async[r.init](){if(this.userEnv.partConfigEnabled("video_section_geo_block")){this.controller=new AbortController;try{const{can_block:e}=await this.geoBlockInfoProvider.ensureGeoBlockInfo(this.ownerId,{signal:this.controller?.signal});(0,a.runInAction)((()=>{this.visibilityToggle.set(e)}))}catch(e){(0,a.runInAction)((()=>{this.visibilityToggle.disable()}))}finally{(0,a.runInAction)((()=>{this.controller=null}))}}}[r.destroy](){this.controller?.abort()}constructor(e,t,i){this.geoBlockInfoProvider=e,this.props=t,this.userEnv=i,this.visibilityToggle=new d.VideoToggle,this.tooltipVisibilityToggle=new d.VideoToggle,this.modalVisibilityToggle=new d.VideoToggle,this.controller=null,(0,a.makeAutoObservable)(this)}}l=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.VideoSectionGeoBlockInfoProvider?Object:s.VideoSectionGeoBlockInfoProvider,void 0===r.Props?Object:r.Props,void 0===n.UserEnv?Object:n.UserEnv])],l);const{Provider:c,useModel:u}=(0,r.createProvider)(l)},642907:(e,t,i)=>{i.d(t,{GeoBlockButtonModelProvider:()=>o.GeoBlockButtonModelProvider,useGeoBlockButtonModel:()=>o.useGeoBlockButtonModel});var o=i(268120)},362258:(e,t,i)=>{i.d(t,{VideoGeoBlockModal:()=>n});var o=i(132028),r=i(990036),s=i(610263);const n=(0,o.createWidget)(r.GeoBlockModalModelProvider,s.GeoBlockModal)},632348:(e,t,i)=>{i.d(t,{GeoBlockModal:()=>l});var o=i(474848),r=i(456921),s=i(211413),n=i(990036),a=i(481961),d=i(501124);const l=(0,r.observer)((function(){const{close:e}=(0,n.useGeoBlockModalModel)();return(0,o.jsx)(s.MessageBoxModal,{onDestroy:e,children:({onClose:e,refreshCoordinates:t})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.GeoBlockModalLoader,{refreshCoordinates:t}),(0,o.jsx)(d.GeoBlockModalBox,{onClose:e})]})})}))},320746:(e,t,i)=>{i.d(t,{GeoBlockModalBox:()=>m});var o=i(474848),r=i(149333),s=i(694244),n=i(782174),a=i(63614),d=i(456921),l=i(972476),c=i(772055),u=i(81344),h=i(686588),p=i(990036);const m=(0,d.observer)((function({onClose:e}){const t=(0,r.useLangs)(),{isInitialLoading:i}=(0,p.useGeoBlockModalModel)();return i?null:(0,o.jsxs)(s.ModalBox,{children:[(0,o.jsx)(n.ModalHeader,{closeAriaLabel:t.getLang("box_cancel"),onClose:e,children:t.getLang("video_geo_block_modal_header")}),(0,o.jsxs)(a.ModalBody,{insetLevel:1,children:[(0,o.jsx)(l.GeoBlockModalErrors,{}),(0,o.jsx)(c.GeoBlockModalCountryField,{}),(0,o.jsx)(u.GeoBlockModalCommentField,{})]}),(0,o.jsx)(h.GeoBlockModalFooter,{onClose:e})]})}))},81344:(e,t,i)=>{i.d(t,{GeoBlockModalCommentField:()=>l});var o=i(474848),r=i(44544),s=i(945206),n=i(149333),a=i(456921),d=i(990036);const l=(0,a.observer)((function(){const e=(0,n.useLangs)(),{setComment:t,commentError:i}=(0,d.useGeoBlockModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"textComment",status:i?"error":"default",top:e.getLang("video_geo_block_textarea_placeholder"),children:(0,o.jsx)(s.Textarea,{id:"textComment",mode:"default",onChange:t})})}))},772055:(e,t,i)=>{i.d(t,{GeoBlockModalCountryField:()=>c});var o=i(474848),r=i(296540),s=i(44544),n=i(220208),a=i(149333),d=i(456921),l=i(990036);const c=(0,d.observer)((function(){const e=(0,a.useLangs)(),{setCountryId:t,countryError:i,countriesOptions:d}=(0,l.useGeoBlockModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"selectCountry",status:i?"error":"default",top:e.getLang("video_geo_block_select_placeholder"),children:(0,o.jsx)(n.CustomSelect,{id:"selectCountry",options:d,renderOption:({option:e,...t})=>(0,r.createElement)(n.CustomSelectOption,{...t,key:e.value}),onChange:t})})}))},972476:(e,t,i)=>{i.d(t,{GeoBlockModalErrors:()=>l});var o=i(474848),r=i(303800),s=i(836422),n=i(149333),a=i(456921),d=i(990036);const l=(0,a.observer)((function(){const e=(0,n.useLangs)(),{formError:t}=(0,d.useGeoBlockModalModel)();return t?(0,o.jsxs)(r.Div,{children:["submit"===t&&(0,o.jsx)(s.FormStatus,{header:e.getLang("video_geo_block_form_submit_error"),mode:"error"}),"required"===t&&(0,o.jsx)(s.FormStatus,{header:e.getLang("video_geo_block_form_required_fields"),mode:"error"})]}):null}))},686588:(e,t,i)=>{i.d(t,{GeoBlockModalFooter:()=>l});var o=i(474848),r=i(908242),s=i(454154),n=i(149333),a=i(456921),d=i(990036);const l=(0,a.observer)((function({onClose:e}){const t=(0,n.useLangs)(),{submit:i,isSubmitDisabled:a,isLoading:l}=(0,d.useGeoBlockModalModel)();return(0,o.jsx)(r.ModalFooter,{actions:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Button,{mode:"secondary",size:"m",onClick:e,children:t.getLang("box_cancel")},1),(0,o.jsx)(s.Button,{mode:"primary",size:"m",onClick:i,disabled:a,loading:l,children:t.getLang("video_geo_block_block_button_text")},2)]})})}))},501124:(e,t,i)=>{i.d(t,{GeoBlockModalBox:()=>o.GeoBlockModalBox});var o=i(320746)},481961:(e,t,i)=>{i.d(t,{GeoBlockModalLoader:()=>a});var o=i(474848),r=i(456921),s=i(211413),n=i(990036);const a=(0,r.observer)((function({refreshCoordinates:e}){const{isInitialLoading:t}=(0,n.useGeoBlockModalModel)();return t?(0,o.jsx)(s.MessageBoxModalLoader,{refreshCoordinates:e}):null}))},610263:(e,t,i)=>{i.d(t,{GeoBlockModal:()=>o.GeoBlockModal});var o=i(632348)},532234:(e,t,i)=>{i.d(t,{VideoGeoBlockModal:()=>o.VideoGeoBlockModal});var o=i(362258)},565430:(e,t,i)=>{i.d(t,{GeoBlockModalModelProvider:()=>m,useGeoBlockModalModel:()=>v});var o=i(331635),r=i(132028),s=i(830501),n=i(644054),a=i(24516),d=i(712600),l=i(670252),c=i(327813),u=i(554314),h=i(358639);class p{get isLoading(){return this._isLoading}get isInitialLoading(){return this._isInitialLoading}get countriesOptions(){return this._countries.filter((({id:e})=>!this.blockedCountriesIds.includes(e))).map((e=>({label:e.title,value:e.id})))}get countryError(){return!this._countryId&&"required"===this._formError}get commentError(){return!this._comment&&"required"===this._formError}get formError(){return this._formError}get isSubmitDisabled(){return!this.changed}async[r.init](){if(this.userEnv.partConfigEnabled("video_section_geo_block")){this.controller=new AbortController,this._isInitialLoading=!0;try{const[{can_block:e},t]=await Promise.all([this.geoBlockInfoProvider.ensureGeoBlockInfo(this.ownerId,{signal:this.controller?.signal}),this.geoBlockCountries.ensureGeoBlockCountries({signal:this.controller?.signal})]);(0,c.runInAction)((()=>{this.visibilityToggle.set(e),this._countries=t}))}catch(e){(0,c.runInAction)((()=>{this.visibilityToggle.disable()}))}finally{(0,c.runInAction)((()=>{this.controller=null,this._isInitialLoading=!1}))}}}[r.destroy](){this.controller?.abort()}get ownerId(){return this.props.current.ownerId}async block(){if(!this._countryId)return!1;this._isLoading=!0;try{return await this.geoBlockInfoProvider.block({countryId:this._countryId,comment:this._comment,ownerId:this.ownerId})}catch(e){return!1}finally{(0,c.runInAction)((()=>{this._isLoading=!1}))}}get blockInfo(){return this.geoBlockInfoProvider.getById(this.ownerId)}get blockedCountriesIds(){return this.blockInfo?.blocked_countries?.map((({id:e})=>e))||[]}constructor(e,t,i,o,r,s){this.geoBlockCountries=e,this.geoBlockInfoProvider=t,this.props=i,this.userEnv=o,this.langsService=r,this.snackbar=s,this.setCountryId=e=>{this.changed=!0,e.target.value&&(this._countryId=Number(e.target.value))},this.setComment=e=>{this.changed=!0,this._comment=e.target.value},this.submit=async()=>{if(this._countryId&&this._comment){if(this._formError="",await this.block())return this.close(),void this.updateInfo();(0,c.runInAction)((()=>{this._formError="submit"}))}else this._formError="required"},this.close=()=>{this.props.current.onClose()},this.controller=null,this.changed=!1,this.visibilityToggle=new h.VideoToggle,this._countries=[],this._countryId=void 0,this._comment="",this._formError="",this._isInitialLoading=!1,this._isLoading=!1,this.updateInfo=async()=>{try{await this.geoBlockInfoProvider.fetchById(this.ownerId)}catch(e){this.snackbar.show((0,u.getSnackbarParams)(this.langsService.getLang("video_geo_block_form_submit_error")))}},(0,c.makeAutoObservable)(this)}}p=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.VideoSectionGeoBlockCountries?Object:s.VideoSectionGeoBlockCountries,void 0===n.VideoSectionGeoBlockInfoProvider?Object:n.VideoSectionGeoBlockInfoProvider,void 0===r.Props?Object:r.Props,void 0===a.UserEnv?Object:a.UserEnv,void 0===d.Langs?Object:d.Langs,void 0===l.Snackbar?Object:l.Snackbar])],p);const{Provider:m,useModel:v}=(0,r.createProvider)(p)},990036:(e,t,i)=>{i.d(t,{GeoBlockModalModelProvider:()=>o.GeoBlockModalModelProvider,useGeoBlockModalModel:()=>o.useGeoBlockModalModel});var o=i(565430)},868804:(e,t,i)=>{i.d(t,{VideoGeoRestrictions:()=>n});var o=i(132028),r=i(499449),s=i(44972);const n=(0,o.createWidget)(r.GeoRestrictionsModelProvider,s.GeoRestrictions)},894234:(e,t,i)=>{i.d(t,{VideoGeoRestrictionsWithPortal:()=>n});var o=i(474848),r=i(440961),s=i(868804);const n=e=>{const t=document.getElementById("video-section-geo-restrictions");return t?(0,r.createPortal)((0,o.jsx)(s.VideoGeoRestrictions,{...e}),t):null}},529408:(e,t,i)=>{i.d(t,{GeoRestrictionLoader:()=>d});var o=i(474848),r=i(157643),s=i(194528),n=i(456921),a=i(499449);const d=(0,n.observer)((function(){const{addBottomSpacing:e}=(0,a.useGeoRestrictionsModel)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Skeleton,{height:"88px",borderRadius:"12px"}),e&&(0,o.jsx)(s.Spacing,{size:16})]})}))},917596:(e,t,i)=>{i.d(t,{GeoRestrictionMessage:()=>u});var o=i(474848),r=i(172656),s=i(303800),n=i(285056),a=i(194528),d=i(454154),l=i(149333),c=i(499449);const u=({country:e,addBottomSpacing:t})=>{const i=(0,l.useLangs)(),{isModerator:u,unblock:h}=(0,c.useGeoRestrictionsModel)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Group,{separator:"hide",children:(0,o.jsxs)(s.Div,{children:[(0,o.jsxs)(n.Text,{children:[i.getLang("blank_rkn_block_country")," ",e.titleForRestrictions," ",e.comment]}),u&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:4}),(0,o.jsxs)(d.Button,{mode:"link",appearance:"accent-invariable",onClick:()=>h(e.id),children:[i.getLang("video_geo_block_unblock_button_text")," ",e.titleForRestrictions]})]})]})}),t&&(0,o.jsx)(a.Spacing,{size:16})]})}},664169:(e,t,i)=>{i.d(t,{GeoRestrictionMessageBlock:()=>d});var o=i(474848),r=i(456921),s=i(499449),n=i(508304),a=i(529408);const d=(0,r.observer)((function(){const{isLoading:e}=(0,s.useGeoRestrictionsModel)();return e?(0,o.jsx)(a.GeoRestrictionLoader,{}):(0,o.jsx)(n.GeoRestrictionMessageList,{})}))},508304:(e,t,i)=>{i.d(t,{GeoRestrictionMessageList:()=>a});var o=i(474848),r=i(456921),s=i(917596),n=i(499449);const a=(0,r.observer)((function(){const{countries:e,addBottomSpacing:t}=(0,n.useGeoRestrictionsModel)();return(0,o.jsx)(o.Fragment,{children:e.map(((e,i,r)=>(0,o.jsx)(s.GeoRestrictionMessage,{country:e,addBottomSpacing:i!==r.length-1||t},e.id)))})}))},474470:(e,t,i)=>{i.d(t,{GeoRestrictionPlaceholder:()=>d});var o=i(474848),r=i(720836),s=i(149333),n=i(456921),a=i(499449);const d=(0,n.observer)((function(){const e=(0,s.useLangs)(),{countries:[t]}=(0,a.useGeoRestrictionsModel)();return t?(0,o.jsxs)(r.Placeholder,{children:[e.getLang("blank_rkn_block_country")," ",t.titleForRestrictions," ",t.comment]}):null}))},102186:(e,t,i)=>{i.d(t,{GeoRestrictions:()=>d});var o=i(474848),r=i(456921),s=i(499449),n=i(664169),a=i(474470);const d=(0,r.observer)((function(){const{countries:e,isVideoSectionUsage:t}=(0,s.useGeoRestrictionsModel)();return e.length?t?(0,o.jsx)(n.GeoRestrictionMessageBlock,{}):(0,o.jsx)(a.GeoRestrictionPlaceholder,{}):null}))},44972:(e,t,i)=>{i.d(t,{GeoRestrictions:()=>o.GeoRestrictions});var o=i(102186)},573291:(e,t,i)=>{i.d(t,{VideoGeoRestrictionsWithPortal:()=>o.VideoGeoRestrictionsWithPortal});i(868804);var o=i(894234)},902394:(e,t,i)=>{i.d(t,{GeoRestrictionsModelProvider:()=>h,useGeoRestrictionsModel:()=>p});var o=i(331635),r=i(712600),s=i(24516),n=i(670252),a=i(132028),d=i(644054),l=i(327813),c=i(554314);class u{get countries(){return(this.geoBlockInfoProvider.getById(this.ownerId)?.blocked_countries||[]).map((({id:e,comment:t})=>({id:e,comment:t||"",titleForRestrictions:this.getTitleForRestrictionByCountryId(e)})))}get isModerator(){return Boolean(this.geoBlockInfoProvider.getById(this.ownerId)?.can_block)}get isLoading(){return this._isLoading||this.geoBlockInfoProvider.checkIsLoading(this.ownerId)}get addBottomSpacing(){return this.props.current.addBottomSpacing||!1}get isVideoSectionUsage(){return this.props.current.isVideoSectionUsage||!1}async[a.init](){if(this.userEnv.partConfigEnabled("video_section_geo_block")){this.controller=new AbortController,this._isLoading=!0;try{await this.geoBlockInfoProvider.ensureGeoBlockInfo(this.ownerId,{signal:this.controller?.signal})}catch(e){this.snackbar.show((0,c.getSnackbarParams)(this.langsService.getLang("video_geo_block_init_error")))}finally{(0,l.runInAction)((()=>{this.controller=null,this._isLoading=!1}))}}}[a.destroy](){this.controller?.abort()}get ownerId(){return this.props.current.ownerId}getTitleForRestrictionByCountryId(e){switch(e){case 1:return this.langsService.getLang("blank_rkn_block_country_rus");case 4:return this.langsService.getLang("blank_rkn_block_country_kaz");case 16:return this.langsService.getLang("blank_rkn_block_country_taji");case 200:return this.langsService.getLang("blank_rkn_block_country_tur");case 3:return this.langsService.getLang("blank_rkn_block_country_blr");case 209:return this.langsService.getLang("blank_rkn_block_country_fr");case 18:return this.langsService.getLang("blank_rkn_block_country_uzb");case 97:return this.langsService.getLang("blank_rkn_block_country_cn");case 65:return this.langsService.getLang("blank_rkn_block_country_de");case 192:return this.langsService.getLang("blank_rkn_block_country_tw");default:return""}}constructor(e,t,i,o,r){this.geoBlockInfoProvider=e,this.langsService=t,this.props=i,this.userEnv=o,this.snackbar=r,this.unblock=async e=>{if(this.ownerId&&e){this._isLoading=!0;try{await this.geoBlockInfoProvider.unblock({countryId:e,ownerId:this.ownerId})}catch(e){this.snackbar.show((0,c.getSnackbarParams)(this.langsService.getLang("video_geo_block_form_submit_error")))}finally{(0,l.runInAction)((()=>{this._isLoading=!1}))}await this.updateInfo()}},this.controller=null,this._isLoading=!1,this.updateInfo=async()=>{try{await this.geoBlockInfoProvider.fetchById(this.ownerId)}catch(e){this.snackbar.show((0,c.getSnackbarParams)(this.langsService.getLang("video_geo_block_form_submit_error")))}},(0,l.makeAutoObservable)(this)}}u=(0,o.__decorate)([a.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===d.VideoSectionGeoBlockInfoProvider?Object:d.VideoSectionGeoBlockInfoProvider,void 0===r.Langs?Object:r.Langs,void 0===a.Props?Object:a.Props,void 0===s.UserEnv?Object:s.UserEnv,void 0===n.Snackbar?Object:n.Snackbar])],u);const{Provider:h,useModel:p}=(0,a.createProvider)(u)},499449:(e,t,i)=>{i.d(t,{GeoRestrictionsModelProvider:()=>o.GeoRestrictionsModelProvider,useGeoRestrictionsModel:()=>o.useGeoRestrictionsModel});var o=i(902394)},816659:(e,t,i)=>{i.d(t,{VideoGeoBlockButton:()=>o.VideoGeoBlockButton,VideoGeoRestrictionsWithPortal:()=>r.VideoGeoRestrictionsWithPortal});var o=i(187941),r=(i(532234),i(573291))},554314:(e,t,i)=>{i.d(t,{getSnackbarParams:()=>o});const o=e=>({text:e,type:"error"})},110322:(e,t,i)=>{i.d(t,{showPlaylistModalWidget:()=>f});var o=i(474848),r=i(211413),s=i(296540),n=i(149333),a=i(694244),d=i(782174),l=i(723723),c=i(285056),u=i(63614),h=i(908242),p=i(454154),m=i(132028),v=i(456921),g=i(319756),_=i(119823),C=i(21608),y=i(149562),b=i(453814);const I=(0,v.observer)((function(){const{messageBoxProps:e,isUpdated:t,onSubmitClick:i,userModel:r}=(0,C.useVideoPlaylistModel)(),m=(0,n.useLangs)();return(0,s.useEffect)((()=>{e.refreshCoordinates()}),[]),r.error?(0,o.jsx)(_.PlaylistErrorModal,{error:r.error,onClose:e.onClose}):(0,o.jsxs)(a.ModalBox,{height:365,children:[(0,o.jsx)(d.ModalHeader,{closeAriaLabel:m.getLang("box_cancel"),className:(0,l.getColorClass)("color_text_secondary"),onClose:e.onClose,before:(0,o.jsx)(c.Headline,{level:"1",className:b.default.modalHeader,children:`${m.getLang("video_add_to_playlist_placeholder_text")}: `}),children:(0,o.jsx)(y.DropdownComponent,{})}),(0,o.jsx)(u.ModalBody,{insetLevel:1,children:(0,o.jsx)(y.ModalBodyComponent,{})}),(0,o.jsx)(h.ModalFooter,{actions:[(0,o.jsx)(p.Button,{mode:"secondary",size:"m",onClick:e.onClose,children:m.getLang("box_cancel")},1),(0,o.jsx)(p.Button,{mode:"primary",size:"m",onClick:i,disabled:!t,children:m.getLang("Save")},2)]})]})})),S=(0,m.createWidget)(C.VideoPlaylistModelProvider,I),f=e=>{(0,r.showMessageBoxModal)((t=>(0,o.jsx)(g.DIRootWebProvider,{children:(0,o.jsx)(S,{...e,...t})})),{width:420})}},834346:(e,t,i)=>{i.d(t,{DropdownComponent:()=>h});var o=i(474848),r=i(456921),s=i(670016),n=i(507852),a=i(260546),d=i(612196),l=i(723723),c=i(972289),u=i(21608);const h=(0,r.observer)((function(){const{name:e,userModel:t}=(0,u.useVideoPlaylistModel)();return(0,o.jsx)(n.DropdownActionSheet,{width:217,maxHeight:168,placement:"bottom-end",trigger:"click",padding:"none",content:(0,o.jsx)(s.GroupsList,{}),size:"s",children:t.currentUser&&(0,o.jsx)(a.SimpleCell,{maxHeight:32,before:(0,o.jsx)(d.Avatar,{size:20,src:t.currentUser.photo_50}),after:(0,o.jsx)(c.Icon16DropdownOutline,{className:(0,l.getColorClass)("color_text_secondary")}),children:e})})}))},735710:(e,t,i)=>{i.d(t,{GroupItem:()=>c});var o=i(474848),r=i(456921),s=i(507852),n=i(723723),a=i(612196),d=i(344634),l=i(21608);const c=(0,r.observer)((function({item:e}){const{getName:t,onSelectUser:i,checkByItem:r}=(0,l.useVideoPlaylistModel)();return(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:()=>i(e),after:r(e)&&(0,o.jsx)(d.Icon16CheckOutline,{className:(0,n.getColorClass)("color_icon_accent")}),before:(0,o.jsx)(a.Avatar,{size:20,src:e.photo_50}),children:t(e)})}))},670016:(e,t,i)=>{i.d(t,{GroupsList:()=>a});var o=i(474848),r=i(456921),s=i(21608),n=i(735710);const a=(0,r.observer)((function(){const{userModel:e}=(0,s.useVideoPlaylistModel)();return(0,o.jsx)(o.Fragment,{children:e.list.map((e=>(0,o.jsx)(n.GroupItem,{item:e},e.id)))})}))},761928:(e,t,i)=>{i.d(t,{ModalBodyComponent:()=>y});var o=i(474848),r=i(303800),s=i(194528),n=i(700272),a=i(944048),d=i(582192),l=i(285056),c=i(723723),u=i(299494),h=i(652862),p=i(909529),m=i(564508),v=i(884945),g=i(456921),_=i(21608),C=i(149333);const y=(0,g.observer)((function(){const{isLoading:e,playlists:t,isLoadedFully:i,isListEmpty:g,fetchMorePlaylists:y,isMyAlbum:b,createNewPlaylistModel:I,handleAddToMyVideo:S,isGroup:f}=(0,_.useVideoPlaylistModel)(),w=(0,C.useLangs)();return g&&e?(0,o.jsxs)(r.Div,{mode:"horizontal",children:[(0,o.jsx)(s.Spacing,{size:104}),(0,o.jsx)(n.Spinner,{}),(0,o.jsx)(s.Spacing,{size:104})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Checkbox,{checked:b,disabled:e,onChange:S,children:f?w.getLang("video_all_groups_videos"):w.getLang("video_my_added_videos_playlist")}),(0,o.jsx)(s.Spacing,{size:8}),(0,o.jsx)(d.Separator,{}),(0,o.jsx)(s.Spacing,{size:8}),(0,o.jsx)(r.Div,{mode:"horizontal",spacing:6,children:(0,o.jsx)(l.Footnote,{className:(0,c.getColorClass)("color_text_subhead"),weight:"3",children:w.getLang("video_playlists")})}),t&&t.length>0&&(0,o.jsxs)(u.ModalScrollView,{height:108,maxHeight:108,children:[t.map((e=>(0,o.jsx)(p.PlaylistCheckbox,{playlist:e},e.id))),e&&(0,o.jsx)(r.Div,{mode:"horizontal",spacing:4,children:(0,o.jsx)(n.Spinner,{})}),!i&&(0,o.jsx)(m.DynamicPagination,{isLoading:Boolean(e),fetchData:y,nextFrom:t.length,withSpinner:!1})]}),(0,o.jsx)(h.CellButton,{onClick:I.handleCreateNewPlaylist,before:(0,o.jsx)(v.Icon28AddOutline,{}),children:w.getLang("video_add_video_to_new_playlist")}),!t?.length&&(0,o.jsx)(s.Spacing,{size:106})]})}))},909529:(e,t,i)=>{i.d(t,{PlaylistCheckbox:()=>l});var o=i(474848),r=i(944048),s=i(412888),n=i(761608),a=i(456921),d=i(21608);const l=(0,a.observer)((function({playlist:e}){const{toggle:t,getChecked:i}=(0,d.useVideoPlaylistModel)(),{id:a,title:l}=e;return(0,o.jsx)(r.Checkbox,{checked:i(a),onChange:()=>t(a),titleAfter:(0,o.jsx)(n.PlaylistCheckboxTooltip,{privacy:e.privacy?.category}),children:(0,o.jsx)(s.TextClamp,{lines:1,children:l})})}))},761608:(e,t,i)=>{i.d(t,{PlaylistCheckboxTooltip:()=>c});var o=i(474848),r=i(866467),s=i(456921),n=i(373206),a=i(562791),d=i(578392),l=i(723723);const c=(0,s.observer)((function({privacy:e}){const t=(()=>{switch(e){case"all":return{Icon:n.Icon16UnlockOutline,text:(0,r.getLang)("video_playlist_available_to_all_tooltip")};case"only_me":return{Icon:a.Icon16LockOutline,text:(0,r.getLang)("video_playlist_private_tooltip")};default:return}})();if(!t)return null;const{Icon:i,text:s}=t;return(0,o.jsx)(d.TextTooltip,{placement:"top",appearance:"black",offsetByCrossAxis:-56,offsetByMainAxis:4,text:s,children:(0,o.jsx)(i,{className:(0,l.getColorClass)("color_icon_secondary")})})}))},149562:(e,t,i)=>{i.d(t,{DropdownComponent:()=>r.DropdownComponent,ModalBodyComponent:()=>o.ModalBodyComponent});var o=i(761928),r=i(834346)},990305:(e,t,i)=>{i.d(t,{VideoCreateNewPlaylistModel:()=>r.VideoCreateNewPlaylistModel,VideoGroupsFetchModel:()=>r.VideoGroupsFetchModel,VideoUserFetchModel:()=>r.VideoUserFetchModel,showPlaylistModalWidget:()=>o.showPlaylistModalWidget});var o=i(110322),r=i(21608)},393654:(e,t,i)=>{i.d(t,{VideoCreateNewPlaylistModel:()=>l});var o=i(327813),r=i(468073),s=i(540462),n=i(609253),a=i(826619),d=i(680635);class l{get messageBoxProps(){return{onClose:this.props.current.onClose,refreshCoordinates:this.props.current.refreshCoordinates}}constructor(e,t,i,l,c,u,h){this.props=e,this.langs=t,this.videoPlaylistListProvider=i,this.playlistsListService=l,this._playlistsList=c,this.userModel=u,this.snackbar=h,this.handleCreateNewPlaylist=(e,t=!0,i=!0)=>{t&&this.messageBoxProps.onClose();const o=this.props.current.isGroupOwner||this.userModel.currentUser?.id!==this.userModel.user?.id?r.Ranges.convertGroupIdToOwnerId(Math.abs(this.userModel.currentUser?.id||0)):this.userModel.currentUser?.id;(0,s.partConfigEnabled)("video_playlist_redesign_popup")?(0,n.showPlaylistModal)({ownerId:o||0,onCreate:this.createPlaylist,hasOnCreateSnackbar:!1}):!(0,s.partConfigEnabled)("video_add_to_album_group")||i?(0,a.createPlaylistPopup)({event:e,ownerId:o||0,videoId:this.props.current.videoId,videoOwnerId:this.props.current.videoOwnerId,requestOrigin:a.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL}):(0,a.createPlaylistPopup)({event:e,ownerId:o||0,requestOrigin:a.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL})},this.createPlaylist=async e=>{const t=this.userModel.currentUser?.id||0;this.targetId=this.props.current.isGroupOwner&&this.props.current.ownerId||t!==this.userModel.user?.id?r.Ranges.convertGroupIdToOwnerId(t):t;const i=t===this.userModel.user?.id?t:this.targetId;try{await this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,extended:!0,targetId:i}),await this.playlistsListService.addToAlbum({videoId:this.props.current.videoId,targetId:i,ownerId:this.props.current.videoOwnerId,albumId:e.id}),await this._playlistsList.fetch({ownerId:this.props.current.ownerId,count:this._chunkSize}),(0,o.runInAction)((()=>{(0,d.showSuccessSnackbar)(this.snackbar,this.langs.getLang("video_changes_saved"))}))}catch(e){(0,o.runInAction)((()=>{(0,d.showFailSnackbar)(this.snackbar,this.langs.getLang("video_editor_popout_save_failed_header")),this._error=e}))}},this._error=void 0,this._chunkSize=50,this.targetId=0,this._playlistsList=i.createList(),(0,o.makeAutoObservable)(this)}}},787814:(e,t,i)=>{i.d(t,{VideoGroupsFetchModel:()=>s});var o=i(327813),r=i(866763);class s{get error(){return this._error}get groupsItems(){if(this._groups?.items&&!r.VideoGroupsFetchService.isNumberArray(this._groups.items))return this._groups.items}async fetchGroups(){try{this._groups=await this.groupsService.fetch({userId:this.authService?.userId||void 0,extended:!0,filter:["editor","has_video"]})}catch(e){console.error(e),this._error=e}}constructor(e,t){this.authService=e,this.groupsService=t,this._error=void 0,this._groups=void 0,(0,o.makeAutoObservable)(this)}}},609623:(e,t,i)=>{i.d(t,{VideoPlaylistModelProvider:()=>k,useVideoPlaylistModel:()=>P});var o=i(331635),r=i(327813),s=i(132028),n=i(627016),a=i(968192),d=i(491318),l=i(866763),c=i(639147),u=i(349773),h=i(476205),p=i(712600),m=i(951652),v=i(670252),g=i(468073),_=i(768035),C=i(856289),y=i(680635),b=i(888133),I=i(787814),S=i(393654);let f=s.init,w=s.destroy;class E{abort(){this._abortController?.abort()}get name(){return this.userModel.currentUser&&this.getName(this.userModel.currentUser)}get isMyAlbum(){return!this.toRemove.has(C.MY_VIDEO_ALBUM_ID)&&(!!this.toAdd.has(C.MY_VIDEO_ALBUM_ID)||this.checkedIds?.has(C.MY_VIDEO_ALBUM_ID))}get messageBoxProps(){return{onClose:this.props.current.onClose,refreshCoordinates:this.props.current.refreshCoordinates}}get propsList(){return this.props.current}get checkedIds(){return this.userModel.currentUser?.id&&this.checkedIdsMap.has(this.userModel.currentUser.id)?this.checkedIdsMap.get(this.userModel.currentUser.id||0):this.playlistsListService.getContainingVideoPlaylistIds(this.props.current.videoId)}get playlists(){return this._playlistsList?.playlists.map((e=>e.data))}get isLoading(){return this._playlistsList?.isLoading}get isLoadedFully(){return this._playlistsList?.isLoadedFully}get isListEmpty(){return!this._playlistsList?.playlists.length}get isUpdated(){return Boolean(this.toAdd.size||this.toRemove.size)}get isGroup(){return this.userModel.currentUser?.id!==this.userModel.user?.id}async[f](){this._abortController=new AbortController,this.targetId=this.props.current.isGroupOwner&&this.props.current.ownerId?g.Ranges.convertGroupIdToOwnerId(this.props.current.ownerId):this.props.current.ownerId;const e=this.props.current.isGroupOwner?{groupId:this.props.current.ownerId}:{ownerId:this.props.current.ownerId};e.count=this._chunkSize;try{await Promise.all([this.groupsModel.fetchGroups(),this.userModel.fetchUser(),this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,extended:!0,targetId:this.targetId},{signal:this._abortController.signal}),this._playlistsList?.fetch({...e},this._abortController)]),(0,r.runInAction)((()=>{this.userModel.initUser(),this.setOwnersPlaylistsMap(),this.setCheckedIdsByOwner()}))}catch(e){(0,r.runInAction)((()=>{this._abortController=void 0,this._error=e}))}}[w](){this.abort()}async fetchPlaylists(){this.abort(),this._abortController=new AbortController,this._playlistsList=this.videoPlaylistListProvider.createList();const e=this.userModel.currentUser?.id||0;this.targetId=this.props.current.isGroupOwner&&this.props.current.ownerId||this.isGroup?g.Ranges.convertGroupIdToOwnerId(e):e;const t=this.isGroup?{groupId:this.userModel.currentUser?.id}:{ownerId:this.userModel.currentUser?.id};t.count=this._chunkSize;try{await Promise.all([this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,extended:!0,targetId:this.isGroup?this.targetId:this.userModel.user?.id},{signal:this._abortController.signal}),this._playlistsList.fetch({...t},this._abortController)]),(0,r.runInAction)((()=>{this.setCheckedIdsByOwner(),this.setOwnersPlaylistsMap()}))}catch(e){(0,r.runInAction)((()=>{this._abortController=void 0,this._error=e}))}}setCheckedIdsByOwner(){return this.checkedIdsMap.set(this.userModel.currentUser?.id||0,this.checkedIds)}setOwnersPlaylistsMap(){return this.ownersPlaylistsMap.set(this.userModel.currentUser?.id||0,this._playlistsList)}constructor(e,t,i,o,s,n,a,d,l,c,u){this.props=e,this.langs=t,this.authService=i,this.videoPlaylistProvider=o,this.videoPlaylistListProvider=s,this.playlistsListService=n,this.groupsService=a,this.userService=d,this.usersStoreFactory=l,this.groupsStoreFactory=c,this.snackbar=u,this.getName=e=>(e=>Boolean(e&&"name"in e))(e)?this.videoGroupsStore.getById(e.id)?.name:this.userModel.name,this.checkByItem=e=>this.userModel.currentUser?.id===e.id,this.handleAddToMyVideo=()=>{this.toggle(C.MY_VIDEO_ALBUM_ID)},this.fetchMorePlaylists=async()=>{try{await(this._playlistsList?.fetchMore())}catch(e){(0,r.runInAction)((()=>{this._error=e}))}},this.onSelectUser=e=>{this.userModel.setCurrentUser(e),this.toRemove.clear(),this.toAdd.clear(),this.ownersPlaylistsMap.has(e.id||0)?this._playlistsList=this.ownersPlaylistsMap.get(e.id):this.fetchPlaylists()},this.onSubmitClick=()=>{this.onSubmit({ownerId:this.props.current.videoOwnerId,videoId:this.props.current.videoId}),this.messageBoxProps.onClose()},this.toggle=e=>{this.checkedIds?.has(e)?E.toggleSetById(this.toRemove,e):E.toggleSetById(this.toAdd,e)},this.getChecked=e=>this.toRemove.has(e)?!this.toRemove?.has(e):this.toAdd.has(e)?this.toAdd?.has(e):this.checkedIds?.has(e),this.targetId=0,this._playlistsList=void 0,this._abortController=void 0,this._error=void 0,this._chunkSize=50,this.toAdd=new Set,this.toRemove=new Set,this._id=void 0,this.checkedIdsMap=new Map,this.ownersPlaylistsMap=new Map,this.onSubmit=async({videoId:e,ownerId:t,playlistId:i,ref:o,context:s,accessKey:n})=>{const a=this.userModel.currentUser?.id===this.userModel.user?.id?this.userModel.currentUser?.id:this.targetId;try{if(this.toAdd.size&&await this.playlistsListService.addToAlbum({videoId:e,ref:o,albumIds:[...this.toAdd,...this.checkedIds??[]],albumId:i,accessKey:n,context:s,targetId:a,ownerId:t}),this.toRemove.size){if(this.props.current.playlistId){const{id:e}=(0,_.parseRawId)(this.props.current.playlistId);this._id=e}await this.playlistsListService.removeFromAlbum({videoId:e,albumIds:Array.from(this.toRemove),albumId:i,targetId:a,ownerId:t}),this._id&&Array.from(this.toRemove).includes(this._id)&&window.nav.reload()}(0,y.showSuccessSnackbar)(this.snackbar,this.langs.getLang("video_changes_saved"))}catch(e){(0,r.runInAction)((()=>{this._error=e})),(0,y.showFailSnackbar)(this.snackbar,this.langs.getLang("video_editor_popout_save_failed_header"))}this.toRemove.clear(),this.toAdd.clear()},this._playlistsList=s.createList(),this.groupsModel=new I.VideoGroupsFetchModel(this.authService,this.groupsService),this.videoGroupsStore=c.ensureByFields([]),this.userModel=new b.VideoUserFetchModel(this.props,this.userService,this.authService,this.usersStoreFactory,this.groupsModel),this.createNewPlaylistModel=new S.VideoCreateNewPlaylistModel(this.props,this.langs,this.videoPlaylistListProvider,this.playlistsListService,this._playlistsList,this.userModel,this.snackbar),(0,r.makeAutoObservable)(this)}}E.toggleSetById=(e,t)=>{e.has(t)?e.delete(t):e.add(t)},E=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===p.Langs?Object:p.Langs,void 0===m.AuthService?Object:m.AuthService,void 0===n.VideoPlaylistsProvider?Object:n.VideoPlaylistsProvider,void 0===a.VideoPlaylistsListProvider?Object:a.VideoPlaylistsListProvider,void 0===d.VideoPlaylistsListService?Object:d.VideoPlaylistsListService,void 0===l.VideoGroupsFetchService?Object:l.VideoGroupsFetchService,void 0===c.VideoUsersFetchService?Object:c.VideoUsersFetchService,void 0===u.VideoUsersStoreFactory?Object:u.VideoUsersStoreFactory,void 0===h.VideoGroupsStoreFactory?Object:h.VideoGroupsStoreFactory,void 0===v.Snackbar?Object:v.Snackbar])],E);const{Provider:k,useModel:P}=(0,s.createProvider)(E,{isolatedContext:!1,onlyTransient:!0})},888133:(e,t,i)=>{i.d(t,{VideoUserFetchModel:()=>r});var o=i(327813);class r{get error(){return this._error||this.groupsModel.error}get user(){return this.userData?.data}get name(){return this.userData?.name}setCurrentUser(e){this._currentUser=e}initUser(){this._currentUser=this.list.find((e=>e.id===this.props.current.ownerId))}get list(){const e=this.groupsModel.groupsItems?Array.from(this.groupsModel.groupsItems||[]):[];return this.user&&e.unshift(this.user),e}get currentUser(){return this._currentUser}async fetchUser(){try{await this.userService.fetch({fields:["photo_50"],userIds:this.authService.userId?[this.authService.userId]:void 0})}catch(e){console.error(e),this._error=e}}get userData(){if(this.authService.userId)return this.usersStoreFactory.ensureByFields(["photo_50"]).getById(this.authService.userId)}constructor(e,t,i,r,s){this.props=e,this.userService=t,this.authService=i,this.usersStoreFactory=r,this.groupsModel=s,this._error=void 0,this._currentUser=void 0,(0,o.makeAutoObservable)(this)}}},21608:(e,t,i)=>{i.d(t,{VideoCreateNewPlaylistModel:()=>s.VideoCreateNewPlaylistModel,VideoGroupsFetchModel:()=>n.VideoGroupsFetchModel,VideoPlaylistModelProvider:()=>o.VideoPlaylistModelProvider,VideoUserFetchModel:()=>r.VideoUserFetchModel,useVideoPlaylistModel:()=>o.useVideoPlaylistModel});var o=i(609623),r=i(888133),s=i(393654),n=i(787814)},831458:(e,t,i)=>{i.d(t,{VideoRestoreButton:()=>a});var o=i(474848),r=i(456921),s=i(279734),n=i(558845);const a=(0,r.observer)((function({restore:e}){return(0,o.jsx)(s.Link,{onClick:e,id:"video-restore-button-widget",children:(0,n.getLang)("video_restore")})}))},413974:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveButtonWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(715624),a=i(831458);const d=(0,r.observer)((function(){const{restore:e}=(0,n.useVideoRestoreFromFaveModel)();return(0,o.jsx)(a.VideoRestoreButton,{restore:e})})),l=(0,s.createWidget)(n.VideoRestoreFromFaveProvider,d)},887329:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveButtonWidget:()=>o.VideoRestoreFromFaveButtonWidget});var o=i(413974)},125072:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveProvider:()=>d,useVideoRestoreFromFaveModel:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(485484);class a{constructor(e,t){this.videoBookmarksService=e,this.props=t,this.restore=async()=>{const{videoId:e,ownerId:t,onClick:i,onRestore:o}=this.props.current;if(!e||!t)return;i?.();await this.videoBookmarksService.add({ownerId:t,videoId:e})&&o?.()},(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoBookmarksService?Object:n.VideoBookmarksService,void 0===s.Props?Object:s.Props])],a);const{Provider:d,useModel:l}=(0,s.createProvider)(a,{isolatedContext:!1,onlyTransient:!0})},715624:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveProvider:()=>o.VideoRestoreFromFaveProvider,useVideoRestoreFromFaveModel:()=>o.useVideoRestoreFromFaveModel});var o=i(125072)},850414:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesButtonWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(496786),a=i(831458);const d=(0,r.observer)((function(){const{restore:e}=(0,n.useVideoRestoreFromLikesModel)();return(0,o.jsx)(a.VideoRestoreButton,{restore:e})})),l=(0,s.createWidget)(n.VideoRestoreFromLikesProvider,d)},381915:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesButtonWidget:()=>o.VideoRestoreFromLikesButtonWidget});var o=i(850414)},273714:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesProvider:()=>d,useVideoRestoreFromLikesModel:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(129021);class a{constructor(e,t){this.videoLikesService=e,this.props=t,this.restore=async()=>{const{videoId:e,ownerId:t,onClick:i,onRestore:o}=this.props.current;if(!e||!t)return;i?.();await this.videoLikesService.add({type:"video",ownerId:t,itemId:e})&&o?.()},(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoLikesService?Object:n.VideoLikesService,void 0===s.Props?Object:s.Props])],a);const{Provider:d,useModel:l}=(0,s.createProvider)(a,{isolatedContext:!1,onlyTransient:!0})},496786:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesProvider:()=>o.VideoRestoreFromLikesProvider,useVideoRestoreFromLikesModel:()=>o.useVideoRestoreFromLikesModel});var o=i(273714)},211574:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoButtonWidget:()=>l});var o=i(474848),r=i(456921),s=i(132028),n=i(585875),a=i(831458);const d=(0,r.observer)((function(){const{restore:e}=(0,n.useVideoRestoreFromVideoModel)();return(0,o.jsx)(a.VideoRestoreButton,{restore:e})})),l=(0,s.createWidget)(n.VideoRestoreFromVideoProvider,d)},209340:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoButtonWidget:()=>o.VideoRestoreFromVideoButtonWidget});var o=i(211574)},375260:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoProvider:()=>c,useVideoRestoreFromVideoModel:()=>u});var o=i(331635),r=i(327813),s=i(132028),n=i(436402),a=i(627016),d=i(406751);class l{constructor(e,t,i){this.videoVideosDeletingService=e,this.videoPlaylistsProvider=t,this.props=i,this.restore=async()=>{const{videoId:e,ownerId:t,targetId:i,playlistId:o,onClick:r,onRestore:s,isVideoModal:n}=this.props.current;if(!e||!t)return;r?.();(n||t===i&&o&&[d.MY_VIDEO_ALBUM_ID,d.UPLOADED_ALBUM_ID].includes(o)?await this.videoVideosDeletingService.restore({videoId:e,ownerId:t}):await this.videoPlaylistsProvider.addVideoToPlaylist({video_id:e,target_id:i,owner_id:t,album_id:o}))&&s?.()},(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoVideosDeletingService?Object:n.VideoVideosDeletingService,void 0===a.VideoPlaylistsProvider?Object:a.VideoPlaylistsProvider,void 0===s.Props?Object:s.Props])],l);const{Provider:c,useModel:u}=(0,s.createProvider)(l,{isolatedContext:!1,onlyTransient:!0})},585875:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoProvider:()=>o.VideoRestoreFromVideoProvider,useVideoRestoreFromVideoModel:()=>o.useVideoRestoreFromVideoModel});var o=i(375260)},156657:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveButtonWidget:()=>r.VideoRestoreFromFaveButtonWidget,VideoRestoreFromLikesButtonWidget:()=>s.VideoRestoreFromLikesButtonWidget,VideoRestoreFromVideoButtonWidget:()=>o.VideoRestoreFromVideoButtonWidget});var o=i(209340),r=i(887329),s=i(381915)},175380:(e,t,i)=>{i.d(t,{FINISHED_LIVE_STATUSES:()=>r,SNACKBAR_TIMEOUT:()=>o,VIDEO_CARD_TITLE_EPISODE_THUMB_WIDTH:()=>s});const o=4e3,r=["postlive","finished"],s=48},609253:(e,t,i)=>{i.d(t,{CommentsWidget:()=>r.CommentsWidget,SNACKBAR_TIMEOUT:()=>s.SNACKBAR_TIMEOUT,StatsService:()=>c.StatsService,VideoClipsWidget:()=>l.VideoClipsWidget,VideoGeoBlockButton:()=>u.VideoGeoBlockButton,VideoGeoRestrictionsWithPortal:()=>u.VideoGeoRestrictionsWithPortal,showAddToGroupAlbumModal:()=>o.showAddToGroupAlbumModal,showEditPlaylistCategoriesModal:()=>n.showEditPlaylistCategoriesModal,showNewOrReplacePopout:()=>c.showNewOrReplacePopout,showPlaylistModal:()=>a.showPlaylistModal,showPlaylistModalWidget:()=>h.showPlaylistModalWidget,showSaveFailedPopout:()=>c.showSaveFailedPopout,showSubscriptionsActualizationModal:()=>d.showSubscriptionsActualizationModal});var o=i(828463),r=i(622108),s=i(175380),n=i(947658),a=(i(731956),i(570085)),d=i(766169),l=(i(692851),i(779584)),c=i(191792),u=i(816659),h=i(990305);i(156657)},800513:(e,t,i)=>{i.d(t,{VideoEditPlaylistCategoriesModal:()=>n});var o=i(132028),r=i(746471),s=i(900545);const n=(0,o.createWidget)(s.EditPlaylistCategoriesModalProvider,r.EditPlaylistCategoriesModal)},419668:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModal:()=>d});var o=i(474848),r=i(456921),s=i(211413),n=i(900545),a=i(566370);const d=(0,r.observer)((function(){const{isShow:e,isInitialLoading:t,refreshCoordinates:i}=(0,n.useEditPlaylistCategoriesModalModel)();return e?t?(0,o.jsx)(s.MessageBoxModalLoader,{refreshCoordinates:i}):(0,o.jsx)(a.ModalBox,{}):null}))},779625:(e,t,i)=>{i.d(t,{Errors:()=>l});var o=i(474848),r=i(149333),s=i(303800),n=i(836422),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{submitError:t}=(0,d.useEditPlaylistCategoriesModalModel)();return t?(0,o.jsx)(s.Div,{mode:"horizontal",spacing:12,children:(0,o.jsx)(s.Div,{mode:"horizontal",spacing:0,children:(0,o.jsx)(n.FormStatus,{header:e.getLang("video_edit_playlist_categories_modal_error_submit"),mode:"error"})})}):null}))},384908:(e,t,i)=>{i.d(t,{ActorsField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t,getOptions:i,dynamicTags:a}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"actors",top:e.getLang("video_edit_playlist_categories_modal_actors_field_label"),children:(0,o.jsx)(n.ChipsSelect,{id:"actors",onInputChange:e=>a.loadTags("actors",e?.target.value),options:i("actors"),fetching:a.checkLoading("actors"),onChange:t?.actors.change,value:t?.actors.value,emptyText:a.checkSearchLengthError("actors")?e.getLang("video_edit_playlist_categories_modal_search_minimum_symbols_error"):void 0,forceDropdownPortal:!1})})}))},542810:(e,t,i)=>{i.d(t,{CategoriesField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"categories",top:e.getLang("video_edit_playlist_categories_modal_categories_field_label"),children:(0,o.jsx)(n.ChipsSelect,{id:"categories",options:i("categories"),onChange:t?.categories.change,value:t?.categories.value,forceDropdownPortal:!1})})}))},928698:(e,t,i)=>{i.d(t,{CountriesField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"countries",top:e.getLang("video_edit_playlist_categories_modal_countries_field_label"),children:(0,o.jsx)(n.ChipsSelect,{id:"countries",options:i("countries"),onChange:t?.countries.change,value:t?.countries.value,forceDropdownPortal:!1})})}))},175192:(e,t,i)=>{i.d(t,{CustomTagsField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"customTags",top:e.getLang("video_edit_playlist_categories_modal_tags_field_label"),children:(0,o.jsx)(n.ChipsSelect,{id:"customTags",options:i("customTags"),onChange:t?.customTags.change,value:t?.customTags.value,forceDropdownPortal:!1})})}))},486649:(e,t,i)=>{i.d(t,{DirectorsField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t,getOptions:i,dynamicTags:a}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"director",top:e.getLang("video_edit_playlist_categories_modal_directors_field_label"),children:(0,o.jsx)(n.ChipsSelect,{id:"director",onInputChange:e=>a.loadTags("directors",e?.target.value),options:i("directors"),fetching:a.checkLoading("directors"),onChange:t?.directors.change,value:t?.directors.value,emptyText:a.checkSearchLengthError("directors")?e.getLang("video_edit_playlist_categories_modal_search_minimum_symbols_error"):void 0,forceDropdownPortal:!1})})}))},590902:(e,t,i)=>{i.d(t,{GenresField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"genres",top:e.getLang("video_edit_playlist_categories_modal_genres_field_label"),children:(0,o.jsx)(n.ChipsSelect,{id:"genres",options:i("genres"),onChange:t?.genres.change,value:t?.genres.value,forceDropdownPortal:!1})})}))},331778:(e,t,i)=>{i.d(t,{KinopoiskIdField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"kinopoiskId",top:e.getLang("video_edit_playlist_categories_modal_kinopoisk_id_field_label"),mode:"horizontal",children:(0,o.jsx)(n.Input,{id:"kinopoiskId",defaultValue:t?.kinopoiskId.value,onChange:e=>t?.kinopoiskId.change(e.target.value)})})}))},183553:(e,t,i)=>{i.d(t,{PlaylistMarkField:()=>l});var o=i(474848),r=i(44544),s=i(220208),n=i(149333),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,n.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"playlistMark",top:e.getLang("video_edit_playlist_categories_modal_playlist_mark_field_label"),mode:"horizontal",children:(0,o.jsx)(s.Select,{id:"playlistMark",options:i("playlistMark"),value:t?.playlistMark.value,onChange:e=>t?.playlistMark.change(e.target.value),forceDropdownPortal:!1})})}))},408012:(e,t,i)=>{i.d(t,{RatingAgeField:()=>l});var o=i(474848),r=i(44544),s=i(220208),n=i(149333),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,n.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"ratingAge",top:e.getLang("video_edit_playlist_categories_modal_rating_age_field_label"),mode:"horizontal",children:(0,o.jsx)(s.Select,{id:"ratingAge",options:i("ratingAge"),value:t?.ratingAge.value,onChange:e=>t?.ratingAge.change(e.target.value),forceDropdownPortal:!1})})}))},27164:(e,t,i)=>{i.d(t,{RatingKinopoiskField:()=>u});var o=i(474848),r=i(149333),s=i(551737),n=i(44544),a=i(712616),d=i(456921),l=i(900545);const c=(0,s.maskitoNumberOptionsGenerator)({precision:1,min:1,max:10}),u=(0,d.observer)((function(){const e=(0,r.useLangs)(),{fields:t}=(0,l.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(n.FormItem,{htmlFor:"kinopoiskRate",top:e.getLang("video_edit_playlist_categories_modal_kinopoisk_rating_field_label"),mode:"horizontal",children:(0,o.jsx)(a.MaskedInput,{maskOptions:c,id:"kinopoiskRate",value:t?.ratingKinopoisk.value||"",onInput:e=>t?.ratingKinopoisk.change(e.target.value)})})}))},935691:(e,t,i)=>{i.d(t,{YearField:()=>l});var o=i(474848),r=i(149333),s=i(44544),n=i(220208),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{fields:t}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"year",top:e.getLang("video_edit_playlist_categories_modal_year_field_label"),mode:"horizontal",children:(0,o.jsx)(n.Input,{id:"year",defaultValue:t?.year.value,onChange:e=>t?.year.change(e.target.value)})})}))},488978:(e,t,i)=>{i.d(t,{ActorsField:()=>o.ActorsField,CategoriesField:()=>s.CategoriesField,CountriesField:()=>n.CountriesField,CustomTagsField:()=>u.CustomTagsField,DirectorsField:()=>a.DirectorsField,GenresField:()=>d.GenresField,KinopoiskIdField:()=>l.KinopoiskIdField,PlaylistMarkField:()=>p.PlaylistMarkField,RatingAgeField:()=>r.RatingAgeField,RatingKinopoiskField:()=>c.RatingKinopoiskField,YearField:()=>h.YearField});var o=i(384908),r=i(408012),s=i(542810),n=i(928698),a=i(486649),d=i(590902),l=i(331778),c=i(27164),u=i(175192),h=i(935691),p=i(183553)},857877:(e,t,i)=>{i.d(t,{Footer:()=>l});var o=i(474848),r=i(149333),s=i(908242),n=i(454154),a=i(456921),d=i(900545);const l=(0,a.observer)((function(){const e=(0,r.useLangs)(),{submit:t,isLoading:i,isSubmitDisabled:a,close:l}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.ModalFooter,{actions:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.Button,{mode:"secondary",size:"m",onClick:l,children:e.getLang("video_edit_playlist_categories_modal_close")}),(0,o.jsx)(n.Button,{mode:"primary",size:"m",onClick:t,loading:i,disabled:a,children:e.getLang("video_edit_playlist_categories_modal_submit")})]})})}))},922439:(e,t,i)=>{i.d(t,{Header:()=>d});var o=i(474848),r=i(149333),s=i(782174),n=i(456921),a=i(900545);const d=(0,n.observer)((function(){const e=(0,r.useLangs)(),{close:t}=(0,a.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.ModalHeader,{closeAriaLabel:e.getLang("video_edit_playlist_categories_modal_close"),onClose:t,children:e.getLang("video_edit_playlist_categories_modal_header")})}))},379722:(e,t,i)=>{i.d(t,{ModalBox:()=>u});var o=i(474848),r=i(694244),s=i(63614),n=i(303800),a=i(488978),d=i(779625),l=i(922439),c=i(857877);const u=()=>(0,o.jsxs)(r.ModalBox,{width:420,children:[(0,o.jsx)(l.Header,{}),(0,o.jsxs)(s.ModalBody,{insetLevel:0,children:[(0,o.jsx)(d.Errors,{}),(0,o.jsxs)(n.Div,{paddingTop:0,children:[(0,o.jsx)(a.CategoriesField,{}),(0,o.jsx)(a.ActorsField,{}),(0,o.jsx)(a.DirectorsField,{}),(0,o.jsx)(a.CountriesField,{}),(0,o.jsx)(a.GenresField,{}),(0,o.jsx)(a.CustomTagsField,{}),(0,o.jsx)(a.KinopoiskIdField,{}),(0,o.jsx)(a.YearField,{}),(0,o.jsx)(a.RatingKinopoiskField,{}),(0,o.jsx)(a.RatingAgeField,{}),(0,o.jsx)(a.PlaylistMarkField,{})]})]}),(0,o.jsx)(c.Footer,{})]})},566370:(e,t,i)=>{i.d(t,{ModalBox:()=>o.ModalBox});var o=i(379722)},746471:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModal:()=>o.EditPlaylistCategoriesModal});var o=i(419668)},952666:(e,t,i)=>{i.d(t,{showEditPlaylistCategoriesModal:()=>o.showEditPlaylistCategoriesModal});i(800513);var o=i(586298)},888628:(e,t,i)=>{i.d(t,{DynamicTags:()=>a});var o=i(327813),r=i(165268),s=i(8520);const n={actors:r.VideoMovieInfoDropdownDataTypeParams.ACTOR,directors:r.VideoMovieInfoDropdownDataTypeParams.DIRECTOR};class a{setSearchError(e,t){this.searchLengthErrors.set(e,t)}constructor(e){this.movieInfoDropdownProvider=e,this.checkLoading=e=>Boolean(this.pendingMap.get(e)),this.checkSearchLengthError=e=>this.searchLengthErrors.get(e)??!0,this.get=e=>this.dynamicOptions.get(e)||[],this.loadTags=(0,s.debounce)((async(e,t)=>{if(this.setSearchError(e,!1),t.length<2)return this.setSearchError(e,!0),void this.dynamicOptions.delete(e);this.checkLoading(e)&&this.pendingMap.get(e)?.controller.abort();const i=new AbortController,r=this.movieInfoDropdownProvider.fetch({type:n[e],search:t},{signal:i.signal});this.pendingMap.set(e,{request:r,controller:i});try{const t=await r;(0,o.runInAction)((()=>{this.dynamicOptions.set(e,t),this.pendingMap.delete(e)}))}catch(t){(0,o.runInAction)((()=>{this.dynamicOptions.delete(e)}))}}),400),this.pendingMap=new Map,this.dynamicOptions=new Map,this.searchLengthErrors=new Map,(0,o.makeAutoObservable)(this)}}},135330:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModalProvider:()=>h,useEditPlaylistCategoriesModalModel:()=>p});var o=i(331635),r=i(132028),s=i(406341),n=i(165268),a=i(327813),d=i(283304),l=i(888628),c=i(798103);class u{get dynamicTags(){return this._dynamicTags}get isShow(){return this._isShow}get refreshCoordinates(){return this._props.current.refreshCoordinates}get isInitialLoading(){return this._isInitialLoading}get isLoading(){return this._isLoading}get submitError(){return this._submitError}get isSubmitDisabled(){return!this._form?.isChanged}get fields(){return this._form?.fields}async[r.init](){this._isInitialLoading=!0,this.abortController=new AbortController;try{const e=await this.movieInfoProvider.fetch({ownerId:this.ownerId,playlistId:this.playlistId},{signal:this.abortController.signal});(0,a.runInAction)((()=>{this._currentState=e,this._form=new c.Form({fields:{categories:{value:(0,d.getOptionsByIds)(this._currentState?.values.categoryIds,this.getOptions("categories"))},actors:{value:(0,d.getOptionsByTags)(this._currentState?.values.actors)},directors:{value:(0,d.getOptionsByTags)(this._currentState?.values.directors)},countries:{value:(0,d.getOptionsByIds)(this._currentState?.values.countryIds,this.getOptions("countries"))},genres:{value:(0,d.getOptionsByIds)(this._currentState?.values.genreIds,this.getOptions("genres"))},customTags:{value:(0,d.getOptionsByIds)(this._currentState?.values.customTagIds,this.getOptions("customTags"))},kinopoiskId:{value:String(this._currentState?.values.kinopoiskId||"")},year:{value:String(this._currentState?.values.year||"")},ratingKinopoisk:{value:(0,d.getRatingKinopoisk)(this._currentState?.values.ratingKinopoisk)},ratingAge:{value:String(this._currentState?.values.ratingAge||"")},playlistMark:{value:String(this._currentState?.values.playlistMark||"")}}})}))}catch(e){(0,a.runInAction)((()=>{this._currentState=void 0}))}finally{(0,a.runInAction)((()=>{this._isInitialLoading=!1,this.abortController=null}))}}[r.destroy](){this.abortController?.abort()}get ownerId(){return this._props.current.ownerId}get playlistId(){return this._props.current.playlistId}constructor(e,t,i){this.movieInfoProvider=e,this.movieInfoDropdownProvider=t,this._props=i,this.getOptions=e=>"ratingAge"===e?(0,d.getOptionsByTags)(this._currentState?.options.ratingAges):"playlistMark"===e?(0,d.getOptionsByTags)(this._currentState?.options.playlistMarks):"actors"===e||"directors"===e?(0,d.getOptionsByTags)(this._dynamicTags.get(e),!0):(0,d.getOptionsByTags)(this._currentState?.options[e]),this.close=()=>{this._isShow=!1,this._props.current.onClose()},this.submit=async()=>{if(this._currentState&&this.fields){this._submitError=!1,this._isLoading=!0;try{await this.movieInfoProvider.update({ownerId:this.ownerId,playlistId:this.playlistId,infoUpdatedAt:this._currentState.values.infoUpdatedAt,ratingAge:(0,d.getNumberOrUndefined)(this.fields.ratingAge.value),year:(0,d.getNumberOrUndefined)(this.fields.year.value),ratingKinopoisk:(0,d.getNumberOrUndefined)(this.fields.ratingKinopoisk.value,!0),kinopoiskId:(0,d.getNumberOrUndefined)(this.fields.kinopoiskId.value),categoryIds:(0,d.getIdsFromOptions)(this.fields.categories.value),actorIds:(0,d.getIdsFromOptions)(this.fields.actors.value),directorIds:(0,d.getIdsFromOptions)(this.fields.directors.value),countryIds:(0,d.getIdsFromOptions)(this.fields.countries.value),genreIds:(0,d.getIdsFromOptions)(this.fields.genres.value),customTagIds:(0,d.getIdsFromOptions)(this.fields.customTags.value),playlistMark:(0,d.getNumberOrUndefined)(this.fields.playlistMark.value)})&&this.close()}catch(e){(0,a.runInAction)((()=>{this._submitError=!0}))}finally{(0,a.runInAction)((()=>{this._isLoading=!1}))}}},this._form=void 0,this._isShow=!0,this._isInitialLoading=!1,this._isLoading=!1,this._submitError=!1,this._currentState=void 0,this.abortController=null,this._dynamicTags=new l.DynamicTags(t),(0,a.makeAutoObservable)(this)}}u=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.VideoMovieInfoProvider?Object:s.VideoMovieInfoProvider,void 0===n.VideoMovieInfoDropdownDataProvider?Object:n.VideoMovieInfoDropdownDataProvider,void 0===r.Props?Object:r.Props])],u);const{Provider:h,useModel:p}=(0,r.createProvider)(u,{isolatedContext:!1,onlyTransient:!0})},604388:(e,t,i)=>{i.d(t,{Form:()=>s});var o=i(327813),r=i(916790);class s{get isChanged(){return this.fieldKeys.reduce(((e,t)=>e||this._fields[t].isChanged),!1)}get isValid(){return this.fieldKeys.reduce(((e,t)=>e||this._fields[t].isValid),!1)}get fields(){return this._fields}validate(){return this.fieldKeys.reduce(((e,t)=>{const i=this._fields[t].validate();return i&&e.push(i),e}),[])}get fieldKeys(){return Object.keys(this._fields)}constructor({fields:e}){this._fields={},Object.keys(e).forEach((t=>{this._fields[t]=new r.FormField(e[t])})),(0,o.makeAutoObservable)(this)}}},916790:(e,t,i)=>{i.d(t,{FormField:()=>n});var o=i(327813),r=i(8520),s=i(431541);class n{get value(){return this._value}get changedValue(){if(this._changed)return this._value}get isChanged(){return this._changed}get isValid(){return!this.validationError}get validationError(){return this._validationError}validateValue(e){const t=this.validateByRequired();if(t)return this._validationError=t,t;const i=this.validator(e);return this._validationError=i,i}validateByRequired(){return this._required&&!this._value||this._required&&Array.isArray(this._value)&&this._value?.length?s.ValidationErrors.REQUIRED:""}constructor({value:e,validator:t,required:i,preparator:s}){this.change=e=>{const t=this.preparator(e);this._changed=!(0,r.isEqual)(t,this._initialValue),this._value=t,this.validateValue(t)},this.validate=()=>{const e=this.validateByRequired();if(e)return this._validationError=e,e;const t=this.validator(this._value);return this._validationError=t,t},this._initialValue=void 0,this._changed=!1,this._validationError="",this._value=void 0,this._required=Boolean(i),this._value=e,this._initialValue=e,this.preparator=s||(e=>e),this.validator=t||(()=>""),(0,o.makeAutoObservable)(this)}}},798103:(e,t,i)=>{i.d(t,{Form:()=>o.Form});i(431541);var o=i(604388);i(916790)},431541:(e,t,i)=>{i.d(t,{ValidationErrors:()=>o});var o=function(e){return e.REQUIRED="required",e}({})},900545:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModalProvider:()=>o.EditPlaylistCategoriesModalProvider,useEditPlaylistCategoriesModalModel:()=>o.useEditPlaylistCategoriesModalModel});var o=i(135330)},283304:(e,t,i)=>{i.d(t,{getIdsFromOptions:()=>s,getNumberOrUndefined:()=>n,getOptionsByIds:()=>o,getOptionsByTags:()=>r,getRatingKinopoisk:()=>a});const o=(e,t)=>e&&e.length&&t?t.filter((({value:t})=>e.includes(Number(t)))):[],r=(e,t=!1)=>e?e.map((({id:e,name:i})=>({value:e,label:t?`${i} (${e})`:i}))):[],s=e=>{if(e)return e.map((e=>Number(e.value)))},n=(e,t)=>{if(!e)return;if(!t)return Number(e);const i=e.includes(".0")?e.split(".")[0]:e.replace(".","");return Number(i)},a=e=>{if(!e)return"";if(10===e)return String(e);const[t,...i]=String(e);return i.length?[t,".",...i].join(""):t}},586298:(e,t,i)=>{i.d(t,{showEditPlaylistCategoriesModal:()=>n});var o=i(474848),r=i(211413),s=i(800513);const n=e=>{(0,r.showMessageBoxModal)((t=>(0,o.jsx)(s.VideoEditPlaylistCategoriesModal,{...e,...t})),{fullscreen:!0})}},947658:(e,t,i)=>{i.d(t,{showEditPlaylistCategoriesModal:()=>o.showEditPlaylistCategoriesModal});var o=i(952666)},95417:(e,t,i)=>{function o(e,t){return t?e?.ids?.includes(t)?e.ids:[]:e?.ids??[]}i.d(t,{getListIds:()=>o})},453852:(e,t,i)=>{i.d(t,{getPlaylistUrl:()=>o});const o=e=>`/video/playlist/${e}`},680635:(e,t,i)=>{i.d(t,{getListIds:()=>s.getListIds,getPlaylistUrl:()=>o.getPlaylistUrl,isLiveVideo:()=>r.isLiveVideo,showFailSnackbar:()=>n.showFailSnackbar,showSuccessSnackbar:()=>n.showSuccessSnackbar});var o=i(453852),r=i(425874),s=i(95417),n=i(507843)},425874:(e,t,i)=>{i.d(t,{isLiveVideo:()=>r});var o=i(175380);const r=({live_status:e})=>Boolean(e&&!o.FINISHED_LIVE_STATUSES.includes(e))},507843:(e,t,i)=>{i.d(t,{showFailSnackbar:()=>a,showSuccessSnackbar:()=>n});var o=i(474848),r=i(818515),s=i(175380);const n=(e,t)=>{e.show({text:t,type:"ok",duration:s.SNACKBAR_TIMEOUT,before:{content:(0,o.jsx)(r.Icon28ListCheckOutline,{})}})},a=(e,t)=>{e.show({text:t,type:"error",duration:s.SNACKBAR_TIMEOUT,before:{content:(0,o.jsx)(r.Icon28ListCheckOutline,{})}})}},896412:(e,t,i)=>{function o(e){e.preventDefault(),e.stopPropagation()}i.d(t,{cancelEvent:()=>o})},324742:(e,t,i)=>{i.d(t,{BlackListService:()=>u});var o=i(331635),r=i(327813),s=i(21632),n=i(24516),a=i(132028),d=i(468073),l=i(33305),c=i(331488);class u{get isFirstLoadingProgress(){return this.isLoading&&this._isFirstLoad}get total(){return this.totalAvailable}get loadedCount(){return this.itemsMap.size}get allLoaded(){return!this.isLoading&&this.itemsMap.size>=this.totalAvailable}get orderedItems(){return this.itemsOrder.reduce(((e,t)=>{const i=this.itemsMap.get(t),o=this.itemsStates.get(t);return i&&o&&e.push({...i,state:o}),e}),[])}getItemById(e){const t=this.itemsMap.get(e),i=this.itemsStates.get(e);return t&&i?{...t,state:i}:void 0}get blacklistedIds(){const e=[];return this.itemsStates.forEach(((t,i)=>{t.changing||t.status===c.BlackListItemStatus.Removed||e.push(i)})),e}async performLoadMore(){const e={offset:this.offset,count:this.pageSize,fields:this.userFields.join(",")},t=this.userEnv.partConfigEnabled("web_settings_api_prefetch")?this.accountApi.getBannedWithPrefetch(e):this.accountApi.getBanned(e),i=await t,o=i.profiles??[],s=i.groups??[],n=i.items?.map((e=>d.Ranges.isGroupId(e)?s.find((t=>d.Ranges.convertGroupIdToOwnerIdStrict(t.id)===e)):o.find((t=>t.id===e))));(0,r.runInAction)((()=>{this.offset+=this.pageSize,this.totalAvailable=i.count;for(const e of n){if(!e)continue;const t=(0,l.isOwnerUser)(e)?(0,c.fromUser)(e):(0,c.fromGroup)(e);this.itemsMap.set(t.id,t),this.itemsStates.set(t.id,t.state),this.itemsOrder.includes(t.id)||this.itemsOrder.push(t.id)}this.loadingMore=null}))}updateItem({id:e,...t}){const i=this.itemsStates.get(e);if(i){const o={...i,...t};this.itemsStates.set(e,o)}}revertItem(e,t){this.updateItem({id:e,status:t,changing:!1})}constructor(e,t){this.accountApi=e,this.userEnv=t,this.isLoading=!1,this.pageSize=20,this.userFields=[],this.itemsMap=new Map,this.itemsStates=new Map,this.itemsOrder=[],this.offset=0,this.totalAvailable=0,this.loadingMore=null,this._isFirstLoad=!0,this.loadMore=async()=>{this.isLoading=!0,null===this.loadingMore&&(this.loadingMore=this.performLoadMore()),await this.loadingMore,(0,r.runInAction)((()=>{this.isLoading=!1,this._isFirstLoad=!1}))},this.add=async e=>{this.itemsMap.has(e.id)?this.updateItem({id:e.id,changing:!0,status:c.BlackListItemStatus.Restored}):(this.itemsMap.set(e.id,e),this.itemsStates.set(e.id,{changing:!0,status:c.BlackListItemStatus.Idle}),this.itemsOrder.includes(e.id)||this.itemsOrder.unshift(e.id));try{await this.accountApi.ban({owner_id:e.id}),(0,r.runInAction)((()=>{this.updateItem({id:e.id,changing:!1}),this.totalAvailable++}))}catch(t){throw this.updateItem({id:e.id,changing:!1,status:c.BlackListItemStatus.NotAdded}),t}},this.remove=async e=>{const t=this.getItemById(e),i=t?.state?.status||c.BlackListItemStatus.Idle;this.updateItem({id:e,changing:!0});try{await this.accountApi.unban({owner_id:e}),(0,r.runInAction)((()=>{this.updateItem({id:e,changing:!1,status:c.BlackListItemStatus.Removed}),this.totalAvailable--}))}catch(t){throw this.revertItem(e,i),t}},this.restore=async e=>{const t=this.getItemById(e),i=t?.state?.status||c.BlackListItemStatus.Removed;this.updateItem({id:e,changing:!0});try{await this.accountApi.ban({owner_id:e}),(0,r.runInAction)((()=>{this.updateItem({id:e,changing:!1,status:c.BlackListItemStatus.Restored}),this.totalAvailable++}))}catch(t){throw this.revertItem(e,i),t}},(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.AccountApi?Object:s.AccountApi,void 0===n.UserEnv?Object:n.UserEnv])],u)},331488:(e,t,i)=>{i.d(t,{BlackListItemStatus:()=>s,fromGroup:()=>a,fromUser:()=>n});var o=i(33305),r=i(468073),s=function(e){return e[e.Idle=0]="Idle",e[e.Removed=1]="Removed",e[e.Restored=2]="Restored",e[e.NotAdded=3]="NotAdded",e}({});const n=(e,t={changing:!1,status:0})=>({type:"user",id:e.id,name:(0,o.getOwnerFullName)(e)||"",href:(0,o.getOwnerHref)(e),occupation:e.occupation,online:e.online,online_mobile:e.online_mobile,photo_50:e.photo_50,verified:e.verified,sex:e.sex,state:t,deactivated:e.deactivated}),a=(e,t={changing:!1,status:0})=>({type:"group",id:r.Ranges.convertGroupIdToOwnerIdStrict(e.id),name:e.name||"",href:(0,o.getOwnerHref)(e),photo_50:e.photo_50,verified:e.verified,state:t,deactivated:e.deactivated})},152685:(e,t,i)=>{i.d(t,{creatPlaceholdersProvider:()=>s,createCatalogPlaceholdersProvider:()=>r});var o=i(154481);const r=()=>new o.CatalogEntityProvider(new o.CatalogEntitiesBaseStore({toKey:e=>e.id})),s=r},301250:(e,t,i)=>{i.d(t,{FriendsService:()=>d});var o=i(331635),r=i(327813),s=i(208214),n=i(132028),a=i(655465);class d{async fetch(e,t){const i=await this.friendsApi.get(e,t);if((0,a.isFriendsGetFieldsResponse)(i))throw new Error("Unexpected friends.get fetch response format");return i}async fetchFields(e,t){const i=await this.friendsApi.get(e,t);if(!(0,a.isFriendsGetFieldsResponse)(i))throw new Error("Unexpected friends.get fetchFields response format");return i}constructor(e){this.friendsApi=e,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([n.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.FriendsApi?Object:s.FriendsApi])],d)},3969:(e,t,i)=>{i.d(t,{FriendsListsListsProvider:()=>l});var o=i(331635),r=i(327813),s=i(208214),n=i(951652),a=i(24516),d=i(132028);class l{getIsLoading(e){return Boolean(this.requestsMap.get(e))}getIsLoadingCurrentUser(){return this.getIsLoading(this.authService.ensureUserId())}async request(e,t){this.abortController=new AbortController;const i=this.userEnv.partConfigEnabled("web_settings_api_prefetch")?this.friendsApi.getListsWithPrefetch(e,{signal:this.abortController?.signal}):this.friendsApi.getLists(e,{signal:this.abortController?.signal}),o=await i;return this.friendsListMap.set(t,o.items),o.items}async fetch(e){const t={user_id:e.userId,return_system:e.returnSystem?1:0},i=this.request(t,e.userId);this.requestsMap.set(e.userId,i);try{return await i}catch{return[]}finally{this.requestsMap.delete(e.userId)}}async ensure(e){const t=this.requestsMap.get(e.userId);if(t)return await t;const i=this.friendsListMap.get(e.userId);return i||this.fetch(e)}async ensureForCurrentUser(e={}){return this.ensure({...e,userId:this.authService.ensureUserId()})}reset(){this.friendsListMap.clear(),this.abortController?.abort(),this.requestsMap.clear()}constructor(e,t,i){this.friendsApi=e,this.authService=t,this.userEnv=i,this.abortController=null,this.requestsMap=new Map,this.friendsListMap=new Map,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([d.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.FriendsApi?Object:s.FriendsApi,void 0===n.AuthService?Object:n.AuthService,void 0===a.UserEnv?Object:a.UserEnv])],l)},889781:(e,t,i)=>{i.d(t,{FriendsSearchService:()=>a});var o=i(331635),r=i(327813),s=i(208214),n=i(132028);class a{async search(e,t){return this.friendsApi.search(e,t)}constructor(e){this.friendsApi=e,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([n.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.FriendsApi?Object:s.FriendsApi])],a)},655465:(e,t,i)=>{i.d(t,{isFriendsGetFieldsResponse:()=>o});const o=e=>!e.items.length||e.items.some((e=>"number"!=typeof e))},715799:(e,t,i)=>{i.d(t,{ShortVideoCoOwnerService:()=>d});var o=i(331635),r=i(132028),s=i(327813),n=i(914492),a=i(632520);class d{setPending(e,t){this.pendingMap.set(e,t)}getCoOwnerIds(e){return this.shortVideoVideosProvider.get(e)?.data.short_video_info?.co_owners?.filter((e=>"approved"===e.status)).map((e=>e.owner_id))??[]}markAsLoaded(e){this.loadedSet.add(e)}isPending(e){return!!this.pendingMap.get(e)}isLoaded(e){return this.loadedSet.has(e)}getCoOwners(e){return this.getCoOwnerIds(e).map((e=>this.shortVideoOwnersProvider.get(e))).filter(Boolean)}async fetchCoOwnersInfo(e){if(this.isLoaded(e))return;if(!this.shortVideoVideosProvider.get(e))try{this.setPending(e,!0),await this.shortVideoVideosProvider.fetchAllFields(e)}catch(e){throw new Error("Fetch video for co-owners failed",{cause:e})}finally{this.setPending(e,!1)}const t=this.getCoOwnerIds(e);if(0!==t.length&&!this.isPending(e)){this.setPending(e,!0);try{await Promise.all(t.map((e=>this.shortVideoOwnersProvider.ensure(e)))),this.markAsLoaded(e),this.setPending(e,!1)}catch(t){throw this.setPending(e,!1),new Error("Fetch groups/users failed",{cause:t})}}}constructor(e,t){this.shortVideoVideosProvider=e,this.shortVideoOwnersProvider=t,this.pendingMap=new Map,this.loadedSet=new Set,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===n.ShortVideoOwnersProvider?Object:n.ShortVideoOwnersProvider])],d)},961189:(e,t,i)=>{i.d(t,{ShortVideoAuthorAnalytics:()=>a});var o=i(331635),r=i(132028),s=i(655758),n=i(951652);class a{logBaseClickEvent({event:e,screen:t}){this.productionStats.send({screen:t,type:"type_click",type_click:e})}constructor(e,t){this.productionStats=e,this.authService=t,this.logClickToCoowners=({ownerId:e,videoId:t,trackCode:i,screen:o="clips"})=>{e&&t&&this.authService.userId&&this.logBaseClickEvent({screen:o,event:{item:{type:"clip",track_code:i},type:"type_clips_view_authors_click_item",type_clips_view_authors_click_item:{event_type:"view_authors",user_id:this.authService.userId,video_owner_id:e,video_id:t}}})},this.logClickLinkClickPostOwner=({ownerId:e,videoId:t,navScreen:i,trackCode:o,screen:r="clips"})=>{e&&t&&this.authService.userId&&this.logBaseClickEvent({screen:r,event:{item:{type:"clip",track_code:o},type:"type_clips_link_click_post_owner_click_item",type_clips_link_click_post_owner_click_item:{event_type:"link_click_post_owner",user_id:this.authService.userId,video_owner_id:e,video_id:t,nav_screen:i}}})},this.logClickToDescription=({ownerId:e,videoId:t,objectType:i,objectValue:o,trackCode:r,screen:s="clips"})=>{this.authService.userId&&this.logBaseClickEvent({screen:s,event:{item:{type:"clip",track_code:r},type:"type_clips_description_click_item",type_clips_description_click_item:{event_type:"click_to_description",video_owner_id:e,video_id:t,object_type:i,object_value:o}}})},this.logClickToExpandDescription=({ownerId:e,videoId:t,trackCode:i,screen:o="clips"})=>{this.authService.userId&&this.logBaseClickEvent({screen:o,event:{item:{type:"clip",track_code:i},type:"type_clips_description_click_item",type_clips_description_click_item:{event_type:"click_to_expand_description",video_owner_id:e,video_id:t}}})},this.logClickToSubscriptionButton=({ownerId:e,videoId:t,subtype:i,place:o,trackCode:r,screen:s="clips"})=>{this.authService.userId&&this.logBaseClickEvent({screen:s,event:{item:{type:"clip",track_code:r},type:"type_clip_viewer_item",type_clip_viewer_item:{type_clips_subscribe_click_item:{event_subtype:i,subscription_place:o},event_type:"click_to_subscription_button",video_owner_id:e,video_id:t}}})},this.logClickToDownloadButton=({ownerId:e,videoId:t,downloadQuality:i,downloadState:o,trackCode:r,screen:s="clips"})=>{this.authService.userId&&this.logBaseClickEvent({screen:s,event:{item:{type:"clip"},type:"type_clip_viewer_item",type_clip_viewer_item:{type_clips_download_click_item:{download_quality:i,download_state:o,owner_id:e,video_id:t,track_code:r},event_type:"download_state_change",video_owner_id:e,video_id:t}}})}}}a=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.ProductionStats?Object:s.ProductionStats,void 0===n.AuthService?Object:n.AuthService])],a)},964867:(e,t,i)=>{i.d(t,{ShortVideoBadgesProvider:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(632520),a=i(824358);class d{get(e){const t=this.badgesMap.get(e);if(!t){const t=new a.ShortVideoBadges(this.shortVideoVideosProvider,e);return this.badgesMap.set(e,t),t}return t}constructor(e){this.shortVideoVideosProvider=e,this.badgesMap=new Map,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider])],d)},824358:(e,t,i)=>{i.d(t,{ShortVideoBadges:()=>d});var o=i(327813),r=i(873900);function s(e){return e.parent?s(e.parent):e}function n(e){return Boolean(e.market_item)}function a(e){return Boolean(e.place_info)}class d{get shortVideo(){return this.shortVideoVideosProvider.get(this.clipId)}get shortVideoInfo(){return this.shortVideo?.data.short_video_info}get clickableStickers(){return this.shortVideoInfo?.clickable_stickers?.items??[]}get availableOnlyForOwner(){return Boolean("only_me"===this.shortVideo?.data.privacy_view?.category)}get marketItem(){const e=this.clickableStickers.find(n);if(!e||!e.market_item)return;const t=e.market_item;return{...t,ads_label:e.ads_label,is_service:12===s(t.category).id}}get placeInfo(){return this.clickableStickers.find(a)?.place_info}get duet(){const e=this.shortVideoInfo?.duet;if(e)return{...e,clip_id:(0,r.getIdentityRawIdOrUndefined)({ownerId:e.owner_id,id:e.video_id})}}get playlists(){return this.shortVideoInfo?.playlists??[]}get compilations(){return this.shortVideoInfo?.compilations??[]}get masks(){return this.shortVideoInfo?.masks??[]}get effects(){return this.shortVideoInfo?.effects??[]}constructor(e,t){this.shortVideoVideosProvider=e,this.clipId=t,(0,o.makeAutoObservable)(this)}}},782413:(e,t,i)=>{i.d(t,{ShortVideoVideoAnalytics:()=>d});var o=i(331635),r=i(132028),s=i(768035),n=i(655758),a=i(951652);class d{logBaseClickEvent({event:e,screen:t}){this.productionStats.send({screen:t,type:"type_click",type_click:e})}constructor(e,t){this.productionStats=e,this.authService=t,this.logClickOnActionButton=({clipRawId:e,objectRawId:t,url:i,type:o,screen:r="clips"})=>{if(!this.authService.userId)return;const{id:n,ownerId:a}=(0,s.parseRawId)(e);let d=0,l=0;try{const e=(0,s.parseRawId)(t);d=e.id,l=e.ownerId}catch{}this.productionStats.send({screen:r,type:"type_click",type_click:{item:{type:"clip"},type:"type_clip_viewer_item",type_clip_viewer_item:{event_type:"click_to_action_button",video_owner_id:a,video_id:n,object_type:o,object_owner_id:l,object_id:d,object_url:i}}})}}}d=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.ProductionStats?Object:n.ProductionStats,void 0===a.AuthService?Object:a.AuthService])],d)},891999:(e,t,i)=>{i.d(t,{UsersProvider:()=>a});var o=i(331635),r=i(132028),s=i(488709),n=i(327813);class a{createUserFromAPI(e){return(0,n.observable)(e)}async fetchUsersByIds(e,t,i=!1){return(await(i?this.usersApi.getWithPrefetch:this.usersApi.get)({user_ids:e.userIds.join(","),fields:e.fields?.join(",")},t)).map((e=>this.createUserFromAPI(e)))}constructor(e){this.usersApi=e,(0,n.makeAutoObservable)(this)}}a=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.UsersApi?Object:s.UsersApi])],a)},479804:(e,t,i)=>{i.d(t,{VideoPlaylistCreationService:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(859139),d=i(468073);class l{async create(e,t){const{ownerId:i,title:o,privacy:r,photoId:s,photoHash:n,verticalPhotoHash:l,verticalPhotoTag:c}=e,u={title:o};return void 0!==s&&(u.photo_id=s,u.photo_hash=n),void 0!==c&&(u.vertical_photo_tag=c,u.vertical_photo_hash=l),r&&(u.privacy=(0,a.stringifyBasePrivacy)(r)),d.Ranges.isGroupId(i)&&(u.group_id=d.Ranges.convertOwnerIdToGroupId(i)),this.videoApi.addAlbum(u,t)}constructor(e){this.videoApi=e,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],l)},263349:(e,t,i)=>{i.d(t,{VideoPlaylistThumbService:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(882044);class a{async upload(e,t,i){const o=await this.uploadThumb(e,{owner_id:t.ownerId,type:1},i);return this.videoApi.savePlaylistThumb({owner_id:t.ownerId,thumb_json:JSON.stringify(o),thumb_size:"l"},i)}async uploadAdditional(e,t,i){const o=await this.uploadThumb(e,{owner_id:t.ownerId,type:2},i);return this.videoApi.savePlaylistAdditionalThumb({owner_id:t.ownerId,thumb_json:JSON.stringify(o),thumb_size:"l"},i)}async uploadThumb(e,t,i){const o=await this.getPlaylistThumbUploadUrl(t,i);return this.uploadFile(e,o,i)}async getPlaylistThumbUploadUrl(e,t){const{upload_url:i}=await this.videoApi.getPlaylistThumbUploadUrl(e,t);return i}async uploadFile(e,t,i){const o=new FormData;o.append("photo",e);return(await fetch(t,{method:"POST",body:o,signal:i?.signal})).json()}constructor(e){this.videoApi=e,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],a)},491318:(e,t,i)=>{i.d(t,{VideoPlaylistsListService:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(800227);class d{getContainingVideoPlaylistIds(e){return this.playlistsIdByVideoMap.get(e)}getContainingVideoPlaylists(e){return this.playlistsByVideoMap.get(e)}async addToAlbum({videoId:e,albumId:t,albumIds:i,targetId:o,ownerId:r,accessKey:s,ref:n,context:a},d){const l={video_id:e,target_id:o,access_key:s,owner_id:r,album_id:t,album_ids:i?.join(","),ref:n,context:a};return await this.videoApi.addToAlbum(l,d)}async removeFromAlbum({ownerId:e,albumId:t,albumIds:i,targetId:o,videoId:r},s){const n={owner_id:e,video_id:r,album_id:t,target_id:o,album_ids:i?.join(",")};return await this.videoApi.removeFromAlbum(n,s)}async fetchAlbumsByVideo({targetId:e,videoId:t,ownerId:i,extended:o},s){const n={extended:(0,a.convertToBooleanParam)(o),video_id:t,target_id:e,owner_id:i},d=await this.videoApi.getAlbumsByVideo(n,s);return(0,r.runInAction)((()=>{if(Array.isArray(d))this.playlistsIdByVideoMap.set(n.video_id,new Set(d));else{const e=d.items.map((e=>e.id));this.playlistsIdByVideoMap.set(n.video_id,new Set(e)),this.playlistsByVideoMap.set(n.video_id,d.items)}})),d}constructor(e){this.videoApi=e,this.playlistsIdByVideoMap=new Map,this.playlistsByVideoMap=new Map,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],d)},485484:(e,t,i)=>{i.d(t,{VideoBookmarksService:()=>d});var o=i(331635),r=i(132028),s=i(972573),n=i(327813),a=i(538522);class d{async add({videoId:e,ownerId:t,ref:i,source:o},r){const s=(0,a.joinRawId)({itemId:e,ownerId:t});if(this.isBookmarkDeleting(s))return!1;const n={owner_id:t,id:e,ref:i,source:o};this.videoBookmarkAddingMap.set(s,!0);try{const e=await this.faveApi.addVideo(n,r);return this.videoBookmarkAddedMap.set(s,!0),e}finally{this.videoBookmarkAddingMap.set(s,!1)}}async remove({videoId:e,ownerId:t,ref:i,source:o},r){const s=(0,a.joinRawId)({itemId:e,ownerId:t});if(this.isBookmarkAdding(s))return!1;const n={owner_id:t,id:e,ref:i,source:o};this.videoBookmarkDeletingMap.set(s,!0);try{const e=await this.faveApi.removeVideo(n,r);return this.videoBookmarkAddedMap.set(s,!1),e}finally{this.videoBookmarkDeletingMap.set(s,!1)}}isBookmarkAdded(e){return this.videoBookmarkAddedMap.get(e)}isBookmarkAdding(e){return this.videoBookmarkAddingMap.get(e)}isBookmarkDeleting(e){return this.videoBookmarkDeletingMap.get(e)}constructor(e){this.faveApi=e,this.videoBookmarkAddedMap=new Map,this.videoBookmarkAddingMap=new Map,this.videoBookmarkDeletingMap=new Map,(0,n.makeAutoObservable)(this)}}d=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.FaveApi?Object:s.FaveApi])],d)},343825:(e,t,i)=>{i.d(t,{VideoCommentCreationService:()=>u});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(951652),d=i(873900),l=i(607417),c=i(800227);class u{async createComment(e){if(!this.authService.userId)return;const t={video_id:e.videoId,owner_id:e.ownerId,from_group:(0,c.convertToBooleanParam)(e.isCommentFromGroup),reply_to_comment:e.replyToCommentId,access_key:e.accessKey};e.stickerId?t.sticker_id=e.stickerId:(t.message=e.message,t.attachments=e.attachments);const i=await this.videoApi.createComment(t),o=e.fields??[];return await this.commentsProvider.fetch({ownerId:e.ownerId,commentId:i,fields:o},{}),(0,d.getIdentityRawId)({id:i,ownerId:e.isCommentFromGroup?e.ownerId:this.authService.userId})}constructor(e,t,i){this.videoApi=e,this.commentsProvider=t,this.authService=i,(0,r.makeAutoObservable)(this)}}u=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi,void 0===l.VideoCommentsProvider?Object:l.VideoCommentsProvider,void 0===a.AuthService?Object:a.AuthService])],u)},473905:(e,t,i)=>{i.d(t,{VideoCommentsDeletingService:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(361121);class d{async delete(e,t){const{commentId:i,ownerId:o}=e,s={owner_id:o,comment_id:(0,a.splitRawId)(i).itemId};this.videoCommentsDeletedMap.set(i,!0);try{const e=await this.videoApi.deleteComment(s,t);(0,r.runInAction)((()=>{this.videoCommentsDeletedMap.set(i,Boolean(e))}))}catch(e){throw(0,r.runInAction)((()=>{this.videoCommentsDeletedMap.set(i,!1)})),e}}async restore(e,t){const{commentId:i,ownerId:o}=e,s={owner_id:o,comment_id:(0,a.splitRawId)(i).itemId};this.videoCommentsDeletedMap.set(i,!1);try{const e=await this.videoApi.restoreComment(s,t);(0,r.runInAction)((()=>{this.videoCommentsDeletedMap.set(i,!Boolean(e))}))}catch(e){throw(0,r.runInAction)((()=>{this.videoCommentsDeletedMap.set(i,!0)})),e}}isDeleted(e){return this.videoCommentsDeletedMap.get(e)}clear(e){this.videoCommentsDeletedMap.delete(e)}constructor(e){this.videoApi=e,this.videoCommentsDeletedMap=new Map,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],d)},307951:(e,t,i)=>{i.d(t,{VideoCommentsDeletingTreadService:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(882044);class a{async delete(e,t){const{threadId:i,ownerId:o}=e,s={owner_id:o,thread_id:i};this.videoCommentsDeletedThreadMap.set(i,!0);try{const e=await this.videoApi.deleteThread(s,t);(0,r.runInAction)((()=>{this.videoCommentsDeletedThreadMap.set(i,Boolean(e))}))}catch(e){throw(0,r.runInAction)((()=>{this.videoCommentsDeletedThreadMap.set(i,!1)})),e}}async restore(e,t){const{threadId:i,ownerId:o}=e,s={owner_id:o,thread_id:i};this.videoCommentsDeletedThreadMap.set(i,!1);try{const e=await this.videoApi.restoreThread(s,t);(0,r.runInAction)((()=>{this.videoCommentsDeletedThreadMap.set(i,!Boolean(e))}))}catch(e){throw(0,r.runInAction)((()=>{this.videoCommentsDeletedThreadMap.set(i,!0)})),e}}clear(e){this.videoCommentsDeletedThreadMap.delete(e)}constructor(e){this.videoApi=e,this.videoCommentsDeletedThreadMap=new Map,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],a)},311127:(e,t,i)=>{i.d(t,{VideoCommentsEditingService:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(951652);class d{async editComment(e){if(!this.authService.userId)return;const t={comment_id:e.id,owner_id:e.ownerId,message:e.message,attachments:e.attachments};await this.videoApi.editComment(t);const i=await this.videoApi.getComment({owner_id:e.ownerId,comment_id:e.id}),{items:o}=i;return o[0]}constructor(e,t){this.videoApi=e,this.authService=t,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi,void 0===a.AuthService?Object:a.AuthService])],d)},903653:(e,t,i)=>{i.d(t,{VideoCommentsListProvider:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(607417),a=i(212800);class d{createList(){return new a.VideoCommentsList(this.commentsProvider)}getList(e){const t=this.commentsListByVideo.get(e);if(t)return t;const i=this.createList();return this.commentsListByVideo.set(e,i),i}reset(){this.commentsListByVideo.clear()}constructor(e){this.commentsProvider=e,this.commentsListByVideo=new Map,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoCommentsProvider?Object:n.VideoCommentsProvider])],d)},607417:(e,t,i)=>{i.d(t,{VideoCommentsProvider:()=>v});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(476205),d=i(129021),l=i(562587),c=i(349773),u=i(800227),h=i(81213),p=i(473905),m=i(311127);class v{getItem(e){return this.commentsMap.get(e)}async fetch(e,t){const i=e.fields??[],o=function(e){return"videoId"in e}(e)?await this.videoApi.getComments(v.getApiParams(e),t):await this.videoApi.getComment(v.getApiParamsOne(e),t),{can_post:r,count:s,current_level_count:n,groups:d,items:l,orders:u,profiles:h,real_offset:p}=o;d&&this.groupsStoreFactory.ensureByFields(a.VideoGroupsStoreFactory.filterFields(i)).createManyFromApi(d),h&&this.usersStoreFactory.ensureByFields(c.VideoUsersStoreFactory.filterFields(i)).createManyFromApi(h);return{count:s,items:this.createManyFromApi(l,this.ownerStoreFactory.ensureByFields(i)),can_post:r,orders:u,real_offset:p,current_level_count:n}}createOneFromApi(e,t){const i=new h.VideoComment(e,t,this.likesService,this.deletingService,this.editingService);return this.commentsMap.set(i.rawId,i),this.deletingService.clear(i.rawId),i}createManyFromApi(e,t){return e.map((e=>this.createOneFromApi(e,t)))}static getApiParams(e){return{video_id:e.videoId,owner_id:e.ownerId,count:e.count,offset:e.offset,sort:e.sort,need_likes:(0,u.convertToBooleanParam)(!0),extended:(0,u.convertToBooleanParam)(!0),fields:e.fields?.join(","),comment_id:e.commentId,access_key:e.accessKey,start_comment_id:e.startCommentId}}static getApiParamsOne(e){return{comment_id:e.commentId,owner_id:e.ownerId,extended:(0,u.convertToBooleanParam)(!0),fields:e.fields?.join(",")}}constructor(e,t,i,o,s,n,a){this.groupsStoreFactory=e,this.usersStoreFactory=t,this.ownerStoreFactory=i,this.likesService=o,this.deletingService=s,this.editingService=n,this.videoApi=a,this.commentsMap=new Map,(0,r.makeAutoObservable)(this)}}v=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.VideoGroupsStoreFactory?Object:a.VideoGroupsStoreFactory,void 0===c.VideoUsersStoreFactory?Object:c.VideoUsersStoreFactory,void 0===l.VideoOwnerStoreFactory?Object:l.VideoOwnerStoreFactory,void 0===d.VideoLikesService?Object:d.VideoLikesService,void 0===p.VideoCommentsDeletingService?Object:p.VideoCommentsDeletingService,void 0===m.VideoCommentsEditingService?Object:m.VideoCommentsEditingService,void 0===n.VideoApi?Object:n.VideoApi])],v)},172539:(e,t,i)=>{i.d(t,{VideoCommentsReportService:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(361121);class d{static isVideoReportCommentParamsReason(e){return void 0===e||"number"==typeof e&&[0,1,2,4,5,6,8,9,10,11,12,13,15,27,41,42,43,101].includes(e)}async report(e){const{commentId:t,ownerId:i,reason:o,ref:r}=e,s={owner_id:i,comment_id:(0,a.splitRawId)(t).itemId,reason:this.changeReasonType(o),ref:r};try{await this.videoApi.reportComment(s)}catch(e){throw e}}changeReasonType(e){return d.isVideoReportCommentParamsReason(e)?e:void 0}constructor(e){this.videoApi=e,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],d)},81213:(e,t,i)=>{i.d(t,{VideoComment:()=>n});var o=i(327813),r=i(873900),s=i(498085);class n{static createRawId(e){return(0,r.getIdentityRawId)(e)}get rawId(){const{id:e,from_id:t}=this.data;return n.createRawId({id:e,ownerId:t})}get data(){return this._data}get owner(){return this.ownerStore.getById(this._data.from_id)}get parentOwner(){return this.ownerStore.getById(this._data.reply_to_user??0)}get isDeleted(){return Boolean(this.deletingService.isDeleted(this.rawId)||this._data.deleted)}get isEditing(){return this._isEditing}async edit(e){if(this._isEditing)throw new Error("Comment is already editing");this._isEditing=!0;try{const t=await this.editingService.editComment({id:this.data.id,...e});(0,o.runInAction)((()=>{this._data.text=t?.text??"",this._data.attachments=t?.attachments}))}finally{(0,o.runInAction)((()=>{this._isEditing=!1}))}}constructor(e,t,i,r,n){this._data=e,this.ownerStore=t,this.likesService=i,this.deletingService=r,this.editingService=n,this._isEditing=!1,this.likes=new s.VideoCommentLikes(this,this.likesService),(0,o.makeAutoObservable)(this)}}},498085:(e,t,i)=>{i.d(t,{VideoCommentLikes:()=>s});var o=i(327813),r=i(98710);class s{async toggleLike(e){const{optimistic:t,ownerId:i}=e,o={type:"video_comment",itemId:this.data.id,ownerId:i};this.controller?.abort(),this.controller=new AbortController,this.hasUserLikes?this.removeLike(o,t):this.addLike(o,t),this.hasUserLikes=!this.hasUserLikes}async toggleAdminLike(e){const{optimistic:t,ownerId:i,fromGroup:o}=e,r={type:"video_comment",itemId:this.data.id,ownerId:i,fromGroup:o};this.controller?.abort(),this.controller=new AbortController,this.hasGroupLikes?this.removeLike(r,t):this.addLike(r,t),this.hasGroupLikes=!this.hasGroupLikes}optimisticAddLike(e,t){this.data.likes&&(this.data.likes.count=t??this.data.likes.count+1,e.fromGroup||(this.data.likes.user_likes=1))}optimisticRemoveLike(e,t){this.data.likes&&(this.data.likes.count=t??Math.max(this.data.likes.count-1,0),e.fromGroup||(this.data.likes.user_likes=0))}async addLike(e,t){try{t&&this.optimisticAddLike(e);const i=await this.likesService.add(e,{signal:this.controller?.signal});(0,o.runInAction)((()=>{this.controller=null,this.optimisticAddLike(e,i.likes)}))}catch(i){!(0,r.isAbortError)(i)&&t&&this.optimisticRemoveLike(e)}}async removeLike(e,t){try{t&&this.optimisticRemoveLike(e);const i=await this.likesService.remove(e,{signal:this.controller?.signal});(0,o.runInAction)((()=>{this.controller=null,this.optimisticRemoveLike(e,i.likes)}))}catch(i){!(0,r.isAbortError)(i)&&t&&this.optimisticAddLike(e)}}get data(){return this.comment.data}constructor(e,t){this.comment=e,this.likesService=t,this.controller=null,this.hasUserLikes=Boolean(this.data.likes?.user_likes??0),this.hasGroupLikes=Boolean(this.data.likes?.group_liked??0),(0,o.makeAutoObservable)(this)}}},212800:(e,t,i)=>{i.d(t,{VideoCommentsList:()=>r});var o=i(327813);class r{get countAll(){return this._count}get countAllWithAdded(){return this.countAll+this._addedCount}get levelCount(){return this._levelCount??this._count}get levelCountWithAdded(){return this.levelCount+this._addedCount}get ids(){return this._ids}get isLoading(){return this._isLoading||this._isNextLoading}get isLoadedFully(){return!!this.prevRequestParams&&this._offset+this._loadedCount>=this.levelCount}get isLoaded(){return Boolean(this.prevRequestParams)}get isPrevLoading(){return this._isPrevLoading}get isPrevLoadedFully(){return!!this.prevRequestParams&&0===this._offset}get canPost(){return this._canPost}get loadedCount(){return this._loadedCount}get offset(){return this._offset}get order(){return this._order}get orderItems(){return this._orderItems}dispose(){this.controller?.abort(),this.prevController?.abort()}done(e,t){const{startCommentId:i,...o}=e,r=t.real_offset??e.offset??0,s=t.items.map((({rawId:e})=>e)),n=this._offset>r,a=n?[...s,...this._ids]:[...this._ids,...s];return this._loadedCount+=s.length,this._count=t.count,this._ids=Array.from(new Set(a).values()),this._canPost=Boolean(t.can_post),this._order=t.orders?.current_order??e.sort??"asc",this._orderItems=t.orders?.items??this._orderItems,void 0!==t.current_level_count&&(this._levelCount=t.current_level_count),void 0!==t.real_offset&&(this._offset=t.real_offset),n?this._offset=r:this.prevRequestParams=o,s}async addComment(e){this._ids.unshift(e),this._lastAddedItemId=e,this.incrementCommentsCount()}get lastAddedItemId(){return this._lastAddedItemId}async addCommentToEnd(e){this._ids.push(e),this._lastAddedItemId=e,this.incrementCommentsCount()}async fetch(e,t=new AbortController){this.reset(),this.controller=t,this._isLoading=!0;try{const i=await this.request(e,t);return(0,o.runInAction)((()=>{this._isLoading=!1,this.controller=null})),this.done(e,i)}catch(e){throw(0,o.runInAction)((()=>{this._isLoading=!1})),e}}async fetchMore(e,t=new AbortController){if(!this.prevRequestParams||this._isNextLoading||this.isLoadedFully)return;this.controller=t,this._isNextLoading=!0;const i={...this.prevRequestParams,offset:this._offset+this._loadedCount,count:e??this.prevRequestParams?.count};try{const e=await this.request(i,t);return(0,o.runInAction)((()=>{this._isNextLoading=!1,this.controller=null})),this.done(i,e)}catch(e){throw(0,o.runInAction)((()=>{this._isLoading=!1})),e}}async fetchPrev(e,t=new AbortController){if(!this.prevRequestParams||this._isPrevLoading||this.isPrevLoadedFully)return;this.prevController=t,this._isPrevLoading=!0;const i={...this.prevRequestParams,offset:Math.max(0,this.offset-e),count:Math.min(this.offset,e)},r=await this.request(i,t);return(0,o.runInAction)((()=>{this._isPrevLoading=!1,this.prevController=null})),this.done(i,r)}incrementCommentsCount(){this._addedCount+=1}request(e,t){return this.commentsProvider.fetch(e,{signal:t.signal})}reset(){this.controller?.abort(),this.prevController?.abort(),this.resetData()}resetData(){this._count=0,this._isLoading=!1,this._isNextLoading=!1,this._isPrevLoading=!1,this._levelCount=null,this._loadedCount=0,this._offset=0,this._ids=[],this._order="asc",this._orderItems=[],this.prevRequestParams=null,this.controller=null,this.prevController=null,this._addedCount=0}constructor(e){this.commentsProvider=e,this._ids=[],this.prevRequestParams=null,this.controller=null,this._count=0,this.prevController=null,this._canPost=!0,this._order="asc",this._orderItems=[],this._isLoading=!1,this._isNextLoading=!1,this._isPrevLoading=!1,this._lastAddedItemId=null,this._levelCount=null,this._loadedCount=0,this._addedCount=0,this._offset=0,(0,o.makeAutoObservable)(this)}}},866763:(e,t,i)=>{i.d(t,{VideoGroupsFetchService:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(962005),a=i(800227),d=i(476205);class l{static isNumberArray(e){const[t]=e;return"number"==typeof t}async fetch(e,t){const i=this.getPending(e);if(i)return i;const o=this.groupsApi.get(l.getApiParams(e),t),s=l.getKey(e);this.pendingMap.set(s,o);try{const t=await o,{items:i}=t;return l.isNumberArray(i)||this.groupsStoreFactory.ensureByFields(e.fields??[]).createManyFromApi(i),t}finally{(0,r.runInAction)((()=>{this.pendingMap.delete(s)}))}}async fetchById(e,t){const i=await this.groupsApi.getById({fields:e.fields?.join(","),group_ids:e.groupIds?.join(",")},t),{groups:o}=i;if(o)return this.groupsStoreFactory.ensureByFields(e.fields??[]).createManyFromApi(o),o}isPending(e){return Boolean(this.getPending(e))}getPending(e){return this.pendingMap.get(l.getKey(e))}static getApiParams(e){const t={count:e.count,extended:(0,a.convertToBooleanParam)(e.extended),fields:e.fields?.join(","),filter:e.filter?.join(","),last_request_time:e.lastRequestTime,offset:e.offset,user_id:e.userId};return Object.fromEntries(Object.entries(t).filter((([,e])=>void 0!==e)))}static getKey(e){return JSON.stringify(Object.entries(l.getApiParams(e)).sort((([e],[t])=>e<t?-1:1)))}constructor(e,t){this.groupsApi=e,this.groupsStoreFactory=t,this.pendingMap=new Map,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.GroupsApi?Object:n.GroupsApi,void 0===d.VideoGroupsStoreFactory?Object:d.VideoGroupsStoreFactory])],l)},104403:(e,t,i)=>{i.d(t,{VideoGroupsStore:()=>s});var o=i(327813),r=i(73573);class s{createManyFromApi(e){return e.map(this.createOneFromApi)}getById(e){return this.groupsMap.get(e)}constructor(){this.createOneFromApi=e=>{const t=new r.VideoGroup(e);return this.groupsMap.set(e.id,t),t},this.groupsMap=new Map,(0,o.makeAutoObservable)(this)}}},476205:(e,t,i)=>{i.d(t,{VideoGroupsStoreFactory:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(740370),a=i(104403);class d{static filterFields(e){const t=n.VIDEO_GROUP_OPTIONAL_FIELDS;return e.filter((e=>t.includes(e)))}ensureByFields(e){const t=d.getKey(e);return this.stores.get(t)??this.create(t)}create(e){const t=new a.VideoGroupsStore;return this.stores.set(e,t),t}static getKey(e){return[...new Set(e)].sort().join(",")}constructor(){this.stores=new Map,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[])],d)},740370:(e,t,i)=>{i.d(t,{VIDEO_GROUP_OPTIONAL_FIELDS:()=>o});const o=["activity","addresses","age_limits","ban_info","can_create_topic","can_message","can_post","can_suggest","can_see_all_posts","can_upload_doc","can_upload_story","can_upload_video","city","contacts","counters","country","cover","crop_photo","description","fixed_post","has_photo","is_favorite","is_hidden_from_feed","is_messages_blocked","links","main_album_id","main_section","market","member_status","members_count","place","public_date_label","site","start_date и finish_date","status","trending","verified","wall","wiki_page"]},129021:(e,t,i)=>{i.d(t,{VideoLikesService:()=>a});var o=i(331635),r=i(132028),s=i(813682),n=i(327813);class a{async add(e,t){const i={type:e.type,owner_id:e.ownerId,item_id:e.itemId,from_group:e.fromGroup};return await this.likesApi.add(i,t)}async remove(e,t){const i={type:e.type,owner_id:e.ownerId,item_id:e.itemId,from_group:e.fromGroup};return await this.likesApi.delete(i,t)}constructor(e){this.likesApi=e,(0,n.makeAutoObservable)(this)}}a=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.LikesApi?Object:s.LikesApi])],a)},190105:(e,t,i)=>{i.d(t,{VideoModerationProvider:()=>d});var o=i(331635),r=i(327813),s=i(132028),n=i(551494),a=i(24763);class d{async getModerationRights(e){const t=await this.internalApi.getVideoRights({owner_id:e});return new a.VideoModerationRights(t).data}constructor(e){this.internalApi=e,(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.InternalApi?Object:n.InternalApi])],d)},24763:(e,t,i)=>{i.d(t,{VideoModerationRights:()=>o});class o{get data(){return this._data}constructor(e){this._data=e}}},165268:(e,t,i)=>{i.d(t,{VideoMovieInfoDropdownDataProvider:()=>d,VideoMovieInfoDropdownDataTypeParams:()=>a});var o=i(331635),r=i(132028),s=i(882044),n=i(327813);const a={ACTOR:1,DIRECTOR:2,COUNTRY:3,GENRE:4,CUSTOM:5};class d{async fetch(e,t){const i=this.getMapKey(e),o=this._pendingMap.get(i);if(o){const{items:e}=await o;return e}const r=this.videoApi.getMovieInfoDropdownData(e,t);try{this._pendingMap.set(i,r);const{items:e}=await r;return e}finally{this._pendingMap.delete(i)}}getMapKey({type:e,search:t}){return[e,t].join()}constructor(e){this.videoApi=e,this._pendingMap=new Map,(0,n.makeAutoObservable)(this)}}d=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.VideoApi?Object:s.VideoApi])],d)},406341:(e,t,i)=>{i.d(t,{VideoMovieInfoProvider:()=>l});var o=i(331635),r=i(132028),s=i(882044),n=i(327813),a=i(376150),d=i(839526);class l{async fetch({ownerId:e,playlistId:t},i){const o=this.getMapKey({ownerId:e,playlistId:t}),r=this._pendingMap.get(o);if(r)return this.createFromApi(await r);const s=this.videoApi.getMovieInfo({owner_id:e,playlist_id:t},i);try{return this._pendingMap.set(o,s),this.createFromApi(await s)}finally{this._pendingMap.delete(o)}}async update({ownerId:e,playlistId:t,infoUpdatedAt:i,ratingAge:o,year:r,ratingKinopoisk:s,kinopoiskId:n,categoryIds:a,actorIds:l,directorIds:c,countryIds:u,genreIds:h,customTagIds:p,playlistMark:m}){const v={owner_id:e,playlist_id:t,info_updated_at:i||Date.now(),rating_age:o,year:r,rating_kinopoisk:s,kinopoisk_id:n,category_ids:(0,d.getJoinedStringOrUndefined)(a),actor_ids:(0,d.getJoinedStringOrUndefined)(l),director_ids:(0,d.getJoinedStringOrUndefined)(c),country_ids:(0,d.getJoinedStringOrUndefined)(u),genre_ids:(0,d.getJoinedStringOrUndefined)(h),custom_tag_ids:(0,d.getJoinedStringOrUndefined)(p),playlist_mark:m},g=Object.fromEntries(Object.entries(v).filter((([,e])=>void 0!==e)));return Boolean(await this.videoApi.updateMovieInfo(g))}createFromApi(e){return new a.VideoMovieInfo(e)}getMapKey({ownerId:e,playlistId:t}){return[e,t].join()}constructor(e){this.videoApi=e,this._pendingMap=new Map,(0,n.makeAutoObservable)(this)}}l=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.VideoApi?Object:s.VideoApi])],l)},376150:(e,t,i)=>{i.d(t,{VideoMovieInfo:()=>r});var o=i(327813);class r{get values(){return{infoUpdatedAt:this.data.info_updated_at,kinopoiskId:this.data.kinopoisk_id,year:this.data.year,ratingKinopoisk:this.data.rating_kinopoisk,ratingAge:this.data.rating_age,categoryIds:this.data.category_ids,countryIds:this.data.country_ids,genreIds:this.data.genre_ids,customTagIds:this.data.custom_tag_ids,actors:this.data.selected_actors,directors:this.data.selected_directors,playlistMark:this.data.playlist_mark}}get options(){return{categories:this.data.all_categories,countries:this.data.all_countries,genres:this.data.all_genres,customTags:this.data.all_custom_tags,ratingAges:this.data.all_rating_ages,playlistMarks:this.data.all_playlist_mark}}constructor(e){this.data=e,(0,o.makeAutoObservable)(this)}}},839526:(e,t,i)=>{i.d(t,{getJoinedStringOrUndefined:()=>o});const o=e=>{if(e&&e?.length)return e.join()}},562587:(e,t,i)=>{i.d(t,{VideoOwnerStoreFactory:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(476205),a=i(349773),d=i(23893);class l{ensureByFields(e){const t=l.getKey(e);return this.stores.get(t)??this.create(t,e)}create(e,t=[]){const i=new d.VideoOwnerStore(this.videoGroupsStoreFactory.ensureByFields(n.VideoGroupsStoreFactory.filterFields(t)),this.videoUsersStoreFactory.ensureByFields(a.VideoUsersStoreFactory.filterFields(t)));return this.stores.set(e,i),i}static getKey(e){return[...new Set(e)].sort().join(",")}constructor(e,t){this.videoGroupsStoreFactory=e,this.videoUsersStoreFactory=t,this.stores=new Map,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoGroupsStoreFactory?Object:n.VideoGroupsStoreFactory,void 0===a.VideoUsersStoreFactory?Object:a.VideoUsersStoreFactory])],l)},67552:(e,t,i)=>{i.d(t,{VideoSubscriptionsCatalogProvider:()=>h});var o=i(331635),r=i(327813),s=i(132028),n=i(52016),a=i(863297),d=i(664700),l=i(31287),c=i(152685),u=i(903723);class h{async fetchSection(e,t){const i=await this.catalogApi.getSection(e,t);if(!i.section)return null;const o=this.createEntities(),{section:r,...s}=i,n={default_section:r.id,sections:[r]};return new a.Catalog({data:n,catalogApi:this.catalogApi,entitiesSource:s,entities:o})}async fetchSectionId(e){const t=await this.catalogApi.getVideo(e);if(!t?.catalog?.default_section)throw new Error("No section ID");return t.catalog.default_section}constructor(e,t){this.catalogApi=e,this.groupsProvider=t,this.createEntities=()=>new d.CatalogEntities({groups:(0,l.createCatalogGroupsProvider)(this.groupsProvider),placeholders:(0,c.createCatalogPlaceholdersProvider)()}),(0,r.makeAutoObservable)(this)}}h=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.CatalogApi?Object:n.CatalogApi,void 0===u.GroupsProvider?Object:u.GroupsProvider])],h)},298593:(e,t,i)=>{i.d(t,{VideoSubscriptionsService:()=>a});var o=i(331635),r=i(327813),s=i(132028),n=i(882044);class a{async subscribeChooseRelevantAuthors(e){return Boolean(await this.videoApi.subscribeChooseRelevantAuthors(e))}async subscribeGetRelevantAuthors(e){return await this.videoApi.subscribeGetRelevantAuthors(e)}constructor(e){this.videoApi=e,(0,r.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],a)},878728:(e,t,i)=>{i.d(t,{isAbortApiError:()=>s});var o=i(782399),r=i(285953);const s=e=>(0,o.isNetworkError)(e)&&(0,r.isRequestAbortError)(e.error)},98710:(e,t,i)=>{i.d(t,{isAbortError:()=>s});var o=i(804076),r=i(878728);const s=e=>(0,o.isApiNetworkError)(e)&&(0,r.isAbortApiError)(e)},804076:(e,t,i)=>{i.d(t,{isApiNetworkError:()=>o});const o=e=>!!e&&"object"==typeof e&&"type"in e&&"network_error"===e.type},285953:(e,t,i)=>{i.d(t,{isRequestAbortError:()=>o});const o=e=>e instanceof DOMException&&(20===e.code||"AbortError"===e.name)},436402:(e,t,i)=>{i.d(t,{VideoVideosDeletingService:()=>l});var o=i(331635),r=i(327813),s=i(132028),n=i(882044),a=i(768035),d=i(873900);class l{async delete(e,{targetId:t,controller:i}={}){const o=(0,a.parseRawId)(e);if(this.isRestoring(e))return!1;const r={video_id:o.id,owner_id:o.ownerId,target_id:t};this.videoDeletingMap.set(e,!0);try{const t=await this.videoApi.delete(r,{signal:i?.signal});return t&&this.videoDeletedMap.set(e,!0),Boolean(t)}finally{this.videoDeletingMap.set(e,!1)}}async restore({videoId:e,ownerId:t},i){const o=(0,d.getIdentityRawId)({id:e,ownerId:t});if(this.isDeleting(o))return!1;this.videoRestoringMap.set(o,!0);try{const r=await this.videoApi.restore({video_id:e,owner_id:t},i);return this.videoDeletedMap.set(o,!1),r}finally{this.videoRestoringMap.set(o,!1)}}isDeleted(e){return this.videoDeletedMap.get(e)}isDeleting(e){return this.videoDeletingMap.get(e)}isRestoring(e){return this.videoDeletingMap.get(e)}constructor(e){this.videoApi=e,this.videoDeletedMap=new Map,this.videoDeletingMap=new Map,this.videoRestoringMap=new Map,(0,r.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoApi?Object:n.VideoApi])],l)},830501:(e,t,i)=>{i.d(t,{VideoSectionGeoBlockCountries:()=>a});var o=i(331635),r=i(132028),s=i(882044),n=i(327813);class a{async fetch(e){if(this.pendingCountries)return this.pendingCountries;const t=this.videoApi.getCountriesForGeoBlockSection({},e);this.pendingCountries=t;try{const e=await t;return(0,n.runInAction)((()=>{this.countries=e})),e}finally{(0,n.runInAction)((()=>{this.pendingCountries=void 0}))}}get(){return this.countries}async ensureGeoBlockCountries(e){const t=this.get();return t||this.fetch(e)}constructor(e){this.videoApi=e,this.pendingCountries=void 0,this.countries=void 0,(0,n.makeAutoObservable)(this)}}a=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.VideoApi?Object:s.VideoApi])],a)},644054:(e,t,i)=>{i.d(t,{VideoSectionGeoBlockInfoProvider:()=>a});var o=i(331635),r=i(882044),s=i(132028),n=i(327813);class a{checkIsLoading(e){return Boolean(this.pendingInfoMap.get(e))}async fetchById(e,t){const i=this.pendingInfoMap.get(e);if(i)return i;const o=this.fetchGeoBlockInfo(e,t);this.pendingInfoMap.set(e,o);try{const t=await o;return(0,n.runInAction)((()=>{this.infoMap.set(e,t)})),t}finally{(0,n.runInAction)((()=>{this.pendingInfoMap.delete(e)}))}}getById(e){return this.infoMap.get(e)}async ensureGeoBlockInfo(e,t){const i=this.getById(e);return i||this.fetchById(e,t)}async block({ownerId:e,countryId:t,comment:i},o){return await this.videoApi.geoBlockSection({owner_id:e,country_id:t,comment:i},o)}async unblock({ownerId:e,countryId:t},i){return await this.videoApi.unblockSection({owner_id:e,country_id:t},i)}async fetchGeoBlockInfo(e,t){return await this.videoApi.getGeoBlockSectionInfo({owner_id:e},t)}constructor(e){this.videoApi=e,this.pendingInfoMap=new Map,this.infoMap=new Map,(0,n.makeAutoObservable)(this)}}a=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi])],a)},528847:(e,t,i)=>{i.d(t,{storeFieldProperty:()=>o});const o=Symbol.for("_isEffectorStore")},664317:(e,t,i)=>{i.d(t,{adapter:()=>r});var o=i(528847);const r=()=>e=>new Proxy(e,{construct:(e,t)=>new Proxy(new e(...t),{get(e,t){if(t in e){const i=e[t];return i[o.storeFieldProperty]?i():i}},set(e,t,i){if(t in e&&e[t][o.storeFieldProperty])throw new Error("The effector store is readonly!");return e[t]=i,!0}})})},254328:(e,t,i)=>{i.d(t,{effect:()=>n,event:()=>s,store:()=>r});var o=i(593449);const r=e=>(0,o.wrapEvent)(e.updates,e.getState()),s=e=>t=>{e(t)},n=e=>t=>e(t)},593449:(e,t,i)=>{i.d(t,{wrapEvent:()=>n});var o=i(327813),r=i(528847);const s=()=>{},n=(e,t)=>{let i=t,n=s;const a=(0,o.createAtom)("effector-store",(()=>{n=e.watch((e=>{i!==e&&(i=e,a.reportChanged())}))}),(()=>{n(),n=s})),d=()=>(a.reportObserved(),i);return Object.defineProperty(d,r.storeFieldProperty,{get:()=>!0}),d}},551494:(e,t,i)=>{i.d(t,{InternalApi:()=>n});var o=i(331635),r=i(132028),s=i(641569);class n extends s.ApiNamespace{get namespace(){return"internal"}constructor(...e){super(...e),this.getYaGeocoderString=this.makeMethod("getYaGeocoderString"),this.getWebLeftMenu=this.makeMethod("getWebLeftMenu"),this.getVideoRights=this.makeMethod("getVideoRights")}}n=(0,o.__decorate)([r.scope.global()],n)},328959:(e,t,i)=>{i.d(t,{QueueManager:()=>s});var o=i(634317),r=i(863488);class s{addQueue(e,t){return this._transport?.addQueue(e,t),this}removeQueue(e){return this._transport?.removeQueue(e),this}subscribe(e,t){return this._transport?.subscribe(e,t),this}destroy(){this._transport?.destroy()}toggleDebug(e){this._transport?.toggleDebug(e)}constructor({debug:e,noSharedWorker:t,withCredentials:i}={}){"undefined"==typeof SharedWorker||t?this._transport=new r.RegularTransport(i):this._transport=new o.SharedWorkerTransport(i),this.toggleDebug(e)}}},863488:(e,t,i)=>{i.d(t,{RegularTransport:()=>n});var o=i(8520),r=i(889944),s=i(746629);class n{addQueue(e,t){this.credentialsGetters.set(e,t),this.longpollManager.has(e)||this.requestCredentials(e)}async requestCredentials(e){const t=this.credentialsGetters.get(e);if(t&&!this.credentialsProcessing.has(e)){this.credentialsProcessing.add(e);try{this.logger.debug(`request credentials for ${e}`);const i=await t();this.longpollManager.add(e,i)}catch(e){this.logger.error("[requestCredentials]",e)}finally{this.credentialsProcessing.delete(e)}}}removeQueue(e){this.credentialsGetters.delete(e),this.credentialsProcessing.delete(e),this.longpollManager.remove(e)}subscribe(e,t){this.onMessage=e,t&&(this.onReset=t)}toggleDebug(e){this.logger.enabled=Boolean(e)}destroy(){this.onMessage=o.noop,this.onReset=o.noop;for(let[e]of this.credentialsGetters)this.longpollManager.remove(e)}constructor(e){this.credentialsGetters=new Map,this.credentialsProcessing=new Set,this.onMessage=o.noop,this.onReset=o.noop,this.logger=new r.Logger(!1,"RegularTransport"),this.callbackHandler=(e,t)=>{this.logger.debug(`response for ${e}`,t);const i=(0,o.isObjectLike)(t)&&("err"in t||"failed"in t);i&&this.longpollManager.remove(e),this.onMessage(e,t),i&&this.onReset()},this.longpollManager=new s.LongpollManager(this.callbackHandler,this.logger,e)}}},634317:(e,t,i)=>{i.d(t,{SharedWorkerTransport:()=>s});var o=i(418562),r=i(461015);class s{_postMessage(e){this._worker.port.postMessage(e)}_handleMessage(e){switch(this._isDebug&&"ping"!==e.data.type&&console.debug("Message received from worker\n",e.data),e.data.type){case"ping":e.data.payload===this._clientId&&(this._postMessage({type:"pong"}),this._checkKeepAlivePortInterval());break;case"longpoll-event":e.data.payload.clientId===this._clientId&&this._onMessage?.(e.data.payload.queueId,e.data.payload.data);break;case"request-credentials":e.data.payload.clientId===this._clientId&&this._requestCredentials(e.data.payload.queueId)}}_checkKeepAlivePortInterval(){this._keepAliveTimeout&&clearTimeout(this._keepAliveTimeout),this._keepAliveTimeout=setTimeout((()=>this._onReset?.()),r.TO_PORT_PING_INTERVAL+r.TO_PORT_PING_INTERVAL/2)}_setBeforeUnloadListener(){const e=()=>this.destroy();return window.addEventListener("beforeunload",e),e}async _requestCredentials(e){const t=this._credentialsGetters.get(e);if(t&&!this._credentialsProcessing.has(e)){this._credentialsProcessing.add(e);try{const i=await t();this._postMessage({type:"set-credentials",payload:{queueId:e,params:i,withCredentials:this._withCredentials}})}catch(e){console.error("[SharedWorkerTransport][_requestCredentials]",e)}finally{this._credentialsProcessing.delete(e)}}}destroy(){this._postMessage({type:"disconnect",payload:this._clientId}),this._worker.port.close(),window.removeEventListener("beforeunload",this._onBeforeUnloadLink),this._onMessage=null,this._onReset=null}addQueue(e,t){this._credentialsGetters.set(e,t),this._postMessage({type:"add-queue",payload:{queueId:e}})}subscribe(e,t){this._onMessage=e,this._onReset=t}removeQueue(e){this._credentialsGetters.delete(e),this._postMessage({type:"remove-queue",payload:{queueId:e}})}toggleDebug(e){const t=Boolean(e);this._isDebug=t,this._postMessage({type:"debug",payload:t})}constructor(e=!1){this._onReset=null,this._onMessage=null,this._keepAliveTimeout=null,this._isDebug=!1,this._clientId=(0,o.default)(),this._worker=new SharedWorker(new URL(self.location.origin+"/dist/"+i.u(30420),i.b)),this._onBeforeUnloadLink=this._setBeforeUnloadListener(),this._credentialsGetters=new Map,this._credentialsProcessing=new Set,this._withCredentials=e,this._worker.onerror=e=>console.error(e),this._worker.port.onmessage=e=>this._handleMessage(e),this._postMessage({type:"connect",payload:this._clientId}),this._worker.port.start(),this._checkKeepAlivePortInterval()}}},889944:(e,t,i)=>{i.d(t,{Logger:()=>o});class o{createMessage(e){return this.prefix?e.map(((e,t)=>0===t&&"string"==typeof e?`[${this.prefix}] ${e}`:e)):e}debug(...e){this.enabled&&console.debug(...this.createMessage(e))}log(...e){this.enabled&&console.log(...this.createMessage(e))}warn(...e){this.enabled&&console.warn(...this.createMessage(e))}error(...e){this.enabled&&console.error(...this.createMessage(e))}constructor(e,t=""){this.enabled=e,this.prefix=t}}},746629:(e,t,i)=>{i.d(t,{LongpollManager:()=>s});var o=i(8520),r=i(381162);class s{add(e,t,i){void 0!==i&&(this._withCredentials=i);const o=this._queues.get(e);(o?.ts||0)<t.ts&&this._queues.set(e,{...t}),this._start()}remove(e){const t=this._queues.get(e);t&&this._retryCount.delete(t?.url),this._queues.delete(e)}has(e){return this._queues.has(e)}_start(){for(const e of this._queues.values())this._processing.has(e.url)||this._processing.set(e.url,setTimeout((()=>this._processUrl(e.url)),this._getTimeoutValue(e.url)))}_getTimeoutValue(e){const t=this._getRetryCount(e);return 1===t?4:2*t*1e3}_getRetryCount(e){return this._retryCount.get(e)??1}_increaseRetryCount(e){const t=this._getRetryCount(e)+1;return this._retryCount.set(e,t),t}_resetRetryCount(e){this._retryCount.set(e,1)}async _processUrl(e){const t=[],i=[];for(const[o,r]of this._queues.entries())r.url===e&&(t.push(o),i.push(r));if(!t.length||!i.length)return void this._processing.delete(e);let o;try{const t=(0,r.createUrl)(i,this._logger),s=await this._request(t);o=Array.isArray(s)?s:[s],this._resetRetryCount(e)}catch(i){o=[],this._increaseRetryCount(e)>=20&&t.forEach((()=>o.push(this._createFailedResponse())))}finally{this._processing.delete(e)}for(let e=0;e<o.length;++e)this._publish(t[e],o[e]),this._updateTs(t[e],o[e]);this._start()}_request(e){return fetch(e,this._withCredentials?{credentials:"include",mode:"cors"}:void 0).then((e=>e.json()))}_updateTs(e,t){if(!(0,o.isObject)(t)||!("ts"in t))return;const i=this._queues.get(e),r=Number(t.ts);!(0,o.isUndefined)(i)&&i.ts<r&&(i.ts=r)}_createFailedResponse(){return{err:1,failed:1}}constructor(e,t,i=!1){this._queues=new Map,this._processing=new Map,this._publish=e,this._logger=t,this._withCredentials=i,this._retryCount=new Map}}},381162:(e,t,i)=>{i.d(t,{createUrl:()=>r});const o=25;function r(e,t){const i=e[0].url,r=e[0].id;let s=e[0].key,n=`${e[0].ts}`;for(let o=1;o<e.length;++o){if(e[o].id!==r){const i=`Invalid userId pair: ${r}, ${e[o].id}`;throw t?.error(i),new Error(i)}if(e[o].url!==i){const r=`Invalid baseUrl pair: ${i}, ${e[o].url}`;throw t?.error(r),new Error(r)}s+=`${e[o].key}`,n+=`_${e[o].ts}`}return`${i}?act=a_check&key=${s}&id=${r}&ts=${n}&wait=${o}`}},461015:(e,t,i)=>{i.d(t,{TO_PORT_PING_INTERVAL:()=>o,TO_PORT_PING_REPLY_WAIT:()=>r});const o=1e4,r=1e3},50790:(e,t,i)=>{i.d(t,{useIsMounted:()=>r});var o=i(296540);const r=()=>{const e=(0,o.useRef)(!1);return(0,o.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,o.useCallback)((()=>e.current),[])}},162951:(e,t,i)=>{i.d(t,{createUtilsResolveScreenNameFx:()=>r});var o=i(412554);const r=e=>(0,o.createApiEffect)("utils.resolveScreenName",e)},986125:(e,t,i)=>{i.d(t,{createVideoAddAlbumFx:()=>I,createVideoAddFx:()=>r,createVideoAddToAlbumFx:()=>m,createVideoDeleteAlbumFx:()=>_,createVideoDeleteFx:()=>f,createVideoEditAlbumFx:()=>b,createVideoFeedVideosForYouBlockItemsFx:()=>h,createVideoGetAlbumByIdFx:()=>n,createVideoGetAlbumsByVideoFx:()=>g,createVideoGetAlbumsExtendedFx:()=>p,createVideoGetBlockItemsFx:()=>a,createVideoGetFx:()=>s,createVideoGetGroupsForStreamingFx:()=>C,createVideoGetVideoDiscoverFx:()=>y,createVideoPinVideoFx:()=>E,createVideoRemoveFromAlbumFx:()=>v,createVideoReorderVideosFx:()=>S,createVideoRestoreFx:()=>w,createVideoSubscribeHideAuthor:()=>c,createVideoSubscribeToAlbum:()=>d,createVideoSubscribeUnhideAuthor:()=>u,createVideoUnpinVideoFx:()=>k,createVideoUnsubscribeFromAlbum:()=>l});var o=i(412554);const r=e=>(0,o.createApiEffect)("video.add",e),s=e=>(0,o.createApiEffect)("video.get",e),n=e=>(0,o.createApiEffect)("video.getAlbumById",e),a=e=>(0,o.createApiEffect)("video.getCatalogBlockItems",e),d=e=>(0,o.createApiEffect)("video.subscribeToAlbum",e),l=e=>(0,o.createApiEffect)("video.unsubscribeFromAlbum",e),c=e=>(0,o.createApiEffect)("video.subscribeHideAuthors",e),u=e=>(0,o.createApiEffect)("video.subscribeUnhideAuthors",e),h=e=>(0,o.createApiEffect)("video.feedVideosForYouBlockItems",e),p=e=>(0,o.createApiEffect)("video.getAlbums",e),m=e=>(0,o.createApiEffect)("video.addToAlbum",e),v=e=>(0,o.createApiEffect)("video.removeFromAlbum",e),g=e=>(0,o.createApiEffect)("video.getAlbumsByVideo",e),_=e=>(0,o.createApiEffect)("video.deleteAlbum",e),C=e=>(0,o.createApiEffect)("video.getGroupsForStreaming",e),y=e=>(0,o.createApiEffect)("video.getVideoDiscover",e),b=e=>(0,o.createApiEffect)("video.editAlbum",e),I=e=>(0,o.createApiEffect)("video.addAlbum",e),S=e=>(0,o.createApiEffect)("video.reorderVideos",e),f=e=>(0,o.createApiEffect)("video.delete",e),w=e=>(0,o.createApiEffect)("video.restore",e),E=e=>(0,o.createApiEffect)("video.pinVideo",e),k=e=>(0,o.createApiEffect)("video.unpinVideo",e)},98961:(e,t,i)=>{i.d(t,{listActions:()=>r});var o=i(32489);const r=({domain:e,$entitiesListIds:t,$entitiesCount:i})=>{const r=(0,o.createEvent)({domain:e}),s=(0,o.createEvent)({domain:e}),n=(0,o.createEvent)({domain:e}),a=e=>({entitiesCount:t,entitiesListIds:i},{entityKey:o,itemKeys:r})=>[].concat(o??Object.keys(i)).reduce(((o,s)=>{const n=t[s],a=i[s];if("number"!=typeof n||!a)return o;const d=1===e,l=r.reduce(((t,i)=>{const o=a.includes(i);return d?o?t:t+e:o?t+e:t}),0);return t[s]!==n||(o[s]=n+l),o}),{...t}),d=e=>(t,{entityKey:i,itemKeys:o})=>[].concat(i??Object.keys(t)).reduce(((i,r)=>{const s=t[r];if(!s)return i;const n=o.filter((e=>!s.includes(e)));return n.length?(i[r]="push"===e?[...s,...n]:[...n,...s],i):i}),{...t});return(0,o.sample)({clock:[n],source:{entitiesCount:i,entitiesListIds:t},fn:a(-1),target:i}),(0,o.sample)({clock:[r,s],source:{entitiesCount:i,entitiesListIds:t},fn:a(1),target:i}),(0,o.sample)({clock:[r],source:t,fn:d("push"),target:t}),(0,o.sample)({clock:[s],source:t,fn:d("unshift"),target:t}),(0,o.sample)({clock:[n],source:t,fn:function(e,{entityKey:t,itemKeys:i}){return[].concat(t??Object.keys(e)).reduce(((t,o)=>{const r=e[o];if(!r)return t;const s=r.filter((e=>!i.includes(e)));return s.length===r.length||(t[o]=s),t}),{...e})},target:t}),{pushItemsEvent:r,unshiftItemsEvent:s,deleteItemsEvent:n}}},510015:(e,t,i)=>{i.d(t,{createFactoryLists:()=>l});var o=i(32489),r=i(8520),s=i(914231),n=i(858716),a=i(224191),d=i(98961);const l=({domain:e,fetchFx:t,$entitiesItems:i,getListKey:l,getList:c,getListCount:u,getListNextFrom:h,getItemKey:p,getEntityKey:m,getOffset:v=e=>Number(e.query.offset)||0,getCount:g=e=>Number(e.query.count)||0,mapNextListQuery:_=({count:e,offset:t,start_from:i})=>({count:e,offset:t,start_from:i})})=>{const C=e.createEvent(),y=e.createEvent(),b=e.createStore({}),I=e.createStore({}),S=e.createStore({}),f=e.createStore({}),w=e.createStore({}),E=e.createStore({}),k=e.createStore({}),P=e.createStore({}),{pushItemsEvent:A,unshiftItemsEvent:L,deleteItemsEvent:x}=(0,d.listActions)({domain:e,$entitiesCount:f,$entitiesListIds:E});return[b,I,S,f,w,E,k].forEach((e=>{e.on(C,s.resetEntities)})),b.on(t.done,((e,{params:t})=>(0,n.setEntity)(e,l(t),t))),I.on(t,((e,t)=>t.query.offset?e:(0,n.setEntity)(e,l(t),!1))).on(t.done,((e,{params:t,result:i})=>{const o=l(t),r=u(i),s=v(t)+g(t),a=h?.(i);return(0,n.setEntity)(e,o,s>=r&&!a)})),S.on(t,((e,t)=>(0,n.setEntity)(e,l(t),!0))).on(t.finally,((e,t)=>t.params.controller?.signal.aborted?e:(0,n.setEntity)(e,l(t.params),!1))),P.on(C,((e,t)=>(t?e[t]?.abort():Object.keys(e).forEach((t=>{e[t]?.abort()})),(0,s.resetEntities)(e,t)))).on(t,((e,t)=>{const i=l(t);return e[i]?.abort(),t.controller?(0,n.setEntity)(e,i,t.controller):e})),f.on(t,((e,t)=>t.query.offset?e:(0,s.resetEntities)(e,l(t)))).on(t.done,((e,t)=>(0,n.setEntity)(e,l(t.params),u(t.result)))),"function"==typeof h&&w.on(t,((e,t)=>t.query.start_from?e:(0,s.resetEntities)(e,l(t)))).on(t.done,((e,t)=>(0,n.setEntity)(e,l(t.params),h(t.result)))),E.on(t,((e,t)=>t.query.offset?e:(0,s.resetEntities)(e,l(t)))).on(t.done,((e,t)=>{const i=l(t.params),o=c(t.result),s=(0,r.uniqueArray)([...e[i]||[],...o.map(p)]);return(0,n.setEntity)(e,i,s)})),k.on(t,((e,t)=>t.query.offset?e:(0,s.resetEntities)(e,l(t)))).on(t.fail,((e,t)=>t.params.controller?.signal.aborted?e:(0,n.setEntity)(e,l(t.params),t.error))),(0,o.sample)({clock:t.done,source:i,fn:(e,t)=>(0,a.mapToEntity)(e,c(t.result),m),target:i}),(0,o.sample)({clock:y,source:{entitiesFullyLoaded:I,entitiesLoading:S,entitiesParams:b,nextFrom:w},filter:(e,{entityKey:t})=>!e.entitiesLoading[t]&&!e.entitiesFullyLoaded[t]&&!!e.entitiesParams[t],fn:(e,{count:t,entityKey:i})=>{const o=e.entitiesParams[i];if(!o)throw new Error("FactoryLists: Empty request params");const r=t||g(o),s=e.nextFrom[i]||"";return{...o,query:{...o.query,..._({count:r,offset:v(o)+r,start_from:s})},controller:new AbortController}},target:t}),{resetEvent:C,fetchMoreEvent:y,pushItemsEvent:A,unshiftItemsEvent:L,deleteItemsEvent:x,fetchFx:t,$entitiesFullyLoaded:I,$entitiesLoading:S,$entitiesListIds:E,$entitiesCount:f,$entitiesError:k,selectStores:e=>{const t=(e,t)=>t[e]??null;return{$count:(0,o.combine)(e,f,t),$listIds:(0,o.combine)(e,E,t),$error:(0,o.combine)(e,k,t),$loading:(0,o.combine)(e,S,t),$fullyLoaded:(0,o.combine)(e,I,t)}}}}},296627:(e,t,i)=>{i.d(t,{createEntitiesCatalogLiveCategoriesService:()=>s});var o=i(32489),r=i(224191);const s=({domain:e})=>{const t=e.createStore({}),i=e.createEvent();return(0,o.sample)({clock:i,source:t,fn:(e,t)=>(0,r.mapToEntity)({},t),target:t}),{$entitiesCatalogLiveCategories:t,setCatalogLiveCategoriesEvent:i}}},583855:(e,t,i)=>{i.d(t,{createEntitiesCatalogLiveChannelsService:()=>s});var o=i(32489),r=i(224191);const s=({domain:e})=>{const t=e.createStore({}),i=e.createEvent();return(0,o.sample)({clock:i,source:t,fn:(e,t)=>(0,r.mapToEntity)(e,t,"stream_id"),target:t}),{$entitiesCatalogLiveChannels:t,setCatalogLiveChannelsEvent:i}}},424424:(e,t,i)=>{i.d(t,{createEntitiesCatalogSectionsService:()=>a});var o=i(32489),r=i(679005),s=i(876761),n=i(224191);const a=({domain:e})=>{const t=(0,s.createCatalogGetSectionFx)({domain:e}),i=e.createEvent(),a=e.createEvent(),d=e.createEvent(),l=e.createStore({}).reset(a),c=e.createStore([]).reset(i),u=e.createStore({}),h=e.createStore({}).reset(i);return(0,o.sample)({clock:d,source:l,fn:(e,t)=>(0,n.mapToEntity)(e,t),target:l}),(0,o.sample)({clock:i,source:l,fn:(e,t)=>(0,n.mapToEntity)(e,t.catalog?.sections??[]),target:l}),(0,o.sample)({clock:i,source:c,fn:(e,t)=>[...e,...t.catalog?.sections.map((({id:e})=>e))??[]],target:c}),u.on(t,((e,t)=>{const i=t.query.section_id;return i?{...e,[i]:!0}:e})),u.on(t.finally,((e,t)=>{const i=t.params.query.section_id;return i?{...e,[i]:!1}:e})),h.on(t,((e,t)=>(0,r.produce)(e,(e=>{const i=t.query.section_id;i&&(e[i]=null)})))),h.on(t.fail,((e,t)=>{const i=t.params.query.section_id;return i?{...e,[i]:t.error}:e})),{initCatalog:i,$entitiesCatalogSections:l,$entitiesCatalogSectionIds:c,$entitiesSectionsErrors:h,$entitiesSectionsLoading:u,catalogGetSectionFx:t,setCatalogGetSectionsEvent:d,resetSections:a}}},980578:(e,t,i)=>{i.d(t,{createEntitiesCatalogVideoService:()=>l});var o=i(32489),r=i(876761),s=i(401464),n=i(564479),a=i(254461);const d=({query:e})=>e.url??e.owner_id??"",l=({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:i,entitiesUsersService:l,entitiesVideoAlbumsService:c,entitiesVideoService:u,entitiesPlaceholdersService:h})=>{const p=(0,r.createCatalogGetVideoFx)({domain:e}),m=(0,s.errors)({effect:p,getKey:d,store:e.createStore({})}),v=(0,n.pendings)({effect:p,getKey:d,store:e.createStore({})}),g=e.createEvent(),_=e.createStore({}),{$entitiesCatalogSections:C,catalogGetSectionFx:y,initCatalog:b,setCatalogGetSectionsEvent:I}=t;(0,o.sample)({clock:p.doneData,target:b}),(0,o.sample)({clock:p.done,source:_,fn:(e,{params:t,result:i})=>({...e,[d(t)]:i.catalog}),target:_}),(0,o.sample)({clock:[y.doneData,g],source:C,filter:(e,{section:t})=>Boolean(t?.id),fn:(e,{section:t})=>{if(!t)return[];const i=e[t.id];if(!i)return[t];return[{...t,actions:i.actions&&t.actions?[...i.actions,...t.actions]:t.actions,blocks:(0,a.mergeCatalogVideoSectionBlocks)(i.blocks,t.blocks)}]},target:I});const S=(0,o.sample)({clock:[p.doneData,y.doneData,g]});return(0,o.sample)({clock:S,filter:({albums:e})=>Boolean(e?.length),fn:({albums:e=[]})=>e,target:c.setVideoAlbumsEvent}),(0,o.sample)({clock:S,filter:({groups:e})=>Boolean(e?.length),fn:({groups:e=[]})=>e,target:i.setGroupsEvent}),(0,o.sample)({clock:S,filter:({profiles:e})=>Boolean(e?.length),fn:({profiles:e=[]})=>e,target:l.setUsersEvent}),(0,o.sample)({clock:S,filter:({videos:e})=>Boolean(e?.length),fn:({videos:e=[]})=>e,target:u.setVideosEvent}),(0,o.sample)({clock:S,filter:({placeholders:e})=>Boolean(e?.length),fn:({placeholders:e=[]})=>e,target:h.setPlaceholdersEvent}),{$entitiesCatalogVideo:_,$entitiesCatalogVideoErrors:m,$entitiesCatalogVideoLoading:v,catalogGetVideoFx:p,updateSectionEvent:g}}},906085:(e,t,i)=>{i.d(t,{createEntitiesPlaceholdersService:()=>s});var o=i(32489),r=i(224191);const s=({domain:e})=>{const t=e.createStore({}),i=e.createEvent();return(0,o.sample)({clock:i,source:t,fn:(e,t)=>(0,r.mapToEntity)(e,t),target:t}),{$entitiesPlaceholders:t,setPlaceholdersEvent:i}}},254461:(e,t,i)=>{i.d(t,{mergeCatalogVideoSectionBlocks:()=>r});const o=["videos_ids","albums_ids","item_badges","search_author_items","vklive_channels_ids","vklive_categories_ids"],r=(e,t)=>t?e?t.reduce(((e,t)=>{const i=e.findIndex((({id:e})=>e===t.id));return e[i]?(o.forEach((o=>{if(!t[o])return;const r=e[i][o]??[],s=t[o]??[];e[i]={...e[i],[o]:[...r,...s]}})),e):(e.push(t),e)}),[...e]):t??[]:e??[]},188386:(e,t,i)=>{i.d(t,{createEntitiesFaveVideoService:()=>c});var o=i(32489),r=i(538522),s=i(278116),n=i(401464),a=i(564479);const d=({query:e})=>(0,r.joinRawId)({ownerId:e.owner_id,itemId:e.id}),l=(e,{query:t},i)=>({...e,[(0,r.joinRawId)({ownerId:t.owner_id,itemId:t.id})]:i}),c=({domain:e})=>{const t=(0,s.createFaveAddVideoFx)({domain:e}),i=(0,s.createFaveRemoveVideoFx)({domain:e}),r=(0,n.errors)({effect:t,getKey:d,store:e.createStore({})}),c=(0,a.pendings)({effect:t,getKey:d,store:e.createStore({})}),u=(0,n.errors)({effect:i,getKey:d,store:e.createStore({})}),h=(0,a.pendings)({effect:i,getKey:d,store:e.createStore({})}),p=e.createStore({}),m=e.createEvent();return p.on(m,((e,{id:t,value:i})=>({...e,[t]:i}))),(0,o.sample)({clock:t.done,source:p,filter:(e,{result:t})=>Boolean(t),fn:(e,{params:t})=>l(e,t,!0),target:p}),(0,o.sample)({clock:i.done,source:p,filter:(e,{result:t})=>Boolean(t),fn:(e,{params:t})=>l(e,t,!1),target:p}),{$entitiesFaveAddVideoErrors:r,$entitiesFaveAddVideoLoading:c,$entitiesFaveRemoveVideoErrors:u,$entitiesFaveRemoveVideoLoading:h,$entitiesFaveVideo:p,faveAddVideoFx:t,faveRemoveVideoFx:i,setFaveVideoByIdEvent:m}}},12563:(e,t,i)=>{i.d(t,{createEntitiesGroupsService:()=>u});var o=i(32489),r=i(755812),s=i(986125),n=i(224191),a=i(738371),d=i(401464),l=i(564479),c=i(468073);const u=({domain:e})=>{const t=(0,r.createGroupsGetByIdFx)({domain:e}),i=(0,r.createGroupsGetMembersFx)({domain:e}),u=(0,r.createGroupsJoinFx)({domain:e}),h=(0,r.createGroupsLeaveFx)({domain:e}),p=(0,r.createGroupsEditFx)({domain:e}),m=(0,o.createEffect)({handler:e=>{const{groupIds:i,...o}=e.query;return t({...e,query:{...o,group_ids:i.join(",")}})},domain:e}),v=(0,o.createEffect)({handler:e=>i(e),domain:e}),g=(0,s.createVideoGetGroupsForStreamingFx)({domain:e}),_=(0,o.createStore)({},{domain:e}),C=(0,o.createStore)({},{domain:e}),y=(0,o.createStore)({},{domain:e}),b=(0,o.createEvent)({domain:e}),I=e.createEvent(),S=e.createEvent();return(0,d.errors)({effect:m,getKey:e=>e.query.groupIds,store:C}),(0,l.pendings)({effect:m,getKey:e=>e.query.groupIds,store:y}),(0,o.sample)({clock:m.done,fn:e=>e.result.groups||[],target:b}),(0,o.sample)({clock:g.done,fn:e=>e.result||[],target:b}),(0,o.sample)({clock:S,source:_,fn:(e,t)=>t.map((t=>{const i=c.Ranges.convertOwnerIdToGroupId(t.id);return{...e[i],...t}})),target:b}),(0,o.sample)({clock:b,source:_,fn:(e,t)=>(0,n.mapToEntity)(e,t),target:_}),(0,a.sampleEntityUpdater)({store:_,fx:u,key:e=>String(e.params.query.group_id),fn:e=>e?{...e,is_member:1}:null}),(0,a.sampleEntityUpdater)({store:_,fx:h,key:e=>String(e.params.query.group_id),fn:e=>e?{...e,is_member:0}:null}),(0,o.sample)({clock:I,fn:()=>({}),target:_}),{$entitiesGroups:_,$entitiesGroupsLoading:y,$entitiesGroupsErrors:C,groupsGetByIdFx:m,getGroupsForStreamingFx:g,setGroupsEvent:b,groupsJoinFx:u,groupsLeaveFx:h,groupsEditFx:p,clearGroupsEvent:I,groupsGetMembersFx:v,patchGroupsEvent:S}}},178317:(e,t,i)=>{i.d(t,{createEntitiesVideoAlbumService:()=>v});var o=i(32489),r=i(538522),s=i(361121),n=i(93348),a=i(986125),d=i(859139),l=i(310232),c=i(831144),u=i(237656),h=i(649392),p=i(468073);const m=({album_id:e,owner_id:t=0})=>(0,r.joinRawId)({ownerId:t,itemId:e}),v=e=>{const t=(0,a.createVideoDeleteAlbumFx)(e),i=(0,a.createVideoEditAlbumFx)(e),v=(0,a.createVideoAddAlbumFx)(e),g=(0,a.createVideoGetAlbumByIdFx)(e),_=(0,a.createVideoGetAlbumsExtendedFx)(e),C=(0,a.createVideoAddToAlbumFx)(e),y=(0,a.createVideoRemoveFromAlbumFx)(e),{domain:b}=e,I=b.createStore({}),S=b.createStore({}),f=b.createStore({}),w=b.createStore({}),E=b.createStore({}),k=b.createStore({}),P=b.createStore({}),A=b.createStore({}),L=b.createEvent(),x=b.createEvent(),[M,O]=(0,c.createAbortControllerField)(b),[T,V]=(0,c.createAbortControllerField)(b),F=(0,o.attach)({effect:t,mapParams:({id:e,...t})=>{const{itemId:i,ownerId:o}=(0,s.splitRawId)(e);return{...t,query:p.Ranges.isGroupId(o)?{album_id:i,group_id:p.Ranges.convertOwnerIdToGroupId(o)}:{album_id:i,owner_id:o}}}}),j=(0,o.attach)({effect:i,source:M,mapParams:({ownerId:e,itemId:t,title:i,privacy:o,photoId:r,photoHash:s,verticalPhotoTag:n,verticalPhotoHash:a,...l},c)=>{const u={album_id:t,title:i};return void 0!==r&&(u.photo_id=r,u.photo_hash=s),void 0!==n&&(u.vertical_photo_tag=n,u.vertical_photo_hash=a),o&&(u.privacy=(0,d.stringifyBasePrivacy)(o)),p.Ranges.isGroupId(e)&&(u.group_id=p.Ranges.convertOwnerIdToGroupId(e)),{...l,query:u,controller:c??void 0}}});(0,o.sample)({clock:j,source:M,fn:e=>(e?.abort(),new AbortController),target:M});const R=(0,o.attach)({effect:v,source:T,mapParams:({ownerId:e,title:t,privacy:i,photoId:o,photoHash:r,verticalPhotoTag:s,verticalPhotoHash:n,...a},l)=>{const c={title:t};return void 0!==o&&(c.photo_id=o,c.photo_hash=r),void 0!==s&&(c.vertical_photo_tag=s,c.vertical_photo_hash=n),i&&(c.privacy=(0,d.stringifyBasePrivacy)(i)),p.Ranges.isGroupId(e)&&(c.group_id=p.Ranges.convertOwnerIdToGroupId(e)),{...a,query:c,controller:l??void 0}}});(0,o.sample)({clock:R,source:T,fn:e=>(e?.abort(),new AbortController),target:T});const D=R.pending,B=(0,u.createVideoAlbumSubscriptionEffect)((0,a.createVideoSubscribeToAlbum)(e),L,!0),N=(0,u.createVideoAlbumSubscriptionEffect)((0,a.createVideoUnsubscribeFromAlbum)(e),L,!1);return(0,h.registerEntitiesSetSample)(x,I),f.on(g,((e,{query:t})=>(0,l.updateEntitiesBy)(e,m(t),!0))),f.on(g.finally,((e,{params:t})=>(0,l.updateEntitiesBy)(e,m(t.query),!1))),S.on(g,((e,{query:t})=>(0,l.updateEntitiesBy)(e,m(t),null))),S.on(g.fail,((e,{error:t,params:i})=>(0,l.updateEntitiesBy)(e,m(i.query),t))),I.on(g.done,((e,{params:t,result:i})=>(0,l.updateEntitiesBy)(e,m(t.query),i))),k.on(F,((e,{id:t})=>(0,l.updateEntitiesBy)(e,t,!0))),k.on(F.finally,((e,{params:t})=>(0,l.updateEntitiesBy)(e,t.id,!1))),E.on(F,((e,{id:t})=>(0,l.updateEntitiesBy)(e,t,null))),E.on(F.fail,((e,{error:t,params:i})=>(0,l.updateEntitiesBy)(e,i.id,t))),w.on(F.done,((e,{params:t,result:i})=>i?(0,l.updateEntitiesBy)(e,t.id,!0):e)),A.on(j,((e,{ownerId:t,itemId:i})=>(0,l.updateEntitiesBy)(e,(0,r.joinRawId)({itemId:i,ownerId:t}),!0))),A.on(j.finally,((e,{params:t})=>(0,l.updateEntitiesBy)(e,(0,r.joinRawId)({itemId:t.itemId,ownerId:t.ownerId}),!1))),P.on(j,((e,{ownerId:t,itemId:i})=>(0,l.updateEntitiesBy)(e,(0,r.joinRawId)({itemId:i,ownerId:t}),null))),P.on(j.fail,((e,{error:t,params:i})=>(0,l.updateEntitiesBy)(e,(0,r.joinRawId)({itemId:i.itemId,ownerId:i.ownerId}),t))),(0,o.sample)({clock:[_.done],filter:({result:e})=>Boolean(e.items),fn:({result:e})=>e.items,target:x}),(0,o.sample)({clock:j.done,fn:({params:e})=>[{owner_id:e.ownerId,id:e.itemId,title:e.title,privacy:e.privacy}],target:L}),(0,o.sample)({clock:L,source:I,fn:(e,t)=>t.reduce(((t,i)=>{const o=(0,r.joinRawId)({ownerId:i.owner_id,itemId:i.id}),s={...e[o],...i};return(0,n.isVideoVideoAlbumFull)(s)&&t.push(s),t}),[]),target:x}),{$entitiesVideoAlbums:I,$entitiesVideoAlbumsErrors:S,$entitiesVideoAlbumsLoading:f,$entitiesVideoDeletedAlbums:w,$entitiesVideoDeletedAlbumsErrors:E,$entitiesVideoDeletedAlbumsPending:k,$entitiesVideoEditedAlbumsErrors:P,$entitiesVideoEditedAlbumsPending:A,patchVideoAlbumsEvent:L,setVideoAlbumsEvent:x,editVideoAlbumByIdFx:j,abortEditRequestEvent:O,createVideoAlbumFx:R,abortCreateRequestEvent:V,$createVideoAlbumPending:D,deleteVideoAlbumByIdFx:F,getVideoAlbumByIdFx:g,subscribeToVideoAlbumFx:B,unsubscribeFromVideoAlbumFx:N,getVideoAlbumsFx:_,addVideoToAlbumFx:C,removeVideoFromAlbumFx:y}}},87029:(e,t,i)=>{i.d(t,{createEntitiesVideoService:()=>d});var o=i(32489),r=i(538522),s=i(986125),n=i(310232),a=i(649392);const d=({domain:e,entitiesGroupsService:t,entitiesUsersService:i})=>{const d=(0,s.createVideoGetFx)({domain:e}),l=(0,s.createVideoGetVideoDiscoverFx)({domain:e}),c=(0,s.createVideoFeedVideosForYouBlockItemsFx)({domain:e}),u=(0,s.createVideoAddFx)({domain:e}),h=(0,s.createVideoDeleteFx)({domain:e}),p=(0,s.createVideoRestoreFx)({domain:e}),m=e.createStore({}),v=e.createStore({}),g=e.createStore({}),_=e.createEvent(),C=e.createEvent(),y=e.createEvent();g.on(d,((e,{query:t})=>(0,n.updateEntitiesBy)(e,t.videos,!0))),g.on(d.finally,((e,{params:t})=>(0,n.updateEntitiesBy)(e,t.query.videos,!1))),v.on(d,((e,{query:t})=>(0,n.updateEntitiesBy)(e,t.videos,void 0))),v.on(d.fail,((e,{error:t,params:i})=>(0,n.updateEntitiesBy)(e,i.query.videos,t)));const b=(0,o.attach)({effect:d,mapParams:({id:e,extended:t,group_id:i,...o})=>({...o,query:{count:1,videos:e,extended:t,group_id:i}})}),I=(0,o.attach)({effect:d,mapParams:({id:e,extended:t,group_id:i,...o})=>({...o,query:{videos:e,extended:t,group_id:i}})});return(0,o.sample)({clock:[d.done,l.done,c.done],filter:({result:e})=>Boolean(e.items),fn:({result:e})=>e.items,target:_}),t?.setGroupsEvent&&(0,o.sample)({clock:[d.done,l.done,c.done],filter:({result:e})=>Boolean(e.groups?.length),fn:({result:e})=>e.groups??[],target:t?.setGroupsEvent}),i?.setUsersEvent&&(0,o.sample)({clock:[d.done,l.done,c.done],filter:({result:e})=>Boolean(e.profiles?.length),fn:({result:e})=>e.profiles??[],target:i.setUsersEvent}),(0,o.sample)({clock:y,source:m,fn:(e,t)=>t.map((t=>{const i=(0,r.joinRawId)({ownerId:t.owner_id,itemId:t.id});return{...e[i],...t}})),target:_}),(0,a.registerEntitiesSetSample)(_,m),(0,o.sample)({clock:C,fn:()=>({}),target:m}),{$entitiesVideo:m,$entitiesVideoLoading:g,$entitiesVideoErrors:v,patchVideosEvent:y,setVideosEvent:_,clearVideosEvent:C,videoAddFx:u,videoGetFx:d,videoGetByIdFx:b,videosGetByIdsFx:I,videoGetVideoDiscoverFx:l,videoDeleteFx:h,videoRestoreFx:p,videoFeedVideosForYouBlockItemsFx:c}}},530040:(e,t,i)=>{i.d(t,{createListsVideosAlbumsService:()=>a});var o=i(538522),r=i(986125),s=i(510015);const n=({id:e,owner_id:t})=>void 0===e||void 0===t?"":(0,o.joinRawId)({itemId:e,ownerId:t}),a=({domain:e,entitiesVideoAlbumService:t})=>{const i=(0,r.createVideoGetAlbumsExtendedFx)({domain:e}),o=e.createEffect(i),a=(0,s.createFactoryLists)({$entitiesItems:t.$entitiesVideoAlbums,domain:e,fetchFx:o,getItemKey:n,getList:({items:e})=>e,getListCount:({count:e})=>e,getListKey:({entityKey:e})=>e,getEntityKey:n});return{resetVideosAlbumsEvent:a.resetEvent,fetchMoreVideosAlbumsEvent:a.fetchMoreEvent,fetchVideosAlbumsFx:a.fetchFx,$videosAlbumsFullyLoaded:a.$entitiesFullyLoaded,$videosAlbumsLoading:a.$entitiesLoading,$videosAlbumsIds:a.$entitiesListIds,$videosAlbumsCount:a.$entitiesCount,$videosAlbumsError:a.$entitiesError,selectStores:a.selectStores}}},750988:(e,t,i)=>{i.d(t,{createListsVideosService:()=>n});var o=i(538522),r=i(510015);const s=({id:e,owner_id:t})=>void 0===e||void 0===t?"":(0,o.joinRawId)({itemId:e,ownerId:t}),n=({domain:e,entitiesVideoService:t})=>{const i=e.createEffect(t.videoGetFx),o=(0,r.createFactoryLists)({$entitiesItems:t.$entitiesVideo,domain:e,fetchFx:i,getItemKey:s,getList:({items:e})=>e,getListCount:({count:e})=>e,getListKey:({entityKey:e})=>e,getEntityKey:s});return{resetVideosEvent:o.resetEvent,fetchMoreVideosEvent:o.fetchMoreEvent,fetchVideosFx:o.fetchFx,$videosFullyLoaded:o.$entitiesFullyLoaded,$videosLoading:o.$entitiesLoading,$videosIds:o.$entitiesListIds,$videosCount:o.$entitiesCount,$videosError:o.$entitiesError,selectStores:o.selectStores}}},831144:(e,t,i)=>{i.d(t,{createAbortControllerField:()=>r});var o=i(32489);const r=e=>{const t=e.createStore(null),i=e.createEvent();return(0,o.sample)({clock:i,source:t,fn:e=>!1===e?.signal.aborted?(e.abort(),null):e,target:t}),[t,i]}},237656:(e,t,i)=>{i.d(t,{createVideoAlbumSubscriptionEffect:()=>r});var o=i(32489);const r=(e,t,i)=>{const r=(0,o.createEffect)((({optimistic:t,...i})=>e(i)));return(0,o.sample)({clock:r,filter:({optimistic:e=!1,query:t})=>e&&void 0!==t.album_id,fn:({query:e})=>[{owner_id:e.owner_id,id:Number(e.album_id),is_subscribed:i}],target:t}),(0,o.sample)({clock:r.fail,filter:({params:e})=>Boolean(e.optimistic)&&void 0!==e.query.album_id,fn:({params:e})=>[{owner_id:e.query.owner_id,id:Number(e.query.album_id),is_subscribed:!i}],target:t}),(0,o.sample)({clock:r.done,filter:({params:e})=>!e.optimistic&&void 0!==e.query.album_id,fn:({params:e})=>[{owner_id:e.query.owner_id,id:Number(e.query.album_id),is_subscribed:i}],target:t}),r}},649392:(e,t,i)=>{i.d(t,{registerEntitiesSetSample:()=>n});var o=i(32489),r=i(538522),s=i(224191);const n=(e,t)=>{(0,o.sample)({clock:e,source:t,fn:(e,t)=>{const i=t.filter((e=>void 0!==e.owner_id&&void 0!==e.id));return i.length?(0,s.mapToEntity)(e,i,(e=>(0,r.joinRawId)({ownerId:e.owner_id,itemId:e.id}))):e},target:t})}},738371:(e,t,i)=>{i.d(t,{sampleEntityUpdater:()=>o});const o=e=>{const{fx:t,key:i,store:o,fn:r}=e;return o.on(t.done,((e,t)=>{const o="function"==typeof i?i(t):t.params.query[i],s=e[o];return{...e,[o]:r(s,t)}})),o}},401464:(e,t,i)=>{i.d(t,{errors:()=>r});var o=i(679005);function r({effect:e,getKey:t,store:i}){return i.on(e,((e,i)=>(0,o.produce)(e,(e=>{const o=t(i);Array.isArray(o)?o.forEach((t=>e[t]=null)):o&&(e[o]=null)})))),i.on(e.fail,((e,{error:i,params:r})=>(0,o.produce)(e,(e=>{const o=t(r);Array.isArray(o)?o.forEach((t=>e[t]=i)):o&&(e[o]=i)})))),i}},564479:(e,t,i)=>{i.d(t,{pendings:()=>r});var o=i(679005);function r({effect:e,getKey:t,store:i}){return i.on(e,((e,i)=>(0,o.produce)(e,(e=>{const o=t(i);Array.isArray(o)?o.forEach((t=>e[t]=!0)):o&&(e[o]=!0)})))),i.on(e.finally,((e,{params:i})=>(0,o.produce)(e,(e=>{const o=t(i);Array.isArray(o)?o.forEach((t=>e[t]=!1)):o&&(e[o]=!1)})))),i}},914231:(e,t,i)=>{i.d(t,{resetEntities:()=>r});var o=i(679005);const r=(e,t)=>t?(0,o.produce)(e,(e=>{e[t]=null})):{}},858716:(e,t,i)=>{i.d(t,{setEntity:()=>o});const o=(e,t,i)=>t?{...e,[t]:i}:e},363046:(e,t,i)=>{function o(e){e.preventDefault(),e.stopPropagation()}i.d(t,{cancelEvent:()=>o})},820361:(e,t,i)=>{i.d(t,{getUserFullName:()=>o});const o=e=>{const{first_name:t,last_name:i}=e;return`${t} ${i}`}},93348:(e,t,i)=>{i.d(t,{isVideoVideoAlbumFull:()=>o});const o=e=>"object"==typeof e&&null!==e&&"id"in e&&"owner_id"in e&&"title"in e&&"count"in e},302032:(e,t,i)=>{i.d(t,{lazyModule:()=>d});var o=i(474848),r=i(296540);function s(e){console.error(e)}const n=()=>(0,o.jsx)("h2",{children:"Loading..."}),a=()=>(0,o.jsx)("h2",{children:"Cannot load module..."});function d({loader:e,name:t}){const i=({loading:i=(0,o.jsx)(n,{}),loadingError:d=(0,o.jsx)(a,{}),...c})=>{const[u,h]=(0,r.useState)(!1),p=(0,r.useMemo)((()=>(0,r.lazy)((()=>e().then((e=>({default:e})),(e=>(s(e),h(!0),{default:()=>null})))))),[e]);return(0,o.jsx)(l,{fallback:d,moduleName:t,children:u?d:(0,o.jsx)(r.Suspense,{fallback:i,children:(0,o.jsx)(p,{...c})})})};return i.displayName=`lazyModule(${t})`,i.preload=e,i}class l extends r.Component{componentDidCatch(e){s(e),this.setState({hasError:!0})}render(){const{fallback:e,children:t}=this.props,{hasError:i}=this.state;return i?e:t}constructor(...e){super(...e),this.state={hasError:!1}}}},454404:(e,t,i)=>{i.d(t,{LazyStickerRich:()=>d});var o=i(474848),r=i(296540),s=i(220208),n=i(8520);const a=(0,r.lazy)((()=>(0,n.asyncImportLoader)((async()=>{const{StickerRich:e}=await Promise.all([i.e(89631),i.e(15523),i.e(50756),i.e("langs/web/sticker")]).then(i.bind(i,838670));return{default:e}}))));function d(e){const{size:t}=e.baseStickerProps;return(0,o.jsx)(r.Suspense,{fallback:(0,o.jsx)("div",{style:{width:t,height:t},children:(0,o.jsx)(s.Spinner,{})}),children:(0,o.jsx)(a,{...e})})}},902506:(e,t,i)=>{i.d(t,{didStickersSettingsInvalidate:()=>a,disabledPeerIdsByUser:()=>I,getDisabledPeerIdsByUser:()=>f,getIsAnimationAutoplay:()=>m,getIsPopupAutoplayOnGet:()=>b,getIsPopupAutoplayOnSend:()=>_,getSettingsCache:()=>c,invalidateStickersSettings:()=>d,isAnimationAutoplayOff:()=>w,isPeerDisabledByUserForPopupAutoplay:()=>P,isPopupAutoplayForPeerByUserOn:()=>A,isPopupAutoplayOnGetOff:()=>E,isPopupAutoplayOnSendOff:()=>k,setDisabledPeerIdsByUser:()=>S,setIsAnimationAutoplay:()=>p,setIsPopupAutoplayOnGet:()=>y,setIsPopupAutoplayOnSend:()=>g,updateSettingsCache:()=>x,updateSettingsCacheBySetPopupSettingsResponse:()=>L,validateStickersSettings:()=>l});var o=i(558137),r=i(724361),s=i(100596);const n={didInvalidate:!0};function a(){return n.didInvalidate}function d(){n.didInvalidate=!0}function l(){n.didInvalidate=!1}const c=(0,o.makeSharedState)("stickers-settings-cache",(()=>(0,r.createSyncStore)({dbName:"stickers",version:1,storeName:"settings"})),{version:1}),u=c(),h=u.createAtom("isAutoplay",s.SyncAtomType.BOOLEAN),p=e=>{h.set(e)},m=()=>h.get(),v=u.createAtom("isPopupAutoplayOnSend",s.SyncAtomType.BOOLEAN),g=e=>{v.set(e)},_=()=>v.get(),C=u.createAtom("isPopupAutoplayOnGet",s.SyncAtomType.BOOLEAN),y=e=>{C.set(e)},b=()=>C.get(),I=u.createAtom("disabledPeerIdsByUser",s.SyncAtomType.OBJECT),S=e=>{I.set(e)},f=()=>I.get()??[],w=()=>!1===m(),E=()=>!1===b(),k=()=>!1===_(),P=e=>f().includes(e),A=e=>!w()&&!P(e),L=e=>{if(!e.popup)return;const{disabled_peer_ids:t,on_send:i,on_get:o}=e.popup.autoplay;S(t),y(o),g(i)},x=({popupDisabledPeerIds:e,popupAutoplayOnSend:t,popupAutoplayOnGet:i,animationAutoplay:o})=>{S(e),y(i),g(t),p(o)}},344527:(e,t,i)=>{i.d(t,{isBaseSticker:()=>o,isPopupSticker:()=>r});const o=e=>Boolean(e&&"inner_type"in e&&"base_sticker_new"===e.inner_type),r=e=>o(e)&&Boolean(e.popup?.layers)},732061:(e,t,i)=>{i.d(t,{AnimationLayer:()=>a});var o=i(474848),r=i(296540),s=i(970704),n=i(9320);const a=({layer:e,animationState:t,onAnimationPlayBackAreaLoaded:i,onAnimationPlayBackAreaFinished:a,...d})=>{const l=(0,s.isMainAnimationLayout)(e),[c,u]=(0,r.useState)(!1);return c?null:(0,o.jsx)(o.Fragment,{children:l&&(0,o.jsx)(n.MainAnimationLayout,{layer:e,onFirstFrameRender:()=>{t.markStateAsPlaying()},onAnimationLoaded:()=>{i(),t.markStateAsLoaded()},onLayerLoopCompleted:()=>{c||(a(),t.markStateAsFinished(),u(!0))},...d})})}},863826:(e,t,i)=>{i.d(t,{LottiePlayer:()=>p});var o=i(474848),r=i(327813),s=i(456921),n=i(8520),a=i(812153),d=i(296540),l=i(761894),c=i(970704),u=i(808586),h=i(648214);const p=(0,s.observer)((({layer:e,style:t,onAnimationLoaded:i,onFirstFrameRender:s,onLayerLoopCompleted:p})=>{const{popupStore:m}=(0,u.usePopupStickerWithError)(),v=(0,d.useRef)(0),g=(0,d.useRef)(!1),{isPlaying:_,onAnimationClick:C,lottiePlayer:{options:y}}=m,{onLottiePlayerError:b}=m.errorHandlers,{lottieContainerRef:I,lottiePlayerRef:S,lottieLoaded:f,lottieRendered:w,lottieErrorMessage:E}=(0,a.useLottie)({group:l.POPUP_LOTTIE_GROUP,animationUrl:e.url,...y},{play:_}),k=()=>{g.current||(p(),g.current=!0)};return(0,d.useEffect)((()=>{const e=S.current;e&&e.setOptions(y)}),[y]),(0,d.useEffect)((()=>{E&&(e=>{b?.(e),k()})(E)}),[E,b]),(0,d.useEffect)((()=>{const e=S.current;if(e)return i&&e.addEventListener("ready",i,{once:!0}),s&&e.addEventListener("firstFrame",s,{once:!0}),()=>{s&&e.removeEventListener("firstFrame",s),i&&e.removeEventListener("ready",i)}}),[f]),(0,d.useEffect)((()=>{const e=S.current;if(e)return e.addEventListener("destroy",k,{once:!0}),()=>{g.current&&e.removeEventListener("destroy",k)}}),[w]),(0,d.useEffect)((()=>{const t=S.current;if(!t)return;const i=(0,c.getAnimationLayerLoopsLimit)(e),o=()=>{if(v.current+=1,v.current===i)return k(),void t.removeEventListener("loopComplete",o)};return t.addEventListener("loopComplete",o),()=>{t.removeEventListener("loopComplete",o)}}),[f]),(0,o.jsx)("div",{onClick:e=>{C?.(e)},className:(0,n.classNames)(h.default.wrapper,{[h.default.wrapperClickable]:Boolean(C)&&y.speed!==l.SPEED_ON_DESTROY}),style:(0,r.toJS)(t),ref:I})}))},9320:(e,t,i)=>{i.d(t,{MainAnimationLayout:()=>s});var o=i(474848),r=i(863826);const s=({layer:e,popUpLayerStyle:t,onAnimationLoaded:i,onFirstFrameRender:s,onLayerLoopCompleted:n})=>(0,o.jsx)(r.LottiePlayer,{layer:e,style:t,onAnimationLoaded:i,onFirstFrameRender:s,onLayerLoopCompleted:n})},833045:(e,t,i)=>{i.d(t,{NonAnimationLayer:()=>d});var o=i(474848),r=i(296540),s=i(970704),n=i(280501),a=i(674109);const d=({layer:e,parentState:t,popUpLayerStyle:i,popUpLayerStyleData:d})=>{const l=(0,s.isGradientLayer)(e),c=(0,s.isBackgroundLayer)(e),[u,h]=(0,r.useState)(!t);return(0,r.useEffect)((()=>{if(!t)return;const e=()=>{h(!1)},i=()=>{h(!0)};return t.listenable.once("onPlaying",i),t.listenable.once("onFinished",e),()=>{t.listenable.off("onPlaying",i),t.listenable.off("onFinished",e)}}),[]),u?(0,o.jsxs)(o.Fragment,{children:[l&&(0,o.jsx)(n.GradientLayer,{popUpLayerStyle:i,popUpLayerStyleData:d}),c&&(0,o.jsx)(a.BackgroundLayer,{popUpLayerStyle:i})]}):null}},674109:(e,t,i)=>{i.d(t,{BackgroundLayer:()=>s});var o=i(474848),r=i(7279);const s=({popUpLayerStyle:e})=>(0,o.jsx)("div",{className:r.default.wrapper,style:e})},280501:(e,t,i)=>{i.d(t,{GradientLayer:()=>a});var o=i(474848),r=i(948258),s=i(15978),n=i(228679);const a=({popUpLayerStyle:e,popUpLayerStyleData:t})=>{const i={...e,"--gradient-color":(0,r.useAppearanceDetector)()===s.Appearance.DARK?"rgba(0, 0, 0, 0.40)":"var(--white_alpha40)"};return(0,o.jsx)("div",{style:i,className:t?.isRadialGradient?n.default.wrapperWithRadialGradient:n.default.wrapperWithLinearGradient})}},338611:(e,t,i)=>{i.d(t,{PlayBackArea:()=>l});var o=i(474848),r=i(327813),s=i(732061),n=i(833045),a=i(970704),d=i(438185);const l=({layer:e,popUpLayerStyle:t,animationState:i,onAnimationPlayBackAreaFinished:l,onAnimationPlayBackAreaLoaded:c,style:u,popUpLayerStyleData:h,...p})=>{const m=(0,a.isAnimationLayer)(e);return(0,o.jsx)("div",{className:d.default.wrapper,style:(0,r.toJS)(u),...p,children:(0,o.jsxs)("div",{className:d.default.area,children:[m&&i&&(0,o.jsx)(s.AnimationLayer,{layer:e,animationState:i,popUpLayerStyle:t,onAnimationPlayBackAreaLoaded:c,onAnimationPlayBackAreaFinished:l}),!m&&(0,o.jsx)(n.NonAnimationLayer,{layer:e,parentState:i,popUpLayerStyle:t,popUpLayerStyleData:h})]})})}},716253:(e,t,i)=>{i.d(t,{PopUpPortal:()=>h});var o=i(474848),r=i(327813),s=i(440961),n=i(296540),a=i(456921),d=i(338611),l=i(808586),c=i(970704),u=i(761894);const h=(0,a.observer)((({portalElement:e=document.body})=>{const t=(0,n.useRef)(0),i=(0,n.useRef)(0),{popupStore:a}=(0,l.usePopupStickerWithError)(),h=a.playBackAreasProps.filter((({layer:e})=>(0,c.isAnimationLayer)(e))).length,p=()=>{t.current++,t.current===h&&(t.current=0,i.current=0,a.onEndPlay?.())},m=()=>{i.current++,i.current===h&&a.startPlay()};if(!a.playBackAreasProps.length)return null;const v=(0,r.toJS)(a.playBackAreasProps).map((({style:e,popUpLayerStyle:t,...i},s)=>(0,o.jsx)(d.PlayBackArea,{onAnimationPlayBackAreaLoaded:m,onAnimationPlayBackAreaFinished:p,popUpLayerStyle:(0,r.toJS)(t),style:(0,r.toJS)({...e,transition:a.isFinishing?`opacity ${u.DESTROY_ANIMATION_DURATION}ms`:e?.transition??"",opacity:a.isFinishing?"0":e?.opacity??""}),...i},s)));return(0,s.createPortal)(v,e||document.body)}))},609969:(e,t,i)=>{i.d(t,{PopupProvider:()=>a});var o=i(474848),r=i(296540),s=i(808586),n=i(312459);const a=({popupStore:e,children:t})=>{const i=(0,r.useRef)(e??new n.PopupStickerService);return(0,o.jsx)(s.PopupContext.Provider,{value:{popupStore:i.current},children:t})}},808586:(e,t,i)=>{i.d(t,{PopupContext:()=>r,usePopupSticker:()=>n,usePopupStickerWithError:()=>s});var o=i(296540);const r=(0,o.createContext)(null);function s(){const e=(0,o.useContext)(r);if(null===e)throw new Error("You have forgotten to wrap your root component with PopupProvider");return e}function n(){const e=(0,o.useContext)(r);return null===e?{popupStore:void 0}:e}},280401:(e,t,i)=>{i.d(t,{PopupRoot:()=>p});var o=i(474848),r=i(456921),s=i(296540),n=i(716253),a=i(609969),d=i(693217),l=i(650416),c=i(761894),u=i(312459),h=i(526571);const p=(0,r.observer)((({isVisible:e=!0,allowUseCommon:t=!1,isUseAsFullscreen:i=!1,position:r=c.POPUP_POSITION_DEFAULT_VALUE,HtmlElement:p="div",setElementRef:m,children:v,className:g,popUpStore:_,id:C,...y})=>{const[b,I]=(0,s.useState)(null),S=(0,s.useMemo)((()=>new u.PopupStickerService),[]);return(0,s.useEffect)((()=>{e||_?.destroyByRemove()}),[e]),(0,s.useEffect)((()=>()=>{_?.destroyByRemove()}),[]),(0,o.jsx)(p,{id:C,ref:e=>{if((0,l.setRef)(e,m),!e)return void I(null);const o=(0,d.getDataAttrs)({popupStickerPosition:r,popupStickerContainerId:e.id,popupStickerUseCommon:t.toString(),popupStickerFullScreenContainer:i?e.id:void 0});for(const[t,i]of Object.entries(o))e.setAttribute(t,i);I(i?e:document.querySelector(`#${e.getAttribute(c.FULL_SCREEN_CONTAINER_DATA_PROPERTY)}`)||document.querySelector(c.FULL_SCREEN_DATA_DEFAULT_VALUE))},className:g||h.default.wrapper,...y,children:(0,o.jsxs)(a.PopupProvider,{popupStore:_||S,children:[b&&e&&(0,o.jsx)(n.PopUpPortal,{portalElement:b}),v]})})}))},761894:(e,t,i)=>{i.d(t,{ANIMATION_DEDUCTIBLE_DATA_PROPERTY:()=>p,CONTAINER_ID_DATASET_PROPERTY:()=>d,CONTAINER_ID_DATA_DEFAULT_VALUE:()=>s,CONTAINER_ID_DATA_PROPERTY:()=>a,ConflictActionsTypes:()=>x,CustomPopUpLayerTypes:()=>I,DEDUCTIBLE_DATA_PROPERTY:()=>u,DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY:()=>h,DEFAULT_LOOP_LIMIT:()=>f,DEFAULT_PLAYER_OPTIONS:()=>C,DEFAULT_POPUP_CONTAINER_DATA_PROPERTY:()=>m,DEFAULT_POSITION_X:()=>E,DEFAULT_POSITION_Y:()=>k,DEFAULT_SCALE_RATIO:()=>w,DESTROY_ANIMATION_DURATION:()=>M,FULL_SCREEN_CONTAINER_DATA_PROPERTY:()=>c,FULL_SCREEN_DATA_DEFAULT_VALUE:()=>n,MIN_SIZE_FOR_PLAY:()=>A,MIN_SIZE_FOR_SCALE:()=>P,POPUP_LOTTIE_GROUP:()=>L,POPUP_POSITION_DEFAULT_VALUE:()=>g,POPUP_POSITION_PROPERTY:()=>v,POPUP_STICKER_IM_CONTAINER:()=>l,PopUpLayerTypes:()=>b,PopUpPositionTypes:()=>S,SCREEN_MODIFICATOR:()=>_,SPEED_ON_DESTROY:()=>y});var o=i(157951),r=i(351089);const s="common_container",n="body",a="data-popup-sticker-container-id",d=(0,r.dataAttrKeyToDatasetKey)(a),l="popup-sticker-im-container",c="data-popup-sticker-full-screen-container",u="data-popup-sticker-deductible",h="data-popup-sticker-deductible-full-screen",p="data-popup-sticker-animation-deductible",m="data-popup-sticker-use-common",v="data-popup-sticker-position",g="fixed",_="screen",C={speed:1,loop:!0,autoplay:!1,cache:!1,lazyLoading:!0,direction:o.LottiePlayerDirection.FORWARD,strictCache:!0},y=3,b={Gradient:"gradient",FullScreen:"animation_fullscreen",Fixed:"animation_fixed"},I={Background:"background"},S={FullScreen:"fullscreen",Fixed:"fixed",TopFullScreen:"topFullScreen"},f=1,w=1,E="center",k="middle",P=384,A=64,L="Popup",x={ChangeModificator:"changeModificator",DontShow:"dontShow"},M=300},459126:(e,t,i)=>{i.d(t,{AnimationState:()=>u});var o=i(434518),r=i(763812),s=i(584053);const n="preparing",a="loaded",d="playing",l="finished";var c=(0,r._)("_status");class u extends s.Emitter{get status(){return(0,o._)(this,c)[c]}constructor(){super(),Object.defineProperty(this,c,{writable:!0,value:void 0}),(0,o._)(this,c)[c]=n,this.markStateAsLoaded=()=>{(0,o._)(this,c)[c]=a,this.emit("onLoaded")},this.markStateAsPlaying=()=>{(0,o._)(this,c)[c]=d,this.emit("onPlaying")},this.markStateAsFinished=()=>{(0,o._)(this,c)[c]=l,this.emit("onFinished")}}}},129116:(e,t,i)=>{i.d(t,{checkPositionConflict:()=>n});var o=i(970704),r=i(175444),s=i(761894);const n=(e,{bottom:t,right:i,top:n,left:a},d)=>{const l={...d};for(const c of e){if(c.popUpPositions&&!c.popUpPositions.includes((0,r.getPopUpPositionType)(d)))continue;const e=document.querySelector(c.blockSelector);if(!e)continue;const u=e.getBoundingClientRect();if(a<=u.right&&i>=u.left&&n<=u.bottom&&t>=u.top)return c.action===s.ConflictActionsTypes.DontShow?null:(0,o.changeLayerPosition)(l)}return l}},251242:(e,t,i)=>{i.d(t,{createDestroyListeners:()=>o,setDestroyListeners:()=>r});const o=e=>{const t=e=>{document.removeEventListener("wheel",e),document.removeEventListener("touchmove",e),window.removeEventListener("resize",e)},i=()=>{t(i),e()};return{addDestroyListener:()=>{document.addEventListener("wheel",i,{once:!0}),document.addEventListener("touchmove",i,{once:!0}),window.addEventListener("resize",i,{once:!0})},removeDestroyListener:t.bind(void 0,i),handleDestroy:i}},r=(e,t)=>({...e,onEndPlay:()=>{t.removeDestroyListener(),e.onEndPlay?.()},onEndPrepare:i=>{i&&t.addDestroyListener(),e.onEndPrepare?.(i)},onAnimationClick:i=>{t.handleDestroy(),e.onAnimationClick?.(i)}})},686933:(e,t,i)=>{i.d(t,{getAnimationAreaStyle:()=>s});var o=i(761894),r=i(970704);const s=({width:e,height:t},i,s)=>{const n={...s},{position_y:a,position_x:d}=(0,r.getAnimationLayerPosition)(i),l=d.replace(o.SCREEN_MODIFICATOR,"").trim(),c=a.replace(o.SCREEN_MODIFICATOR,"").trim();return n.position="absolute","center"===l?(n.left=.5*e,n.transform="translateX(-50%)"):n.left="left"===l?0:e-parseInt(n.width),"middle"===c?(n.top=.5*t,n.transform="translateY(-50%)"):n.top="top"===c?0:t-parseInt(n.height),"middle"===c&&"center"===l&&(n.transform="translate(-50%, -50%)"),n}},16880:(e,t,i)=>{i.d(t,{getBasePropsForPlaybackAreas:()=>u});var o=i(459126),r=i(175444),s=i(679500),n=i(709467),a=i(686933),d=i(129116),l=i(970704);function c(e,t,i,u){const h=!t.animationFooterElement;if((0,l.isGradientLayer)(e)&&h){if(!u)return null;const t={...u.popUpLayerStyle,top:"unset",left:"unset",transform:"unset"},i=(0,n.getGradientAreaStyle)(e,t);return{layer:e,style:u.style,animationState:u.animationState,popUpLayerStyle:i.style,popUpLayerStyleData:i.styleData}}const p=(0,r.getPopUpPositionType)(e),{playBackAreaStyle:m,topByViewport:v}=(0,s.getPlayBackAreaStyle)(p,t,!(0,l.isGradientLayer)(e));if((0,l.isGradientLayer)(e)){if(!u||h)return null;const t=(0,n.getGradientAreaStyle)(e,{height:"100%",width:"100%"});return{layer:e,style:m,animationState:u.animationState,popUpLayerStyle:t.style,popUpLayerStyleData:t.styleData}}if((0,l.isBackgroundLayer)(e))return{layer:e,style:m,popUpLayerStyle:e.style};const g=new o.AnimationState;if((0,l.isBackgroundAnimationLayout)(e))return null;const _=parseInt(m.width),C=parseInt(m.height);let y=Math.min(_,C);const b=(0,l.getAnimationLayerScaleRatio)(e);if((0,l.isCanScale)(y)&&(y*=b),(0,l.isFullScreenLayer)(e)){const e=.5*Math.min(document.documentElement.clientHeight,document.documentElement.clientWidth);y>e&&(y=e)}if(!(0,l.isCanPlay)(y))return null;const I={height:y,width:y},S=(0,a.getAnimationAreaStyle)({width:_,height:C},e,I),f=v+parseInt(S.top),w=v+parseInt(S.left),E=f+y,k=w+y,P=(0,d.checkPositionConflict)(i,{top:f,left:w,bottom:E,right:k},e);return P?(0,l.checkPositionIsEqual)(e,P)?{animationState:g,layer:e,popUpLayerStyle:S,style:m}:c(P,t,[],null):null}const u=({layers:e,popUpElements:t,conflictBlocks:i})=>{const o=[...e].reverse(),r=[];let s=null;for(const e of o){const o=c(e,t,i,s);(0,l.isMainAnimationLayout)(e)&&(s=o),(0,l.isGradientLayer)(e)&&(s=null),o&&r.push(o)}return r.reverse(),r}},693217:(e,t,i)=>{i.d(t,{findFixedElement:()=>a,getDataAttrs:()=>r,getDeductibleDataAttrs:()=>n,getPopupElementsFromFixedElement:()=>l,getStringDataAttrs:()=>s});var o=i(761894);const r=e=>{const{popupStickerUseCommon:t="false",popupStickerContainerId:i,popupStickerFullScreenContainer:r,popupStickerPosition:s=o.POPUP_POSITION_DEFAULT_VALUE}=e,n={[o.DEFAULT_POPUP_CONTAINER_DATA_PROPERTY]:t,[o.POPUP_POSITION_PROPERTY]:s,[o.CONTAINER_ID_DATA_PROPERTY]:i};return r&&(n[o.FULL_SCREEN_CONTAINER_DATA_PROPERTY]=r),n},s=e=>{let t="";const i=r(e);return Object.entries(i).forEach((([e,i])=>{t+=`${e}='${i}' `})),t.trim()},n=e=>{const{popupStickerDeductible:t,popupStickerDeductibleFullScreen:i}=e,r={};return t&&(r[o.DEDUCTIBLE_DATA_PROPERTY]=t),i&&(r[o.DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY]=i),r},a=e=>e.closest(`[${o.CONTAINER_ID_DATA_PROPERTY}]`)||document.body;function d(e,t,i,r,s,n=null){let a=[...document.querySelectorAll(`[${t}=${r}]`)];switch(s&&(a=[...a,...document.querySelectorAll(`[${t}=${o.CONTAINER_ID_DATA_DEFAULT_VALUE}]`)]),a.push(i),e){case"lower":case"parent":a=a.sort(((e,t)=>e.getBoundingClientRect().top-t.getBoundingClientRect().top));break;case"upper":a=a.sort(((e,t)=>e.getBoundingClientRect().bottom-t.getBoundingClientRect().bottom))}const d=a.findIndex((e=>e===i));let l;switch(e){case"upper":case"parent":l=a[d-1]||null;break;case"lower":l=a[d+1]||null;break;default:l=a[0]||null}return l||n}const l=(e,t)=>{const{popupStickerContainerId:i,popupStickerPosition:r,popupStickerUseCommon:s}=(e=>{const{popupStickerUseCommon:t="false",popupStickerPosition:i=o.POPUP_POSITION_DEFAULT_VALUE,popupStickerContainerId:r=o.CONTAINER_ID_DATA_DEFAULT_VALUE}=e.dataset;return{popupStickerContainerId:r,popupStickerUseCommon:t,popupStickerPosition:i}})(e);let n="true"===s;return{fixedElement:e,headerElement:d("upper",o.DEDUCTIBLE_DATA_PROPERTY,t,i,n),footerElement:d("lower",o.DEDUCTIBLE_DATA_PROPERTY,t,i,n),fullScreenElement:d("parent",o.FULL_SCREEN_CONTAINER_DATA_PROPERTY,t,i,n,document.body),fullScreenHeaderElement:d("upper",o.DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY,t,i,n),fullScreenFooterElement:d("lower",o.DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY,t,i,n),animationFooterElement:d("lower",o.ANIMATION_DEDUCTIBLE_DATA_PROPERTY,t,i,n),position:r}}},709467:(e,t,i)=>{i.d(t,{getGradientAreaStyle:()=>s});var o=i(761894);const r={bottom:"0deg",left:"90deg",top:"180deg",right:"270deg"},s=({position:e},t)=>{const i={position:"absolute"},s=e.replace(`${o.SCREEN_MODIFICATOR} `,"");return"middle"===s?(i.top="50%",i.left="50%",i.transform="translate(-50%, -50%)",{style:{...t,...i},styleData:{isRadialGradient:!0}}):(["top","bottom"].includes(s)?i.width="100%":i.height="100%",i[s]=0,i["--gradient-deg"]=r[s]||r.top,{style:{...t,...i},styleData:{isRadialGradient:!1}})}},679500:(e,t,i)=>{i.d(t,{getPlayBackAreaStyle:()=>r});var o=i(761894);function r(e,{fullScreenHeaderElement:t,fullScreenFooterElement:i,fullScreenElement:r,fixedElement:s,footerElement:n,headerElement:a,animationFooterElement:d,position:l},c=!1){const u=e===o.PopUpPositionTypes.FullScreen,{top:h,left:p,bottom:m}=r.getBoundingClientRect(),v=u?r:s,{top:g,bottom:_,left:C,width:y}=v.getBoundingClientRect(),{bottom:b}=a?.getBoundingClientRect()||{bottom:-1/0},{bottom:I}=t?.getBoundingClientRect()||{bottom:-1/0},S=Math.max(b,g)<0,f=e===o.PopUpPositionTypes.TopFullScreen||S,w=!u&&!f,E=w?b:I,k=u?i:n,P=k?.getClientRects().length,A=d?.getClientRects().length;let L;L=c&&d&&A?d.getBoundingClientRect().top:k&&P?k.getBoundingClientRect().top:1/0;let x=0;"absolute"===l&&(x=-h);const M=[];E>0&&M.push(x+E),w&&g>=0&&M.push(x+g),h<0&&M.push(x);const O=Math.max(...M,0),T=r===document.body?document.documentElement.clientHeight:function(e){return Math.min(e,document.documentElement.clientHeight)}(m),V=[x+T,v===document.body?document.documentElement.clientHeight:x+_,x+L],F=Math.min(...V)-O,j=function(e){return Math.min(e,document.documentElement.clientWidth)}(y),R=C-p,D={position:l};D.top=`${O}px`,D.left=`${R}px`,D.width=`${j}px`,D.height=`${F}px`;return{playBackAreaStyle:D,topByViewport:O-x}}},175444:(e,t,i)=>{i.d(t,{getPopUpPositionType:()=>s});var o=i(970704),r=i(761894);function s(e){return(0,o.isFullScreenLayer)(e)?r.PopUpPositionTypes.FullScreen:(0,o.isTopFullScreenLayer)(e)?r.PopUpPositionTypes.TopFullScreen:r.PopUpPositionTypes.Fixed}},970704:(e,t,i)=>{i.d(t,{changeLayerPosition:()=>v,checkPositionIsEqual:()=>g,getAnimationLayerLoopsLimit:()=>s,getAnimationLayerPosition:()=>r,getAnimationLayerScaleRatio:()=>n,isAnimationLayer:()=>u,isBackgroundAnimationLayout:()=>l,isBackgroundLayer:()=>d,isCanPlay:()=>C,isCanScale:()=>_,isFullOrPartiallyFullScreenLayer:()=>m,isFullScreenLayer:()=>p,isGradientLayer:()=>a,isMainAnimationLayout:()=>c,isTopFullScreenLayer:()=>h});var o=i(761894);const r=e=>{const{position_x:t,position_y:i}=e;return{position_x:t||o.DEFAULT_POSITION_X,position_y:i||o.DEFAULT_POSITION_Y}},s=e=>{const{loops_limit:t=o.DEFAULT_LOOP_LIMIT}=e;return t},n=e=>{const{scale_ratio:t=o.DEFAULT_SCALE_RATIO}=e;return t},a=e=>e.type===o.PopUpLayerTypes.Gradient,d=e=>e.type===o.CustomPopUpLayerTypes.Background,l=e=>e.type===o.PopUpLayerTypes.FullScreen,c=e=>e.type===o.PopUpLayerTypes.Fixed,u=e=>l(e)||c(e),h=e=>{if(!c(e))return!1;const{position_x:t,position_y:i}=r(e);return!t.includes(o.SCREEN_MODIFICATOR)&&i===`${o.SCREEN_MODIFICATOR} top`},p=e=>{if(d(e)||l(e))return!0;if(a(e))return e.position.includes(o.SCREEN_MODIFICATOR);if(c(e)){const{position_x:t,position_y:i}=r(e);return t.includes(o.SCREEN_MODIFICATOR)&&i.includes(o.SCREEN_MODIFICATOR)}return!1},m=e=>p(e)||h(e),v=e=>{const{position_x:t,position_y:i}=r(e);return m(e)?{...e,position_x:t.replace(`${o.SCREEN_MODIFICATOR} `,""),position_y:i.replace(`${o.SCREEN_MODIFICATOR} `,"")}:{...e,position_x:`${o.SCREEN_MODIFICATOR} ${t}`,position_y:`${o.SCREEN_MODIFICATOR} ${i}`}},g=(e,t)=>u(e)&&u(t)?t.position_y===e.position_y&&e.position_x===t.position_x:!(!a(e)||!a(t))&&t.position===e.position,_=e=>e>=o.MIN_SIZE_FOR_SCALE,C=e=>e>=o.MIN_SIZE_FOR_PLAY},3130:(e,t,i)=>{i.d(t,{LottiePlayer:()=>s});var o=i(327813),r=i(761894);class s{constructor(){this.options={...r.DEFAULT_PLAYER_OPTIONS},this.setOptions=e=>{this.options=e},this.setOption=({key:e,value:t})=>{typeof this.options[e]==typeof t&&(this.options={...this.options,[e]:t})},this.reset=()=>{this.options={...r.DEFAULT_PLAYER_OPTIONS}},(0,o.makeAutoObservable)(this)}}},312459:(e,t,i)=>{i.d(t,{PopupStickerService:()=>u});var o=i(327813),r=i(3130),s=i(493940),n=i(251242),a=i(16880),d=i(693217),l=i(761894),c=i(377803);class u{constructor(){this.isPlaying=!1,this.isPreparing=!1,this.isFinishing=!1,this.playBackAreasProps=[],this.onAnimationClick=null,this.onEndPlay=null,this.onEndPrepare=null,this.errorHandlers={},this.conflictBlocks=new s.PositionConflict,this.lottiePlayer=new r.LottiePlayer,this.setLottiePlayerOptions=e=>{this.isPlaying&&this.lottiePlayer.setOptions(e)},this.setLottiePlayerOption=e=>{this.isPlaying&&this.lottiePlayer.setOption(e)},this.preparePreview=e=>{const t=e.layers.slice();t.unshift({type:l.CustomPopUpLayerTypes.Background,style:{opacity:"0.9",background:c.default.colorBackgroundModal.normal.value}}),this.prepare({...e,layers:t})},this.prepareWithDestroyEvent=e=>{const t=(0,n.createDestroyListeners)(this.destroyWithFadeOut.bind(this));this.prepare((0,n.setDestroyListeners)(e,t))},this.prepare=({layers:e,stickerElement:t,onEndPrepare:i=null,onEndPlay:o=null,onAnimationClick:r=null,errorHandlers:s,mountNode:n,disableHardcodedZIndex:l})=>{if(this.isPlaying||this.isPreparing)throw i?.(!1),new Error("Pop-up stickers are already playing");this.isPreparing=!0;const c=(0,d.findFixedElement)(t),u=(0,d.getPopupElementsFromFixedElement)(c,t),h=(0,a.getBasePropsForPlaybackAreas)({layers:e,popUpElements:u,conflictBlocks:this.conflictBlocks.blocks}).map((e=>({...e,style:{...e.style,zIndex:l?"auto":1001}}))),p=Boolean(h.length),m=()=>{this.reset(),o?.()};this.onEndPrepare=i,this.onEndPlay=m,this.onAnimationClick=r,p&&n?.(),this.playBackAreasProps=h,s&&(this.errorHandlers=s),p||(i?.(!1),m())},this.destroyBySpeedIncrement=()=>{this.setLottiePlayerOption({key:"speed",value:l.SPEED_ON_DESTROY})},this.destroyByRemove=()=>{this.onEndPlay?this.onEndPlay():this.reset()},this.destroyWithFadeOut=()=>{this.isFinishing=!0,setTimeout((()=>{this.destroyByRemove()}),l.DESTROY_ANIMATION_DURATION)},this.startPlay=()=>{this.isPlaying=!0,this.isPreparing=!1,this.onEndPrepare?.(!0)},this.reset=()=>{this.isPlaying=!1,this.isPreparing=!1,this.isFinishing=!1,this.playBackAreasProps=[],this.onEndPlay=null,this.onAnimationClick=null,this.onEndPrepare=null,this.errorHandlers={},this.lottiePlayer.reset()},(0,o.makeAutoObservable)(this)}}},493940:(e,t,i)=>{i.d(t,{PositionConflict:()=>r});var o=i(327813);class r{constructor(){this.blocks=[],this.addConflictBlock=e=>{this.blocks.push(e)},this.removeConflictBlockBySelector=e=>{this.blocks.filter((t=>t.blockSelector===e))},(0,o.makeAutoObservable)(this)}}},351089:(e,t,i)=>{i.d(t,{dataAttrKeyToDatasetKey:()=>o});const o=e=>e.slice(5).split("-").map(((e,t)=>0!==t?e.charAt(0).toUpperCase()+e.slice(1):e)).join("")},650416:(e,t,i)=>{i.d(t,{setRef:()=>o});const o=(e,t)=>{t&&("function"==typeof t?t(e):t.hasOwnProperty("current")&&(t.current=e))}},908671:(e,t,i)=>{i.d(t,{formatCount:()=>o});const o=(e,t)=>{const i=t?.separator||".",o=t?.maximumFractionDigits??1,r=t?.roundingMode||void 0,s=t?.kLimit||1e3,n=t?.mLimit||1e6,a=t?.bLimit||1e9,d=window.langConfig?.locale||"ru",l=(e,t)=>{"floor"===r&&(e=Math.floor(e*Math.pow(10,o))/Math.pow(10,o));let s=e.toFixed(o);return Number(s).toLocaleString(d).replace(/\./,i)+t};if(e>-s&&e<s)return e.toLocaleString(d);const c=e/a;if(c>=1||c<=-1)return l(e/1e9,"B");const u=e/n;if(u>=1||u<=-1)return l(e/1e6,"M");const h=e/s;return h>=1||h<=-1?l(e/1e3,"K"):String(e)}},104386:(e,t,i)=>{i.d(t,{getValidateLengthMessage:()=>o});const o=({value:e,maxLength:t,diffForRemainder:i=100,getExceededLengthLabel:o,getRemainingLengthLabel:r})=>{const s=e.trim().length||0,n=s>t-i,a=s>t,d=Math.abs(s-t),l=t-s;return a?o(d):n?r(l):null}},265567:(e,t,i)=>{i.d(t,{CatalogSearchWidget:()=>u});var o=i(474848),r=i(456921),s=i(327813),n=i(296540),a=i(194528),d=i(172656),l=i(4485),c=i(781939);const u=(0,r.observer)((function({section:e,island:t,spacing:i,blockLayoutResolver:r}){const u=(0,n.useMemo)((()=>(0,s.computed)((()=>e?e.blocks.map(((t,i)=>({index:i,block:t,items:(0,c.extractItems)(t.data,e)}))):[]))),[e]).get(),h=(0,n.useMemo)((()=>t&&u.length?(0,c.splitBlocksBySeparator)(u,t):[]),[u,t]);if(!e)return null;const p=e=>e.map((({index:t,block:s,items:d})=>{const l=e[t+1],u=r(s);return i&&(0,c.isSeparatorBlock)(s.data)&&l&&!(0,c.isHeaderBlock)(l.block.data)?(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(u,{index:t,block:s,items:d}),(0,o.jsx)(a.Spacing,{size:i})]},s.id):(0,o.jsx)(u,{index:t,block:s,items:d},s.id)}));return t?(0,o.jsx)(o.Fragment,{children:h.map(((t,i)=>(0,o.jsxs)(d.Group,{mode:"card",children:[p(t),h.length-1===i&&(0,o.jsx)(l.NextFrom,{section:e})]},t[0].block.id)))}):(0,o.jsxs)(o.Fragment,{children:[p(u),(0,o.jsx)(l.NextFrom,{section:e})]})}))},455376:(e,t,i)=>{i.d(t,{NextFrom:()=>d});var o=i(474848),r=i(456921),s=i(296540),n=i(140094),a=i(209808);const d=(0,r.observer)((function({section:e}){const[t,i]=(0,n.useInView)();return(0,s.useEffect)((()=>{if(!i||e.isNextLoading||!e.nextFrom)return;const t=setTimeout((()=>{e.fetchNext()}),200);return()=>clearTimeout(t)}),[i,e.isNextLoading]),e.nextFrom&&(0,o.jsx)(a.PanelSpinner,{getRootRef:t,height:42,size:"small"})}))},4485:(e,t,i)=>{i.d(t,{NextFrom:()=>o.NextFrom});var o=i(455376)},298405:(e,t,i)=>{i.d(t,{getOwner:()=>r});var o=i(468073);const r=(e,t)=>o.Ranges.isUserId(e)?t.profiles.get(e):t.groups.get(o.Ranges.convertOwnerIdToGroupId(e))},157996:(e,t,i)=>{i.d(t,{withCatalogAction:()=>o.withCatalogAction,withCatalogBlock:()=>r.withCatalogBlock,withCatalogStore:()=>s.withCatalogStore});var o=i(250195),r=i(683802),s=i(831518)},250195:(e,t,i)=>{i.d(t,{withCatalogAction:()=>n});var o=i(474848),r=i(456921),s=i(140094);function n(e,t={},i){const{onActionView:n}=t,a=t=>{const r=t.action,a=r.data.track_code,{ref:d}=(0,s.useInView)({threshold:.8,skip:!n||!a,onChange:e=>a&&n&&e&&n(r,a)});return(0,o.jsx)(e,{...t,...i,getRootRef:d,trackCode:a})};return a.displayName=`${e.displayName}_withCatalogAction`,(0,r.observer)(a)}},683802:(e,t,i)=>{i.d(t,{withCatalogBlock:()=>s});var o=i(474848),r=i(456921);function s(e,t,i){const s=({index:r,block:s,items:n})=>{const a=i(s);return n.length&&a?(0,o.jsx)(e,{...t,index:r,block:s,items:n,ItemComponent:a}):null};return s.displayName=`${e.displayName}_withCatalogBlock`,(0,r.observer)(s)}},831518:(e,t,i)=>{i.d(t,{withCatalogStore:()=>d});var o=i(474848),r=i(456921),s=i(22421),n=i(140094),a=i(33305);function d(e,t={},i){const{attachTrackCodeToUrl:d,getUrl:l,getTrackCode:c,onItemView:u}=t,h=t=>{const{item:r,owner:h,...p}=t,m=l?.(r,t),v=c?.(r,t),{ref:g}=(0,n.useInView)({threshold:.8,skip:!u||!v,onChange:e=>v&&u&&e&&u(r,v)});return(0,o.jsx)(e,{...p,...i,item:r,owner:h,getRootRef:g,trackCode:v,group:(0,a.isOwnerUser)(h)?void 0:h,profile:(0,a.isOwnerUser)(h)?h:void 0,href:d&&v&&m?(0,s.makeUrl)(m,{search_track_code:v}):m})};return h.displayName=`${e.displayName}_withCatalogStore`,(0,r.observer)(h)}},839614:(e,t,i)=>{i.d(t,{CatalogSearchWidget:()=>o.CatalogSearchWidget,withCatalogAction:()=>r.withCatalogAction,withCatalogBlock:()=>r.withCatalogBlock,withCatalogStore:()=>r.withCatalogStore});var o=i(265567),r=i(157996)},781939:(e,t,i)=>{i.d(t,{extractItems:()=>l,isHeaderBlock:()=>r,isSeparatorBlock:()=>s,splitBlocksBySeparator:()=>n});var o=i(298405);const r=e=>["header","header_large","header_compact","header_extended"].includes(e.layout.name),s=e=>"separator"===e.layout.name||"separator_compact"===e.layout.name,n=(e,t,i=[])=>{const o=e.findIndex((({block:e})=>"separator"===e.data.layout.name&&("island-only"!==t||"island"===e.data.layout.style)));return-1===o?[...i,e]:n(e.slice(o+1),t,[...i,e.slice(0,o)])},a=(e,t,i,r)=>(t??[]).map((t=>{const s=i(t);if(!s)return null;const n=r?.(s);return{id:t,section:e,item:s,owner:n?(0,o.getOwner)(n,e.providers):void 0}})).filter((e=>Boolean(e))),d=(e,t,i,r,s)=>(t??[]).map((t=>{const n=r(t);if(!n)return null;const a=s?.(n);return{...t,section:e,item:n,id:i(t),owner:a?(0,o.getOwner)(a,e.providers):void 0}})).filter((e=>Boolean(e))),l=(e,t)=>{const i=t,{providers:r}=i;switch(e.data_type){case"groups":return a(i,e.group_ids,(e=>r.groups.get(e)));case"groups_items":return d(i,e.group_items,(e=>e.id),(e=>r.groups.get(e.id)));case"catalog_users":return a(i,e.catalog_users_ids,(e=>r.catalog_users.get(e)),(e=>e.user_id));case"mini_apps":return a(i,e.mini_app_ids,(e=>r.mini_apps.get(Number(e))));case"links":return a(i,e.links_ids,(e=>r.links.get(e)));case"videos":case"catalog_videos":return a(i,e.videos_ids,(e=>r.videos.get(e)),(e=>e.data.owner_id));case"albums":return a(i,e.albums_ids,(e=>r.albums.get(e)),(e=>e.data.owner_id));case"search_suggestions":return a(i,e.suggestions_ids,(e=>r.search_suggestions?.get(e)||r.suggestions?.get(e)));case"catalog_search_suggestion":return a(i,e.search_suggestions_ids,(e=>r.search_suggestions?.get(e)||r.suggestions?.get(e)));case"search_authors":return d(i,e.search_author_items,(e=>e.id),(e=>(0,o.getOwner)(e.id,r)));case"search_filter":return a(i,e.search_filters_ids,(e=>r.search_filters.get(e)));case"music_audios":return a(i,e.audios_ids,(e=>r.audios.get(e)));case"music_playlists":return a(i,e.playlists_ids,(t=>r.playlists.get({rawId:t,blockId:e.id})));case"games":return d(i,e.games_items,(e=>e.id),(e=>r.games.get(e.id)));case"market_items":return a(i,e.market_item_ids,(e=>r.market_items.get(e)),(e=>e.data.owner_id));case"search_entity_items":return a(i,e.search_entity_ids,(e=>r.search_entity_items.get(e)),(e=>e.owner_id));case"placeholder":return a(i,e.placeholder_ids,(e=>r.placeholders.get(e)));case"radiostations":return a(i,e.radio_stations_ids,(e=>r.radio_stations.get(e)));case"search_spellchecker":return a(i,e.search_spellcheckers_ids,(e=>r.search_spellcheckers.get(e)));case"stickers_packs":return a(i,e.stickers_pack_ids,(e=>r.stickers_pack_previews.get(e)));case"action":return(e.actions??[]).map((e=>({id:e.id??"",item:e,section:i})));default:return[]}}},824086:(e,t,i)=>{i.d(t,{useMaskito:()=>n});var o=i(317814),r=i(296540);const s="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;const n=({options:e=o.MASKITO_DEFAULT_OPTIONS,elementPredicate:t=o.MASKITO_DEFAULT_ELEMENT_PREDICATE}={})=>{const[i,n]=(0,r.useState)(null),[a,d]=(0,r.useState)(null),l=(0,r.useCallback)((e=>{n(e)}),[]),c=(0,r.useRef)(t);return c.current=t,s((()=>{if(!i)return;const e=t,o=e(i);var r;(r=o)&&"object"==typeof r&&"then"in r?o.then((t=>{c.current===e&&d(t)})):d(o)}),[i,t,c]),s((()=>{if(!a)return;const t=new o.Maskito(a,e);return()=>{t.destroy()}}),[e,a]),l}},539267:(e,t,i)=>{i.d(t,{Icon12Cancel:()=>o});var o=(0,i(844990).makeIcon)("Icon12Cancel","cancel_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 12" id="cancel_12"><path fill="currentColor" d="M3.525 2.464a.75.75 0 0 0-1.06 1.061L4.938 6 2.464 8.475a.75.75 0 1 0 1.061 1.06L6 7.062l2.475 2.475a.75.75 0 0 0 1.06-1.061L7.062 6l2.475-2.475a.75.75 0 1 0-1.061-1.06L6 4.938z" /></symbol>',12,12,!1,void 0)},157307:(e,t,i)=>{i.d(t,{Icon12ListPlayOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon12ListPlayOutline","list_play_outline_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="list_play_outline_12"><path d="M1.75 2a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5zm9.02 5.3L7.967 5.13A.6.6 0 0 0 7 5.603v4.29a.6.6 0 0 0 .962.479l2.803-2.12a.6.6 0 0 0 .005-.953ZM1 8.75A.75.75 0 0 1 1.75 8h3a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 1 8.75M1.75 5a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5z" /></symbol>',12,12,!1,void 0)},725772:(e,t,i)=>{i.d(t,{Icon12Lock:()=>o});var o=(0,i(844990).makeIcon)("Icon12Lock","lock_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="lock_12"><path d="M6 .5c1.657 0 3 1.337 3 2.992v1.507L9.748 5c.415 0 .752.34.752.76v4.48a.76.76 0 0 1-.752.76H2.252a.756.756 0 0 1-.752-.76V5.76c0-.42.342-.76.752-.76L3 4.999V3.501A3.003 3.003 0 0 1 5.824.505zM6 2l-.145.007A1.496 1.496 0 0 0 4.5 3.5V5h3V3.5C7.5 2.666 6.828 2 6 2" /></symbol>',12,12,!1,void 0)},760793:(e,t,i)=>{i.d(t,{Icon12Mask:()=>o});var o=(0,i(844990).makeIcon)("Icon12Mask","mask_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 12" id="mask_12"><path fill="currentColor" fill-rule="evenodd" d="M6 11.25c-1.805 0-3.513-1.376-4.419-3.581-.998-2.43-1.095-5.756-.304-6.581.396-.414.558-.426 2.276-.155.943.148 1.63.219 2.447.219s1.504-.07 2.447-.22c1.718-.27 1.88-.258 2.276.156.79.825.694 4.15-.304 6.58C9.513 9.875 7.805 11.25 6 11.25m0-2.187c-1.82 0-2.548-1.658-2.184-2.072.173-.198.347-.112.639.03.32.158.783.384 1.545.384s1.224-.226 1.545-.383c.292-.144.465-.229.639-.031.364.414-.364 2.072-2.184 2.072M4.076 5.38c.724.064 1.349-.331 1.396-.883s-.5-1.052-1.224-1.116c-.723-.065-1.348.33-1.395.883s.5 1.051 1.223 1.116m2.452-.883c.047.552.671.947 1.393.883.722-.065 1.27-.564 1.222-1.116-.047-.552-.671-.948-1.393-.883s-1.27.564-1.222 1.116" clip-rule="evenodd" /></symbol>',12,12,!1,void 0)},156006:(e,t,i)=>{i.d(t,{Icon12Stars:()=>o});var o=(0,i(844990).makeIcon)("Icon12Stars","stars_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="stars_12"><path d="M2.803.218a.319.319 0 0 0-.606 0l-.242.728c-.159.476-.533.85-1.009 1.009l-.728.242a.319.319 0 0 0 0 .606l.728.242c.476.159.85.533 1.009 1.009l.242.728a.32.32 0 0 0 .606 0l.242-.728c.159-.476.533-.85 1.009-1.009l.728-.242a.319.319 0 0 0 0-.606l-.728-.242A1.6 1.6 0 0 1 3.045.946zm3.633 3.254c-.256.746-.599 1.5-1.031 1.933-.433.432-1.187.775-1.933 1.03a12 12 0 0 1-.768.237c-.272.075-.272.58 0 .656a15 15 0 0 1 .768.236c.746.256 1.5.599 1.933 1.031.432.433.775 1.187 1.03 1.933a13 13 0 0 1 .237.768c.075.272.58.272.656 0a15 15 0 0 1 .236-.768c.256-.746.599-1.5 1.031-1.933.433-.432 1.187-.775 1.933-1.03a13 13 0 0 1 .768-.237c.272-.075.272-.58 0-.656a15 15 0 0 1-.768-.236c-.746-.256-1.5-.599-1.933-1.031-.432-.433-.775-1.187-1.03-1.933a12 12 0 0 1-.237-.768c-.075-.272-.58-.272-.656 0a15 15 0 0 1-.236.768" clip-rule="evenodd" /></symbol>',12,12,!1,void 0)},562791:(e,t,i)=>{i.d(t,{Icon16LockOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon16LockOutline","lock_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="lock_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M2 10c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.093c.297-.15.645-.218 1.135-.248V4.5a3.5 3.5 0 1 1 7 0v1.524c.49.03.838.097 1.135.249a2.5 2.5 0 0 1 1.093 1.092C14 7.9 14 8.6 14 10v1c0 1.4 0 2.1-.272 2.635a2.5 2.5 0 0 1-1.093 1.093C12.1 15 11.4 15 10 15H6c-1.4 0-2.1 0-2.635-.272a2.5 2.5 0 0 1-1.092-1.093C2 13.1 2 12.4 2 11zm8-2.5H6c-.725 0-1.178.001-1.52.029-.324.027-.413.07-.434.08a1 1 0 0 0-.437.437c-.01.02-.053.11-.08.434-.028.342-.029.795-.029 1.52v1c0 .725.001 1.178.029 1.52.027.324.07.413.08.434a1 1 0 0 0 .437.437c.02.01.11.053.434.08.342.028.795.029 1.52.029h4c.725 0 1.178-.001 1.52-.03.324-.026.413-.069.434-.079a1 1 0 0 0 .437-.437c.01-.02.053-.11.08-.434.028-.342.029-.795.029-1.52v-1c0-.725-.001-1.178-.03-1.52-.026-.324-.069-.413-.079-.434a1 1 0 0 0-.437-.437c-.02-.01-.11-.053-.434-.08-.342-.028-.795-.029-1.52-.029M10 6H6V4.5a2 2 0 1 1 4 0z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},778071:(e,t,i)=>{i.d(t,{Icon16MenuOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon16MenuOutline","menu_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="menu_outline_16"><path fill="currentColor" d="M2 8a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 8m0-4.25A.75.75 0 0 1 2.75 3h10.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 3.75m0 8.5a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1-.75-.75" /></symbol>',16,16,!1,void 0)},865757:(e,t,i)=>{i.d(t,{Icon16StarCircleFillBlue:()=>o});var o=(0,i(844990).makeIcon)("Icon16StarCircleFillBlue","star_circle_fill_blue_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="star_circle_fill_blue_16"><linearGradient id="star_circle_fill_blue_16_a" x1="-8" x2="8" y1="8" y2="24" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#70b2ff" /><stop offset="1" stop-color="#5c9ce6" /></linearGradient><path fill="url(#star_circle_fill_blue_16_a)" fill-rule="evenodd" d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16" clip-rule="evenodd" /><path fill="#fff" d="m9.624 5.76 2.151.21c.748.074.978.822.4 1.314l-1.684 1.431.625 2.333c.206.766-.431 1.23-1.07.768l-2.045-1.478-2.046 1.479c-.635.459-1.275-.003-1.07-.77l.626-2.332-1.684-1.432c-.58-.493-.352-1.239.4-1.312l2.15-.211.947-2.235c.297-.7 1.057-.7 1.353 0z" /></symbol>',16,16,!1,void 0)},373206:(e,t,i)=>{i.d(t,{Icon16UnlockOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon16UnlockOutline","unlock_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="unlock_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M2 10c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.093c.297-.15.645-.218 1.135-.248V4.5a3.5 3.5 0 0 1 6.867-.957.75.75 0 1 1-1.443.41A2 2 0 0 0 6 4.5V6h4c1.4 0 2.1 0 2.635.273a2.5 2.5 0 0 1 1.093 1.092C14 7.9 14 8.6 14 10v1c0 1.4 0 2.1-.272 2.635a2.5 2.5 0 0 1-1.093 1.093C12.1 15 11.4 15 10 15H6c-1.4 0-2.1 0-2.635-.272a2.5 2.5 0 0 1-1.092-1.093C2 13.1 2 12.4 2 11zm8-2.5H6c-.725 0-1.178.001-1.52.029-.324.027-.413.07-.434.08a1 1 0 0 0-.437.437c-.01.02-.053.11-.08.434-.028.342-.029.795-.029 1.52v1c0 .725.001 1.178.029 1.52.027.324.07.413.08.434a1 1 0 0 0 .437.437c.02.01.11.053.434.08.342.028.795.029 1.52.029h4c.725 0 1.178-.001 1.52-.03.324-.026.413-.069.434-.079a1 1 0 0 0 .437-.437c.01-.02.053-.11.08-.434.028-.342.029-.795.029-1.52v-1c0-.725-.001-1.178-.03-1.52-.026-.324-.069-.413-.079-.434a1 1 0 0 0-.437-.437c-.02-.01-.11-.053-.434-.08-.342-.028-.795-.029-1.52-.029" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},394062:(e,t,i)=>{i.d(t,{Icon20Attach:()=>o});var o=(0,i(844990).makeIcon)("Icon20Attach","attach_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="attach_20"><path fill="currentColor" fill-rule="evenodd" d="M14.95 3.801a2.72 2.72 0 0 0-3.857 0L5.56 9.35a4.49 4.49 0 0 0 0 6.338 4.46 4.46 0 0 0 6.317 0l.002-.002 2.88-2.86a.75.75 0 0 1 1.057 1.064l-2.877 2.857-.002.002a5.96 5.96 0 0 1-8.439-.001 5.99 5.99 0 0 1 0-8.458l5.534-5.548a4.22 4.22 0 0 1 5.981 0 4.244 4.244 0 0 1 0 5.991l-5.534 5.548a2.486 2.486 0 0 1-3.521 0 2.497 2.497 0 0 1 0-3.525l.002-.002 3.102-3.083a.75.75 0 0 1 1.058 1.064l-3.1 3.08-.001.002a.997.997 0 0 0 0 1.405.986.986 0 0 0 1.398 0l5.534-5.548a2.744 2.744 0 0 0 0-3.873" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},289150:(e,t,i)=>{i.d(t,{Icon20DownloadOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon20DownloadOutline","download_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="download_outline_20"><g fill="currentColor"><path fill-rule="evenodd" d="M4 17.75a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H4.75a.75.75 0 0 1-.75-.75" clip-rule="evenodd" /><path d="M10.75 2.726c0-.401-.336-.726-.75-.726a.74.74 0 0 0-.75.726v9.722l-3.97-3.97a.75.75 0 0 0-1.06 1.06l5.245 5.246a.75.75 0 0 0 1.06 0l5.257-5.256a.75.75 0 0 0-1.061-1.061l-3.972 3.972z" /></g></symbol>',20,20,!1,void 0)},739483:(e,t,i)=>{i.d(t,{Icon20LinkCircleOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon20LinkCircleOutline","link_circle_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="link_circle_outline_20"><g fill="currentColor"><path d="M7 7.75c0 .414.336.75.75.75h2.69l-3.22 3.22a.75.75 0 1 0 1.06 1.06l3.22-3.22v2.69a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0-.75.75" /><path fill-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 0 0-17 8.5 8.5 0 0 0 0 17m7-8.5a7 7 0 1 1-14 0 7 7 0 0 1 14 0" clip-rule="evenodd" /></g></symbol>',20,20,!1,void 0)},666112:(e,t,i)=>{i.d(t,{Icon20SmileOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon20SmileOutline","smile_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="smile_outline_20"><path d="M10 1.5a8.5 8.5 0 1 1 0 17 8.5 8.5 0 0 1 0-17M10 3a7 7 0 1 0 0 14 7 7 0 0 0 0-14m3.067 9.056c.3.286.312.76.027 1.06a4 4 0 0 1-.855.654A4.36 4.36 0 0 1 10 14.4a4.36 4.36 0 0 1-2.239-.63 4 4 0 0 1-.854-.653.75.75 0 0 1 1.004-1.109l.197.18c.098.083.239.186.417.292.446.263.942.42 1.475.42s1.029-.157 1.475-.42c.178-.106.32-.21.417-.292l.115-.105a.75.75 0 0 1 1.06-.027M7.625 7.25a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25m4.75 0a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25" /></symbol>',20,20,!1,void 0)},560150:(e,t,i)=>{i.d(t,{Icon2418CircleOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon2418CircleOutline","18_circle_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="18_circle_outline_24"><path fill-rule="evenodd" d="M12 2.1c5.467 0 9.9 4.433 9.9 9.9s-4.433 9.9-9.9 9.9-9.9-4.433-9.9-9.9S6.533 2.1 12 2.1m0 1.8A8.1 8.1 0 0 0 3.9 12a8.1 8.1 0 0 0 8.1 8.1 8.1 8.1 0 0 0 8.1-8.1A8.1 8.1 0 0 0 12 3.9" clip-rule="evenodd" /><path d="M9.137 15.998c.585 0 .977-.382.977-.973V9.101C10.114 8.424 9.701 8 8.992 8c-.387 0-.72.043-1.134.322l-1.466 1c-.28.193-.392.413-.392.698 0 .397.285.682.666.682.188 0 .306-.043.483-.167l.967-.671h.038v5.161c0 .591.397.973.983.973m5.11.002c1.921 0 3.253-.908 3.253-2.25 0-1.03-.774-1.753-1.842-1.938v-.036c.92-.206 1.563-.866 1.563-1.695 0-1.21-1.21-2.081-2.974-2.081-1.758 0-2.973.871-2.973 2.075 0 .845.647 1.495 1.573 1.7v.037c-1.068.185-1.847.904-1.847 1.933C11 15.092 12.321 16 14.247 16m0-4.774c-.62 0-1.063-.39-1.063-.95 0-.565.448-.95 1.063-.95.621 0 1.074.385 1.074.95 0 .56-.447.95-1.074.95m0 3.443c-.72 0-1.22-.449-1.22-1.066 0-.608.5-1.046 1.22-1.046.727 0 1.227.438 1.227 1.046 0 .617-.5 1.066-1.227 1.066" /></symbol>',24,24,!1,void 0)},622820:(e,t,i)=>{i.d(t,{Icon24HammerOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon24HammerOutline","hammer_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="hammer_outline_24"><path fill-rule="evenodd" d="M10.123 3.84c-.283.24-.602.559-.977.933l-.49.49-.934-.935c-.222-.222-.449-.439-.754-.538a1.4 1.4 0 0 0-.865 0c-.215.07-.372.186-.479.276L4.066 5.624c-.09.107-.206.264-.276.479a1.4 1.4 0 0 0 0 .865c.099.305.316.533.538.754l.935.935-.49.49c-.374.374-.693.693-.934.976-.252.298-.47.615-.596 1.001a2.9 2.9 0 0 0 0 1.792c.125.387.344.704.596 1.001.24.284.56.603.934.977l1.33 1.33c.375.375.694.694.977.934.298.253.615.472 1.001.597a2.9 2.9 0 0 0 1.793 0c.386-.125.703-.344 1-.596.284-.241.603-.56.978-.935l.489-.489 5.547 5.547.016.016c.085.085.182.183.275.261.106.09.263.207.479.277a1.4 1.4 0 0 0 .865 0 1.4 1.4 0 0 0 .478-.277c.093-.078.19-.176.276-.261l1.02-1.021a4 4 0 0 0 .262-.276 1.4 1.4 0 0 0 .277-.478 1.4 1.4 0 0 0 0-.866 1.4 1.4 0 0 0-.277-.478c-.078-.093-.176-.19-.261-.275l-.016-.016-5.547-5.547.49-.49c.374-.374.693-.693.933-.976.253-.298.472-.615.597-1.001a2.9 2.9 0 0 0 0-1.793c-.125-.386-.344-.703-.596-1a18 18 0 0 0-.935-.978l-1.33-1.33a18 18 0 0 0-.977-.934c-.297-.252-.614-.47-1-.596a2.9 2.9 0 0 0-1.793 0c-.386.125-.703.344-1 .596Zm-4.912 7.448c-.18.213-.234.322-.257.392a1.1 1.1 0 0 0 0 .68c.023.07.077.18.257.392.188.22.454.488.86.894l1.28 1.28c.407.407.674.673.894.86.213.18.322.234.393.257a1.1 1.1 0 0 0 .68 0c.07-.023.18-.076.392-.257.22-.187.487-.453.894-.86l4.322-4.322c.407-.407.673-.674.86-.894.18-.213.234-.322.257-.393a1.1 1.1 0 0 0 0-.68c-.023-.07-.076-.18-.257-.392-.187-.22-.453-.487-.86-.894l-1.28-1.28a17 17 0 0 0-.894-.86c-.212-.18-.322-.234-.392-.257a1.1 1.1 0 0 0-.68 0c-.07.023-.18.077-.392.257-.22.188-.488.454-.894.86L6.07 10.394a18 18 0 0 0-.86.894Zm13.88 8.65.848-.848-5.477-5.476-.848.848 5.476 5.477ZM6.535 7.385l-.849-.848.849-.849.848.849z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},175278:(e,t,i)=>{i.d(t,{Icon24ListAddOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon24ListAddOutline","list_add_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="list_add_outline_24"><g fill="currentColor"><path d="M17.9 11.9a.9.9 0 1 0-1.8 0v3.2h-3.2a.9.9 0 1 0 0 1.8h3.2v3.2a.9.9 0 0 0 1.8 0v-3.2h3.2a.9.9 0 0 0 0-1.8h-3.2zM3.9 6.9h14.2a.9.9 0 1 0 0-1.8H3.9a.9.9 0 1 0 0 1.8M3.9 10.1a.9.9 0 1 0 0 1.8h9.2a.9.9 0 0 0 0-1.8zM3.9 15.1a.9.9 0 1 0 0 1.8h5.2a.9.9 0 0 0 0-1.8z" /></g></symbol>',24,24,!1,void 0)},578192:(e,t,i)=>{i.d(t,{Icon28ArrowDownOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ArrowDownOutline","arrow_down_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="arrow_down_outline_28"><path d="M14 23h-.02l-.07-.004za1 1 0 0 1-.155-.011l-.036-.007a1 1 0 0 1-.62-.377l-7.896-7.898a1 1 0 0 1 1.32-1.497l.094.083L13 19.586V4.95c0-.525.448-.95 1-.95.513 0 .935.367.993.84l.007.11v14.636l6.293-6.293a1 1 0 0 1 1.32-.083l.094.083a1 1 0 0 1 .083 1.32l-.083.094-7.895 7.898a1 1 0 0 1-.621.378l-.037.005A.7.7 0 0 1 14 23" /></symbol>',28,28,!1,void 0)},225583:(e,t,i)=>{i.d(t,{Icon28ArrowUpOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ArrowUpOutline","arrow_up_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_up_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M14 5h.02q.034 0 .07.004zq.079 0 .155.011l.036.007c.254.046.475.184.62.377l7.896 7.898a1 1 0 0 1-1.32 1.497l-.094-.083L15 8.414V23.05c0 .525-.448.95-1 .95-.513 0-.936-.367-.993-.84L13 23.05V8.414l-6.293 6.293a1 1 0 0 1-1.32.083l-.094-.083a1 1 0 0 1-.083-1.32l.083-.094 7.895-7.898c.146-.193.367-.331.621-.378l.037-.005A.7.7 0 0 1 14 5" /></g></symbol>',28,28,!1,void 0)},509548:(e,t,i)=>{i.d(t,{Icon28LikeFillRed:()=>o});var o=(0,i(844990).makeIcon)("Icon28LikeFillRed","like_fill_red_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="like_fill_red_28"><path fill="#ff3347" d="M9.026 4.88A6.526 6.526 0 0 0 2.5 11.406c0 3.613 1.445 5.421 7.493 10.126l2.78 2.16a2 2 0 0 0 2.455 0l2.779-2.16c6.048-4.705 7.493-6.513 7.493-10.126a6.526 6.526 0 0 0-6.526-6.526c-1.872 0-3.538.85-4.974 2.487C12.564 5.73 10.898 4.88 9.026 4.88" /></symbol>',28,28,!1,void 0)},840303:(e,t,i)=>{i.d(t,{Icon28LikeOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28LikeOutline","like_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="like_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M9.026 4.88A6.526 6.526 0 0 0 2.5 11.406c0 3.613 1.445 5.421 7.493 10.126l2.78 2.16a2 2 0 0 0 2.455 0l2.779-2.16c6.048-4.705 7.493-6.513 7.493-10.126a6.526 6.526 0 0 0-6.526-6.526c-1.872 0-3.538.85-4.974 2.487C12.564 5.73 10.898 4.88 9.026 4.88m0 2c1.52 0 2.889.858 4.152 2.683l.205.298a.75.75 0 0 0 1.234 0l.205-.298c1.263-1.825 2.633-2.683 4.152-2.683 2.5 0 4.526 2.027 4.526 4.526 0 2.78-1.137 4.204-6.721 8.547L14 22.114l-2.779-2.161C5.637 15.61 4.5 14.187 4.5 11.406c0-2.5 2.027-4.526 4.526-4.526" /></g></symbol>',28,28,!1,void 0)},225853:(e,t,i)=>{i.d(t,{Icon28MoreHorizontal:()=>o});var o=(0,i(844990).makeIcon)("Icon28MoreHorizontal","more_horizontal_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="more_horizontal_28"><path d="M8.5 14a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0m8 0a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0m5.5 2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5" /></symbol>',28,28,!1,void 0)},217157:(e,t,i)=>{i.d(t,{Icon28MuteOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28MuteOutline","mute_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="mute_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M13.925 4h-.032q-.094 0-.175.002a3 3 0 0 0-1.931.8l-.126.122L6.586 10H5.364c-.39 0-.74 0-1.03.024a2.5 2.5 0 0 0-.969.249 2.5 2.5 0 0 0-1.092 1.092 2.5 2.5 0 0 0-.25.968C2 12.625 2 12.975 2 13.363v1.273c0 .39 0 .74.024 1.03.025.313.083.644.249.969a2.5 2.5 0 0 0 1.092 1.092c.325.166.656.224.968.25.292.023.642.023 1.03.023h1.223l5.075 5.076q.066.066.126.122a3 3 0 0 0 1.93.8c.057.002.113.002.176.002h.032c.066 0 .147 0 .222-.005a2 2 0 0 0 1.848-1.848 3 3 0 0 0 .005-.222V6.075a3 3 0 0 0-.005-.222 2 2 0 0 0-1.848-1.848C14.072 4 13.991 4 13.925 4m-.019 2H14v16h-.208a1 1 0 0 1-.644-.267l-.082-.08-5.312-5.313-.001-.001-.053-.051a1 1 0 0 0-.167-.126 1.1 1.1 0 0 0-.318-.132 1 1 0 0 0-.207-.029L6.935 16H5.4c-.436 0-.704 0-.904-.017a1 1 0 0 1-.184-.025l-.031-.01-.008-.002a.5.5 0 0 1-.218-.219l-.004-.008-.009-.031a1 1 0 0 1-.025-.184c-.016-.2-.017-.467-.017-.904v-1.2c0-.436 0-.704.017-.904a1 1 0 0 1 .025-.184l.01-.031.003-.008a.5.5 0 0 1 .218-.218l.008-.004.031-.009a1 1 0 0 1 .184-.025c.2-.016.467-.017.904-.017h1.535l.073-.001a1.1 1.1 0 0 0 .692-.287c.025-.022.048-.046.053-.05l.001-.002 5.312-5.312.082-.08A1 1 0 0 1 13.792 6zm11.801 4.293a1 1 0 0 1 0 1.414L23.414 14l2.293 2.293a1 1 0 0 1-1.414 1.414L22 15.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L20.586 14l-2.293-2.293a1 1 0 0 1 1.414-1.414L22 12.586l2.293-2.293a1 1 0 0 1 1.414 0" /></symbol>',28,28,!1,void 0)},709781:(e,t,i)=>{i.d(t,{Icon28ShareOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ShareOutline","share_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="share_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M13.476 6.513c0-.442.485-.651.797-.406l9.532 7.483a.52.52 0 0 1 0 .812l-9.532 7.484a.495.495 0 0 1-.797-.406v-4.485a1 1 0 0 0-1-1c-3.565 0-6.252 1.449-8.26 3.267.362-2.161 1.153-3.807 2.225-5.046 1.497-1.73 3.637-2.78 6.22-3.264a1 1 0 0 0 .815-.983zm2.032-1.979c-1.654-1.298-4.032-.093-4.032 1.979V9.16c-2.565.61-4.854 1.79-6.548 3.749C3.051 15.079 2 18.093 2 22.05a1 1 0 0 0 1.788.616c1.741-2.226 4.175-4.292 7.688-4.625v3.438c0 2.072 2.378 3.277 4.032 1.978l9.532-7.483a2.518 2.518 0 0 0 0-3.957z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},544129:(e,t,i)=>{i.d(t,{Icon28ThumbsDown:()=>o});var o=(0,i(844990).makeIcon)("Icon28ThumbsDown","thumbs_down_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="thumbs_down_28"><path fill-rule="evenodd" d="M23.75 4.004a1.25 1.25 0 0 0-1.251 1.25v11.5a1.25 1.25 0 0 0 2.5 0v-11.5c0-.69-.559-1.25-1.25-1.25Zm-4.235 14.602-2.37 4.997a2.443 2.443 0 0 1-4.65-1.046v-3.768a.287.287 0 0 0-.288-.287H6.503c-2.456 0-4.149-2.465-3.266-4.757l2.96-7.69a3.2 3.2 0 0 1 2.987-2.05h7.213a3.6 3.6 0 0 1 3.6 3.6v8.86a5 5 0 0 1-.482 2.141" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},222870:(e,t,i)=>{i.d(t,{Icon28ThumbsDownOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ThumbsDownOutline","thumbs_down_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="thumbs_down_outline_28"><path fill-rule="evenodd" d="M16.201 23.188a1.419 1.419 0 0 1-2.701-.607v-3.699c0-.763-.619-1.382-1.382-1.382h-5.61a2.5 2.5 0 0 1-2.322-3.424l2.982-7.5A2.5 2.5 0 0 1 9.491 5H16.5A2.5 2.5 0 0 1 19 7.5v8.951c0 .543-.12 1.079-.352 1.569L16.2 23.188ZM14.92 26a3.42 3.42 0 0 0 3.09-1.956l2.446-5.168A5.7 5.7 0 0 0 21 16.45V7.5A4.5 4.5 0 0 0 16.5 3H9.491A4.5 4.5 0 0 0 5.31 5.837l-2.983 7.5C1.152 16.292 3.33 19.5 6.51 19.5h4.99v3.081A3.42 3.42 0 0 0 14.919 26ZM24 3a1 1 0 0 0-1 1v12a1 1 0 1 0 2 0V4a1 1 0 0 0-1-1" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},54472:(e,t,i)=>{i.d(t,{Icon28VolumeOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28VolumeOutline","volume_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="volume_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M13.925 4c.066 0 .147 0 .222.005A2 2 0 0 1 16 6.075v15.85a3 3 0 0 1-.005.222A2 2 0 0 1 13.925 24h-.032q-.093 0-.175-.002a3 3 0 0 1-1.931-.8c-.041-.038-.08-.077-.126-.122L6.586 18H5.364c-.39 0-.74 0-1.03-.024a2.5 2.5 0 0 1-.969-.249 2.5 2.5 0 0 1-1.092-1.092 2.5 2.5 0 0 1-.25-.968C2 15.375 2 15.025 2 14.637v-1.273c0-.39 0-.74.024-1.03.025-.313.083-.644.249-.969a2.5 2.5 0 0 1 1.092-1.092 2.5 2.5 0 0 1 .968-.25C4.625 10 4.975 10 5.363 10h1.223l5.075-5.075.126-.123a3 3 0 0 1 1.93-.8C13.775 4 13.83 4 13.894 4zm.07 2h-.203a1 1 0 0 0-.644.267l-.082.08-5.312 5.313v.001l-.054.051a1.1 1.1 0 0 1-.692.287L6.935 12H5.4c-.436 0-.704 0-.904.017a1 1 0 0 0-.184.025l-.031.01-.008.002a.5.5 0 0 0-.218.219s-.002.003-.004.008l-.009.031a1 1 0 0 0-.025.184c-.016.2-.017.467-.017.904v1.2c0 .437 0 .704.017.904.008.093.017.15.025.184l.01.031.003.008a.5.5 0 0 0 .218.219s.003 0 .008.003l.031.009c.035.008.091.017.184.025.2.016.467.017.904.017h1.535l.073.001a1 1 0 0 1 .207.03 1.1 1.1 0 0 1 .538.308h.001l5.312 5.313c.06.06.071.071.082.08a1 1 0 0 0 .644.267l.114.001H14V6zm4.725 4.252a1 1 0 0 1 1.406-.155A5 5 0 0 1 22 14c0 1.58-.733 2.988-1.874 3.903a1 1 0 0 1-1.251-1.56A3 3 0 0 0 20 14c0-.947-.437-1.791-1.125-2.342a1 1 0 0 1-.155-1.406m4.233-3.002a1 1 0 0 0-1.323 1.5A6.98 6.98 0 0 1 24 14a6.98 6.98 0 0 1-2.37 5.25 1 1 0 1 0 1.323 1.5A8.98 8.98 0 0 0 26 14a8.98 8.98 0 0 0-3.047-6.75" /></symbol>',28,28,!1,void 0)},357331:(e,t,i)=>{i.d(t,{Icon36Pause:()=>o});var o=(0,i(844990).makeIcon)("Icon36Pause","pause_36","0 0 36 36",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 36 36" id="pause_36"><g fill="currentColor"><path d="M20.5 9.5A1.5 1.5 0 0 1 22 8h3.5A1.5 1.5 0 0 1 27 9.5v17a1.5 1.5 0 0 1-1.5 1.5H22a1.5 1.5 0 0 1-1.5-1.5zM9 9.5A1.5 1.5 0 0 1 10.5 8H14a1.5 1.5 0 0 1 1.5 1.5v17A1.5 1.5 0 0 1 14 28h-3.5A1.5 1.5 0 0 1 9 26.5z" /></g></symbol>',36,36,!1,void 0)},313393:(e,t,i)=>{i.d(t,{Icon56CommentOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon56CommentOutline","comment_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 56 56" id="comment_outline_56"><path fill-rule="evenodd" d="M15.036 8h25.928c1.626 0 2.937 0 3.999.087 1.093.09 2.053.278 2.942.73a7.5 7.5 0 0 1 3.277 3.278c.453.888.642 1.849.731 2.942C52 16.1 52 17.41 52 19.036v12.928c0 1.626 0 2.937-.087 3.999-.09 1.093-.278 2.053-.73 2.942a7.5 7.5 0 0 1-3.278 3.277c-.889.453-1.849.642-2.942.731C43.9 43 42.59 43 40.964 43H30.121l-9.136 9.137c-1.84 1.84-4.985.536-4.985-2.065V43h-.964c-1.626 0-2.937 0-3.999-.087-1.093-.09-2.053-.278-2.942-.73a7.5 7.5 0 0 1-3.278-3.278c-.452-.889-.641-1.849-.73-2.942C4 34.9 4 33.59 4 31.964V19.036c0-1.626 0-2.937.087-3.999.09-1.093.278-2.054.73-2.942a7.5 7.5 0 0 1 3.278-3.278c.889-.452 1.849-.641 2.942-.73C12.1 8 13.41 8 15.036 8m-3.755 3.077c-.907.074-1.429.212-1.824.414a4.5 4.5 0 0 0-1.967 1.966c-.2.395-.34.917-.413 1.824C7 16.207 7 17.395 7 19.1v12.8c0 1.705.001 2.893.077 3.819.074.907.212 1.429.413 1.824a4.5 4.5 0 0 0 1.967 1.967c.395.2.917.34 1.824.413.926.076 2.114.077 3.819.077h2.4a1.5 1.5 0 0 1 1.5 1.5v8.379l9.44-9.44A1.5 1.5 0 0 1 29.5 40h11.4c1.705 0 2.893-.001 3.819-.077.907-.074 1.429-.212 1.824-.413a4.5 4.5 0 0 0 1.967-1.967c.2-.395.34-.917.413-1.824C49 34.793 49 33.605 49 31.9V19.1c0-1.705-.001-2.893-.077-3.819-.074-.907-.212-1.429-.413-1.824a4.5 4.5 0 0 0-1.967-1.966c-.395-.202-.917-.34-1.824-.414C43.793 11 42.605 11 40.9 11H15.1c-1.705 0-2.893.001-3.819.077" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},910551:(e,t,i)=>{i.d(t,{Icon56LogoClipsOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon56LogoClipsOutline","logo_clips_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="logo_clips_outline_56"><path fill="currentColor" d="M20.138 4.003A1.6 1.6 0 0 1 21.835 5.5l.803 12.8a1.6 1.6 0 0 1-3.194.2l-.803-12.8a1.6 1.6 0 0 1 1.497-1.697m20.338 20.358a1.5 1.5 0 0 0-1.952 2.278c3.166 2.714 4.474 6.273 4.476 9.289v.008C43 41.508 37.834 49 28.073 49c-3.654 0-7.463-1.415-10.345-3.797C14.855 42.828 13 39.583 13 35.936c0-1.686.519-3.43 1.615-4.725C15.675 29.957 17.376 29 20.036 29c1.441 0 3.813.703 5.06 4.027a1.5 1.5 0 0 0 2.809-1.054c-1.753-4.672-5.377-5.971-7.864-5.973h-.005c-3.47 0-6.036 1.293-7.712 3.273C10.684 31.212 10 33.686 10 35.936c0 4.73 2.413 8.766 5.817 11.58C19.212 50.32 23.69 52 28.073 52 39.553 52 45.997 43.103 46 35.941v-.005c0-3.855-1.661-8.264-5.524-11.575M35.825 5.057a1.6 1.6 0 0 1 1.117 1.968l-3.8 13.8a1.6 1.6 0 1 1-3.085-.85l3.8-13.8a1.6 1.6 0 0 1 1.968-1.118" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},19999:(e,t,i)=>{i.d(t,{default:()=>o});const o={layerOuter:"WebModalRoot__layerOuter--O6HAQ",outerFixed:"WebModalRoot__outerFixed--ildg7",layerIn:"WebModalRoot__layerIn--VH0kc"}},107528:(e,t,i)=>{i.d(t,{default:()=>o});const o={playlistPrivateIcon:"PlaylistCheckboxTooltip__playlistPrivateIcon--Q2r70"}},982184:(e,t,i)=>{i.d(t,{default:()=>o});const o={playlistPrivateIcon:"PlaylistPopover__playlistPrivateIcon--CxRHz",playlistSubhead:"PlaylistPopover__playlistSubhead--M3q0F",scrollHeight:"PlaylistPopover__scrollHeight--r5ujL",maxScrollHeight:"PlaylistPopover__maxScrollHeight--fjD1M"}},426955:(e,t,i)=>{i.d(t,{default:()=>o});const o={scroll:"PrivacyFriendsFormList__scroll--zmea0"}},451097:(e,t,i)=>{i.d(t,{default:()=>o});const o={status:"PrivacyFriendsFormStatus__status--vu5fb"}},780387:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"PopupStickerRoot__wrapper--oWtob"}},529247:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"ClipsCommentsScrollWrapper__wrapper--jnWG9"}},334655:(e,t,i)=>{i.d(t,{default:()=>o});const o={clipsCommentsSkeleton:"ClipsCommentsSkeleton__clipsCommentsSkeleton--GaX7O"}},326300:(e,t,i)=>{i.d(t,{default:()=>o});const o={feedWrapper:"ClipsFeedComponent__feedWrapper--ZNlpZ",feedWrapperFlex:"ClipsFeedComponent__feedWrapperFlex--6n7lD"}},725930:(e,t,i)=>{i.d(t,{default:()=>o});const o={root:"ClipsFeedControlsLayout__root--gKqwc"}},75976:(e,t,i)=>{i.d(t,{default:()=>o});const o={app:"PageSkeleton__app--MkkwX",feed:"PageSkeleton__feed--JBkbq",carousel:"PageSkeleton__carousel--2G4MG",carouselItem:"PageSkeleton__carouselItem--FteX4",gridItem:"PageSkeleton__gridItem--z0IPY"}},762216:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"CoOwners__wrapper--qYYVc",authorLink:"CoOwners__authorLink--pWpzA",coAuthorLink:"CoOwners__coAuthorLink--dk6P9"}},550628:(e,t,i)=>{i.d(t,{default:()=>o});const o={clipsModal:"ClipsModal__clipsModal--MEPIA",clipsFeedWrapper:"ClipsModal__clipsFeedWrapper--2lCb0",clipsFeedSidebar:"ClipsModal__clipsFeedSidebar--qyKGe"}},604818:(e,t,i)=>{i.d(t,{default:()=>o});const o={clipCommentsWidgetList:"ClipComments__clipCommentsWidgetList--Q01tN"}},463968:(e,t,i)=>{i.d(t,{default:()=>o});const o={clipSidebar:"ClipSidebar__clipSidebar--3AqDe",clipComments:"ClipSidebar__clipComments--7Xtn1"}},42802:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrap:"AttachmentStub__wrap--RFk36"}},738262:(e,t,i)=>{i.d(t,{default:()=>o});const o={root:"AudioAttachment__root--gXBSB"}},351655:(e,t,i)=>{i.d(t,{default:()=>o});const o={root:"CommentsBlock__root--A04RY",inputWrapper:"CommentsBlock__inputWrapper--LLLyI"}},342009:(e,t,i)=>{i.d(t,{default:()=>o});const o={button:"ScrollBackButton__button--V56Fe"}},963293:(e,t,i)=>{i.d(t,{default:()=>o});const o={root:"CommentsSkeleton__root--4Rdtw"}},13261:(e,t,i)=>{i.d(t,{default:()=>o});const o={emojiKeyboardWrapper:"InputActionButtons__emojiKeyboardWrapper--fgCPE"}},675736:(e,t,i)=>{i.d(t,{default:()=>o});const o={emojiKeyboardWrapper:"EmojiInputButton__emojiKeyboardWrapper--VtIwP"}},784623:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrap:"AttachStub__wrap--aH0rL"}},495792:(e,t,i)=>{i.d(t,{default:()=>o});const o={container:"VideoClipsWidget__container--KfKzS"}},453814:(e,t,i)=>{i.d(t,{default:()=>o});const o={modalHeader:"VideoPlaylistsModal__modalHeader--CyRtC"}},648214:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"LottiePlayer__wrapper--TRe0Y",wrapperClickable:"LottiePlayer__wrapperClickable--us5Hc"}},7279:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"BackgroundLayer__wrapper--ZKEnV"}},228679:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapperWithLinearGradient:"GradientLayer__wrapperWithLinearGradient--dy1wa",wrapperWithRadialGradient:"GradientLayer__wrapperWithRadialGradient--dj3fq"}},438185:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"PlayBackArea__wrapper--QT0CO",area:"PlayBackArea__area--GdpFO"}},526571:(e,t,i)=>{i.d(t,{default:()=>o});const o={wrapper:"PopupRoot__wrapper--0UPFd"}},651220:(e,t,i)=>{i.d(t,{useVirtualizer:()=>d,useWindowVirtualizer:()=>l});var o=i(296540),r=i(440961),s=i(842468);const n="undefined"!=typeof document?o.useLayoutEffect:o.useEffect;function a(e){const t=o.useReducer((()=>({})),{})[1],i={...e,onChange:(i,o)=>{var s;o?(0,r.flushSync)(t):t(),null==(s=e.onChange)||s.call(e,i,o)}},[a]=o.useState((()=>new s.Virtualizer(i)));return a.setOptions(i),o.useEffect((()=>a._didMount()),[]),n((()=>a._willUpdate())),a}function d(e){return a({observeElementRect:s.observeElementRect,observeElementOffset:s.observeElementOffset,scrollToFn:s.elementScroll,...e})}function l(e){return a({getScrollElement:()=>"undefined"!=typeof document?window:null,observeElementRect:s.observeWindowRect,observeElementOffset:s.observeWindowOffset,scrollToFn:s.windowScroll,initialOffset:()=>"undefined"!=typeof document?window.scrollY:0,...e})}},842468:(e,t,i)=>{i.d(t,{Virtualizer:()=>v,defaultRangeExtractor:()=>s,elementScroll:()=>m,observeElementOffset:()=>c,observeElementRect:()=>n,observeWindowOffset:()=>u,observeWindowRect:()=>d,windowScroll:()=>p});var o=i(580621);const r=e=>e,s=e=>{const t=Math.max(e.startIndex-e.overscan,0),i=Math.min(e.endIndex+e.overscan,e.count-1),o=[];for(let e=t;e<=i;e++)o.push(e);return o},n=(e,t)=>{const i=e.scrollElement;if(!i)return;const o=e.targetWindow;if(!o)return;const r=e=>{const{width:i,height:o}=e;t({width:Math.round(i),height:Math.round(o)})};if(r(i.getBoundingClientRect()),!o.ResizeObserver)return()=>{};const s=new o.ResizeObserver((e=>{const t=e[0];if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return void r({width:e.inlineSize,height:e.blockSize})}r(i.getBoundingClientRect())}));return s.observe(i,{box:"border-box"}),()=>{s.unobserve(i)}},a={passive:!0},d=(e,t)=>{const i=e.scrollElement;if(!i)return;const o=()=>{t({width:i.innerWidth,height:i.innerHeight})};return o(),i.addEventListener("resize",o,a),()=>{i.removeEventListener("resize",o)}},l="undefined"==typeof window||"onscrollend"in window,c=(e,t)=>{const i=e.scrollElement;if(!i)return;const r=e.targetWindow;if(!r)return;let s=0;const n=l?()=>{}:(0,o.debounce)(r,(()=>{t(s,!1)}),e.options.isScrollingResetDelay),d=o=>()=>{s=i[e.options.horizontal?"scrollLeft":"scrollTop"],n(),t(s,o)},c=d(!0),u=d(!1);return u(),i.addEventListener("scroll",c,a),i.addEventListener("scrollend",u,a),()=>{i.removeEventListener("scroll",c),i.removeEventListener("scrollend",u)}},u=(e,t)=>{const i=e.scrollElement;if(!i)return;const r=e.targetWindow;if(!r)return;let s=0;const n=l?()=>{}:(0,o.debounce)(r,(()=>{t(s,!1)}),e.options.isScrollingResetDelay),d=o=>()=>{s=i[e.options.horizontal?"scrollX":"scrollY"],n(),t(s,o)},c=d(!0),u=d(!1);return u(),i.addEventListener("scroll",c,a),i.addEventListener("scrollend",u,a),()=>{i.removeEventListener("scroll",c),i.removeEventListener("scrollend",u)}},h=(e,t,i)=>{if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e){return Math.round(e[i.options.horizontal?"inlineSize":"blockSize"])}}return Math.round(e.getBoundingClientRect()[i.options.horizontal?"width":"height"])},p=(e,{adjustments:t=0,behavior:i},o)=>{var r,s;const n=e+t;null==(s=null==(r=o.scrollElement)?void 0:r.scrollTo)||s.call(r,{[o.options.horizontal?"left":"top"]:n,behavior:i})},m=(e,{adjustments:t=0,behavior:i},o)=>{var r,s;const n=e+t;null==(s=null==(r=o.scrollElement)?void 0:r.scrollTo)||s.call(r,{[o.options.horizontal?"left":"top"]:n,behavior:i})};class v{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver((e=>{e.forEach((e=>{this._measureElement(e.target,e)}))})):null);return{disconnect:()=>{var e;return null==(e=t())?void 0:e.disconnect()},observe:e=>{var i;return null==(i=t())?void 0:i.observe(e,{box:"border-box"})},unobserve:e=>{var i;return null==(i=t())?void 0:i.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach((([t,i])=>{void 0===i&&delete e[t]})),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:r,rangeExtractor:s,onChange:()=>{},measureElement:h,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...e}},this.notify=(e,t)=>{var i,o;const{startIndex:r,endIndex:s}=this.range??{startIndex:void 0,endIndex:void 0},n=this.calculateRange();(e||r!==(null==n?void 0:n.startIndex)||s!==(null==n?void 0:n.endIndex))&&(null==(o=(i=this.options).onChange)||o.call(i,this,t))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach((e=>e())),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{var e;const t=this.options.getScrollElement();this.scrollElement!==t&&(this.cleanup(),this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,(e=>{this.scrollRect=e,this.notify(!1,!1)}))),this.unsubs.push(this.options.observeElementOffset(this,((e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.scrollOffset<e?"forward":"backward":null,this.scrollOffset=e;const i=this.isScrolling;this.isScrolling=t,this.notify(i!==t,t)}))))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=(0,o.memo)((()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey]),((e,t,i,o)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:i,getItemKey:o})),{key:!1}),this.getFurthestMeasurement=(e,t)=>{const i=new Map,o=new Map;for(let r=t-1;r>=0;r--){const t=e[r];if(i.has(t.lane))continue;const s=o.get(t.lane);if(null==s||t.end>s.end?o.set(t.lane,t):t.end<s.end&&i.set(t.lane,!0),i.size===this.options.lanes)break}return o.size===this.options.lanes?Array.from(o.values()).sort(((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end))[0]:void 0},this.getMeasurements=(0,o.memo)((()=>[this.getMeasurementOptions(),this.itemSizeCache]),(({count:e,paddingStart:t,scrollMargin:i,getItemKey:o},r)=>{const s=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const n=this.measurementsCache.slice(0,s);for(let a=s;a<e;a++){const e=o(a),s=1===this.options.lanes?n[a-1]:this.getFurthestMeasurement(n,a),d=s?s.end+this.options.gap:t+i,l=r.get(e),c="number"==typeof l?l:this.options.estimateSize(a),u=d+c,h=s?s.lane:a%this.options.lanes;n[a]={index:a,start:d,size:c,end:u,key:e,lane:h}}return this.measurementsCache=n,n}),{key:!1,debug:()=>this.options.debug}),this.calculateRange=(0,o.memo)((()=>[this.getMeasurements(),this.getSize(),this.scrollOffset]),((e,t,i)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:i}){const o=e.length-1,r=t=>e[t].start,s=g(0,o,r,i);let n=s;for(;n<o&&e[n].end<i+t;)n++;return{startIndex:s,endIndex:n}}({measurements:e,outerSize:t,scrollOffset:i}):null),{key:!1,debug:()=>this.options.debug}),this.getIndexes=(0,o.memo)((()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count]),((e,t,i,o)=>null===t?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:i,count:o})),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,i=e.getAttribute(t);return i?parseInt(i,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const i=this.measurementsCache[this.indexFromElement(e)];if(!i||!e.isConnected)return void this.measureElementCache.forEach(((t,i)=>{t===e&&(this.observer.unobserve(e),this.measureElementCache.delete(i))}));const o=this.measureElementCache.get(i.key);o!==e&&(o&&this.observer.unobserve(o),this.observer.observe(e),this.measureElementCache.set(i.key,e));const r=this.options.measureElement(e,t,this);this.resizeItem(i,r)},this.resizeItem=(e,t)=>{const i=t-(this.itemSizeCache.get(e.key)??e.size);0!==i&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(e,i,this):e.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,t)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=(0,o.memo)((()=>[this.getIndexes(),this.getMeasurements()]),((e,t)=>{const i=[];for(let o=0,r=e.length;o<r;o++){const r=t[e[o]];i.push(r)}return i}),{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();return(0,o.notUndefined)(t[g(0,t.length-1,(e=>(0,o.notUndefined)(t[e]).start),e)])},this.getOffsetForAlignment=(e,t)=>{const i=this.getSize();"auto"===t&&(t=e<=this.scrollOffset?"start":e>=this.scrollOffset+i?"end":"start"),"start"===t||("end"===t?e-=i:"center"===t&&(e-=i/2));const o=this.options.horizontal?"scrollWidth":"scrollHeight",r=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[o]:this.scrollElement[o]:0)-this.getSize();return Math.max(Math.min(r,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const i=(0,o.notUndefined)(this.getMeasurements()[e]);if("auto"===t)if(i.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)t="end";else{if(!(i.start<=this.scrollOffset+this.options.scrollPaddingStart))return[this.scrollOffset,t];t="start"}const r="end"===t?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(r,t),t]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{null!==this.scrollToIndexTimeoutId&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:i}={})=>{this.cancelScrollToIndex(),"smooth"===i&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:i})},this.scrollToIndex=(e,{align:t="auto",behavior:i}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),"smooth"===i&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[r,s]=this.getOffsetForIndex(e,t);this._scrollToOffset(r,{adjustments:void 0,behavior:i}),"smooth"!==i&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout((()=>{this.scrollToIndexTimeoutId=null;if(this.measureElementCache.has(this.options.getItemKey(e))){const[t]=this.getOffsetForIndex(e,s);(0,o.approxEqual)(t,this.scrollOffset)||this.scrollToIndex(e,{align:s,behavior:i})}else this.scrollToIndex(e,{align:s,behavior:i})})))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),"smooth"===t&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let i;return i=0===t.length?this.options.paddingStart:1===this.options.lanes?(null==(e=t[t.length-1])?void 0:e.end)??0:Math.max(...t.slice(-this.options.lanes).map((e=>e.end))),i-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:t,behavior:i})=>{this.options.scrollToFn(e,{behavior:i,adjustments:t},this)},this.measure=()=>{var e,t;this.itemSizeCache=new Map,null==(t=(e=this.options).onChange)||t.call(e,this,!1)},this.setOptions(e),this.scrollRect=this.options.initialRect,this.scrollOffset="function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((e=>{this.itemSizeCache.set(e.key,e.size)})),this.notify(!1,!1)}}const g=(e,t,i,o)=>{for(;e<=t;){const r=(e+t)/2|0,s=i(r);if(s<o)e=r+1;else{if(!(s>o))return r;t=r-1}}return e>0?e-1:0}},580621:(e,t,i)=>{function o(e,t,i){let o,r=i.initialDeps??[];return()=>{var s,n,a,d;let l;i.key&&(null==(s=i.debug)?void 0:s.call(i))&&(l=Date.now());const c=e();if(!(c.length!==r.length||c.some(((e,t)=>r[t]!==e))))return o;let u;if(r=c,i.key&&(null==(n=i.debug)?void 0:n.call(i))&&(u=Date.now()),o=t(...c),i.key&&(null==(a=i.debug)?void 0:a.call(i))){const e=Math.round(100*(Date.now()-l))/100,t=Math.round(100*(Date.now()-u))/100,o=t/16,r=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c⏱ ${r(t,5)} /${r(e,5)} ms`,`\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl(${Math.max(0,Math.min(120-120*o,120))}deg 100% 31%);`,null==i?void 0:i.key)}return null==(d=null==i?void 0:i.onChange)||d.call(i,o),o}}function r(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?`: ${t}`:""));return e}i.d(t,{approxEqual:()=>s,debounce:()=>n,memo:()=>o,notUndefined:()=>r});const s=(e,t)=>Math.abs(e-t)<1,n=(e,t,i)=>{let o;return function(...r){e.clearTimeout(o),o=e.setTimeout((()=>t.apply(this,r)),i)}}},807320:(e,t,i)=>{i.d(t,{PresenceChild:()=>d});var o=i(331635),r=i(296540),s=i(786719),n=i(328601),a=i(114278),d=function(e){var t=e.children,i=e.initial,d=e.isPresent,c=e.onExitComplete,u=e.custom,h=e.presenceAffectsLayout,p=(0,n.useConstant)(l),m=(0,a.useId)(),v=(0,r.useMemo)((function(){return{id:m,initial:i,isPresent:d,custom:u,onExitComplete:function(e){var t,i;p.set(e,!0);try{for(var r=(0,o.__values)(p.values()),s=r.next();!s.done;s=r.next()){if(!s.value)return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}null==c||c()},register:function(e){return p.set(e,!1),function(){return p.delete(e)}}}}),h?void 0:[d]);return(0,r.useMemo)((function(){p.forEach((function(e,t){return p.set(t,!1)}))}),[d]),r.useEffect((function(){!d&&!p.size&&(null==c||c())}),[d]),r.createElement(s.PresenceContext.Provider,{value:v},t)};function l(){return new Map}},854999:(e,t,i)=>{i.d(t,{AnimatePresence:()=>p});var o=i(331635),r=i(296540),s=i(93593),n=i(198048),a=i(51194),d=i(807320),l=i(29473),c=i(525128),u=i(757491),h=function(e){return e.key||""};var p=function(e){var t=e.children,i=e.custom,p=e.initial,m=void 0===p||p,v=e.onExitComplete,g=e.exitBeforeEnter,_=e.presenceAffectsLayout,C=void 0===_||_,y=(0,o.__read)((0,n.useForceUpdate)(),1)[0],b=(0,r.useContext)(l.LayoutGroupContext).forceRender;b&&(y=b);var I=(0,a.useIsMounted)(),S=function(e){var t=[];return r.Children.forEach(e,(function(e){(0,r.isValidElement)(e)&&t.push(e)})),t}(t),f=S,w=new Set,E=(0,r.useRef)(f),k=(0,r.useRef)(new Map).current,P=(0,r.useRef)(!0);if((0,c.useIsomorphicLayoutEffect)((function(){P.current=!1,function(e,t){e.forEach((function(e){var i=h(e);t.set(i,e)}))}(S,k),E.current=f})),(0,u.useUnmountEffect)((function(){P.current=!0,k.clear(),w.clear()})),P.current)return r.createElement(r.Fragment,null,f.map((function(e){return r.createElement(d.PresenceChild,{key:h(e),isPresent:!0,initial:!!m&&void 0,presenceAffectsLayout:C},e)})));f=(0,o.__spreadArray)([],(0,o.__read)(f),!1);for(var A=E.current.map(h),L=S.map(h),x=A.length,M=0;M<x;M++){var O=A[M];-1===L.indexOf(O)&&w.add(O)}return g&&w.size&&(f=[]),w.forEach((function(e){if(-1===L.indexOf(e)){var t=k.get(e);if(t){var o=A.indexOf(e);f.splice(o,0,r.createElement(d.PresenceChild,{key:h(t),isPresent:!1,onExitComplete:function(){k.delete(e),w.delete(e);var t=E.current.findIndex((function(t){return t.key===e}));if(E.current.splice(t,1),!w.size){if(E.current=S,!1===I.current)return;y(),v&&v()}},custom:i,presenceAffectsLayout:C},t))}}})),f=f.map((function(e){var t=e.key;return w.has(t)?e:r.createElement(d.PresenceChild,{key:h(e),isPresent:!0,presenceAffectsLayout:C},e)})),"production"!==s.env&&g&&f.length>1&&console.warn("You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour."),r.createElement(r.Fragment,null,w.size?f:f.map((function(e){return(0,r.cloneElement)(e)})))}},198048:(e,t,i)=>{i.d(t,{useForceUpdate:()=>a});var o=i(331635),r=i(282439),s=i(296540),n=i(51194);function a(){var e=(0,n.useIsMounted)(),t=(0,o.__read)((0,s.useState)(0),2),i=t[0],a=t[1],d=(0,s.useCallback)((function(){e.current&&a(i+1)}),[i]);return[(0,s.useCallback)((function(){return r.default.postRender(d)}),[d]),i]}},114278:(e,t,i)=>{i.d(t,{useId:()=>n});var o=i(328601),r=0,s=function(){return r++},n=function(){return(0,o.useConstant)(s)}},51194:(e,t,i)=>{i.d(t,{useIsMounted:()=>s});var o=i(296540),r=i(525128);function s(){var e=(0,o.useRef)(!1);return(0,r.useIsomorphicLayoutEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}},757491:(e,t,i)=>{i.d(t,{useUnmountEffect:()=>r});var o=i(296540);function r(e){return(0,o.useEffect)((function(){return function(){return e()}}),[])}},32105:(e,t,i)=>{i.d(t,{default:()=>o});const o=function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}},383149:(e,t,i)=>{i.d(t,{default:()=>r});var o=i(352531);const r=function(e,t){return!!(null==e?0:e.length)&&(0,o.default)(e,t,0)>-1}},887809:(e,t,i)=>{i.d(t,{default:()=>o});const o=function(e,t,i){for(var o=-1,r=null==e?0:e.length;++o<r;)if(i(t,e[o]))return!0;return!1}},458043:(e,t,i)=>{i.d(t,{default:()=>l});var o=i(601275),r=i(383149),s=i(887809),n=i(45572),a=i(552789),d=i(764099);const l=function(e,t,i,l){var c=-1,u=r.default,h=!0,p=e.length,m=[],v=t.length;if(!p)return m;i&&(t=(0,n.default)(t,(0,a.default)(i))),l?(u=s.default,h=!1):t.length>=200&&(u=d.default,h=!1,t=new o.default(t));e:for(;++c<p;){var g=e[c],_=null==i?g:i(g);if(g=l||0!==g?g:0,h&&_==_){for(var C=v;C--;)if(t[C]===_)continue e;m.push(g)}else u(t,_,l)||m.push(g)}return m}},925707:(e,t,i)=>{i.d(t,{default:()=>o});const o=function(e,t,i,o){for(var r=e.length,s=i+(o?1:-1);o?s--:++s<r;)if(t(e[s],s,e))return s;return-1}},391392:(e,t,i)=>{i.d(t,{default:()=>s});var o=i(976912),r=i(445075);const s=function e(t,i,s,n,a){var d=-1,l=t.length;for(s||(s=r.default),a||(a=[]);++d<l;){var c=t[d];i>0&&s(c)?i>1?e(c,i-1,s,n,a):(0,o.default)(a,c):n||(a[a.length]=c)}return a}},352531:(e,t,i)=>{i.d(t,{default:()=>n});var o=i(925707),r=i(866983),s=i(166031);const n=function(e,t,i){return t==t?(0,s.default)(e,t,i):(0,o.default)(e,r.default,i)}},126369:(e,t,i)=>{i.d(t,{default:()=>c});var o=i(601275),r=i(383149),s=i(887809),n=i(45572),a=i(552789),d=i(764099),l=Math.min;const c=function(e,t,i){for(var c=i?s.default:r.default,u=e[0].length,h=e.length,p=h,m=Array(h),v=1/0,g=[];p--;){var _=e[p];p&&t&&(_=(0,n.default)(_,(0,a.default)(t))),v=l(_.length,v),m[p]=!i&&(t||u>=120&&_.length>=120)?new o.default(p&&_):void 0}_=e[0];var C=-1,y=m[0];e:for(;++C<u&&g.length<v;){var b=_[C],I=t?t(b):b;if(b=i||0!==b?b:0,!(y?(0,d.default)(y,I):c(g,I,i))){for(p=h;--p;){var S=m[p];if(!(S?(0,d.default)(S,I):c(e[p],I,i)))continue e}y&&y.push(I),g.push(b)}}return g}},866983:(e,t,i)=>{i.d(t,{default:()=>o});const o=function(e){return e!=e}},224326:(e,t,i)=>{i.d(t,{default:()=>n});var o=i(929008),r=i(962245),s=i(558417);const n=function(e,t){return(0,s.default)((0,r.default)(e,t,o.default),e+"")}},301634:(e,t,i)=>{i.d(t,{default:()=>n});var o=i(639142),r=i(684171),s=i(929008);const n=r.default?function(e,t){return(0,r.default)(e,"toString",{configurable:!0,enumerable:!1,value:(0,o.default)(t),writable:!0})}:s.default},976501:(e,t,i)=>{i.d(t,{default:()=>r});var o=i(153533);const r=function(e){return(0,o.default)(e)?e:[]}},445075:(e,t,i)=>{i.d(t,{default:()=>a});var o=i(700241),r=i(241788),s=i(292049),n=o.default?o.default.isConcatSpreadable:void 0;const a=function(e){return(0,s.default)(e)||(0,r.default)(e)||!!(n&&e&&e[n])}},962245:(e,t,i)=>{i.d(t,{default:()=>s});var o=i(32105),r=Math.max;const s=function(e,t,i){return t=r(void 0===t?e.length-1:t,0),function(){for(var s=arguments,n=-1,a=r(s.length-t,0),d=Array(a);++n<a;)d[n]=s[t+n];n=-1;for(var l=Array(t+1);++n<t;)l[n]=s[n];return l[t]=i(d),(0,o.default)(e,this,l)}}},558417:(e,t,i)=>{i.d(t,{default:()=>r});var o=i(301634);const r=(0,i(369395).default)(o.default)},369395:(e,t,i)=>{i.d(t,{default:()=>r});var o=Date.now;const r=function(e){var t=0,i=0;return function(){var r=o(),s=16-(r-i);if(i=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},166031:(e,t,i)=>{i.d(t,{default:()=>o});const o=function(e,t,i){for(var o=i-1,r=e.length;++o<r;)if(e[o]===t)return o;return-1}},639142:(e,t,i)=>{i.d(t,{default:()=>o});const o=function(e){return function(){return e}}},144757:(e,t,i)=>{i.d(t,{default:()=>a});var o=i(458043),r=i(391392),s=i(224326),n=i(153533);const a=(0,s.default)((function(e,t){return(0,n.default)(e)?(0,o.default)(e,(0,r.default)(t,1,n.default,!0)):[]}))},217239:(e,t,i)=>{i.d(t,{default:()=>a});var o=i(45572),r=i(126369),s=i(224326),n=i(976501);const a=(0,s.default)((function(e){var t=(0,o.default)(e,n.default);return t.length&&t[0]===e[0]?(0,r.default)(t):[]}))},153533:(e,t,i)=>{i.d(t,{default:()=>s});var o=i(238446),r=i(753098);const s=function(e){return(0,r.default)(e)&&(0,o.default)(e)}},857456:(e,t,i)=>{i.d(t,{default:()=>n});var o=i(458043),r=i(224326),s=i(153533);const n=(0,r.default)((function(e,t){return(0,s.default)(e)?(0,o.default)(e,t):[]}))}}]);try{stManager?.done("dist/web/chunks/2d548543.05b4e08c.js")}catch(e){}