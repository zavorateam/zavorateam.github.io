<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор CSS-анимаций</title>
    <link href="./common_styles.css" rel="stylesheet">
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .animation-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .preview-area {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .control-panel {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .animation-target {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 8px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .keyframes-container {
            margin-top: 15px;
        }

        .keyframe {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .keyframe-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .remove-keyframe {
            background: none;
            border: none;
            color: #ff3333;
            cursor: pointer;
            font-weight: bold;
        }

        .properties-container {
            margin-top: 10px;
        }

        .property-row {
            display: flex;
            gap: 10px;
            margin-bottom: 5px;
        }

        .add-property {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            padding: 0;
            font-weight: bold;
        }

        .remove-property {
            background: none;
            border: none;
            color: #ff3333;
            cursor: pointer;
            padding: 0;
        }

        .output-container {
            margin-top: 20px;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .css-output {
            width: 100%;
            height: 150px;
            font-family: monospace;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            resize: none;
        }

        @media (max-width: 768px) {
            .animation-panel {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="cont">
        <h1>Генератор CSS-анимаций</h1>
        
        <div class="container">
            <p>Создайте свою CSS-анимацию и получите готовый код</p>
            
            <div class="animation-panel">
                <div class="preview-area">
                    <div class="animation-target" id="animationTarget"></div>
                </div>
                
                <div class="control-panel">
                    <div class="form-group">
                        <label for="animationName">Название анимации</label>
                        <input type="text" id="animationName" value="myAnimation">
                    </div>
                    
                    <div class="form-group">
                        <label for="animationDuration">Длительность (секунды)</label>
                        <input type="number" id="animationDuration" min="0.1" step="0.1" value="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="animationTimingFunction">Функция времени</label>
                        <select id="animationTimingFunction">
                            <option value="linear">Линейная</option>
                            <option value="ease" selected>Плавная</option>
                            <option value="ease-in">Плавное начало</option>
                            <option value="ease-out">Плавное окончание</option>
                            <option value="ease-in-out">Плавное начало и окончание</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="animationIterationCount">Количество повторений</label>
                        <select id="animationIterationCount">
                            <option value="1">1 раз</option>
                            <option value="2">2 раза</option>
                            <option value="3">3 раза</option>
                            <option value="infinite" selected>Бесконечно</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="animationDirection">Направление</label>
                        <select id="animationDirection">
                            <option value="normal">Нормальное</option>
                            <option value="reverse">Обратное</option>
                            <option value="alternate" selected>Чередование</option>
                            <option value="alternate-reverse">Обратное чередование</option>
                        </select>
                    </div>
                    
                    <h3>Ключевые кадры</h3>
                    <div id="keyframesContainer" class="keyframes-container">
                        <!-- Ключевые кадры будут добавлены здесь -->
                    </div>
                    
                    <button id="addKeyframeBtn" class="btn">Добавить ключевой кадр</button>
                </div>
            </div>
            
            <div class="output-container">
                <h3>CSS код</h3>
                <textarea id="cssOutput" class="css-output" readonly></textarea>
                <button id="copyCodeBtn" class="btn">Копировать код</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Основные элементы
            const animationTarget = document.getElementById('animationTarget');
            const keyframesContainer = document.getElementById('keyframesContainer');
            const addKeyframeBtn = document.getElementById('addKeyframeBtn');
            const cssOutput = document.getElementById('cssOutput');
            const copyCodeBtn = document.getElementById('copyCodeBtn');
            
            // Элементы управления анимацией
            const animationName = document.getElementById('animationName');
            const animationDuration = document.getElementById('animationDuration');
            const animationTimingFunction = document.getElementById('animationTimingFunction');
            const animationIterationCount = document.getElementById('animationIterationCount');
            const animationDirection = document.getElementById('animationDirection');
            
            // Массив для хранения данных ключевых кадров
            let keyframes = [
                { percentage: 0, properties: [{ name: 'transform', value: 'scale(1)' }] },
                { percentage: 50, properties: [{ name: 'transform', value: 'scale(1.5)' }] },
                { percentage: 100, properties: [{ name: 'transform', value: 'scale(1)' }] }
            ];
            
            // Доступные CSS свойства для анимации
            const availableProperties = [
                'transform',
                'opacity',
                'background-color',
                'width',
                'height',
                'border-radius',
                'margin',
                'padding',
                'color',
                'font-size',
                'letter-spacing'
            ];
            
            // Инициализация
            renderKeyframes();
            updateAnimation();
            updateCSSOutput();
            
            // Обработчики событий
            addKeyframeBtn.addEventListener('click', addKeyframe);
            copyCodeBtn.addEventListener('click', copyCSS);
            
            animationName.addEventListener('input', updateAnimation);
            animationDuration.addEventListener('input', updateAnimation);
            animationTimingFunction.addEventListener('change', updateAnimation);
            animationIterationCount.addEventListener('change', updateAnimation);
            animationDirection.addEventListener('change', updateAnimation);
            
            // Функции
            function renderKeyframes() {
                keyframesContainer.innerHTML = '';
                
                keyframes.forEach((keyframe, index) => {
                    const keyframeElement = document.createElement('div');
                    keyframeElement.className = 'keyframe';
                    
                    // Заголовок ключевого кадра
                    const keyframeHeader = document.createElement('div');
                    keyframeHeader.className = 'keyframe-header';
                    
                    const percentageLabel = document.createElement('label');
                    percentageLabel.textContent = 'Процент (%)';
                    
                    const percentageInput = document.createElement('input');
                    percentageInput.type = 'number';
                    percentageInput.min = 0;
                    percentageInput.max = 100;
                    percentageInput.value = keyframe.percentage;
                    percentageInput.addEventListener('input', (e) => {
                        keyframe.percentage = parseInt(e.target.value);
                        updateAnimation();
                        updateCSSOutput();
                    });
                    
                    const removeButton = document.createElement('button');
                    removeButton.className = 'remove-keyframe';
                    removeButton.textContent = '✕';
                    removeButton.addEventListener('click', () => {
                        if (keyframes.length > 2) {
                            keyframes.splice(index, 1);
                            renderKeyframes();
                            updateAnimation();
                            updateCSSOutput();
                        } else {
                            alert('Минимум 2 ключевых кадра требуется для анимации');
                        }
                    });
                    
                    keyframeHeader.appendChild(percentageLabel);
                    keyframeHeader.appendChild(percentageInput);
                    keyframeHeader.appendChild(removeButton);
                    keyframeElement.appendChild(keyframeHeader);
                    
                    // Контейнер для свойств
                    const propertiesContainer = document.createElement('div');
                    propertiesContainer.className = 'properties-container';
                    
                    // Отображение свойств
                    keyframe.properties.forEach((property, propIndex) => {
                        const propertyRow = createPropertyRow(keyframe, property, propIndex);
                        propertiesContainer.appendChild(propertyRow);
                    });
                    
                    // Кнопка добавления свойства
                    const addPropertyBtn = document.createElement('button');
                    addPropertyBtn.className = 'add-property';
                    addPropertyBtn.textContent = '+ Добавить свойство';
                    addPropertyBtn.addEventListener('click', () => {
                        keyframe.properties.push({ name: 'opacity', value: '1' });
                        renderKeyframes();
                        updateAnimation();
                        updateCSSOutput();
                    });
                    
                    propertiesContainer.appendChild(addPropertyBtn);
                    keyframeElement.appendChild(propertiesContainer);
                    
                    keyframesContainer.appendChild(keyframeElement);
                });
            }
            
            function createPropertyRow(keyframe, property, propIndex) {
                const row = document.createElement('div');
                row.className = 'property-row';
                
                // Выбор свойства
                const propertySelect = document.createElement('select');
                availableProperties.forEach(propName => {
                    const option = document.createElement('option');
                    option.value = propName;
                    option.textContent = propName;
                    propertySelect.appendChild(option);
                });
                propertySelect.value = property.name;
                propertySelect.addEventListener('change', (e) => {
                    property.name = e.target.value;
                    updateAnimation();
                    updateCSSOutput();
                });
                
                // Значение свойства
                const valueInput = document.createElement('input');
                valueInput.type = 'text';
                valueInput.value = property.value;
                valueInput.addEventListener('input', (e) => {
                    property.value = e.target.value;
                    updateAnimation();
                    updateCSSOutput();
                });
                
                // Кнопка удаления свойства
                const removeButton = document.createElement('button');
                removeButton.className = 'remove-property';
                removeButton.textContent = '✕';
                removeButton.addEventListener('click', () => {
                    if (keyframe.properties.length > 1) {
                        keyframe.properties.splice(propIndex, 1);
                        renderKeyframes();
                        updateAnimation();
                        updateCSSOutput();
                    } else {
                        alert('Требуется хотя бы одно свойство для каждого ключевого кадра');
                    }
                });
                
                row.appendChild(propertySelect);
                row.appendChild(valueInput);
                row.appendChild(removeButton);
                
                return row;
            }
            
            function addKeyframe() {
                const newPercentage = keyframes.length === 0 ? 0 : 
                    keyframes[keyframes.length - 1].percentage < 100 ? 
                    keyframes[keyframes.length - 1].percentage + 25 : 
                    (keyframes[keyframes.length - 2].percentage + keyframes[keyframes.length - 1].percentage) / 2;
                
                keyframes.push({
                    percentage: Math.min(100, newPercentage),
                    properties: [{ name: 'transform', value: 'scale(1)' }]
                });
                
                // Сортировка ключевых кадров по проценту
                keyframes.sort((a, b) => a.percentage - b.percentage);
                
                renderKeyframes();
                updateAnimation();
                updateCSSOutput();
            }
            
            function updateAnimation() {
                // Создаем стиль для анимации
                const name = animationName.value || 'myAnimation';
                const duration = animationDuration.value + 's';
                const timingFunction = animationTimingFunction.value;
                const iterationCount = animationIterationCount.value;
                const direction = animationDirection.value;
                
                // Применяем анимацию к элементу
                animationTarget.style.animation = `${name} ${duration} ${timingFunction} ${iterationCount} ${direction}`;
                
                // Создаем и добавляем стиль @keyframes
                updateKeyframesStyle(name);
            }
            
            function updateKeyframesStyle(name) {
                // Удаляем старый стиль, если есть
                const oldStyle = document.getElementById('keyframesStyle');
                if (oldStyle) {
                    oldStyle.remove();
                }
                
                // Создаем новый стиль
                const styleElement = document.createElement('style');
                styleElement.id = 'keyframesStyle';
                
                let keyframesCSS = `@keyframes ${name} {\n`;
                
                // Добавляем каждый ключевой кадр
                keyframes.forEach(keyframe => {
                    keyframesCSS += `  ${keyframe.percentage}% {\n`;
                    
                    // Добавляем свойства
                    keyframe.properties.forEach(property => {
                        keyframesCSS += `    ${property.name}: ${property.value};\n`;
                    });
                    
                    keyframesCSS += `  }\n`;
                });
                
                keyframesCSS += `}`;
                
                styleElement.textContent = keyframesCSS;
                document.head.appendChild(styleElement);
            }
            
            function updateCSSOutput() {
                const name = animationName.value || 'myAnimation';
                const duration = animationDuration.value + 's';
                const timingFunction = animationTimingFunction.value;
                const iterationCount = animationIterationCount.value;
                const direction = animationDirection.value;
                
                let css = `.element {\n`;
                css += `  animation: ${name} ${duration} ${timingFunction} ${iterationCount} ${direction};\n`;
                css += `}\n\n`;
                
                css += `@keyframes ${name} {\n`;
                
                // Добавляем каждый ключевой кадр
                keyframes.forEach(keyframe => {
                    css += `  ${keyframe.percentage}% {\n`;
                    
                    // Добавляем свойства
                    keyframe.properties.forEach(property => {
                        css += `    ${property.name}: ${property.value};\n`;
                    });
                    
                    css += `  }\n`;
                });
                
                css += `}`;
                
                cssOutput.value = css;
            }
            
            function copyCSS() {
                cssOutput.select();
                document.execCommand('copy');
                
                // Визуальная обратная связь
                const originalText = copyCodeBtn.textContent;
                copyCodeBtn.textContent = 'Скопировано!';
                setTimeout(() => {
                    copyCodeBtn.textContent = originalText;
                }, 1500);
            }
        });
    </script>
</body>
</html> 